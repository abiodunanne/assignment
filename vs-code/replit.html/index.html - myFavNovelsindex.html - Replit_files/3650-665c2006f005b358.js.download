!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="580fed2e-cf4f-483f-ba68-790b3423fbba",e._sentryDebugIdIdentifier="sentry-dbid-580fed2e-cf4f-483f-ba68-790b3423fbba")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"2f8d6ed5"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3650,4618],{11134:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(8182),i=n(94450),o=n.n(i);n(43429);var a=n(69832),l=n.n(a);function c(e){var t=e.unreadDot,n=e.size,i=void 0===n?12:n,a=e.count,c=void 0===a?null:a,s=c&&c>99,u=s?"99+":null==c?void 0:c.toString();return(0,r.BX)("span",{className:"jsx-1c7f3b9066c4c334",children:[(0,r.tZ)("svg",{width:i,height:i,viewBox:"0 0 24 24",fill:"none",style:{color:"currentColor"},xmlns:"http://www.w3.org/2000/svg",className:"jsx-1c7f3b9066c4c334",children:(0,r.tZ)("path",{d:"M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-1c7f3b9066c4c334"})}),t?(0,r.tZ)("div",{className:"jsx-1c7f3b9066c4c334 unread-indicator"}):null,!!c&&(0,r.tZ)("div",{className:"jsx-1c7f3b9066c4c334 "+(l()("count",{overflow:s})||""),children:u}),(0,r.tZ)(o(),{id:"1c7f3b9066c4c334",children:"span.jsx-1c7f3b9066c4c334{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.unread-indicator.jsx-1c7f3b9066c4c334{width:5px;height:5px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;background-color:var(--accent-red-default);-webkit-transform:translate(8px,-1px);-moz-transform:translate(8px,-1px);-ms-transform:translate(8px,-1px);-o-transform:translate(8px,-1px);transform:translate(8px,-1px);position:absolute}.count.jsx-1c7f3b9066c4c334{-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;background-color:var(--accent-negative-default);-webkit-transform:translate(50%,-50%);-moz-transform:translate(50%,-50%);-ms-transform:translate(50%,-50%);-o-transform:translate(50%,-50%);transform:translate(50%,-50%);position:absolute;min-width:16px;padding:2px 3px;height:16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;color:white;font-size:var(--font-size-small)}.overflow.jsx-1c7f3b9066c4c334{-webkit-transform:translate(25%,-50%);-moz-transform:translate(25%,-50%);-ms-transform:translate(25%,-50%);-o-transform:translate(25%,-50%);transform:translate(25%,-50%)}"})]})}},55846:function(e,t,n){n.d(t,{AS:function(){return T},Hj:function(){return P},Rp:function(){return I},Tt:function(){return N},gE:function(){return G},j7:function(){return _},xT:function(){return S},yi:function(){return k}});var r=n(45903),i=n(93295),o=n(23982),a=n(66039),l=n(13440),c=n(71362);function s(){var e=(0,i._)(["\n  fragment AnnotationsUser on User {\n    id\n    username\n    fullName\n    image\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  fragment AnnotationMessageContent on MessageContentType {\n    __typename\n    ... on TextMessageContentType {\n      text\n    }\n    ... on PreviewMessageContentType {\n      preview\n    }\n    ... on StatusMessageContentType {\n      status\n    }\n  }\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  fragment AnnotationsUIMessage on AnnotationMessage {\n    id\n    user {\n      id\n      ...AnnotationsUser\n    }\n    anchor {\n      id\n    }\n    timeCreated\n    content {\n      __typename\n      ...AnnotationMessageContent\n    }\n    currentUserIsAuthor\n    seen\n  }\n  ","\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  fragment AnnotationsUIAnchor on AnnotationAnchor {\n    id\n    user {\n      id\n      ...AnnotationsUser\n    }\n    path\n    otVersion\n    indexStart\n    indexEnd\n    isResolved\n    isGeneral\n    messages {\n      id\n      ...AnnotationsUIMessage\n    }\n  }\n  ","\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  query AnnotationAnchorsByRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        annotationAnchors {\n          id\n          ...AnnotationsUIAnchor\n        }\n      }\n    }\n    currentUser {\n      id\n      username\n      fullName\n      image\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation CreateAnnotationAnchor(\n    $annotationAnchor: AnnotationAnchorInput!\n    $annotationMessage: AnnotationMessageInput\n    $highlight: AnnotationHighlightInput\n  ) {\n    createAnnotationAnchor(\n      annotationAnchor: $annotationAnchor\n      annotationMessage: $annotationMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}function m(){var e=(0,i._)(["\n  mutation UpdateAnnotationAnchor(\n    $id: String!\n    $changes: AnnotationAnchorChangesInput!\n  ) {\n    updateAnnotationAnchor(id: $id, changes: $changes) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}function v(){var e=(0,i._)(["\n  mutation CreateAnnotationMessage(\n    $replId: String!\n    $anchorId: String!\n    $annotationMessage: AnnotationMessageInput!\n    $highlight: AnnotationHighlightInput\n  ) {\n    createAnnotationMessage(\n      replId: $replId\n      anchorId: $anchorId\n      annotationMessage: $annotationMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return v=function(){return e},e}function g(){var e=(0,i._)(["\n  mutation updateThreadPreview(\n    $threadId: String!\n    $messageId: String!\n    $message: String\n  ) {\n    updateThreadPreview(\n      threadId: $threadId\n      messageId: $messageId\n      message: $message\n    )\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,i._)(["\n  subscription AnnotationUpdates($replId: String!) {\n    updatedAnnotation: annotationUpdatesByRepl(replId: $replId) {\n      id\n      ...AnnotationsUIAnchor\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function b(){var e=(0,i._)(["\n  subscription MessagePreview($threadId: String!) {\n    threadPreview(threadId: $threadId) {\n      userId\n      messageId\n      message\n    }\n  }\n"]);return b=function(){return e},e}var Z={},w=(0,o.Ps)(s()),x=(0,o.Ps)(u()),C=(0,o.Ps)(d(),w,x),_=(0,o.Ps)(f(),w,C),k=(0,o.Ps)(h(),_);function S(e){var t=(0,r._)({},Z,e);return a.a(k,t)}var E=(0,o.Ps)(p(),_);function T(e){var t=(0,r._)({},Z,e);return l.D(E,t)}var R=(0,o.Ps)(m(),_);function I(e){var t=(0,r._)({},Z,e);return l.D(R,t)}var D=(0,o.Ps)(v(),_);function G(e){var t=(0,r._)({},Z,e);return l.D(D,t)}var B=(0,o.Ps)(g());function P(e){var t=(0,r._)({},Z,e);return l.D(B,t)}var A=(0,o.Ps)(y(),_);function N(e){var t=(0,r._)({},Z,e);return c.m(A,t)}b()},8482:function(e,t,n){n.d(t,{Ft:function(){return d},Vy:function(){return m},kL:function(){return p}});var r=n(34142),i=n(32477),o=n(87682),a=n(48900),l=n(84357);function c(){return(c=(0,r._)(function(e,t,n){var r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(!e.path||"number"!=typeof e.indexStart||"number"!=typeof e.indexEnd||!e.otVersion)return[2];if(n===e.otVersion)return[2,{path:e.path,indexStart:e.indexStart,indexEnd:e.indexEnd,otVersion:e.otVersion}];return[4,t({indexStart:e.indexStart,indexEnd:e.indexEnd,versionFrom:e.otVersion,versionTo:n})];case 1:return r=i.sent(),[2,{path:e.path,indexStart:r.indexStart,indexEnd:r.indexEnd,otVersion:n}]}})})).apply(this,arguments)}var s=n(54916),u=n(43429);function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,i,s,u,d;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(t=e.anchor,n=e.version,r=e.transformSelection,i=e.content,!t.path)return[2,null];return[4,function(e,t,n){return c.apply(this,arguments)}(t,r,n)];case 1:if(!(s=o.sent()))return[2,null];return d=function(){if(s){var e=s.indexStart,t=s.indexEnd;try{var n=l.xv.of(i.split("\n")),r=n.lineAt(e),o=n.lineAt(t),c=n.sliceString(n.line(Math.max(r.number-2,1)).from,e),u=n.sliceString(t,n.line(Math.min(o.number+2,n.lines)).to);return{precode:c,code:n.sliceString(e,t),postcode:u}}catch(e){a.Tb(e)}}},[2,{anchor:t,newSelection:s,newPosition:u,getHighlight:d,snippet:h(i,s)}]}})})).apply(this,arguments)}var h=function(e,t){var n=l.xv.of(e.split("\n")),r=n.lineAt(t.indexStart).number,i=n.lineAt(t.indexEnd).number,o=[];r===i&&(r=Math.max(1,r-1),i=Math.min(n.lines,i+1));for(var a=r;a<=i;a++)o.push(n.line(a).text);return{startLineNumber:r,lines:o}};function p(e){var t=(0,s.Z)().fs,n=u.useRef(null),r=u.useRef(null),o=(0,i._)(u.useState(!1),2),a=o[0],l=o[1];return u.useEffect(function(){if(e){var i=function(){r.current=null,l(!1)},o=t.watchTextFile(e,{onReady:function(e){var t=e.transformSelection,i=e.initialContent;n.current=i.toString(),r.current=t,l(!0)},onMoveOrDelete:function(){i()},onError:function(){i()},onChange:function(e){var t=e.latestContent;n.current=t}});return function(){i(),o()}}},[e,t]),{contentRef:n,transformSelectionRef:r,loadedFile:a}}function m(e){var t=(0,s.Z)().fs,n=(0,i._)(u.useState(null),2),r=n[0],o=n[1],l=p(null==e?void 0:e.path),c=l.contentRef,f=l.loadedFile,h=l.transformSelectionRef;return u.useEffect(function(){(null==e?void 0:e.path)&&f&&h.current&&null!==c.current&&d({anchor:e,version:t.getOTVersion(e.path),transformSelection:h.current,content:c.current}).then(function(e){o(e)}).catch(function(e){o(null),a.Tb(e)})},[t,e,f,h,c]),r}},19229:function(e,t,n){n.d(t,{n:function(){return u}});var r=n(45903),i=n(93295),o=n(23982),a=n(13440);function l(){var e=(0,i._)(["\n  mutation MarkMessagesAsSeen(\n    $replId: String!\n    $threadId: String\n    $messageIds: [String!]\n  ) {\n    markMessagesAsSeen(\n      replId: $replId\n      threadId: $threadId\n      messageIds: $messageIds\n    ) {\n      ... on AnnotationMessageList {\n        messages {\n          id\n          seen\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l());function u(e){var t=(0,r._)({},c,e);return a.D(s,t)}},59725:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(32477),i=n(43429),o=n(50782),a=n(19229);function l(e){var t=(0,o.Z)(),n=(0,r._)((0,a.n)(),1)[0];i.useEffect(function(){if(e){var r=e.messages.filter(function(e){return!e.seen}).map(function(e){return e.id});0!==r.length&&n({variables:{replId:t,threadId:e.id,messageIds:r},optimisticResponse:{__typename:"RootMutationType",markMessagesAsSeen:{messages:r.map(function(e){return{id:e,seen:!0,__typename:"AnnotationMessage"}}),__typename:"AnnotationMessageList"}}})}},[t,e,n])}},30456:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(45903),i=n(93295),o=n(23982),a=n(66039);function l(){var e=(0,i._)(["\n  query ThreadReplCollaborators($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          ... on User {\n            id\n            username\n            image\n            fullName\n          }\n          ... on Team {\n            id\n            username\n            image\n          }\n        }\n        permissions {\n          id\n          user {\n            id\n            username\n            image\n            fullName\n          }\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l()),u=n(50782);function d(){var e=(l={variables:{replId:(0,u.Z)()}},d=(0,r._)({},c,l),a.a(s,d)).data;if((null==e?void 0:e.repl.__typename)!=="Repl")return[];var t=[];(null===(f=e.repl.owner)||void 0===f?void 0:f.username)&&"User"===e.repl.owner.__typename&&t.push(e.repl.owner);var n=!0,i=!1,o=void 0;try{for(var l,d,f,h,p=e.repl.permissions[Symbol.iterator]();!(n=(h=p.next()).done);n=!0){var m,v=h.value;(null===(m=v.user)||void 0===m?void 0:m.username)&&t.push(v.user)}}catch(e){i=!0,o=e}finally{try{n||null==p.return||p.return()}finally{if(i)throw o}}return t}},58626:function(e,t,n){n.d(t,{q:function(){return G},J:function(){return D}});var r,i,o,a=n(45903),l=n(25e3),c=n(70322),s=n(32477),u=n(8182),d=n(23026),f=n(3194),h=n(2543),p=n(84357),m=n(38265),v=n(54340),g=m.tk.baseTheme({".cm-diff-inserted":{backgroundColor:"#0053A644",borderLeft:"#0053A6 solid 3px"},".cm-diff-deleted":{backgroundColor:"#c93c3733",borderLeft:"#c93c37 solid 3px"}}),y=m.p.line({attributes:{class:"cm-diff-inserted"}}),b=m.p.line({attributes:{class:"cm-diff-deleted"}}),Z=p.Py.define({map:function(e,t){return e.map(t)}}),w=function(e){"use strict";(0,f._)(n,e);var t=(0,h._)(n);function n(){return(0,d._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-alignment cm-line",e.innerHTML="&nbsp;",e},r.ignoreEvent=function(){return!1},n}(m.l9);function x(e){var t=new p.f_,n=new w;e.sort(function(e,t){return e.character-t.character});var r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0)for(var c=a.value,s=c.character,u=c.padding,d=0;d<u;d++)t.add(s,s,m.p.widget({widget:n,side:-1,block:!0}))}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return t.finish()}function C(e){var t=e.coloredLines,n=e.colorDecoration;return[g,m.lg.fromClass(function e(r){"use strict";(0,d._)(this,e);var i=new p.f_,o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,f=r.state.doc.line(u);i.add(f.from,f.from,n)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}this.decorations=i.finish()},{decorations:function(e){return e.decorations}}),p.QQ.define({create:function(){return m.p.none},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(Z))return l.value}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.docChanged?e.map(t.changes):e},provide:function(e){return m.tk.decorations.from(e)}})]}var _=n(20142),k=n(81013),S=n(43429),E=n(4498),T=(r=function(e,t){return m.tk.domEventHandlers({scroll:function(n,r){if(r===e&&n.target){var i=n.target;if(i.scrollTop){var o=i.scrollTop;t.scrollDOM.scrollTo({top:o})}}}})},i=new p.F6,o=new p.F6,{extensions:function(){return{right:i.of([]),left:o.of([])}},setup:function(e,t){e.dispatch({effects:o.reconfigure(r(e,t))}),t.dispatch({effects:i.reconfigure(r(t,e))})}}),R=T.extensions,I=T.setup;function D(e){var t=e.left,n=e.right,r=e.showDiffDecorations,i=void 0===r||r,o=t.code,u=(0,c._)(t,["code"]),d=n.code,f=(0,c._)(n,["code"]),h=(0,k.Z)(),m=h.ref,g=h.view,w=(0,k.Z)(),_=w.ref,E=w.view,T=S.useMemo(function(){var e=R().left;return u.extensions?[u.extensions,e]:e},[u.extensions]),D=S.useMemo(function(){var e=R().right;return f.extensions?[f.extensions,e]:e},[f.extensions]);u=(0,l._)((0,a._)({},u),{extensions:T}),f=(0,l._)((0,a._)({},f),{extensions:D});var G=(0,s._)(S.useState(!1),2),B=G[0],P=G[1],A=(0,s._)(S.useState(!1),2),N=A[0],U=A[1];return S.useEffect(function(){if(g&&E&&B&&N&&i){var e=setTimeout(function(){var e;I(g,E),e=(0,v.Bz)(g.state.doc.sliceString(0),E.state.doc.sliceString(0)),g.dispatch({effects:[p.Py.appendConfig.of(C({coloredLines:e.leftColored.sort(function(e,t){return e-t}),colorDecoration:b})),Z.of(x(e.leftPadded))]}),E.dispatch({effects:[p.Py.appendConfig.of(C({coloredLines:e.rightColored.sort(function(e,t){return e-t}),colorDecoration:y})),Z.of(x(e.rightPadded))]})});return function(){return clearTimeout(e)}}},[g,E,B,N,i]),S.useEffect(function(){g&&(g.dispatch({changes:{from:0,to:g.state.doc.length,insert:o}}),P(!0))},[o,g]),S.useEffect(function(){E&&(E.dispatch({changes:{from:0,to:E.state.doc.length,insert:d}}),U(!0))},[d,E]),{left:{view:g,ref:m,code:o,options:u,ready:B},right:{view:E,ref:_,code:d,options:f,ready:N}}}function G(e){var t=e.diffViewer,n=(0,c._)(e,["diffViewer"]),r=(0,a._)({},t.options,n);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(_.ZP,(0,a._)({ref:t.ref,css:{height:t.ready?0:"auto"},initialDoc:t.code,lineWrapping:!1,readOnly:!0},r)),!t.ready&&(0,u.tZ)(E.Z,{code:t.code,language:r.language,filePath:r.filePath,lineNumbers:!r.hideGutter,fontSize:r.fontSize})]})}},54340:function(e,t,n){n.d(t,{Bz:function(){return p},PO:function(){return m}});var r=n(23026),i=n(32477),o=n(87682),a=n(37443),l=n.n(a),c=l().DIFF_DELETE,s=l().DIFF_INSERT,u=l().DIFF_EQUAL;function d(e,t){var n=new(l()),r=n.diff_linesToChars_(e,t),i=r.chars1,o=r.chars2,a=r.lineArray,c=n.diff_main(i,o,!1);return n.diff_charsToLines_(c,a),c}function f(e){return e.split("\n").length-1}function h(e,t,n){if(e>0){var r=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===n)return 0;var i=t.indexOf("\n",r);return -1===i?null:1===n?i+1:e(t,n-1,i+1)}(n,t);if(null!==r)return{lineNumber:t,character:r,padding:e}}return null}function p(e,t){var n=!1,r=!1;n="\n"===e[e.length-1],r="\n"===t[t.length-1];for(var o=d(e+(n?"":"\n"),t+(r?"":"\n")),a=0,l=0,p=[],m=[],v=[],g=[],y=0,b=0,Z=0;Z<o.length;Z++){var w=(0,i._)(o[Z],2),x=w[0],C=f(w[1]);switch(x){case c:var _,k=(0,i._)(null!==(_=o[Z+1])&&void 0!==_?_:[],2),S=k[0],E=k[1];a+=C;for(var T=0;T<C;T++)p.push(a-T);var R=C;S===s&&(R-=f(E));var I=h(R,l,t);I&&g.push(I);break;case s:var D,G=(0,i._)(null!==(D=o[Z-1])&&void 0!==D?D:[],2),B=G[0],P=G[1];l+=C;for(var A=0;A<C;A++)m.push(l-A);var N=C;B===c&&(N-=f(P));var U=h(N,a,e);U&&v.push(U);break;case u:l>b&&(b=l),a>y&&(y=a),a+=C,l+=C}}return{leftPadded:v.filter(function(e){return e.lineNumber<b}),rightPadded:g.filter(function(e){return e.lineNumber<y}),leftColored:p,rightColored:m,changedTrailingNewline:n!==r,leftTrailingNewline:n,rightTrailingNewline:r}}var m=function(){"use strict";function e(t,n){(0,r._)(this,e),this.deleted=new Set,this.inserted=new Map,this.linePositions=new Map,this.lineLengths=new Map,this.currentTrailingNewline="\n"===t[t.length-1],this.otherTrailingNewline="\n"===n[n.length-1],this.changedTrailingNewline=this.currentTrailingNewline!==this.otherTrailingNewline;var o=d(t,n),a=[],l=!0,f=!1,h=void 0;try{for(var p,m=o[Symbol.iterator]();!(l=(p=m.next()).done);l=!0){var v=(0,i._)(p.value,2),g=v[0],y=v[1].split("\n");""===y[y.length-1]&&y.pop();var b=!0,Z=!1,w=void 0;try{for(var x,C=y[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var _=x.value;a.push([g,_])}}catch(e){Z=!0,w=e}finally{try{b||null==C.return||C.return()}finally{if(Z)throw w}}}}catch(e){f=!0,h=e}finally{try{l||null==m.return||m.return()}finally{if(f)throw h}}this.currentTrailingNewline&&!this.otherTrailingNewline?a.push([c,""]):!this.currentTrailingNewline&&this.otherTrailingNewline?a.push([s,""]):this.currentTrailingNewline&&this.otherTrailingNewline&&a.push([u,""]);var k=1,S=0,E=1,T=!0,R=!1,I=void 0;try{for(var D,G=a[Symbol.iterator]();!(T=(D=G.next()).done);T=!0){var B=(0,i._)(D.value,2),P=B[0],A=B[1];switch(P){case c:this.linePositions.set(k,S),this.lineLengths.set(k,A.length),this.deleted.add(k),S+=A.length+1,k++;break;case s:var N=k-1,U=this.inserted.get(N);U||(U=[],this.inserted.set(N,U)),U.push({number:E,content:A}),E++;break;case u:this.linePositions.set(k,S),this.lineLengths.set(k,A.length),S+=A.length+1,k++,E++}}}catch(e){R=!0,I=e}finally{try{T||null==G.return||G.return()}finally{if(R)throw I}}}var t=e.prototype;return t.startInsertions=function(){var e=this.inserted.get(0);return e&&0!==e.length?e:null},t.lineIsDeleted=function(e){return this.deleted.has(e)},t.lineInsertions=function(e){var t=this.inserted.get(e);return t&&0!==t.length?t:null},t.lineInsertedContent=function(e){var t=this.lineInsertions(e);return t?t.map(function(e){return e.content}).join("\n"):null},t.offsetFor=function(e){var t,n,r;r=0+(null!==(n=null===(t=this.inserted.get(0))||void 0===t?void 0:t.length)&&void 0!==n?n:0);for(var i=1;i<e;i++){this.lineIsDeleted(i)&&r--;var o=this.lineInsertions(i);o&&(r+=o.length)}return r},t.linePosition=function(e){var t;return null!==(t=this.linePositions.get(e))&&void 0!==t?t:null},t.lineLength=function(e){var t;return null!==(t=this.lineLengths.get(e))&&void 0!==t?t:null},t.line=function(e){var t=this.linePosition(e),n=this.lineLength(e);if(null===t||null===n)return null;var r=this.offsetFor(e),i=this.lineIsDeleted(e),o=this.lineInsertions(e);return{number:e,from:t,to:t+n,length:n,offset:r,isDeleted:i,insertions:o}},t.lines=function(){var e,t,n,r,a,l,c,s;return(0,o.Jh)(this,function(o){switch(o.label){case 0:e=!0,t=!1,n=void 0,o.label=1;case 1:o.trys.push([1,6,7,8]),r=this.linePositions[Symbol.iterator](),o.label=2;case 2:if(e=(a=r.next()).done)return[3,5];if(l=(0,i._)(a.value,1)[0],!(c=this.line(l)))throw Error("line should not be null");return[4,c];case 3:o.sent(),o.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return s=o.sent(),t=!0,n=s,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})},e}()},30804:function(e,t,n){n.d(t,{z:function(){return a}});var r=n(23026),i=n(87682),o=n(31157),a=function(){"use strict";function e(t,n,i,o){(0,r._)(this,e),this.a=t,this.b=n,this.chunks=i,this.map=o}var t=e.prototype;return t.line=function(e,t){return t===o.MF.A?this.a.line(e):this.b.line(e)},t.bounds=function(e){if(0===this.chunks.length)return null;var t=(0,o.Cf)(this.chunks[0],e),n=(0,o.Cf)(this.chunks[this.chunks.length-1],e),r=e===o.MF.A?this.a.length:this.b.length,i=Math.min(n.to,r);return{from:t.from,to:i}},t.hasChanges=function(){return this.chunks.length>0},t.updateA=function(t,n){var r=this.b,i=(0,o.U_)(t,r,{chunks:this.chunks,changesA:n}),a=(0,o.XW)(t,r,i);return new e(t,r,i,a)},t.updateB=function(t,n){var r=this.a,i=(0,o.U_)(r,t,{chunks:this.chunks,changesB:n}),a=(0,o.XW)(r,t,i);return new e(r,t,i,a)},t.getContainingChunk=function(e,t){for(var n=0,r=this.chunks.length-1;n<=r;){var i=n+r>>>1,a=this.chunks[i],l=(0,o.Cf)(a,t);if(e>=l.from&&e<=l.to)return a;e<l.from?r=i-1:e>l.to&&(n=i+1)}return null},t.getCorrespondingLine=function(e,t){var n=this.map.get(t===o.MF.A?-e:e);return n?this.line(n,(0,o.rN)(t)):null},t.getLineChangeType=function(e,t){if(this.map.get(t===o.MF.A?-e:e))return o.dQ.UNCHANGED;var n=this.line(e,t),r=this.getContainingChunk(n.from,t);return r?(0,o.dx)(n,t,r.changes,r):o.dQ.UNCHANGED},t.iterLines=function(e){var t,n,r,a;return(0,i.Jh)(this,function(i){switch(i.label){case 0:t=e===o.MF.A?this.a:this.b,n=1,i.label=1;case 1:if(!(n<=t.lines))return[3,4];return r=t.line(n),a=this.getCorrespondingLine(r.number,e),[4,{line:r,correspondingLine:a}];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})},t.iterRanges=function(){var e,t,n,r,o;return(0,i.Jh)(this,function(i){switch(i.label){case 0:e=0,i.label=1;case 1:if(!(e<this.chunks.length))return[3,6];t=this.chunks[e].fromA,n=this.chunks[e].fromB,r=0,i.label=2;case 2:if(!(r<this.chunks[e].changes.length))return[3,5];return o=this.chunks[e].changes[r],[4,{fromA:t+o.fromA,toA:t+o.toA,fromB:n+o.fromB,toB:n+o.toB}];case 3:i.sent(),i.label=4;case 4:return r++,[3,2];case 5:return e++,[3,1];case 6:return[2]}})},e.create=function(t,n){var r=(0,o.U_)(t,n),i=(0,o.XW)(t,n,r);return new e(t,n,r,i)},e}()},10814:function(e,t,n){n.d(t,{p:function(){return q}});var r,i=n(84357),o=n(23026),a=n(57953),l=n(3194),c=n(2543),s=n(38265),u=n(74633),d=n(81232),f=n(30804),h=n(67075),p=i.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),m=i.QQ.define({create:function(){return{diff:null,tree:d.mp.empty}},update:function(e,t){var n,r,i=t.state.facet(p),o=null===(n=t.state.facet(u.dK))||void 0===n?void 0:n.parser;if(!i)return null===e.diff&&e.tree===d.mp.empty?e:{diff:null,tree:d.mp.empty};var a=e.diff,l=e.tree;return(a&&a.a.eq(i)?t.docChanged&&(a=a.updateB(t.newDoc,t.changes)):(a=f.z.create(i,t.newDoc),l=d.mp.empty),(null===(r=t.startState.facet(u.dK))||void 0===r?void 0:r.parser)!==o&&(l=d.mp.empty),o&&l.length!==a.a.length)?(l=(0,h.p)({parser:o,text:a.a,maxTime:16,base:l}),{diff:a,tree:l}):e.diff===a&&e.tree===l?e:{diff:a,tree:l}}}),v=n(39698),g=n(29287),y="cm-inline-diff-line-deletion-base",b="cm-inline-diff-line-deletion",Z="cm-inline-diff-text-deletion",w="cm-inline-diff-line-insertion-base",x="cm-inline-diff-line-insertion",C="cm-inline-diff-text-insertion",_="rgba(180, 0, 0, 0.075)",k="rgba(180, 0, 0, 0.125)",S="rgba(0, 180, 0, 0.075)",E="rgba(0, 180, 0, 0.125)",T="cm-inline-diff-marker",R="cm-inline-diff-marker-left",I="cm-inline-diff-marker-right";function D(e,t){var n="linear-gradient(to right, ".concat(e,", ").concat(e,")");return t&&(n+=", linear-gradient(to right, ".concat(t,", ").concat(t,")")),n}var G=s.tk.theme((r={},(0,v._)(r,".".concat(y,", .").concat(b),{cursor:"text","&.cm-line ::selection":{backgroundColor:"".concat(g.TV.accentPrimaryDimmest," !important")}}),(0,v._)(r,".".concat(y),{background:D(_)}),(0,v._)(r,".".concat(b),{background:D(_,k)}),(0,v._)(r,".".concat(w),{background:D(S)}),(0,v._)(r,".".concat(x),{background:D(S,E)}),(0,v._)(r,".".concat(C),{display:"inline-block",background:E,"&:first-of-type":{backgroundClip:"padding-box",borderLeft:"3px solid ".concat(E),paddingLeft:"3px",marginLeft:"-6px"}}),(0,v._)(r,".".concat(Z),{display:"inline-block",background:k,"&:first-of-type":{backgroundClip:"padding-box",borderLeft:"3px solid ".concat(k),paddingLeft:"3px",marginLeft:"-6px"}}),(0,v._)(r,".".concat(T),{display:"flex",width:"100%",justifyContent:"space-between"}),(0,v._)(r,".".concat(R),{width:"calc(50% - 1ch)",textAlign:"right"}),(0,v._)(r,".".concat(I),{width:"50%",textAlign:"right"}),r)),B=n(31157),P=n(15658),A=n(3756),N=n.n(A),U=function(e){"use strict";(0,l._)(n,e);var t=(0,c._)(n);function n(e,r,i){var a;return(0,o._)(this,n),(a=t.call(this)).line=e,a.index=r,a.changed=i,a}var r=n.prototype;return r.toDOM=function(){var e=this,t=document.createElement("div");if(t.className=this.changed?"cm-line ".concat(y):"cm-line ".concat(b),!this.changed||!this.changed.length){var n=!0,r=!1,i=void 0;try{for(var o,a=this.line[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=l.text,s=l.tags,u=document.createElement("span");u.textContent=c||"\xa0",u.className=null!=s?s:"",t.appendChild(u)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}for(var d=0,f=0,h=null,p=null,m=function(t,n){if(!h)throw Error("range is null");var r=e.line[f],i=r.text,o=r.tags,a=i.slice(d-h.from,n-h.from),l=document.createElement("span");l.textContent=a||"\xa0",l.className=null!=o?o:"",t.appendChild(l),d+=a.length};f<this.line.length;){if(!h){var v=this.line[f].text;h={from:d,to:d+v.length}}if(!p){var g=!0,w=!1,x=void 0;try{for(var C,_=this.changed[Symbol.iterator]();!(g=(C=_.next()).done);g=!0){var k=C.value;if(!(k.from>=h.to)&&!(k.to<=d)){var S=document.createElement("span");S.className=Z,p={from:k.from,to:k.to,dom:S},d<p.from&&m(t,p.from),t.appendChild(S);break}}}catch(e){w=!0,x=e}finally{try{g||null==_.return||_.return()}finally{if(w)throw x}}}p?(d<p.to&&m(p.dom,p.to),d>=p.to&&(p=null)):m(t,h.to),d>=h.to&&(h=null,f++)}return t},r.eq=function(e){var t,r;return e instanceof n&&this.index===e.index&&this.line.length===e.line.length&&(null===(t=this.changed)||void 0===t?void 0:t.length)===(null===(r=e.changed)||void 0===r?void 0:r.length)&&N()(this.line,e.line)&&N()(this.changed,e.changed)},r.ignoreEvent=function(e){return e.stopImmediatePropagation(),!0},(0,a._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(s.l9),L=s.p.line({class:w}),O=s.p.line({class:x}),X=s.p.mark({class:C}),M=s.tk.decorations.compute([m],function(e){var t=function(e,t){if(r.getLineChangeType(e.number,B.MF.B)===B.dQ.COVERED)o.push(O.range(e.from));else{o.push(L.range(e.from));var n=!0,i=!1,a=void 0;try{for(var l,c=(0,B.Po)(e,t,B.MF.B,!1)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=l.value;o.push(X.range(s.from,s.to))}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}}},n=e.field(m,!1);if(!n||!n.diff)return s.p.none;var r=n.diff,i=n.tree,o=[],a=!0,l=!1,c=void 0;try{for(var u,d=r.chunks[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var f=u.value;if(f.fromB!==f.endB)for(var h=r.b.lineAt(f.fromB),p=r.b.lineAt(f.endB),v=h.number;v<=p.number;v++)t(r.b.line(v),f);else f.fromA===f.endA&&t(r.b.lineAt(f.fromB),f);if(f.fromA!==f.toA)for(var g=r.a.lineAt(f.fromA),y=(0,P.CT)(i,r.a,e,f.fromA,f.endA),b=0;b<y.length;b++){var Z=y[b],w=r.a.line(g.number+b),x=r.getLineChangeType(w.number,B.MF.A)===B.dQ.COVERED?null:(0,B.Po)(w,f,B.MF.A,!0),C=s.p.widget({widget:new U(Z,w.number,x),block:!0,side:-(y.length-b)});o.push(C.range(f.fromB))}}}catch(e){l=!0,c=e}finally{try{a||null==d.return||d.return()}finally{if(l)throw c}}return s.p.set(o,!0)}),F=n(92708),W=(0,s.v5)({class:F.Tr,renderEmptyElements:!0,lineMarker:function(e,t){var n=e.state.field(m,!1);if(!n||!n.diff||!n.diff.hasChanges())return null;if(0===n.diff.a.length)return F.vP;var r=e.state.doc.lineAt(t.from);switch(n.diff.getLineChangeType(r.number,B.MF.B)){case B.dQ.COVERED:case B.dQ.MODIFIED:return F.vP;default:return null}},widgetMarker:function(e,t){if(!(t instanceof U))return null;var n=e.state.field(m,!1);if(!n||!n.diff||!n.diff.hasChanges())return null;switch(n.diff.getLineChangeType(t.index,B.MF.A)){case B.dQ.COVERED:case B.dQ.MODIFIED:return F.We;default:return null}},initialSpacer:function(e){var t=e.state.field(m,!1);return(null==t?void 0:t.diff)?F.vP:F.Do},updateSpacer:function(e,t){var n=t.state.field(m,!1),r=(null==n?void 0:n.diff)?F.vP:F.Do;return e===r?e:r}}),H=n(3917),V=function(e){"use strict";(0,l._)(n,e);var t=(0,c._)(n);function n(e,r){var i;return(0,o._)(this,n),(i=t.call(this)).left=e,i.right=r,i}var r=n.prototype;return r.toDOM=function(e){var t=e.state.doc.lines.toString().length,n=document.createElement("div"),r=document.createElement("span"),i=document.createElement("span");return n.className=T,r.className=R,i.className=I,n.style.width="".concat(2*t+1,"ch"),null!==this.left&&(r.textContent=this.left.toString()),null!==this.right&&(i.textContent=this.right.toString()),n.appendChild(r),n.appendChild(i),n},r.eq=function(e){return e instanceof n&&this.left===e.left&&this.right===e.right},n}(s.SJ),z=H.X4.of(function(e,t){if(t instanceof U)return new V(t.index,null)}),j=[H.gy.of(function(e,t){var n,r=e.state.field(m,!1);if(r&&r.diff&&r.diff.hasChanges()){var i=e.state.doc.lineAt(t.from),o=r.diff.getCorrespondingLine(i.number,B.MF.B);return new V(null!==(n=null==o?void 0:o.number)&&void 0!==n?n:null,i.number)}}),z],q=i.r$.define({enables:function(e){return[p.computeN([e],function(t){return t.facet(e)}),F.Lw,m,G,M,j,W]}})},92708:function(e,t,n){n.d(t,{Do:function(){return I},Lw:function(){return k},Tr:function(){return d},Vt:function(){return R},We:function(){return E},vP:function(){return S},wp:function(){return T}});var r,i=n(23026),o=n(39698),a=n(3194),l=n(2543),c=n(38265),s=n(29287),u=s.TV.space2,d="cm-diff-gutter",f="".concat(d,"-element"),h="".concat(f,"-insertion"),p="".concat(f,"-modified"),m="".concat(f,"-deleted"),v="".concat(f,"-file-added"),g=s.TV.greenDefault,y=s.TV.greenStronger,b=s.TV.blueDefault,Z=s.TV.blueStronger,w=s.TV.redDefault,x=s.TV.redStronger,C=s.TV.greenDimmer,_=s.TV.greenDefault,k=c.tk.theme((r={},(0,o._)(r,".".concat(d,":first-of-type, .").concat(f),{width:u}),(0,o._)(r,".".concat(h),{backgroundColor:g,"&.cm-activeLineGutter":{backgroundColor:y}}),(0,o._)(r,".".concat(p),{backgroundColor:b,"&.cm-activeLineGutter":{backgroundColor:Z}}),(0,o._)(r,".".concat(m),{backgroundColor:w,"&.cm-activeLineGutter":{backgroundColor:x}}),(0,o._)(r,".".concat(v),{backgroundColor:C,"&.cm-activeLineGutter":{backgroundColor:_}}),r)),S=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(h),e}return n}(c.SJ)),E=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(m),e}return n}(c.SJ)),T=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(p),e}return n}(c.SJ)),R=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(v),e}return n}(c.SJ)),I=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return n}(c.SJ))},21677:function(e,t,n){n.d(t,{U:function(){return l}});var r=n(38265),i=n(75023),o=r.tk.theme({".cm-content":{paddingBottom:"".concat(80,"px")}}),a=r.tk.theme({".cm-content":{paddingBottom:"".concat(400,"px")}}),l=new i.j(function(e){return e?o:a})},77858:function(e,t,n){n.d(t,{i:function(){return d},o:function(){return u}});var r=n(98188),i=n(89061),o=n(76804),a=n(85255),l=n(54450),c=n(4753),s=n(27783),u=function(e){var t=e.state.field(a.WF,!1),n=e.state.facet(o.t);if(!t||!t.change||!t.timestamp||Date.now()-t.timestamp<150)return!1;var u=e.state.selection.main.head,d=e.state.doc.lineAt(u);if(u<=d.from+d.length-d.text.trimStart().length){var f=t.change.closestRange(u);if(f.value instanceof c.Yf){var h=f.value.unfulfilled.toString(),p=(0,s.L)(h,e.state.tabSize);if(p>0&&p>=e.state.tabSize)return!1}}var m=t.change.asChangeSpec(),v=e.state.changes(m),g=t.change.extendSelection(e.state.selection);return(0,r._B)(e),e.dispatch({changes:v,selection:g,scrollIntoView:!0,effects:a.OK.of(t.dismiss()),annotations:[l.Z.of(!0),i.Iv.of("full")]}),n.onSuggestionAccepted(e,v),!0},d=function(e){var t=e.state.field(a.WF,!1),n=e.state.facet(o.t);return!!t&&!!t.change&&!!t.presented&&(e.dispatch({effects:a.OK.of(t.dismiss())}),n.onSuggestionExplicitlyDismissed(e),!0)}},76804:function(e,t,n){n.d(t,{t:function(){return r}});var r=n(84357).r$.define({combine:function(e){var t=e.filter(Boolean);return{onDismiss:function(e){return t.forEach(function(t){var n;return null===(n=t.onDismiss)||void 0===n?void 0:n.call(t,e)})},onRequestIgnoredBackendOnly:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestIgnoredBackendOnly)||void 0===n?void 0:n.call(t,e)})},onRequestFirstEmit:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestFirstEmit)||void 0===n?void 0:n.call(t,e)})},onRequestEndedWithNoSuggestion:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestEndedWithNoSuggestion)||void 0===n?void 0:n.call(t,e)})},onRequestCompletelyPresented:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestCompletelyPresented)||void 0===n?void 0:n.call(t,e)})},onSuggestionExplicitlyDismissed:function(e){return t.forEach(function(t){var n;return null===(n=t.onSuggestionExplicitlyDismissed)||void 0===n?void 0:n.call(t,e)})},onSuggestionAccepted:function(e,n){return t.forEach(function(t){var r;return null===(r=t.onSuggestionAccepted)||void 0===r?void 0:r.call(t,e,n)})}}}})},20916:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(92920),i=n(20798),o=n(45903),a=n(93295),l=n(23982),c=n(66039);function s(){var e=(0,a._)(['\n  query CompleteCodeEngine {\n    currentUser {\n      id\n      defaultEngine: gateVariation(feature: "flag-ghostwriter-complete-engine")\n      hasOverride: gate(feature: "flag-code-suggestion-engine")\n    }\n  }\n']);return s=function(){return e},e}var u={},d=(0,l.Ps)(s());function f(){var e,t,n,a,l=(0,r.Z)().preferences,s=(e=(0,o._)({},u,void 0),c.a(d,e)).data,f=null==l?void 0:l.completeCodeEngine;if(f&&(null==s?void 0:null===(t=s.currentUser)||void 0===t?void 0:t.hasOverride)&&i.vw.has(f))return{engine:f,settings:i.Uw[f]};var h=null!==(a=null==s?void 0:null===(n=s.currentUser)||void 0===n?void 0:n.defaultEngine)&&void 0!==a?a:i.OO;return{engine:h,settings:i.Uw[h]}}},21012:function(e,t,n){n.d(t,{Yy:function(){return i},ZP:function(){return m},G_:function(){return p}});var r,i,o=n(25425),a=n(45903),l=n(93295),c=n(23982),s=n(66039);function u(){var e=(0,l._)(['\n  query CompleteCode {\n    currentUser {\n      id\n      userPowerUpsByType {\n        __typename\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n      hasKillswitch: gate(feature: "flag-killswitch-ghostwriter")\n    }\n  }\n']);return u=function(){return e},e}var d={},f=(0,c.Ps)(u()),h=n(85172);function p(e){return"None"!==e&&"BackendOnly"!==e}function m(){var e,t,n,r,i=(e=(0,a._)({},d,void 0),s.a(f,e)).data,l=(0,o.P5)({controlName:"flag-gw-charmander",logFlagToAnalytics:!0}),c=(0,o.P5)({controlName:"flag-gw-charizard",logFlagToAnalytics:!0});if((0,h.v)().isTeamWithAiDisabled)return"None";var u=(null==i?void 0:null===(n=i.currentUser)||void 0===n?void 0:null===(t=n.userPowerUpsByType)||void 0===t?void 0:t.__typename)==="UserPowerUpsTypes"&&(null==i?void 0:i.currentUser.userPowerUpsByType.ghostwriter.active);return(null==i?void 0:null===(r=i.currentUser)||void 0===r?void 0:r.hasKillswitch)?"None":u?"Pro":l?c?"Basic":"BackendOnly":"None"}(r=i||(i={})).None="None",r.Basic="Basic",r.Pro="Pro",r.BackendOnly="BackendOnly"},48581:function(e,t,n){n.d(t,{S:function(){return f},t:function(){return d}});var r=n(45903),i=n(25e3),o=n(32477),a=n(11516),l=n(43429),c=n(90234),s=n(71999),u="ai.codecomplete.lastTooltipHintTimestamp",d=(0,c.cn)({tooltipOpen:!1,consecutiveRejections:0});function f(){var e=(0,o._)((0,s.KO)(d),2),t=e[0],n=e[1];return(0,l.useEffect)(function(){if(t.tooltipOpen){var e=setTimeout(function(){return n(function(e){return(0,i._)((0,r._)({},e),{tooltipOpen:!1})})},2500);return function(){return clearTimeout(e)}}},[t.tooltipOpen,n]),{recordAccept:function(){n(function(e){return(0,i._)((0,r._)({},e),{consecutiveRejections:0})})},recordReject:function(){n(function(e){var t=e.consecutiveRejections+1;if(t>=5){var n=a.Z.get(u,"number");if(!n||Date.now()-n>=432e6)return a.Z.set(u,Date.now()),(0,i._)((0,r._)({},e),{consecutiveRejections:t,tooltipOpen:!0})}return(0,i._)((0,r._)({},e),{consecutiveRejections:t})})},resetState:function(){n(function(e){return(0,i._)((0,r._)({},e),{tooltipOpen:!1,consecutiveRejections:0})})},tooltipOpen:t.tooltipOpen}}},62299:function(e,t,n){n.d(t,{Z:function(){return eR}});var r=n(45903),i=n(25e3),o=n(92994),a=n(92920),l=n(50782),c=n(50199),s=n(43429),u=n(95683),d=n(23026),f=n(32477),h=n(22470),p=n(2283),m=function(){"use strict";function e(){(0,d._)(this,e),this.cache=new h.L(p.vq)}var t=e.prototype;return t.find=function(e){if(this.cache.has(e))return this.cache.get(e);var t=null,n=!0,r=!1,i=void 0;try{for(var o,a=this.cache.entries()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=(0,f._)(o.value,2),c=l[0],s=l[1];if(!(c.length>e.length)&&!(c.length+s.length<=e.length)){var u=c+s;if(u.startsWith(e)){var d=u.slice(e.length);if(d.trim().length<5)continue;t=d,this.cache.set(c,s);break}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t},t.get=function(e){var t=this.find(e);return null===t?null:JSON.stringify({text:t})+"\n"},t.set=function(e,t){this.cache.set(e,t)},e}(),v=n(95867),g=n(34142),y=n(87682),b=n(48900),Z=n(98188),w=n(74633),x=n(84357),C=n(38265),_=n(40497),k=n(59868),S=n(69451),E=n.n(S),T=n(96905),R=n(57783),I=n(89396),D=n(10275),G=n(27308),B=n(21012);function P(e,t,n){var i=null,o=function(){};return{queue:function(a){if(!(Math.random()>n)){i&&clearTimeout(i);var l=function(){(0,k.j)(k.U3.CODE_SUGGESTION_USED,(0,r._)({type:e},a))};i=setTimeout(l,t),o=l}},flush:function(){i&&clearTimeout(i),o()},cancel:function(){i&&clearTimeout(i)}}}var A=n(33212),N=n(20916),U=n(25425),L=n(54916),O=n(29559),X=n(58091),M={javascript:["javascript","typescript"],python:["python","python3"],python3:["python","python3"],typescript:["javascript","typescript"]},F=["json"],W=n(96003),H=n(88674),V=n(5453),z=n(67073),j=n(53921),q=n(12621),Y=n(47507),$=new Map,J={beforeCompletion:function(e){b.n_({category:"ghostwriter",message:"Called completeCode: "+e.engine,level:"debug"});var t=q.YX.add(e),n=Y.kg.timeStart({language:e.language,engine:e.engine,replid:e.replId,codeLength:e.code.length});return $.set(t,n),t},afterCompletion:function(e,t,n,r){switch(e){case"aborted":q.YX.abort(r),$.delete(r);break;case"success":b.n_({category:"ghostwriter",message:"Suggestion emitted: "+n.partialSuggestion,level:"debug"});var i=$.get(r);if(!i)throw Error("No latency logger found for handle: "+JSON.stringify(r));i("code suggestion",{type:"success"}),$.delete(r);break;case"finished":q.YX.complete(r,{__typename:"CompleteCodeResult",id:Date.now().toString(),code:n.completeSuggestion});break;default:throw Error("Unknown completion kind: "+e)}},erroredCompletion:function(e,t){t&&(q.YX.abort(t),$.delete(t)),Y.kg.error("CompleteCode: error in completion provider",{err:String(e)})}},K=n(48581);function Q(){return(Q=(0,z._)(function(e){var t,n,r,i;return(0,y.Jh)(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:return[4,(0,V._)(t.read())];case 2:if(r=(n=o.sent()).done,i=n.value,r)return[3,4];return[4,i];case 3:return o.sent(),[3,1];case 4:return t.releaseLock(),[2]}})})).apply(this,arguments)}function ee(){return(ee=(0,z._)(function(e){var t,n,r,i,o,a,l,c;return(0,y.Jh)(this,function(s){switch(s.label){case 0:t=new TextDecoder("utf-8"),n=!1,r=!1,s.label=1;case 1:s.trys.push([1,7,8,13]),o=(0,v._)(function(e){return Q.apply(this,arguments)}(e)),s.label=2;case 2:return[4,(0,V._)(o.next())];case 3:if(!(n=!(a=s.sent()).done))return[3,6];return l=a.value,[4,t.decode(l,{stream:!0})];case 4:s.sent(),s.label=5;case 5:return n=!1,[3,2];case 6:return[3,13];case 7:return c=s.sent(),r=!0,i=c,[3,13];case 8:if(s.trys.push([8,,11,12]),!(n&&null!=o.return))return[3,10];return[4,o.return()];case 9:s.sent(),s.label=10;case 10:return[3,12];case 11:if(r)throw i;return[7];case 12:return[7];case 13:return[2]}})})).apply(this,arguments)}var et=n(77858),en=x.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),er=n(83684),ei=n(85255),eo=n(86865),ea=n(54450),el=x.QQ.define({create:function(){return null},update:function(e,t){if(t.annotation(ea.Z)||!t.state.field(ei.WF).stopped)return null;if(!t.docChanged&&!t.selection)return e;var n=t.newDoc,r=t.newSelection.main.head;return t.annotation(x.YW.remote)?null!==e&&(0,er.zV)(n,r)&&(0,er.to)(n,r)?e:null:t.selection&&t.isUserEvent("select")?(0,er.zV)(n,r)&&(0,er.to)(n,r)?Date.now():null:t.docChanged&&null!==e?(0,er.zV)(n,r)&&(0,er.to)(n,r)?e:null:e}}),ec=function(){"use strict";function e(t){(0,d._)(this,e),this.view=t,this.timeout=null}var t=e.prototype;return t.update=function(e){var t=this,n=e.startState.field(el),r=e.state.field(el);n!==r&&(null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null),null!==r&&(this.timeout=setTimeout(function(){t.timeout=null,t.view.dispatch({effects:[eo.mb.of(eo.xz.NOW)]})},2500)))},t.destroy=function(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},e}(),es=C.lg.fromClass(ec,{provide:function(){return el}}),eu=n(57953),ed=n(76804),ef=n(66899),eh=n(27783),ep=/\r\n?|\n/,em=/^(?:\n[ \t]*)*/,ev=/^\s*[)\]};]+\n?$/;function eg(e){var t,n="",r="",i=e,o=null===(t=em.exec(e))||void 0===t?void 0:t[0];if(o){var a=o.split(ep);n=a.reduce(function(e){return e+"\n"},"").slice(1),r=a[a.length-1],i=i.slice(o.length)}else i=i.trimStart(),r=e.slice(0,e.length-i.length);return{newlines:n,indentation:r,content:i}}var ey=function(){"use strict";function e(t,n,r,i){(0,d._)(this,e),this.doc=t,this.tree=n,this.pos=r,this.line=t.lineAt(r),this.alreadyCut=!1;var o=eg(i);this.suggestion=o.indentation+o.content,this.startingNewlines=o.newlines}var t=e.prototype;return t.trimEnd=function(){return this.suggestion=this.suggestion.trimEnd(),this},t.removeStartingNewlineIfCurrentIsEmpty=function(){return this.startingNewlines&&0===this.line.text.trim().length&&(this.startingNewlines=""),this},t.orCutAtBlockEnd=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.alreadyCut||(0,ef.ib)(this.doc,this.tree,this.pos)&&(this.orCutAtLowerIndent(e),this.alreadyCut=!0),this},t.orCutIfContentBeforeCursor=function(){return this.alreadyCut||0!==this.doc.sliceString(this.line.from,this.pos).trim().length&&(this.suggestion=this.suggestion.split(ep)[0],this.alreadyCut=!0),this},t.orCutAtLowerIndent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.alreadyCut)return this;for(var t=this.suggestion.split(ep),n=(0,eh.L)(this.line.text+t[0],1),r=0;r<t.length;r++){var i=t[r];if(r>0&&(0,eh.L)(i,1)<n||0===r&&ev.test(i)){r!==t.length-1&&(this.suggestion=t.slice(0,r+(e?0:1)).join("\n")),this.alreadyCut=!0;break}}return this},t.orCutAtFirstLine=function(){return this.alreadyCut||(this.suggestion=this.suggestion.split(ep)[0],this.alreadyCut=!0),this},t.filter=function(){var e=(0,j.cx)(this.suggestion).replacementSuggestion;return e&&(this.suggestion=e),this},t.finish=function(){return this.suggestion?this.startingNewlines+this.suggestion:""},e}();function eb(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=new ey(e,t,n,r);return o.trimEnd().removeStartingNewlineIfCurrentIsEmpty(),i.skipComplexProcessing||o.orCutAtBlockEnd(i.excludeLastIndent).orCutIfContentBeforeCursor().orCutAtLowerIndent(i.excludeLastIndent).orCutAtFirstLine().filter().trimEnd(),o.finish()}var eZ=function(){"use strict";function e(t){var n=this;(0,d._)(this,e),this.config=t,this.finished=!1,this.abortController=new AbortController,this.suggestion="",this.promise=this.start(),this.abortController.signal.addEventListener("abort",function(){if(!n.finished){var e,t;n.finished=!0,null===(e=(t=n.config).onFinished)||void 0===e||e.call(t,null)}})}var t=e.prototype;return t.start=function(){var e=this;return(0,g._)(function(){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,g,b,Z,w,x,C,_,k,S,E,T,R,I;return(0,y.Jh)(this,function(y){switch(y.label){case 0:y.trys.push([0,13,,14]),r="",i=!0,o=!1,a=void 0;try{for(l=e.config.prefix.iter(-1)[Symbol.iterator]();!(i=(c=l.next()).done)&&(u=(s=c.value).trimEnd(),r=(s?s.slice(u.length):"\n")+r,!(u.length>0));i=!0);}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}d=e.config.prefix.length-r.length,f=r?e.config.prefix.slice(0,d):e.config.prefix,h=e.config.request({language:e.config.language,filePath:e.config.filePath,code:f.toString(),suffix:e.config.suffix?e.config.suffix.toString():void 0,maxTokens:e.config.maxTokens,signal:e.abortController.signal}),p=!0,m=!!r,g="",b=!1,Z=!1,y.label=1;case 1:y.trys.push([1,6,7,12]),x=(0,v._)(h),y.label=2;case 2:return[4,x.next()];case 3:if(!(b=!(C=y.sent()).done))return[3,5];if(_=C.value,m){if(g+=_,0===_.trim().length)return[3,4];if(m=!1,k=eg(g),S=eg(r),!k.indentation.startsWith(S.indentation)||!!S.newlines!=!!k.newlines)return e.abort(),[3,5];_=k.indentation.slice(S.indentation.length)+k.content}if(e.suggestion+=_,e.config.onTextReceived&&!1===e.config.onTextReceived(e.suggestion,p))return e.abort(),[3,5];p=!1,y.label=4;case 4:return b=!1,[3,2];case 5:return[3,12];case 6:return E=y.sent(),Z=!0,w=E,[3,12];case 7:if(y.trys.push([7,,10,11]),!(b&&null!=x.return))return[3,9];return[4,x.return()];case 8:y.sent(),y.label=9;case 9:return[3,11];case 10:if(Z)throw w;return[7];case 11:return[7];case 12:return[3,14];case 13:return T=y.sent(),e.aborted||e.abort(),T instanceof DOMException&&"AbortError"===T.name||null===(R=(I=e.config).onError)||void 0===R||R.call(I,T),[3,14];case 14:if(e.aborted)return[2,null];return e.finished=!0,null===(t=(n=e.config).onFinished)||void 0===t||t.call(n,e.suggestion),[2,e.suggestion]}})})()},t.abort=function(){this.aborted||this.abortController.abort()},t.then=function(e,t){return this.promise.then(e,t)},(0,eu._)(e,[{key:"aborted",get:function(){return this.abortController.signal.aborted}}]),e}(),ew=n(89798),ex=n(7612),eC=n(73164),e_=function(){"use strict";function e(t){(0,d._)(this,e),this.view=t,this.destroyed=!1,this.stream=null,this.debounceTimeout=null,this.queued=!1,this.lastPrefixLength=0}var t=e.prototype;return t.dispatchSuggestion=function(e){this.view.dispatch({effects:ei.OK.of(e)})},t.dismiss=function(){this.queued=!1,null!==this.debounceTimeout&&(clearTimeout(this.debounceTimeout),this.debounceTimeout=null),!this.stream||this.stream.finished||this.stream.aborted||this.stream.abort(),this.destroyed||this.suggestion.stopped||this.dispatchSuggestion(this.suggestion.dismiss()),this.listeners.onDismiss(this.view)},t.requestSuggestion=function(e){var t,n,r=this;if(null!==this.config&&null!==this.fileTypeConfig){if(null!==this.debounceTimeout&&(clearTimeout(this.debounceTimeout),this.debounceTimeout=null),!this.config.debounceAlways&&e===eo.xz.NOW){this.requestSuggestionImmediately();return}var i=this.view.state.selection.main.head,o=this.view.state.wordAt(i),a=o&&o.from!==i?null!==(n=this.config.debounceTimeInsideWord)&&void 0!==n?n:0:null!==(t=this.config.debounceTimeOutsideWord)&&void 0!==t?t:0;0===a?this.requestSuggestionImmediately():this.debounceTimeout=setTimeout(function(){r.debounceTimeout=null,r.requestSuggestionImmediately()},a)}},t.requestSuggestionImmediately=function(){var e,t,n=this;if(this.dismiss(),null!==this.config&&null!==this.fileTypeConfig&&!this.destroyed&&this.view.hasFocus&&(0,er.zV)(this.view.state.doc,this.view.state.selection.main.head)){var r=this.config,i=this.view.state,o=i.selection.main.head,a=i.doc,l=(0,w.qz)(i),c=this.fileTypeConfig,s=null!==(e=c.excludeLastIndent)&&void 0!==e&&e,u=null!==(t=c.skipComplexProcessing)&&void 0!==t&&t,d=(0,er.$j)(a,i.facet(w.c),o),f=r.infill?(0,er.WN)(a,o,s):null,h=p.uV.DEFAULT;(0,ef.ib)(a,l,o)&&(h=r.supportsExpandedMaximumTokens?p.uV.EMPTY_BLOCK_EXPANDED:p.uV.EMPTY_BLOCK),this.lastPrefixLength=d.length,r.backendOnly||this.dispatchSuggestion(this.suggestion.start(i)),this.stream=new eZ({request:r.request,language:c.id,filePath:c.path,maxTokens:h,prefix:d,suffix:f,onTextReceived:function(e,t){if(t&&n.listeners.onRequestFirstEmit(n.view),r.backendOnly){n.listeners.onRequestIgnoredBackendOnly(n.view);return}if(n.suggestion.stopped)return!1;var i=eb(a,l,o,e,{excludeLastIndent:s,skipComplexProcessing:u});if(!i)return!1;var c=n.suggestion.merge({from:o,insert:i},!r.infill);if(c.stopped)return!1;n.dispatchSuggestion(c)},onFinished:function(e){var t=n.queued;if(n.queued=!1,!r.backendOnly){if(e&&!n.suggestion.stopped){var i=eb(a,l,o,e,{excludeLastIndent:s,skipComplexProcessing:u});if(i){var c=n.suggestion.merge({from:o,insert:i},!r.infill);if(!c.stopped){n.dispatchSuggestion(c.present()),n.listeners.onRequestCompletelyPresented(n.view);return}}}n.dismiss(),t&&n.requestSuggestion(eo.xz.ENQUEUE),""===e&&n.listeners.onRequestEndedWithNoSuggestion(n.view)}},onError:function(e){b.$e(function(t){t.setExtra("prefix",d.toString()),t.setExtra("maxTokens",h),t.setExtra("language",c.id),t.setExtra("selection-head",o),t.setExtra("previous-character",a.sliceString(o-1,o)),r.onErrorExtras&&t.setExtras(r.onErrorExtras(n)),t.setTag("ghostwriter",!0),b.Tb(e)})}})}},t.postUpdate=function(e){(0,ex.a)(e,en,ew.Yp)&&this.dismiss(),(0,ex.a)(e,ei.WF)&&this.suggestion.stopped&&this.streaming&&this.dismiss();var t=(0,eo.Io)(e.transactions);switch(t){case eo.xz.STOP:this.active&&this.dismiss();break;case eo.xz.ENQUEUE:case eo.xz.NOW:this.active?this.queued=!0:this.requestSuggestion(t)}},t.destroy=function(){this.destroyed=!0,this.dismiss()},(0,eu._)(e,[{key:"config",get:function(){return this.view.state.facet(en)}},{key:"listeners",get:function(){return this.view.state.facet(ed.t)}},{key:"suggestion",get:function(){return this.view.state.field(ei.WF)}},{key:"fileTypeConfig",get:function(){var e,t=this.view.state.facet(ew.Yp);if(!t)return null;var n=eC.$R.from(t);if(!n)return null;var o=null===(e=n.getFeature("ai"))||void 0===e?void 0:e.complete;return(null==o?void 0:o.enabled)?(0,i._)((0,r._)({},o),{id:n.id,path:null!=t?t:""}):null}},{key:"streaming",get:function(){return null!==this.debounceTimeout||null!==this.stream&&!this.stream.finished}},{key:"active",get:function(){return this.streaming||!this.suggestion.stopped}}]),e}(),ek=C.lg.fromClass(e_,{provide:function(e){return C.tk.updateListener.of(function(t){var n;null===(n=t.view.plugin(e))||void 0===n||n.postUpdate(t)})}}),eS=function(){"use strict";function e(t){(0,d._)(this,e),this.view=t,this.gesture=null,this.touchstart=this.touchstart.bind(this),this.touchmove=this.touchmove.bind(this),this.touchend=this.touchend.bind(this),this.touchcancel=this.touchcancel.bind(this),t.dom.addEventListener("touchstart",this.touchstart)}var t=e.prototype;return t.shouldAllowSwiping=function(){if(!this.view.hasFocus)return!1;var e=this.view.state.selection.main.head,t=this.view.viewport;if(t.from>e||t.to<e)return!1;var n=this.view.state.field(ei.WF,!1);return!!n&&!!n.change&&!!n.presented},t.stop=function(){this.gesture&&(this.gesture=null,document.removeEventListener("touchmove",this.touchmove),document.removeEventListener("touchend",this.touchend),document.removeEventListener("touchcancel",this.touchcancel))},t.touchFor=function(e){if(!this.gesture)return null;var t=!0,n=!1,r=void 0;try{for(var i,o=e.changedTouches[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.identifier===this.gesture.id)return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return null},t.touchstart=function(e){if(this.gesture&&!this.gesture.time)return this.stop();if(!this.gesture&&this.shouldAllowSwiping()&&1===e.changedTouches.length){var t=e.changedTouches[0];this.gesture={id:t.identifier,start:{x:t.clientX,y:t.clientY},end:{x:t.clientX,y:t.clientY},time:null},document.addEventListener("touchmove",this.touchmove,{passive:!1}),document.addEventListener("touchend",this.touchend,{passive:!1}),document.addEventListener("touchcancel",this.touchcancel)}},t.touchmove=function(e){var t=this.touchFor(e);if(this.gesture&&t){if(this.gesture.end.x=t.clientX,this.gesture.end.y=t.clientY,this.gesture.time&&Date.now()-this.gesture.time>500)return this.stop();var n=Math.abs(this.gesture.start.y-this.gesture.end.y),r=Math.abs(this.gesture.start.x-this.gesture.end.x);if(n>20)return this.stop();if(r>10){if(this.gesture.start.x>this.gesture.end.x)return this.stop();this.gesture.time||(this.gesture.time=Date.now()),e.preventDefault()}}},t.touchend=function(e){var t=this.touchFor(e);if(this.gesture&&t){this.gesture.end.x=t.clientX,this.gesture.end.y=t.clientY;var n=Math.abs(this.gesture.start.y-this.gesture.end.y),r=Math.abs(this.gesture.start.x-this.gesture.end.x);n<=20&&r>75&&this.gesture.start.x<this.gesture.end.x&&(!this.gesture.time||Date.now()-this.gesture.time<500)&&((0,et.o)(this.view),e.preventDefault()),this.stop()}},t.touchcancel=function(e){this.touchFor(e)&&this.stop()},t.update=function(){this.gesture&&!this.shouldAllowSwiping()&&this.stop()},t.destroy=function(){this.view.dom.removeEventListener("touchstart",this.touchstart),document.removeEventListener("touchmove",this.touchmove),document.removeEventListener("touchend",this.touchend),document.removeEventListener("touchcancel",this.touchcancel)},e}(),eE=C.lg.fromClass(eS),eT=x.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null},enables:function(e){return[en.compute([e],function(t){return t.facet(e)}),ei.WF,eo._v,ek,eE,es,x.Wl.high(C.$f.compute([e],function(t){var n=t.facet(e),r=[];return(null==n?void 0:n.keyAcceptSuggestion)&&r.push({key:(0,G.cU)(n.keyAcceptSuggestion),run:et.o}),(null==n?void 0:n.keyDismissSuggestion)&&r.push({key:(0,G.cU)(n.keyDismissSuggestion),run:et.i}),r}))]}});function eR(e){var t,n,d,h,S,Y,$,Q,et,en,er,ei=e.filePath,ea=e.view,el=(0,l.Z)(),ec=(0,a.Z)().preferences,es=(0,N.Z)(),eu=es.engine,ef=es.settings,eh=(0,U.P5)({controlName:"flag-ghostwriter-alternate-debounce",logFlagToAnalytics:!0}),ep=null!==(er=null==ef?void 0:ef.infill)&&void 0!==er&&er,em=(0,W.gf)(H.CN.acceptPrimaryCompletion.id),ev=(0,W.gf)(H.CN.cancelCompletion.id),eg=(0,B.ZP)(),ey=(0,u.S)(ei),eb=(0,U.P5)({controlName:"flag-code-suggestion-markdown",logFlagToAnalytics:!1}),eZ=(0,U.P5)({controlName:"flag-gw-new-ghost-text",logFlagToAnalytics:!1}),ew=(0,U.P5)({controlName:"flag-gw-magikarp-bounce-time",logFlagToAnalytics:!1,default:p.yr,type:"number"}),ex=(0,U.P5)({controlName:"flag-killswitch-pichu",logFlagToAnalytics:!1}),eC=(0,K.S)(),e_=ex?eC:void 0,eS=(0,U.P5)({controlName:"flag-completely-different",logFlagToAnalytics:!1}),eE=(0,U.P5)({controlName:"flag-completely-different-tree-trigger",logFlagToAnalytics:!1});(0,s.useEffect)(function(){q.YX.toggle(!!ec.codeSuggestion)},[ec.codeSuggestion]);var eR=(0,c.Z)(function(){var e;return e=(0,g._)(function(e,t){var n,r,i,o,a,l;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return[4,fetch("/ai/complete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},signal:t,body:JSON.stringify(e)})];case 1:if(r=(n=c.sent()).body,!(200!==(i=n.status)))return[3,3];return o=Error.bind,l=(a="Error (".concat(i,") response from /ai/complete: ")).concat,[4,n.text()];case 2:throw new(o.apply(Error,[void 0,l.apply(a,[c.sent()])]));case 3:if(!r)throw Error("No body in response");return[2,function(){return function(e){return ee.apply(this,arguments)}(r)}]}})}),function(t,n){return e.apply(this,arguments)}},[]),eI=(0,c.Z)(function(){return new m},[ey,ei,el,eu]),eD=function(e,t){var n,r,i,o,a,l,c,d,h,p,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,b=(0,L.Z)().fs,Z=(r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=(0,U.P5)({controlName:"flag-ghostwriter-neighboring-context",logFlagToAnalytics:!1}),i=(0,X.Bx)(),o=(0,f._)((0,s.useState)(null),2),a=o[0],l=o[1];return(0,s.useEffect)(function(){l(r?i.filter(function(n){var r,i;return(!!((r=(0,u.S)(n).toLowerCase())===(i=e.toLowerCase())||F.includes(r))||!!M[r]&&M[r].includes(i))&&n!==t&&(0,O.Mb)(n)}).slice(0,n):null)},[e,t,r,n,i]),a}(e,t,v),i=(0,s.useCallback)(function(e,t){var n,r;return n=(0,u.S)(t),{code:(r=e.split("\n")).slice(Math.max(0,r.length-m)).join("\n"),language:n,filePath:t}},[m]),o=(0,s.useCallback)((n=(0,g._)(function(e){return(0,y.Jh)(this,function(t){switch(t.label){case 0:return[4,b.readFile(e)];case 1:return[2,t.sent()]}})}),function(e){return n.apply(this,arguments)}),[b]),l=(a=(0,f._)((0,s.useState)([]),2))[0],c=a[1],h=(d=(0,f._)((0,s.useState)(!1),2))[0],p=d[1],(0,s.useEffect)(function(){r&&(p(!0),(0,g._)(function(){var e;return(0,y.Jh)(this,function(t){switch(t.label){case 0:var n;return[4,Promise.all(r.map((n=(0,g._)(function(e){var t;return(0,y.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o(e)];case 1:if((t=n.sent()).error)return[2,!1];return[2,i(t.content.toString(),e)];case 2:return n.sent(),[2,!1];case 3:return[2]}})}),function(e){return n.apply(this,arguments)})))];case 1:return e=t.sent().filter(Boolean),p(!1),c(e),[2]}})})())},[r,o,i]),{cachedFiles:l,loading:h}).cachedFiles;return null!=Z?Z:[]}(ey,ei),eG=(n=(t={engine:eu,replId:el,additionalContext:eD,settings:{infill:ep},provider:eR,cache:eI,hooks:J}).engine,d=t.replId,h=t.additionalContext,S=t.settings,Y=t.provider,$=t.cache,Q=t.hooks,et=S.infill,(0,s.useCallback)((en=(0,z._)(function(e){var t,i,o,a,l,c,s,u,f,p,m,g,b,Z,w,x,C,_,k,S,E,T,R,I,D,G;return(0,y.Jh)(this,function(B){switch(B.label){case 0:if(t=e.language,i=e.filePath,o=e.code,a=e.suffix,l=e.signal,c=e.maxTokens,!o)return[2];if(s="markdown"===t?{maxTokens:75,stop:[]}:{},u=(0,r._)({language:t,code:o,suffix:et?a:void 0,replId:d,filePath:i,engine:n,maxTokens:c,additionalContext:h,stop:["\n\n","```"]},s),f=null==Q?void 0:Q.beforeCompletion(u),!(null!=(m=$.get(o))))return[3,1];return p=(0,z._)(function(){return(0,y.Jh)(this,function(e){switch(e.label){case 0:return[4,m];case 1:return e.sent(),[2]}})}),[3,4];case 1:return B.trys.push([1,3,,4]),[4,(0,V._)(Y(u,l))];case 2:return p=B.sent(),[3,4];case 3:if((null==(g=B.sent())?void 0:g.name)==="AbortError")return[2];return null==Q||Q.erroredCompletion(g instanceof Error?g:Error("Unknown error"),f),[2];case 4:b="",Z="",w=!0,x=!1,l.addEventListener("abort",function(){f&&(null==Q||Q.afterCompletion("aborted",u,{},f)),x=!0}),C=!1,_=!1,B.label=5;case 5:B.trys.push([5,13,14,19]),S=(0,v._)(p()),B.label=6;case 6:return[4,(0,V._)(S.next())];case 7:if(!(C=!(E=B.sent()).done))return[3,12];T=E.value,Z+=T,R=void 0,B.label=8;case 8:if(!(-1!==(R=Z.indexOf("\n"))))return[3,11];if(I=JSON.parse(Z.substring(0,R)).text,Z=Z.substring(R+1),D=(0,j.Hy)(I,t).replacementSuggestion,b+=D,x)return[3,10];return[4,D];case 9:B.sent(),B.label=10;case 10:return!x&&w&&f&&(null==Q||Q.afterCompletion("success",u,{fromCache:!!m,partialSuggestion:D},f)),w=!1,(0,j.cx)(b).haltAfter&&(x=!0),[3,8];case 11:return C=!1,[3,6];case 12:return[3,19];case 13:return G=B.sent(),_=!0,k=G,[3,19];case 14:if(B.trys.push([14,,17,18]),!(C&&null!=S.return))return[3,16];return[4,S.return()];case 15:B.sent(),B.label=16;case 16:return[3,18];case 17:if(_)throw k;return[7];case 18:return[7];case 19:if(null===m&&b.trim().length&&$.set(o,b),!(!x&&Z))return[3,21];return[4,Z];case 20:B.sent(),B.label=21;case 21:return f&&(null==Q||Q.afterCompletion("finished",u,{completeSuggestion:b,fromCache:!!m},f)),[2]}})}),function(e){return en.apply(this,arguments)}),[n,d,h,et,$,Q,Y])),eB=(0,o.Z)({view:ea});(0,s.useEffect)(function(){if(ea&&ec.codeSuggestion&&eg!==B.Yy.None){var e={filePath:ei,language:ey,engine:eu,additionalContextCount:eD.length,additionalContextLength:eD.reduce(function(e,t){return e+t.code.length},0)};if(eS){var t,n,o=P("suggestionPresented",500,.1);eg===B.Yy.Pro?(t=p.Dz,n=eh?p.Dd:p.Dz):(t=ew,n=eh?p.VF:ew);var a="replit-v1-5-3b"===eu||"replit-repltuned-v1-5-3b"===eu;ea.dispatch({effects:eB.reconfigure([eT.of({request:eG,infill:ep,backendOnly:eg===B.Yy.BackendOnly,debounceTimeOutsideWord:t,debounceTimeInsideWord:n,debounceAlways:eg!==B.Yy.Pro,supportsExpandedMaximumTokens:a,keyAcceptSuggestion:em,keyDismissSuggestion:ev,onErrorExtras:function(){return e}}),eo._b.of(eE),ed.t.of({onDismiss:function(){o.cancel()},onRequestIgnoredBackendOnly:function(){b.n_({category:"ghostwriter",message:"called completeCode for free user but did not show the ghost text.",level:"info"}),(0,k.j)(k.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionNotPresented"},e),{reason:"ghostTextNotEnabledForFreeUser"}))},onRequestFirstEmit:function(t){var n=t.plugin(ek);n&&(b.n_({category:"ghostwriter",message:"Suggestion presented",level:"debug"}),o.queue((0,i._)((0,r._)({},e),{prefixLength:n.lastPrefixLength})))},onRequestEndedWithNoSuggestion:function(){b.n_({category:"ghostwriter",message:"Exited completeCode iteration with no suggestion.",level:"info"}),(0,k.j)(k.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionNotPresented"},e),{reason:"noSuggestion"}))},onSuggestionAccepted:function(t,n){var a=t.plugin(ek);if(a){o.flush();var l=Math.abs(n.newLength-n.length);(0,k.j)(k.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionAccepted"},e),{prefixLength:a.lastPrefixLength,suggestionLength:l})),b.n_({category:"ghostwriter",message:"Suggestion accepted",level:"info"}),null==e_||e_.recordAccept()}},onSuggestionExplicitlyDismissed:function(t){var n=t.plugin(ek);n&&(o.flush(),(0,k.j)(k.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionDismissed"},e),{prefixLength:n.lastPrefixLength})),b.n_({category:"ghostwriter",message:"Suggestion explicitly dismissed",level:"info"}),null==e_||e_.recordReject())}})])})}else{var l,c,s,u,d,f,h,m,S,N,U,L,O,X,M,F,W,H,V,z,j,q,Y,$,J,K,Q,ee="markdown"===ey&&eb;if(!p.PE.has(ey)&&!ee){b.n_({category:"ghostwriter",message:"Explicitly skipped useCompleteCode effect.",level:"info"});return}ea.dispatch({effects:eB.reconfigure((c=(l={language:ey,filePath:ei,infill:ep,alternateDebounce:eh,completeCodeAccessLevel:eg,completeCode:eG,freeUserDebounceTime:ew,logMetadata:e,newRendering:eZ,keybindings:{acceptPrimaryCompletion:em,cancelCompletion:ev},tooltipControl:e_}).language,s=l.filePath,u=l.infill,d=l.alternateDebounce,f=l.completeCodeAccessLevel,h=l.completeCode,m=l.freeUserDebounceTime,S=l.logMetadata,N=l.newRendering,U=l.keybindings,L=l.tooltipControl,X={abort:function(){null==O||O.abort()},requestSignal:function(){var e=new AbortController;return null==O||O.abort(),O=e,e.signal}},M=P("suggestionPresented",500,.1),F=null,W=(0,g._)(function(e){var t,n,o,a,l,d,m,g,x,C,_,E,R,D,G,P,N,U;return(0,y.Jh)(this,function(y){switch(y.label){case 0:if(o=(n=e.state).doc,0===(a=n.selection.main.head)||(l=o.sliceString(a-1,a),p.mP.has(l)||!(d=o.sliceString(Math.max(0,a-p.ed),a))||d.length<p.jr))return[2];F=d.length,d=e.state.facet(w.c)+"\n"+d,m=u?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.split("\n"),r=0;r<n.length;r++){var i=n[r];if(i[0]&&i[0].match(/\S/)){if(t)return n.slice(0,r).join("\n")+"\n";return n.slice(0,r+1).join("\n")}}return e}(o.sliceString(a),p.NX.has(c)):void 0,g=(0,I.i)(e.state)?p.Pz:p._7,x=null===(t=d.match(/[^\s]([ \t]+)$/))||void 0===t?void 0:t[1],y.label=1;case 1:y.trys.push([1,14,,15]),C=!0,_=!1,E=!1,y.label=2;case 2:y.trys.push([2,7,8,13]),D=(0,v._)(h({language:c,filePath:s,code:x?d.slice(0,-x.length):d,suffix:m,maxTokens:g,signal:X.requestSignal()})),y.label=3;case 3:return[4,D.next()];case 4:if(!(_=!(G=y.sent()).done))return[3,6];if(P=G.value,"active"===(0,Z.LR)(e.state))return X.abort(),[3,6];if(f===B.Yy.BackendOnly)return b.n_({category:"ghostwriter",message:"called completeCode for free user but did not show the ghost text.",level:"info"}),(0,k.j)(k.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionNotPresented"},S),{reason:"ghostTextNotEnabledForFreeUser"})),[3,5];if(C&&x){if(!P.startsWith(x))return X.abort(),[3,6];P=P.slice(x.length)}C&&(b.n_({category:"ghostwriter",message:"Suggestion presented",level:"debug"}),M.queue((0,i._)((0,r._)({},S),{prefixLength:F}))),e.dispatch({effects:C?T.t8.of({code:P,language:c,infill:u}):T.R3.of(P)}),C=!1,y.label=5;case 5:return _=!1,[3,3];case 6:return[3,13];case 7:return N=y.sent(),E=!0,R=N,[3,13];case 8:if(y.trys.push([8,,11,12]),!(_&&null!=D.return))return[3,10];return[4,D.return()];case 9:y.sent(),y.label=10;case 10:return[3,12];case 11:if(E)throw R;return[7];case 12:return[7];case 13:if(!1!==C)return b.n_({category:"ghostwriter",message:"Exited completeCode iteration with no suggestion.",level:"info"}),e.dispatch({effects:T.t8.of(null)}),[2];return b.n_({category:"ghostwriter",message:"Suggestion completely presented",level:"debug"}),e.dispatch({effects:T.dp.of(!0)}),[3,15];case 14:if((null==(U=y.sent())?void 0:U.name)==="AbortError")return[2];return b.$e(function(e){e.setExtra("prefix",d),e.setExtra("maxTokens",g),e.setExtra("language",c),e.setExtra("selection-head",a),e.setExtra("previous-character",l),e.setExtras(S),e.setTag("ghostwriter",!0),b.Tb(U)}),A.error("CodeSuggestionExtension"),A.error(U),[3,15];case 15:return[2]}})}),H=function(e){return W.apply(this,arguments)},V=new Map,z=function(e,t){var n=V.get(t);return n||(n=E()(e,t),V.set(t,n)),n},j=(0,g._)(function(e,t){var n,r,i,o,a;return(0,y.Jh)(this,function(l){var c,s,u,h;return r=(n=e.state).doc,0===(i=n.selection.main.head)||(o=r.sliceString(i-1,i),(a=z(H,(s=(c={isInsideWordDebounce:!p.AX.has(o)&&!!d,completeCodeAccessLevel:f,freeUserDebounceTime:m}).isInsideWordDebounce,u=c.completeCodeAccessLevel,h=c.freeUserDebounceTime,s?u===B.Yy.Pro?p.Dd:p.VF:u===B.Yy.Pro?p.Dz:h)))(e),t===D.z.Now&&f===B.Yy.Pro&&a.flush()),[2]})}),q=function(e){var t=(0,R.$o)(e);if(t){var n=t.texts.reduce(function(e,t){return e+t.text.length},0);return M.cancel(),(0,k.j)(k.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionAccepted"},S),{prefixLength:F,suggestionLength:n})),b.n_({category:"ghostwriter",message:"Suggestion accepted",level:"info"}),(0,Z._B)(e),L&&L.recordAccept(),!0}return!1},[x.Wl.high(C.$f.of([{key:(0,G.cU)(U.acceptPrimaryCompletion),run:q},{key:(0,G.cU)(U.cancelCompletion),run:function(e){return!!(0,R._n)(e)&&(X.abort(),M.flush(),(0,k.j)(k.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionDismissed"},S),{prefixLength:F})),b.n_({category:"ghostwriter",message:"Suggestion explicitly dismissed",level:"info"}),L&&L.recordReject(),!0)}},{key:"Enter",run:R.gT}])),C.tk.domEventHandlers({blur:function(e,t){setTimeout(function(){t.dispatch({effects:T.t8.of(null)})},100),M.cancel(),X.abort()}}),C.tk.updateListener.of(function(e){(0,_.j)(e,T.he,function(t){if(t.value!==D.z.Stop){var n,r;n=e.view,r=t.value,M.cancel(),X.abort(),function(e,t){j.apply(this,arguments)}(n,r)}else M.cancel(),X.abort()})}),(0,R.G0)(N),($=(Y={onComplete:q,onEscape:R._n}).onComplete,J=Y.onEscape,K=null,Q=null,C.tk.domEventHandlers({touchstart:function(e){Q=null,K=e.targetTouches[0].clientX},touchmove:function(e){Q=e.targetTouches[0].clientX},touchend:function(e,t){if(K&&Q)return K-Q<-50&&$(t),J(t),!0}}))]))})}return function(){ea.dispatch({effects:eB.reconfigure([])})}}},[ea,eI,eG,eB,ei,ey,el,eu,ec.codeSuggestion,ep,eh,eg,ew,eD,em,ev,eb,eZ,e_,eS,eE])}},53466:function(e,t,n){n.d(t,{$:function(){return f},u:function(){return h}});var r=n(45903),i=n(25e3),o=n(84357),a=n(38265),l=n(51944),c=n(82200),s=n(40497),u=n(59868);function d(e){var t=e.state.field(f);if(t){var n=t.type;return"explainCode"===n?(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"EXPLAIN"}):"generateCode"===n?(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"GENERATE"}):"transformCode"===n&&(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"TRANSFORM"}),e.dispatch({effects:l.Q.of(null)}),!0}return!1}var f=o.QQ.define({create:function(){return null},update:function(e,t){if((0,s.j)(t,l.Q,function(t){e=t.value?{codeReference:t.value.codeReference,type:t.value.type,loading:t.value.loading,data:t.value.data}:null}),!e||t.changes.empty)return e;var n=e.codeReference.range.indexFrom>t.newDoc.length?t.newDoc.length:t.changes.mapPos(e.codeReference.range.indexFrom),o=e.codeReference.range.indexTo>t.newDoc.length?t.newDoc.length:t.changes.mapPos(e.codeReference.range.indexTo);return n>=o?null:e=(0,i._)((0,r._)({},e),{codeReference:(0,i._)((0,r._)({},e.codeReference),{range:{indexFrom:n,indexTo:o,lineFrom:t.newDoc.lineAt(n).number,lineTo:t.newDoc.lineAt(o).number}})})},provide:function(e){return[o.Wl.highest(a.$f.of([{key:"Escape",run:d}])),c.gb.from(e,function(e){var t;return null!==(t=(null==e?void 0:e.loading)&&e.codeReference.range.indexFrom===e.codeReference.range.indexTo)&&void 0!==t?t:null})]}}),h=o.QQ.define({create:function(){return null},update:function(e,t){if(!t.state.field(f))return null;var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value;c.is(l.Q)&&(e=null),c.is(l.h)&&(e=c.value)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}})},92994:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(43429),i=n(84357);function o(e){var t=e.view,n=e.initialExtension,o=void 0===n?[]:n,a=(0,r.useRef)();return a.current||(a.current=new i.F6),(0,r.useEffect)(function(){if(t){var e=a.current;if(void 0===e.get(t.state))t.dispatch({effects:i.Py.appendConfig.of(e.of(o))});else throw Error("Did not expect useEffect hook to rerun in useCompartment");return function(){t.dispatch({effects:e.reconfigure([])})}}},[t]),a.current}},56981:function(e,t,n){n.d(t,{EE:function(){return m},Gj:function(){return l},ZF:function(){return v},_j:function(){return c},f3:function(){return h},fI:function(){return p},gm:function(){return f},yK:function(){return u}});var r=n(32477),i=n(6634),o=n(61314),a=n.n(o),l={regexp:/-?\b\d+\.?\d*\b/g,cursor:"ew-resize",onDrag:function(e,t,n){var r=Number(e)+n.movementX;isNaN(r)||t(r.toString())}},c={regexp:/true|false/g,cursor:"pointer",onClick:function(e,t){switch(e){case"true":return t("false");case"false":return t("true")}}};function s(e){var t=RegExp("".concat(e,"\\(-?\\b\\d+\\.?\\d*\\b\\s*(,\\s*-?\\b\\d+\\.?\\d*\\b)?"),"g"),n=new RegExp("".concat(e,"\\((?<x>-?\\b\\d+\\.?\\d*\\b)\\s*(,\\s*(?<y>-?\\b\\d+\\.?\\d*\\b))?"));return{regexp:t,cursor:"move",onDrag:function(t,r,i){var o,a,l=n.exec(t),c=Number(null==l?void 0:null===(o=l.groups)||void 0===o?void 0:o.x),s=Number(null==l?void 0:null===(a=l.groups)||void 0===a?void 0:a.y);isNaN(c)||(isNaN(s)&&(s=c),r("".concat(e,"(").concat(c+i.movementX,", ").concat(s+i.movementY)))}}}var u=s("vec2");function d(e){var t=RegExp("".concat(e,"\\(.*\\)"),"g"),n=new RegExp("".concat(e,"\\((?<r>\\d+)\\s*,\\s*(?<g>\\d+)\\s*,\\s*(?<b>\\d+)\\)"));return{regexp:t,cursor:"pointer",onClick:function(t,o){var a,l,c,s=n.exec(t),u=Number(null==s?void 0:null===(a=s.groups)||void 0===a?void 0:a.r),d=Number(null==s?void 0:null===(l=s.groups)||void 0===l?void 0:l.g),f=Number(null==s?void 0:null===(c=s.groups)||void 0===c?void 0:c.b),h=document.createElement("input");h.type="color",isNaN(u+d+f)||(h.value=(0,i.C)(u,d,f)),h.addEventListener("input",function(t){var n=t.target;if(n.value){var a=(0,r._)((0,i.w)(n.value),3),l=a[0],c=a[1],s=a[2];o("".concat(e,"(").concat(l,", ").concat(c,", ").concat(s,")"))}}),h.click()}}}s("ellipse"),s("circle"),s("point"),s("rect"),s("square"),s("vertex");var f=d("rgb"),h=d("background"),p=d("fill"),m=d("stroke"),v={regexp:/https?:\/\/[^\s)"']+/g,cursor:"pointer",onClick:function(e){a()(e)&&window.open(e,"_blank")}}},81031:function(e,t,n){n.d(t,{F:function(){return C},V:function(){return _}});var r=n(32477),i=n(8182),o=n(43429),a=n(38265),l=n(57468),c=n(56596),s=n(29287),u=n(15146),d=n(99741),f=n(74833),h=n(73157),p=n(74106),m=n(20142),v=n(51384),g=n(81013),y=n(75023),b=(0,v.iv)({scrollbarWidth:"thin",outline:"none",overflow:"auto",".cm-content":{paddingBottom:0},"::-webkit-scrollbar":{width:4},".cm-gutters":{minWidth:"unset"}}),Z=(0,v.iv)({overflow:"hidden",".cm-scroller":{overflow:"hidden"}}),w={root:s.l0.backgroundColor.backgroundRoot,higher:s.l0.backgroundColor.backgroundHigher,highest:s.l0.backgroundColor.backgroundHighest,default:s.l0.backgroundColor.backgroundDefault},x=new y.j(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(0,a.Eu)({formatNumber:function(t,n){for(var r=String(n.doc.lines).length,i=String(t+e-1);r>i.length;)i="\xa0"+i;return i}})});function C(e){var t=e.path,n=e.initialDoc,r=e.maxHeight,a=e.minHeight,l=e.extensions,c=e.allowScroll,s=e.fontSize,u=e.hideGutter,d=e.startLineNumber,f=e.style,h=e.elevation,y=e.onNavigateToCode,C=(0,g.Z)(),_=C.ref,k=C.view,S=o.useMemo(function(){var e;return e=w[null!=h?h:"default"],(0,v.iv)({".cm-editor":e,".cm-gutters":e})},[h]),E=x.use(d);return(0,i.tZ)("div",{style:f,children:(0,i.tZ)(m.ZP,{ref:_,initialDoc:n,css:[b,S,void 0===c||c?null:Z],extensions:[E,void 0===l?[]:l],style:{minHeight:a,maxHeight:null!=r?r:"10em"},hideGutter:u,filePath:t,fontSize:s,readOnly:!0,onClick:function(e){if(y&&k){var t=e.clientX,n=e.clientY,r=k.posAtCoords({x:t,y:n});y(null!==r?(0,p.s)(k.state.doc,r):null)}}})})}function _(e){var t=e.path,n=e.doc,a=e.extensions,p=e.numMatches,m=e.onNavigateToCode,v=e.initiallyExpanded,g=(0,r._)(o.useState(v),2),y=g[0],b=g[1];return(0,i.BX)(c.G,{children:[(0,i.BX)(c.G,{css:[s.l0.width("100%"),s.l0.p(4),s.l0.rowWithGap(8),{alignItems:"center"}],children:[(0,i.tZ)(l.Z,{path:t}),(0,i.tZ)(f.xv,{multiline:!1,title:t,css:[s.l0.flex.shrink(1),{textOverflow:"ellipsis"}],children:t}),(0,i.tZ)(f.xv,{color:"dimmest",multiline:!1,children:(0,h.Z)("match",p,!0)}),(0,i.tZ)(c.G,{css:s.l0.flex.grow(1)}),(0,i.tZ)(u.hU,{alt:y?"Collapse snippet":"Expand snippet",tooltipHidden:!0,onClick:function(){return b(function(e){return!e})},children:(0,i.tZ)(d.Z,{rotate:y?180:0,style:{transition:"200ms ease"}})})]}),(0,i.tZ)(c.G,{css:[s.l0.p(4),{display:y?"block":"none"}],children:(0,i.tZ)(C,{path:t,initialDoc:n,extensions:void 0===a?[]:a,maxHeight:"max-content",allowScroll:!0,hideGutter:!0,onNavigateToCode:m})})]})}},95032:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(23026),i=n(3194),o=n(2543),a=n(38265),l=n(84357),c=n(29287),s=n(73157),u=new(function(e){"use strict";(0,i._)(n,e);var t=(0,o._)(n);function n(){var e;return(0,r._)(this,n),(e=t.call(this)).elementClass="cm-gutterElement-hidden",e}return n.prototype.toDOM=function(){var e=document.createElement("span");e.classList.add("cm-hidden-lines-gutter");var t=document.createElement("span");return t.classList.add("cm-dot"),e.appendChild(t),e},n}(a.SJ)),d=function(e){"use strict";(0,i._)(n,e);var t=(0,o._)(n);function n(e){var i;return(0,r._)(this,n),(i=t.call(this)).numLines=e,i}var a=n.prototype;return a.eq=function(e){return e.numLines===this.numLines},a.toDOM=function(){var e=document.createElement("span");return e.textContent="".concat(this.numLines," hidden ").concat((0,s.Z)("line",this.numLines)),e.className="cm-hidden-lines",e},n}(a.l9),f=a.p.mark({class:"cm-searchResultMatch"}),h=a.tk.baseTheme({".cm-hidden-lines":{color:"var(--foreground-dimmer)",backgroundColor:"var(--background-highest)",display:"inline-block",width:"100%"},".cm-gutterElement-hidden":{backgroundColor:"var(--background-highest)"},".cm-hidden-lines-gutter":{backgroundColor:"var(--background-highest)",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},".cm-dot":{height:"5px",width:"5px",backgroundColor:"var(--foreground-dimmest)",borderRadius:"50%",display:"inline-block"},".cm-tooltip .cm-scroller":{border:"2px solid var(--background-highest)",borderRadius:"var(--border-radius-4)"},".cm-tooltip .cm-scroller:hover":{border:"2px solid var(--accent-primary-dimmest)",boxShadow:"var(--shadow-1)",cursor:"pointer"},".cm-searchResultMatch":{color:c.TV.foregroundDefault,backgroundColor:c.TV.accentPrimaryDimmest,outline:c.TV.accentPrimaryDimmer+" solid 1px"},".cm-searchResultMatch span":{color:c.TV.foregroundDefault},".cm-tooltip .cm-searchResultMatch:hover":{opacity:.8},".cm-tooltip .cm-gutterElement":{display:"flex",marginTop:0,textAlign:"center",alignItems:"center",justifyContent:"center",lineHeight:"21px"},".cm-tooltip .cm-line":{padding:0},".cm-tooltip .cm-gutters":{padding:0},".cm-tooltip .cm-content":{paddingTop:0},".cm-tooltip .cm-lineWrapping":{whiteSpace:"pre"},".cm-tooltip .cm-cursor":{display:"none"},".cm-tooltip .cm-selectionBackground":{display:"none"}});function p(e,t){var n=e.sort(function(e,t){return e.from-t.from}),r=n.map(function(e){var t=e.from,n=e.to;return f.range(t,n)});return[a.lg.define(function(){return{}},{decorations:function(){return a.p.set(r)}}),function(e,t){var n=[],r=1;e.forEach(function(i,o){var a=t.lineAt(i.from),l=t.lineAt(i.to);r<a.number-2&&n.push({startLine:r,endLine:a.number-2}),r=l.number+2,o===e.length-1&&r<t.lines&&n.push({startLine:r,endLine:t.lines})});var i=n.map(function(e){var n=t.line(e.startLine),r=t.line(e.endLine);return a.p.replace({widget:new d(e.endLine-e.startLine+1)}).range(n.from,r.to)}),o=n.map(function(e){var n=t.line(e.startLine);return a.p.line({class:"cm-line-hidden"}).range(n.from)}),c=l.QQ.define({create:function(){return a.p.set(i)},update:function(e){return e},provide:function(e){return a.tk.decorations.from(e)}}),s=l.QQ.define({create:function(){return a.p.set(o)},update:function(e){return e},provide:function(e){return a.tk.decorations.from(e)}}),f=n.map(function(e){var n=t.line(e.startLine);return u.range(n.from)});return[c,s,h,a.p2.of(l.Xs.of(f))]}(n,t)]}},11570:function(e,t,n){n.d(t,{Ny:function(){return f},_S:function(){return d},oZ:function(){return u}});var r=n(45903),i=n(25e3),o=n(32477),a=n(43429),l=n(84357),c=n(89061),s=n(22470);function u(e){return JSON.stringify({fileMap:Array.from(e.fileMap.entries()).map(function(e){var t,n=(0,o._)(e,2);return[n[0],(t=n[1],(0,i._)((0,r._)({},t),{editorState:t.editorState.toJSON({history:c.cE})}))]})})}function d(e){var t=JSON.parse(e).fileMap,n=new s.L(20);return t.forEach(function(e){var t=(0,o._)(e,2),a=t[0],s=t[1];n.set(a,(0,i._)((0,r._)({},s),{editorState:l.yy.fromJSON(s.editorState,void 0,{history:c.cE})}))}),{fileMap:n}}function f(){return{fileMap:new s.L(20)}}var h=a.createContext(null);t.ZP=h},10028:function(e,t,n){n.d(t,{AL:function(){return w},GD:function(){return m},VO:function(){return p},Y:function(){return b},tT:function(){return g}});var r=n(45903),i=n(93295),o=n(23982),a=n(55846),l=n(66039),c=n(13440);function s(){var e=(0,i._)(["\n  query CodemirrorThread($id: String!) {\n    thread: annotationAnchor(id: $id) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n    currentUser {\n      id\n      username\n      fullName\n      image\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  mutation CreateThread(\n    $thread: AnnotationAnchorInput!\n    $message: AnnotationMessageInput\n    $highlight: AnnotationHighlightInput\n  ) {\n    createThread: createAnnotationAnchor(\n      annotationAnchor: $thread\n      annotationMessage: $message\n      highlight: $highlight\n    ) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation UpdateThread($id: String!, $changes: AnnotationAnchorChangesInput!) {\n    updateThread: updateAnnotationAnchor(id: $id, changes: $changes) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation CreateThreadMessage(\n    $replId: String!\n    $threadId: String!\n    $threadMessage: AnnotationMessageInput!\n    $highlight: AnnotationHighlightInput\n  ) {\n    createThreadMessage: createAnnotationMessage(\n      replId: $replId\n      anchorId: $threadId\n      annotationMessage: $threadMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}var h={},p=(0,o.Ps)(s(),a.j7);function m(e){var t=(0,r._)({},h,e);return l.a(p,t)}var v=(0,o.Ps)(u(),a.j7);function g(e){var t=(0,r._)({},h,e);return c.D(v,t)}var y=(0,o.Ps)(d(),a.j7);function b(e){var t=(0,r._)({},h,e);return c.D(y,t)}var Z=(0,o.Ps)(f(),a.j7);function w(e){var t=(0,r._)({},h,e);return c.D(Z,t)}},66610:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(45903),i=n(25e3),o=n(32477),a=n(21289),l=n(43429),c=n(55534),s=n(10028),u=n(17491),d=n(55846),f=n(30456),h=n(50782),p=n(66959),m=n(54916),v=n(50220),g=n(50199),y=n(72282),b=n.n(y);function Z(e,t){if(!e)return null;var n,r=e.state.field(v.OQ),i=e.state.field(v.ZS);return(null!==(n=r[t])&&void 0!==n?n:(null==i?void 0:i.id)===t?i:null)||null}function w(e,t){if(!e)return null;var n=Z(e,t);if(!n)return null;var r=Math.min(n.indexStart,n.indexEnd),i=Math.max(n.indexStart,n.indexEnd),o=e.state.doc.lineAt(r),a=e.state.doc.lineAt(i),l=e.state.doc.sliceString(e.state.doc.line(Math.max(o.number-2,1)).from,r),c=e.state.doc.sliceString(i,e.state.doc.line(Math.min(a.number+2,e.state.doc.lines)).to);return{precode:l,code:e.state.doc.sliceString(r,i),postcode:c}}function x(e,t,n){var y=(0,c.Z)().showError,x=(0,h.Z)(),C=(0,f.Z)().map(function(e){return e.username}),_=(0,m.Z)().fs,k=(0,s.GD)({variables:{id:e}}),S=k.data,E=k.error,T=k.loading,R=k.client,I=function(){if(T||!S){var n;return!!t&&(null===(n=t.state.field(v.ZS))||void 0===n?void 0:n.id)===e}return"AnnotationAnchor"!==S.thread.__typename}(),D=l.useMemo(function(){return T||!S?null:"UserError"===S.thread.__typename?{id:e,__typename:"AnnotationAnchor",messages:[],isGeneral:!1,isResolved:!1}:"AnnotationAnchor"===S.thread.__typename?S.thread:null},[S,e,T]),G=(0,o._)((0,s.tT)({onError:function(e){return y(e.message)},update:function(e,t){var n,r;if(t.errors){t.errors.forEach(function(e){return y(e.message)});return}if((null===(r=t.data)||void 0===r?void 0:null===(n=r.createThread)||void 0===n?void 0:n.__typename)==="UserError"){y(t.data.createThread.message);return}}}),1)[0],B=(0,o._)((0,s.AL)({onError:function(e){return y(e.message)},update:function(e,t){if(t.errors){t.errors.forEach(function(e){return y(e.message)});return}var n,r=null===(n=t.data)||void 0===n?void 0:n.createThreadMessage;r&&"UserError"===r.__typename&&y(r.message)}}),1)[0],P=(0,o._)((0,s.Y)({onError:function(e){return y(e.message)},update:function(e,t){if(t.errors){t.errors.forEach(function(e){return y(e.message)});return}var n,r=null===(n=t.data)||void 0===n?void 0:n.updateThread;r&&"UserError"===r.__typename&&y(r.message)}}),1)[0],A=(0,o._)((0,d.Hj)(),1)[0],N=(0,g.Z)(function(){return b()(A,1e3,{trailing:!1})},[A]),U=function(){var e=null==S?void 0:S.currentUser;return e?{user:{__typename:"User",id:e.id,username:e.username,fullName:e.fullName,image:e.image}}:{}};return{thread:D,isPlaceholder:I,error:E,loading:T,getHighlight:w,getLatestAnchor:function(){return Z(t,e)},updateThread:function(e){var t,n=e.changes,o=(null==S?void 0:null===(t=S.thread)||void 0===t?void 0:t.__typename)==="AnnotationAnchor"?S.thread:null;if(!o)throw Error("expected thread");P({variables:{id:o.id,changes:n},optimisticResponse:{__typename:"RootMutationType",updateThread:(0,i._)((0,r._)({},o,n),{isResolved:"boolean"==typeof n.isResolved?n.isResolved:o.isResolved})}})},finalizeThreadMessage:function(o){var l=o.message,c=o.messageId,d=(0,p.kW)(l,{users:(0,a._)(C).concat(["everyone"])}),f={id:c,text:l,mentions:d.mentions};if(I&&t&&n){var h=t.state.field(v.ZS),m={id:e,replId:x,indexStart:null==h?void 0:h.indexStart,indexEnd:null==h?void 0:h.indexEnd,otVersion:_.getOTVersion(n),path:n};G({variables:{thread:m,message:f,highlight:w(t,e)},optimisticResponse:{__typename:"RootMutationType",createThread:(0,i._)((0,r._)({__typename:"AnnotationAnchor"},m,U()),{messages:[(0,i._)((0,r._)({id:c,timeCreated:new Date().toISOString(),currentUserIsAuthor:!0},U()),{content:{text:l,__typename:"TextMessageContentType"},anchor:{id:m.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],isResolved:!1,isGeneral:!1})}}),R.writeQuery({query:s.VO,variables:{id:e},data:{__typename:"RootQueryType",thread:(0,i._)((0,r._)((0,i._)((0,r._)({},m),{isResolved:!1,isGeneral:!1}),U()),{messages:[(0,i._)((0,r._)({id:c,timeCreated:new Date().toISOString(),currentUserIsAuthor:!0},U()),{content:{text:l,__typename:"TextMessageContentType"},anchor:{id:m.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],__typename:"AnnotationAnchor"}),currentUser:null==S?void 0:S.currentUser}});var g=R.readQuery({query:u.Jq,variables:{replId:x,path:n}});if(g){var y,b,Z=(null===(b=g.threadsByFile)||void 0===b?void 0:b.__typename)==="ThreadsByFileResult"?g.threadsByFile.threads:[],k=U().user;R.writeQuery({query:u.Jq,variables:{replId:x,path:n},data:{__typename:"RootQueryType",threadsByFile:{__typename:"ThreadsByFileResult",threads:(0,a._)(Z).concat([(0,r._)({messageCount:1,unreadCount:0,__typename:"AnnotationAnchor",isGeneral:!1,user:k,isResolved:!1,participants:[k]},m)])}}})}return}var E=(null==S?void 0:null===(y=S.thread)||void 0===y?void 0:y.__typename)==="AnnotationAnchor"?S.thread:null;if(!E)throw Error("expected thread");B({variables:{replId:x,threadId:E.id,threadMessage:f,highlight:w(t,E.id)},optimisticResponse:{__typename:"RootMutationType",createThreadMessage:(0,i._)((0,r._)({},E),{messages:(0,a._)(E.messages.filter(function(e){return!e.id.startsWith("chat-")})).concat([(0,i._)((0,r._)({},U(),f),{content:{text:f.text,__typename:"TextMessageContentType"},anchor:{id:E.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",timeCreated:new Date().toISOString(),currentUserIsAuthor:!0,seen:!0})])})}})},changeThreadMessage:function(t){N({variables:{threadId:e,messageId:t.messageId,message:null}})}}}},17491:function(e,t,n){n.d(t,{Jq:function(){return s},eR:function(){return u}});var r=n(45903),i=n(93295),o=n(23982),a=n(66039);function l(){var e=(0,i._)(["\n  query ThreadsByFileHook($replId: String!, $path: String!) {\n    threadsByFile(replId: $replId, path: $path) {\n      ... on ThreadsByFileResult {\n        threads {\n          id\n          path\n          otVersion\n          indexStart\n          indexEnd\n          messageCount\n          unreadCount\n          user {\n            id\n            image\n            username\n          }\n          participants {\n            id\n            image\n            username\n          }\n          isGeneral\n          isResolved\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l());function u(e){var t=(0,r._)({},c,e);return a.a(s,t)}},62609:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(84357),i=n(40497);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=r.Py.define(),o=r.QQ.define({create:function(){return t},update:function(t,r){return(0,i.j)(r,n,function(n){t=e(n.value,t)}),t}});return{effect:n,state:o}}},97703:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(8182),i=n(4498),o=n(43429);function a(e){var t=e.json,n=(0,o.useMemo)(function(){return JSON.stringify(t,null,2)},[t]);return(0,r.tZ)(i.Z,{language:"json",code:n})}},48528:function(e,t,n){n.d(t,{j:function(){return m},m:function(){return p}});var r=n(45903),i=n(25e3),o=n(70322),a=n(32477),l=n(8182),c=n(43429),s=n(1498),u=n(10041),d=n(30983),f=n(15146),h=n(42267);function p(e){var t=e.textToCopy,n=e.tooltip,f=e.timeout,p=void 0===f?4e3:f,m=(0,o._)(e,["textToCopy","tooltip","timeout"]),v=(0,a._)(c.useState(!1),2),g=v[0],y=v[1],b=c.useRef(null);return c.useEffect(function(){return function(){b.current&&clearTimeout(b.current)}},[]),(0,l.tZ)(d.u,{isOpen:g,tooltip:null!=n?n:"".concat(t," copied to clipboard"),placement:"bottom-end",children:function(e,n){return(0,l.tZ)(s.zx,(0,i._)((0,r._)({},(0,h.dG)(m,e)),{ref:n,onClick:function(e){(0,u.Z)(t),y(!0),b.current&&clearTimeout(b.current),b.current=setTimeout(function(){return y(!1)},p),m.onClick&&m.onClick(e)}}))}})}function m(e){var t=e.textToCopy,n=e.tooltip,s=e.timeout,p=void 0===s?4e3:s,m=e.children,v=(0,o._)(e,["textToCopy","tooltip","timeout","children"]),g=(0,a._)(c.useState(!1),2),y=g[0],b=g[1],Z=c.useRef(null);return c.useEffect(function(){return function(){Z.current&&clearTimeout(Z.current)}},[]),(0,l.tZ)(d.u,{isOpen:y,tooltip:null!=n?n:"".concat(t," copied to clipboard"),placement:"bottom-end",children:function(e,n){return(0,l.tZ)(f.hU,(0,i._)((0,r._)({},(0,h.dG)(e,v)),{innerRef:n,onClick:function(e){(0,u.Z)(t),b(!0),Z.current&&clearTimeout(Z.current),Z.current=setTimeout(function(){return b(!1)},p),v.onClick&&v.onClick(e)},children:m}))}})}},42098:function(e,t,n){n.d(t,{E:function(){return p}});var r=n(32477),i=n(8182),o=n(59868),a=n(1498),l=n(74833),c=n(49344),s=n(29287),u=n(56596),d=n(54916),f=n(32377),h=n(43429);function p(){var e=(0,d.Z)().replspaceApi,t=(0,r._)((0,h.useState)(null),2),n=t[0],p=t[1];return(0,h.useEffect)(function(){return e.onConfirmSendToken(function(e){e&&(0,o.j)(o.U3.MODAL_VIEWED,{modalName:"git_token_modal"}),p(function(){return e})})},[e]),(0,i.tZ)(c.u,{isOpen:"function"==typeof n,onRequestClose:function(){null==n||n(!1),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"close"}),p(null)},children:(0,i.BX)(u.G,{css:[s.l0.colWithGap(16)],children:[(0,i.tZ)(l.h4,{variant:"headerDefault",level:3,children:"Pass GitHub Credentials"}),(0,i.tZ)(l.xv,{children:"It looks like you're trying to connect to your GitHub repository through the shell. Pass your token to the shell?"}),(0,i.tZ)(l.xv,{children:"If you did not initiate a git command, you should deny this."}),(0,i.BX)(u.G,{css:[s.l0.justify.end,s.l0.rowWithGap(16)],children:[(0,i.tZ)(a.zx,{onClick:function(){null==n||n(!1),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"deny"}),p(null)},text:"Deny"}),(0,i.tZ)(a.zx,{onClick:function(){null==n||n(!0),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"confirm"}),p(null)},iconLeft:(0,i.tZ)(f.Z,{}),text:"Confirm for this session",colorway:"primary"})]})]})})}},18142:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(45903),i=n(25e3),o=n(70322),a=n(8182);n(43429);var l=n(56596),c=n(29287),s=(0,n(93918).X)({self:[{overflowX:"auto",overflowY:"hidden","::-webkit-scrollbar":[c.l0.display.none]}]});function u(e){var t=e.gap,n=e.inset,u=e.children,d=e.className,f=(0,o._)(e,["gap","inset","children","className"]);return(0,a.tZ)(l.G,(0,i._)((0,r._)({className:d,css:s.self},f),{children:(0,a.tZ)(l.G,{css:[c.l0.px(n),c.l0.rowWithGap(t),{width:"fit-content"}],children:u})}))}},66932:function(e,t,n){n.d(t,{$:function(){return l},i:function(){return a}});var r=n(75582),i=n(40028),o=n(40699);function a(e,t){if(void 0!==t)switch(t){case r.DZ.HostingTierE2Micro:return e.hostingTierE2Micro;case r.DZ.HostingTierE2Small:return e.hostingTierE2Small;case r.DZ.HostingTierE2Medium:return e.hostingTierE2Medium;case r.DZ.HostingTierN1Custom_1_4:return e.hostingTierN1Custom1_4;case r.DZ.HostingTierE2Standard_2:return e.hostingTierE2Standard2;case r.DZ.HostingTierE2Standard_4:return e.hostingTierE2Standard4;default:(0,i.Z)(t)}}function l(e){var t=o.r4[e],n=t.vCpu,r=t.ram,i=t.dedicated;return"".concat(i?"Dedicated ":"").concat(n," vCPU / ").concat(r," GiB RAM")}},84096:function(e,t,n){n.d(t,{e:function(){return p}});var r=n(8182),i=n(7877),o=n(63388),a=n(75582),l=n(93918),c=n(29287),s=n(5039),u=n(30983),d=n(56596),f=n(74833),h=(0,l.X)({root:[c.l0.py(4),c.l0.rowWithGap(4),c.l0.align.center]});function p(e){var t=e.deployment,n=e.small,l=t.currentBuild,c=o.VR[l.status],p=c.title,m=c.color,v=(0,s.Z)(new Date(l.timeCreated),Date.now(),{addSuffix:!0}),g="Deployed ".concat(v," by ").concat(l.user.displayName),y=l.status===a.Fe.Success?"Deployed":p;return(0,r.tZ)(u.u,{tooltip:g,children:(0,r.BX)(d.G,{css:h.root,children:[(0,r.tZ)(i.Z,{size:n?12:16,color:m}),(0,r.tZ)(f.xv,{variant:n?"small":void 0,color:"dimmest",multiline:!1,children:y})]})})}},31577:function(e,t,n){n.d(t,{$:function(){return s}});var r=n(32477),i=n(8182),o=n(43429),a=n(90234),l=n(60427),c=n(64420);function s(e){var t=(0,r._)((0,o.useState)(function(){var t,n,r,i,o;return n=(t={fs:e.fs,container:e.container,dotReplit:e.dotReplit}).container,r=t.fs,i=t.dotReplit,(o=(0,a.MT)()).set(l.CK,n),o.set(l.bA,r),o.set(l.My,i),o}),1)[0];return(0,i.BX)(c.aT.Provider,{value:t,children:[e.children,(0,i.tZ)(l.jd,{replId:e.replId})]})}},92977:function(e,t,n){n.d(t,{Gs:function(){return f},Qw:function(){return d},un:function(){return h}});var r=n(45903),i=n(32477),o=n(8182),a=n(51384),l=n(56596),c=n(93918),s=n(43429),u=n(49275),d=(0,c.X)({maxWidth:{width:"100%",maxWidth:600,marginLeft:"auto",marginRight:"auto"}}),f=function(e,t){return(0,a.F4)("\n  0% {\n    opacity: 0;\n    height: ".concat((null==t?void 0:t.from)?t.from:0,"px;\n  }\n  99% {\n    opacity: 1;\n    height: ").concat(e,"px;\n  }\n  ").concat((null==t?void 0:t.noAuto)?"100% {\n        opacity: 1;\n        height: ".concat(e,"px;\n      }"):"100% {\n    height: auto;\n  }","\n"))};function h(e){var t,n,a,c=e.children,d=e.render,f=e.timeout,h=void 0===f?300:f,p=e.initialHeight,m=(0,s.useRef)(null),v=(0,s.useRef)(null),g=(n=(t=(0,i._)((0,s.useState)(0),2))[0],a=t[1],(0,s.useEffect)(function(){if(v.current){var e=new ResizeObserver(function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var l=i.value.borderBoxSize[0].blockSize;a(l)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}});return e.observe(v.current),function(){return e.disconnect()}}},[n,v]),n),y=g>0?g:p,b={transition:h+"ms ease-out",transitionProperty:"height, opacity",opacity:0,height:0,visibility:"hidden"},Z={entering:{opacity:1,height:y},entered:{transitionProperty:"opacity",opacity:1,height:y,visibility:"visible"},exiting:{opacity:0,height:0,visibility:"visible"},exited:{opacity:0,height:0,visibility:"hidden"}};return(0,o.tZ)(u.ZP,{nodeRef:m,timeout:h,in:d,children:function(e){return(0,o.tZ)(l.G,{innerRef:m,style:(0,r._)({},b,Z[e]),children:(0,o.tZ)(l.G,{innerRef:v,children:c})})}})}},14186:function(e,t,n){var r,i,o,a;n.d(t,{a:function(){return i},k:function(){return r}}),(o=r||(r={})).Intro="intro",o.Deployment="deployment",o.DeploymentInProgress="deployment_in_progress",o.Analytics="analytics",o.Logs="logs",o.Settings="settings",o.ReservedVMTierSelection="reserved_vm_tier_selection",o.AutoscaleMachineConfiguration="autoscale_machine_configuration",(a=i||(i={})).SendDeploymentLifecycleCommand="send_deployment_lifecycle_command",a.ChangeView="change_view"},59121:function(e,t,n){n.d(t,{E:function(){return r},c:function(){return i}});var r="Procfile";function i(e){var t={};return e.split("\n").forEach(function(e){if(""!==e){var n=e.match(/^([A-Za-z0-9_]+):\s*(.+)$/);if(n){var r=n[2].trim().split(" ");t[n[1]]={command:r[0],options:r.slice(1)}}}}),t}},69470:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(43429);function i(){return(0,r.useMemo)(function(){return function(){if("undefined"==typeof document)return!1;var e=document.createElement("input");return"webkitdirectory"in e||"mozdirectory"in e||"msdirectory"in e||"odirectory"in e||"directory"in e}()},[])}},13225:function(e,t,n){var r=n(43429);t.Z=function(e,t,n){r.useEffect(function(){var t=setTimeout(e,n);return function(){clearTimeout(t)}},t)}},62789:function(e,t,n){n.d(t,{f6:function(){return c},oj:function(){return l},xZ:function(){return u}});var r=n(32477),i=n(43429),o=n(54916);function a(e){var t=(0,r._)(i.useState(!1),2),n=t[0],a=t[1],l=(0,o.Z)().dotReplit;return i.useEffect(function(){var t=!1;return l.getConfig().then(function(n){t||n.error||n.config.language!==e||a(!0)}),function(){t=!0}},[e,l]),n}function l(){return a("kaboom")}function c(){return a("kaboomdraw")}var s=/^draw.[tj]s$/;function u(e){return c()&&!!(null==e?void 0:e.match(s))}},85172:function(e,t,n){n.d(t,{v:function(){return d}});var r=n(45903),i=n(93295),o=n(23982),a=n(66039);function l(){var e=(0,i._)(["\n  query ReplTeamOrgSettings($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          __typename\n          ... on Team {\n            id\n            organization {\n              id\n              isAiEnabled\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l()),u=n(50782);function d(){var e,t,n,i,o=(n={variables:{replId:(0,u.Z)()}},i=(0,r._)({},c,n),a.a(s,i)).data;return{isTeamWithAiDisabled:(null==o?void 0:o.repl.__typename)==="Repl"&&(null===(e=o.repl.owner)||void 0===e?void 0:e.__typename)==="Team"&&(null===(t=o.repl.owner.organization)||void 0===t?void 0:t.isAiEnabled)===!1}}},76433:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(94106),i=n.n(r),o=n(54916),a=n(43429),l=n(30084),c=n(21557),s=n(56337),u="You have unsaved changes";function d(){var e=(0,s.Z)(),t=(0,o.Z)().fs,n=(0,r.useRouter)(),d=(0,a.useRef)(!1),f=(0,a.useCallback)(function(){if(!e&&!d.current&&t.getStatus()!==l.kO.Clean&&!window.confirm(u))throw i().events.emit("routeChangeError"),Error("Abort route change. Please ignore this error.")},[t,e]);return(0,a.useEffect)(function(){function r(n){if(!e&&!d.current&&t.getStatus()!==l.kO.Clean)return n.preventDefault(),n.returnValue=u,u}return window.addEventListener("beforeunload",r),c.gn||n.events.on("routeChangeStart",f),function(){window.removeEventListener("beforeunload",r),c.gn||n.events.off("routeChangeStart",f)}},[n.events,t,f,e]),function(e){return d.current=e}}},31147:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(32477),i=n(43429),o=n(45903),a=n(93295),l=n(23982),c=n(13440);function s(){var e=(0,a._)(["\n  mutation ReplFsUpdated($replId: String!) {\n    updateReplTimeUpdated(id: $replId) {\n      ... on Repl {\n        id\n        timeUpdated\n      }\n    }\n  }\n"]);return s=function(){return e},e}var u={},d=(0,l.Ps)(s()),f=n(25202),h=n(66349),p=n(54916);function m(){var e,t=(0,r._)((e=(0,o._)({},u,void 0),c.D(d,e)),1)[0],n=(0,p.Z)().fs,a=(0,h.Z)(),l=null==a?void 0:a.currentUserPermissions.containerWrite,s=null==a?void 0:a.id;(0,i.useEffect)(function(){if(l&&s){var e=(0,f.Z)(function(){return t({variables:{replId:s}})},{wait:6e4,maxWait:6e5}),r=n.onStatusChange(function(){e()});return function(){e.isScheduled()&&e.flush(),r()}}},[n,s,l,t])}},12435:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(32477),i=n(21289),o=n(43429),a=n(6187),l=n(45903),c=n(25e3),s=function(e){return/\s/.test(e)};function u(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=(0,r._)(o.useState(null),2),a=i[0],u=i[1],d=o.useCallback(u,[u]),f=o.useRef(t);o.useEffect(function(){f.current=t},[t]);var h=(0,r._)(o.useState(null),2),p=h[0],m=h[1];return o.useEffect(function(){if(a){var e=function(){var e=a.value,t=a.selectionStart;if(!t){m(null);return}var n=1===t||s(e[t-2]||""),r=e.length?e[t-1]:null;m(function(i){if(i&&(t<i.index||0===t))return null;if(!r||!i&&!n)return i;var o=f.current.includes(r);return i||o?i?s(r)?null:(0,c._)((0,l._)({},i),{text:e.slice(i.index,t)}):{index:t,text:"",match:r}:i})},t=function(){m(null)};return a.addEventListener("focus",e),a.addEventListener("keyup",e),a.addEventListener("blur",t),function(){m(null),a.removeEventListener("focus",e),a.removeEventListener("keyup",e),a.removeEventListener("blur",t)}}},[a,m]),[p,d]}function d(e){var t=o.useRef(e);o.useEffect(function(){t.current=e},[e]);var n=(0,r._)(o.useState(!1),2),l=n[0],c=n[1],s=(0,r._)(o.useState(null),2),d=s[0],f=s[1],h=(0,r._)(u.apply(void 0,(0,i._)(Object.keys(e))),2),p=h[0],m=h[1],v=o.useRef(p);o.useEffect(function(){v.current=p},[p]);var g=(0,a.Z)(p,100);return o.useEffect(function(){if(!g){f(null);return}var e=g.match,n=g.text,r=t.current[e]?t.current[e]:null;if(!r){f(null);return}var i=!1;return c(!0),r(n).then(function(e){i||v.current!==g||(c(!1),f({textTrigger:g,results:e,applySuggestion:function(e){var t=e.targetValue,n=e.suggestionValue,r=t.slice(0,g.index),i=n,o=t.slice(g.index+g.text.length);o&&o.startsWith(" ")||(i+=" ");var a=r+i+o;return{cursorIndex:(r+i).length+(o&&o.startsWith(" ")?1:0),fullValue:a}}}))}),function(){i=!0}},[g,f]),[{isLoading:l,suggestions:d},m]}},23896:function(e,t,n){n.d(t,{T:function(){return o}});var r=n(54916),i=n(16643);function o(){var e=(0,r.Z)().toolchain;return(0,i.Z)(e.configs)}},64457:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(32477),i=n(43429),o=n(2038),a=n(35614);function l(){var e=(0,i.useRef)(0),t=(0,r._)((0,i.useState)(!1),2),n=t[0],l=t[1],c=(0,o.T3)(),s=(0,o.rv)(),u=(0,a.u)();return(0,i.useEffect)(function(){var t,n=window.visualViewport;if(n){if(s){l(null!==(t=null==u?void 0:u.isShown)&&void 0!==t&&t);return}if(c){var r=function(){l(n.height<.8*e.current)};return e.current=n.height,n.addEventListener("resize",r),function(){n.removeEventListener("resize",r)}}}},[c,s,null==u?void 0:u.isShown]),n}},99672:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(45903),i=n(25e3),o=n(47507),a=n(32477),l=n(58130),c=n(54916),s=n(43429),u=n(39426);function d(e,t){var n,d,f,h,p=(n=(0,c.Z)().container,f=(d=(0,a._)((0,s.useState)(null),2))[0],h=d[1],(0,s.useEffect)(function(){if(n)return n.onConnectionStateChanged(function(){h(n.getConnectionMetadata())})},[n]),(0,s.useMemo)(function(){return f?(0,l.he)(f.token):null},[f]));(0,s.useEffect)(function(){if(e&&t){var n,a,l,c=(null===(n=e.origin)||void 0===n?void 0:n.__typename)==="Repl"?e.origin.id:null,s=(0,u.cR)(e.rootOriginReplUrl);return(0,o.Fy)((0,i._)((0,r._)({id:e.id,slug:e.slug,originId:c,roles:t.roles&&t.roles.map(function(e){return e.name}),rootOriginReplUrl:e.rootOriginReplUrl,rootOriginReplReleaseId:null===(l=e.source)||void 0===l?void 0:null===(a=l.release)||void 0===a?void 0:a.id},0!==s.length&&{languages:s}),{tokenCluster:null==p?void 0:p.cluster})),function(){(0,o.dv)()}}},[e,t,p])}},6634:function(e,t,n){n.d(t,{C:function(){return i},w:function(){return r}});var r=function(e){var t=parseInt(e.substring(1),16);return[t>>16&255,t>>8&255,255&t]},i=function(e,t,n){return"#"+e.toString(16)+t.toString(16)+n.toString(16)}},24227:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(34142),i=n(87682),o=n(29559),a=/\(copy\)( \d+)?$/,l=/\d+$/,c=n(39756);function s(e,t){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e,t){var n,r,s,u,d,f;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return n=(0,o.Il)(e),[4,t.readDir(0===n.length?c.Ql:n)];case 1:if((r=i.sent()).error)throw r.error;return s=new Set(r.children.map(function(e){return e.filename})),u=function(e,t){for(var n=(0,o.r6)(e),r=(0,o.eb)(e),i=a.test(r)?e:"".concat(r," (copy)").concat(n.length>0?".".concat(n):""),c=1;c<=t.size&&t.has(i);c++){var s=(0,o.eb)(i),u=s.split(" ");l.test(s)&&u.pop(),i="".concat(u.join(" ")," ").concat(c),n.length>0&&(i+=".".concat(n))}return i}((0,o.UO)(e),s),d=n?"".concat(n,"/").concat(u):u,[4,t.copyFile(e,d)];case 2:if((f=i.sent()).error)throw f.error;return[2,d]}})})).apply(this,arguments)}},95683:function(e,t,n){n.d(t,{S:function(){return l}});var r=n(29559),i={js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",go:"go"},o={rs:"rust",lsp:"lisp",sh:"bash",cpp:"c++",hs:"haskell",go:"go",rb:"ruby",md:"markdown"},a={lua:"lua",hs:"haskell",lhs:"haskell",jl:"julia",lisp:"common-lisp",ml:"ocaml",mli:"ocaml",sol:"solidity",scm:"scheme",ss:"scheme",zig:"zig",rkt:"racket",d:"d",scala:"scala",sc:"scala",swift:"swift"};function l(e){var t=(0,r.r6)(e);return Object.prototype.hasOwnProperty.call(i,t)?i[t]:Object.prototype.hasOwnProperty.call(o,t)?o[t]:Object.prototype.hasOwnProperty.call(a,t)?a[t]:t}},56320:function(e,t,n){n.d(t,{Z:function(){return A}});var r=n(32477),i=n(8182);n(43429);var o=n(56596),a=n(29287),l=n(38080),c=n(18836),s=n(74833),u=n(4070),d=n(93918),f=n(76566),h=n(55534),p=n(45903),m=n(93295),v=n(23982),g=n(66039),y=n(13440);function b(){var e=(0,m._)(["\n  query MultiplayerInviteUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n        owner {\n          ... on User {\n            id\n          }\n          ... on Team {\n            id\n            capabilities {\n              isBusinessPlan\n              hasValidSubscription\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return b=function(){return e},e}function Z(){var e=(0,m._)(["\n  mutation MultiplayerRefreshInviteUrl($replId: String!) {\n    refreshMultiplayerInviteLink(replId: $replId) {\n      id\n      ... on Repl {\n        id\n        inviteUrl\n      }\n    }\n  }\n"]);return Z=function(){return e},e}function w(){var e=(0,m._)(["\n  mutation DeleteMultiplayerInviteUrl($replId: String!) {\n    deleteMultiplayerInviteLink(replId: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return w=function(){return e},e}var x={},C=(0,v.Ps)(b()),_=(0,v.Ps)(Z()),k=(0,v.Ps)(w()),S=n(39390),E=n(48528),T=n(8017),R=n(88936),I=n(20573),D=n(10041),G=n(59868),B=(0,d.X)({container:[a.l0.colWithGap(12),a.l0.px(16),a.l0.pt(12),{borderTop:"solid 1px ".concat(a.TV.outlineDimmest)}],header:[a.l0.flex.row,a.l0.justify.spaceBetween],globeIconContainer:[a.l0.width(40),a.l0.height(40),a.l0.backgroundColor.accentPrimaryDimmer,a.l0.borderRadius("full"),a.l0.align.center,a.l0.justify.center],title:[a.l0.fontWeight.medium],loading:[a.l0.rowWithGap(4),a.l0.align.center],inviteUrlContainer:[a.l0.borderRadius(8),a.l0.flex.row],input:[a.l0.borderRadius(8,0,0,8),a.l0.color.foregroundDimmer],copyToClipboard:[a.l0.borderRadius(0,8,8,0)],titleGroup:[a.l0.rowWithGap(12)]}),P=function(){return(0,i.BX)(o.G,{css:B.titleGroup,children:[(0,i.tZ)(o.G,{css:B.globeIconContainer,children:(0,i.tZ)(S.Z,{color:a.TV.accentPrimaryStrongest,size:20})}),(0,i.BX)(o.G,{children:[(0,i.tZ)(s.xv,{css:B.title,id:"link-switch-label",multiline:!1,children:"Private join link"}),(0,i.tZ)(s.xv,{variant:"small",color:"dimmest",multiline:!1,children:"Anyone with this link can edit files"})]})]})};function A(e){var t,n,d,m,v,b,Z,w,S,A,N,U=e.replId,L=(0,h.Z)(),O=L.showConfirm,X=L.showError,M=(t=(0,p._)({},x,{variables:{replId:U}}),g.a(C,t)),F=M.data,W=M.loading,H=M.error,V=M.refetch,z=(0,r._)((n=(0,p._)({},x,{variables:{replId:U},onError:function(e){return X(e.message)},onCompleted:function(){return O("Join link created")}}),y.D(_,n)),2),j=z[0],q=z[1],Y=(0,r._)((d=(0,p._)({},x,{variables:{replId:U},optimisticResponse:{deleteMultiplayerInviteLink:{id:U,inviteUrl:null,__typename:"Repl"},__typename:"RootMutationType"},onError:function(e){return X(e.message)},onCompleted:function(e){if("UserError"===e.deleteMultiplayerInviteLink.__typename){X(e.deleteMultiplayerInviteLink.message);return}"Repl"===e.deleteMultiplayerInviteLink.__typename&&O("Join link deleted")}}),y.D(k,d)),2),$=Y[0],J=Y[1],K=(null==F?void 0:null===(m=F.repl)||void 0===m?void 0:m.__typename)==="Repl"?F.repl:null,Q=q.loading||J.loading,ee=(null==F?void 0:null===(v=F.repl)||void 0===v?void 0:v.__typename)==="Repl"&&(null==K?void 0:null===(b=K.owner)||void 0===b?void 0:b.__typename)==="Team",et=(null==F?void 0:null===(Z=F.repl)||void 0===Z?void 0:Z.__typename)==="Repl"&&(null==K?void 0:null===(w=K.owner)||void 0===w?void 0:w.__typename)==="Team"&&(null==K?void 0:null===(S=K.owner.capabilities)||void 0===S?void 0:S.isBusinessPlan)&&(null==K?void 0:null===(A=K.owner.capabilities)||void 0===A?void 0:A.hasValidSubscription),en=(null==F?void 0:null===(N=F.repl)||void 0===N?void 0:N.__typename)==="Repl"&&(null==K?void 0:K.inviteUrl)?window.location.origin+(null==K?void 0:K.inviteUrl):null;return W||ee&&!et?null:H?(0,i.BX)(o.G,{css:B.container,children:[(0,i.BX)(o.G,{css:B.header,children:[(0,i.tZ)(P,{}),(0,i.tZ)(u.r,{isSelected:!1,isDisabled:!0,"aria-labelledby":"link-switch-label"})]}),(0,i.tZ)(f.u,{css:[a.l0.textAlign.left],icon:(0,i.tZ)(I.Z,{color:a.TV.accentNegativeStrongest}),colorway:"negative",text:"Error loading join link. Click here to try again, or contact support.",onClick:function(){return V({replId:U})}})]}):(0,i.BX)(o.G,{css:B.container,children:[(0,i.BX)(o.G,{css:B.header,children:[(0,i.tZ)(P,{}),W?(0,i.BX)(o.G,{css:B.loading,children:[(0,i.tZ)(R.Z,{color:a.TV.foregroundDimmer}),(0,i.tZ)(s.xv,{color:"dimmer",multiline:!1,children:"Loading..."})]}):(0,i.tZ)(u.r,{isSelected:!!en,isDisabled:Q,onChange:function(e){Q||(e?j():$())},"aria-labelledby":"link-switch-label"})]}),!W&&en?(0,i.BX)(i.HY,{children:[(0,i.BX)(l.Tg,{css:B.inviteUrlContainer,children:[(0,i.tZ)(c.II,{type:"url",readOnly:!0,disabled:!0,value:Q?"Loading...":en,css:B.input}),(0,i.tZ)(E.m,{textToCopy:en,onClick:function(){en?((0,D.Z)(en),(0,G.j)(G.U3.JOIN_LINK_COPIED,{replId:null==K?void 0:K.id,isTeamRepl:ee,source:"replEnvironment"}),O("Link copied")):X("Could not copy link")},tooltip:"Copied to clipboard",text:"Copy join link",iconLeft:(0,i.tZ)(T.Z,{}),css:B.copyToClipboard,colorway:"primary",disabled:Q})]}),(0,i.tZ)(o.G,{children:(0,i.BX)(s.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Want to revoke access to this link?"," ",(0,i.tZ)("a",{css:a.l0.linkStyle,role:"button",tabIndex:0,onKeyDown:function(e){"Enter"!==e.key||(e.preventDefault(),Q||j())},onClick:function(e){e.preventDefault(),Q||j()},children:"Generate a new link"})]})})]}):null]})}},70712:function(e,t,n){n.d(t,{Jh:function(){return C},RJ:function(){return E},U:function(){return w},dE:function(){return g},mH:function(){return b},z8:function(){return k}});var r=n(45903),i=n(93295),o=n(23982),a=n(66039),l=n(13440);function c(){var e=(0,i._)(["\n  fragment MultiplayerManagerUser on User {\n    id\n    image\n    username\n    url\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  fragment MultiplayerManagerEmailInviteReplPermission on ReplPermission {\n    id\n    type\n    user {\n      id\n      image\n      username\n      url\n    }\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  query MultiplayerManager($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        isOwner\n        multiplayers {\n          ...MultiplayerManagerUser\n        }\n        currentUserPermissions {\n          editMultiplayers\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n      }\n    }\n    currentUser {\n      id\n      isSubscribed\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation MultiplayerManagerAddMultiplayerUser(\n    $replId: String!\n    $username: String!\n    $type: String!\n  ) {\n    addMultiplayerUser(replId: $replId, username: $username, type: $type) {\n      id\n      type\n      user {\n        ...MultiplayerManagerUser\n      }\n      repl {\n        id\n        multiplayers {\n          ...MultiplayerManagerUser\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation MultiplayerManagerRemoveMultiplayerUser(\n    $replId: String!\n    $username: String!\n  ) {\n    removeMultiplayerUser(replId: $replId, username: $username) {\n      id\n      user {\n        id\n        ...MultiplayerManagerUser\n      }\n      repl {\n        id\n        multiplayers {\n          ...MultiplayerManagerUser\n        }\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  mutation MultiplayerManagerCreateMultiplayerInvite(\n    $replId: String!\n    $email: String!\n    $type: String!\n  ) {\n    createMultiplayerInvite2(replId: $replId, email: $email, type: $type) {\n      ... on MultiplayerInvite {\n        email\n        repl {\n          id\n          multiplayers {\n            ...MultiplayerManagerUser\n          }\n          multiplayerInvites {\n            email\n            type\n          }\n        }\n      }\n      ... on UserError {\n        message\n      }\n      ... on ReplPermission {\n        id\n        ...MultiplayerManagerEmailInviteReplPermission\n      }\n    }\n  }\n  ","\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation MultiplayerManagerDeleteMultiplayerInvite(\n    $replId: String!\n    $email: String!\n  ) {\n    deleteMultiplayerInvite(replId: $replId, email: $email) {\n      ... on MultiplayerInvite {\n        email\n        type\n        repl {\n          id\n          multiplayers {\n            ...MultiplayerManagerUser\n          }\n          multiplayerInvites {\n            email\n            type\n          }\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}var m={},v=(0,o.Ps)(c()),g=(0,o.Ps)(s()),y=(0,o.Ps)(u(),v);function b(e){var t=(0,r._)({},m,e);return a.a(y,t)}var Z=(0,o.Ps)(d(),v);function w(e){var t=(0,r._)({},m,e);return l.D(Z,t)}var x=(0,o.Ps)(f(),v);function C(e){var t=(0,r._)({},m,e);return l.D(x,t)}var _=(0,o.Ps)(h(),v,g);function k(e){var t=(0,r._)({},m,e);return l.D(_,t)}var S=(0,o.Ps)(p(),v);function E(e){var t=(0,r._)({},m,e);return l.D(S,t)}},14267:function(e,t,n){n.d(t,{_U:function(){return R},ln:function(){return I}});var r=n(32477),i=n(21289),o=n(8182),a=n(4773),l=n(55534),c=n(2038),s=n(59868),u=n(44343),d=n(3630),f=n(38080),h=n(74833),p=n(56596),m=n(29287),v=n(1128),g=n(88936),y=n(94106),b=n(43429),Z=n(94376),w=n(70712),x=n(6836),C=n(58091),_=n(10602),k=n.n(_),S=n(30983),E=n(97615);function T(e,t){return t.some(function(t){return t.id===e})}var R={root:[m.l0.color.foregroundDefault,m.l0.flex.column,m.l0.colWithGap(12),m.l0.align.stretch,m.l0.flex.growAndShrink(1)],header:[m.l0.flex.row,m.l0.justify.spaceBetween,m.l0.align.center,m.l0.px(16)],header_mobile:[m.l0.px(0)],titleContainer:[m.l0.flex.row,m.l0.rowWithGap(4),m.l0.align.center],limitsContainer:[m.l0.align.center,m.l0.rowWithGap(8)],loading:[m.l0.rowWithGap(4),m.l0.align.center,m.l0.flex.grow(1),m.l0.justify.center],measureBar:[m.l0.height(8),m.l0.width(60)],searchContainer:[m.l0.px(16),m.l0.position.relative,m.l0.maxHeight(32)],userList:[m.l0.flex.column,m.l0.colWithGap(16),m.l0.scrollbar.thin,m.l0.position.relative,m.l0.overflowY("auto"),m.l0.flex.growAndShrink(1),m.l0.pb(8),{maxHeight:300,"::-webkit-scrollbar-thumb":[m.l0.backgroundColor.backgroundHighest,m.l0.borderRadius(4)],scrollbarColor:"".concat(m.TV.backgroundDefault," ").concat(m.TV.backgroundHighest)}],userGroup:{root:[m.l0.colWithGap(8)],titleContainer:[m.l0.rowWithGap(4),m.l0.align.center,m.l0.px(16)],title:[m.l0.fontWeight.medium]},emptyContainer:[m.l0.position.relative,m.l0.flex.row,m.l0.rowWithGap(12),m.l0.py(64),m.l0.center,m.l0.px(16),{maxHeight:220,borderBottom:"solid 1px ".concat(m.TV.outlineDimmest)}]},I=function(e){var t=e.title,n=e.count,r=e.color,i=e.tooltip;return(0,o.BX)(p.G,{css:R.userGroup.titleContainer,children:[(0,o.tZ)(v.Z,{color:r,size:6}),(0,o.tZ)(h.xv,{variant:"small",css:R.userGroup.title,multiline:!1,children:t}),(0,o.tZ)(h.xv,{multiline:!1,variant:"small",color:"dimmest",css:R.userGroup.title,children:n}),i?(0,o.tZ)(S.u,{tooltip:i,children:(0,o.tZ)(E.Z,{})}):null]})};t.ZP=function(e){var t=e.replId,n=e.handleUpgradeTriggered,v=(0,y.useRouter)(),_=(0,c.Vg)(v),S=(0,l.Z)(),E=S.showConfirm,D=S.showError,G=(0,C.aG)(),B=(0,w.mH)({variables:{replId:t},pollInterval:8e3}),P=B.data,A=B.loading,N=(0,r._)((0,w.U)({onCompleted:function(e){var n,r=null===(n=e.addMultiplayerUser.user)||void 0===n?void 0:n.username;r&&((0,s.j)(s.U3.MULTIPLAYER_INVITED,{replId:t,inviteMethod:"username"}),E("Added @".concat(r)))}}),2),U=N[0],L=N[1],O=(0,r._)((0,w.z8)({update:function(e,n){var r=null===(a=n.data)||void 0===a?void 0:a.createMultiplayerInvite2;if(r){if("UserError"===r.__typename){D(r.message);return}if("MultiplayerInvite"===r.__typename){var o=r.email;(0,s.j)(s.U3.MULTIPLAYER_INVITED,{replId:t,inviteMethod:"email"}),E("Invited ".concat(o," via email"));return}if("ReplPermission"===r.__typename){e.modify({id:e.identify({__typename:"Repl",id:t}),fields:{permissions:function(t){var n=e.writeFragment({data:r,fragment:w.dE});return(0,i._)(t).concat([n])}}});var a,l,c=null===(l=r.user)||void 0===l?void 0:l.username;if(!c)return;(0,s.j)(s.U3.MULTIPLAYER_INVITED,{replId:t,inviteMethod:"email"}),E("Invited @".concat(c))}}}}),2),X=O[0],M=O[1];(0,b.useEffect)(function(){var e=L.error||M.error;if(e){if(e.message.includes("reached the limit")){_?D("You have reached the invite limit for a free account, visit https://replit.com/pricing to upgrade."):n&&n(!0);return}D(e.message)}},[L.error,M.error,D,_,n]);var F=(null==P?void 0:P.repl.__typename)==="Repl"?P.repl:null,W=null==P?void 0:P.currentUser,H=null==F?void 0:F.multiplayers.reduce(function(e,t){return(0,i._)(e).concat([t.username])},[]),V=(null==F?void 0:F.currentUserPermissions.editMultiplayers)||!1,z=!!(F&&!F.multiplayers.length&&!F.multiplayerInvites.length),j=null==F?void 0:F.multiplayers.filter(function(e){return e.id!==(null==W?void 0:W.id)}),q=null==j?void 0:j.filter(function(e){return e&&T(e.id,G)}),Y=null==j?void 0:j.filter(function(e){return e&&!T(e.id,G)}),$=j?j.length:null;return(0,o.BX)(f.Tg,{background:"default",css:R.root,children:[(0,o.BX)(p.G,{css:[R.header,_&&R.header_mobile],children:[(0,o.tZ)(p.G,{css:R.titleContainer,children:(0,o.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Multiplayers"})}),(0,o.BX)(p.G,{css:R.limitsContainer,children:[A?(0,o.BX)(p.G,{css:R.loading,children:[(0,o.tZ)(g.Z,{color:m.TV.foregroundDimmer}),(0,o.tZ)(h.xv,{color:"dimmer",multiline:!1,children:"Loading..."})]}):null,null===$||(null==W?void 0:W.isSubscribed)?null:(0,o.BX)(o.HY,{children:[(0,o.BX)(h.xv,{variant:"small",color:"dimmest","aria-hidden":!0,multiline:!1,children:[$," / ",Z.z]}),(0,o.tZ)(d.J,{css:R.measureBar,total:Z.z,current:$,tooltip:"".concat(Z.z-$," free editors remaining")})]}),A||(null==W?void 0:W.isSubscribed)||_?null:(0,o.tZ)(a.Z,{size:"small",context:"workspace_multiplayer_header",onClickCallback:function(){n&&n(!0)},onCancel:function(){n&&n(!1)}})]})]}),V&&H&&F?(0,o.tZ)(p.G,{css:R.searchContainer,children:(0,o.tZ)(u.Z,{existingUsernames:H,onSubmit:function(e){if(!A||(null==W?void 0:W.isSubscribed)){if(k()(e)&&!M.loading){X({variables:{replId:t,email:e,type:"rw"}});return}L.loading||U({variables:{username:e,replId:t,type:"rw"}})}}})}):null,z?(0,o.tZ)(p.G,{css:R.emptyContainer,children:(0,o.tZ)(p.G,{children:(0,o.tZ)(h.xv,{variant:"subheadDefault",color:"dimmer",multiline:!1,children:"No one else is here"})})}):(0,o.BX)(f.Tg,{css:R.userList,children:[(null==q?void 0:q.length)?(0,o.BX)(p.G,{css:R.userGroup.root,children:[(0,o.tZ)(I,{title:"Online",count:q.length||0,color:m.TV.greenStrongest}),q.map(function(e){return e?(0,o.tZ)(x.Z,{isPendingInvitation:!1,replId:t,canEditMultiplayers:V,user:e},e.id):null})]}):null,(null==Y?void 0:Y.length)?(0,o.BX)(p.G,{css:R.userGroup.root,children:[(0,o.tZ)(I,{title:"Offline",count:Y.length||0,color:m.TV.outlineStrongest}),null==Y?void 0:Y.map(function(e){return e?(0,o.tZ)(x.Z,{canEditMultiplayers:V,isPendingInvitation:!1,user:e,replId:t},e.id):null})]}):null,(null==F?void 0:F.multiplayerInvites.length)?(0,o.BX)(p.G,{css:R.userGroup.root,children:[(0,o.tZ)(I,{title:"Pending Invitations",count:(null==F?void 0:F.multiplayerInvites.length)||0,color:m.TV.outlineStrongest}),F.multiplayerInvites.map(function(e){return(0,o.tZ)(x.Z,{canEditMultiplayers:V,replId:t,isPendingInvitation:!0,email:e.email},e.email)})]}):null]})]})}},6836:function(e,t,n){var r=n(32477),i=n(8182),o=n(46056),a=n(15146),l=n(74833),c=n(54254),s=n(56596),u=n(93918),d=n(29287),f=n(17216),h=n(58719),p=n(50862),m=n(36010),v=n.n(m),g=n(70712),y=n(55534),b=(0,u.X)({root:[d.l0.px(16),d.l0.py(4),d.l0.flex.row,d.l0.rowWithGap(8),d.l0.align.center,d.l0.cursor.default,d.l0.justify.spaceBetween],userContainer:d.l0.color.foregroundDefault,userContainer_pending:[d.l0.flex.grow(1),d.l0.flex.row,d.l0.rowWithGap(8),d.l0.align.center,{fontStyle:"italic"}],permissionsContainer:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.align.center]});t.Z=function(e){var t,n=e.isPendingInvitation,u=e.canEditMultiplayers,m=e.replId,Z=(0,y.Z)(),w=Z.showError,x=Z.showConfirm,C=(0,r._)((0,g.Jh)({onError:function(e){return w(e.message)},onCompleted:function(e){var t,n=null===(t=e.removeMultiplayerUser.user)||void 0===t?void 0:t.username;n&&x("".concat(n," removed"))}}),2),_=C[0],k=C[1],S=(0,r._)((0,g.RJ)({onError:function(e){return w(e.message)},onCompleted:function(e){if("UserError"===e.deleteMultiplayerInvite.__typename){w(e.deleteMultiplayerInvite.message);return}if("MultiplayerInvite"===e.deleteMultiplayerInvite.__typename){var t=e.deleteMultiplayerInvite.email;x("Invite canceled for ".concat(t))}}}),2),E=S[0],T=S[1],R=!n,I=R?(0,i.tZ)(o.Z,{size:"m",url:e.user.image,username:e.user.username,fullName:e.user.fullName}):(0,i.tZ)(f.Z,{color:d.TV.outlineDefault,size:32}),D=R?e.user.username:e.email;return(0,i.BX)(s.G,{css:b.root,children:[R?(0,i.tZ)(p.Z,{username:e.user.username,children:(0,i.tZ)(v(),{legacyBehavior:!0,href:"/@".concat(e.user.username),passHref:!0,children:(0,i.tZ)(s.G,{tag:"a",css:b.userContainer,children:(0,i.tZ)(c.n,{username:e.user.username,src:null!==(t=e.user.image)&&void 0!==t?t:null})})})}):(0,i.BX)(s.G,{css:[b.userContainer_pending],children:[I,(0,i.tZ)(l.xv,{color:R?"default":"dimmest",multiline:!1,children:D})]}),(0,i.BX)(s.G,{css:b.permissionsContainer,children:[(0,i.tZ)(l.xv,{color:"dimmest",variant:"small",multiline:!1,children:e.isPendingInvitation?"Invited":"Can edit"}),u?(0,i.tZ)(a.hU,{alt:R?"Remove member":"Cancel invitation",onClick:function(){!u||k.loading||T.loading||(R?_({variables:{replId:m,username:e.user.username}}):E({variables:{replId:m,email:e.email}}))},children:(0,i.tZ)(h.Z,{size:12})}):null]})]})}},44343:function(e,t,n){n.d(t,{Z:function(){return S}});var r=n(45903),i=n(25e3),o=n(32477),a=n(8182),l=n(46056),c=n(6187),s=n(55534),u=n(1498),d=n(18836),f=n(38080),h=n(74833),p=n(56596),m=n(93918),v=n(29287),g=n(32377),y=n(88936),b=n(63130),Z=n(43429),w=n(10981),x=n(10602),C=n.n(x),_=n(57574),k=(0,m.X)({form:[v.l0.align.start,v.l0.display.flex,v.l0.rowWithGap(8),v.l0.width("100%")],searchContainer:[v.l0.position.relative,v.l0.flex.growAndShrink(1)],dropdownMenu:[v.l0.borderRadius(8),v.l0.overflow("hidden"),v.l0.mt(2),v.l0.zIndex(2),v.l0.border({color:v.TV.outlineDimmer,width:1,style:"solid"}),v.l0.maxHeight(280),v.l0.overflowY("auto"),v.l0.scrollbar.thin,{scrollbarColor:v.TV.backgroundHigher+" "+v.TV.backgroundHighest,"&::-webkit-scrollbar-thumb":{backgroundColor:v.TV.backgroundHighest}}],result:[v.l0.p(8),v.l0.rowWithGap(8),v.l0.justify.spaceBetween,v.l0.align.center,v.l0.cursor.pointer],result_active:[v.l0.backgroundColor.accentPrimaryDimmer],userContainer:[v.l0.rowWithGap(8),v.l0.align.center],loadingContainer:[v.l0.align.center,v.l0.m(8),v.l0.rowWithGap(8),v.l0.align.center],emptyText:[v.l0.m(8)]});function S(e){var t=e.onSubmit,n=e.existingUsernames,m=e.isDisabled,x=e.onChange,S=e.placeholder,E=(0,o._)(Z.useState(""),2),T=E[0],R=E[1],I=(0,w.U)(),D=(0,c.Z)(T.trim().replace(/^@/,""),250),G=(0,_.sk)({skip:!D||C()(T),variables:{query:D,limit:6}}),B=G.data,P=G.loading,A=G.error,N=(0,s.Z)().showError;Z.useEffect(function(){A&&N(A.message)},[A,N]);var U=null==B?void 0:B.usernameSearch,L=function(e){R(e.currentTarget.value),null==x||x(e.currentTarget.value)},O=function(e){"Enter"===e.key&&T.match(/.+@.+/)&&(t(T),R(""),e.currentTarget.blur())};return(0,a.BX)("form",{onSubmit:function(e){e.preventDefault(),t(T),R("")},css:k.form,children:[(0,a.tZ)(b.ZP,{onChange:function(e){e&&R(e.username)},itemToString:function(e){return(null==e?void 0:e.username)||""},initialHighlightedIndex:0,defaultHighlightedIndex:0,children:function(e){var t=e.getInputProps,o=e.getItemProps,c=e.getMenuProps,s=e.isOpen,u=e.highlightedIndex,m=e.getRootProps;return(0,a.BX)(p.G,(0,i._)((0,r._)({css:k.searchContainer},m({refKey:"innerRef"})),{children:[(0,a.tZ)(d.II,(0,r._)({id:I("username-search")},t({ref:null,value:T,onChange:L,placeholder:null!=S?S:"Add people by username or email",autoComplete:"off",onKeyDown:O}))),s?(0,a.BX)(p.G,{children:[U&&U.length?(0,a.tZ)(f.Tg,(0,i._)((0,r._)({elevated:!0,css:k.dropdownMenu,tag:"ul"},c({refKey:"innerRef"})),{children:U.map(function(e,t){return(0,a.BX)(p.G,(0,i._)((0,r._)({tag:"li"},o({item:e,index:t})),{css:[k.result,t===u&&k.result_active],children:[(0,a.BX)(p.G,{css:k.userContainer,children:[(0,a.tZ)(l.Z,{size:"m",url:e.image,username:e.username,fullName:e.fullName}),(0,a.tZ)(h.xv,{multiline:!1,children:e.username})]}),n.includes(e.username)?(0,a.tZ)(p.G,{children:(0,a.tZ)(g.Z,{color:v.TV.accentPositiveStronger})}):null]}),t)})})):null,P?(0,a.tZ)(f.Tg,{elevated:!0,css:k.dropdownMenu,children:(0,a.BX)(p.G,{css:k.loadingContainer,children:[(0,a.tZ)(y.Z,{}),(0,a.tZ)(h.xv,{color:"dimmer",multiline:!1,children:"Loading"})]})}):null,U&&0===U.length?(0,a.tZ)(f.Tg,{elevated:!0,css:k.dropdownMenu,children:(0,a.BX)(h.xv,{css:k.emptyText,color:"dimmer",multiline:!1,children:['No results found for "',T,'"']})}):null]}):null]}))}}),(0,a.tZ)(p.G,{children:(0,a.tZ)(u.zx,{colorway:"primary",type:"submit",disabled:m||!T,text:"Invite"})})]})}},26592:function(e,t,n){n.d(t,{s:function(){return eF}});var r=n(8182),i=n(41588),o=n(59868),a=n(89960),l=n(34142),c=n(45903),s=n(25e3),u=n(32477),d=n(87682),f=n(64697),h=n(60814),p=n(84460),m=n(88211),v=n(7755),g=n(29287),y=n(74833),b=n(56596),Z=n(74094);function w(e){var t=e.amount,n=e.includeUsd,i=e.variant,o=e.color,a=void 0===o?"default":o,l=(0,v.$E)(t),c=(0,v.H2)(t);return(0,r.BX)(b.G,{css:[g.l0.rowWithGap(2),g.l0.align.center],children:[(0,r.tZ)(Z.Z,{size:"small"===i?12:16,css:[y.E_[a]]}),(0,r.BX)(y.xv,{variant:i,color:a,multiline:!1,children:[c,n?" (".concat(l,")"):""]})]})}var x=n(32450),C=n(75582),_={boost:C.kL.Boost,hosting_tier:C.kL.HostingTier},k={boost_2cpu_2ram:C.s2.Boost_2cpu_2ram,boost_4cpu_4ram:C.s2.Boost_4cpu_4ram,boost_8cpu_8ram:C.s2.Boost_8cpu_8ram,boost_16cpu_16ram:C.s2.Boost_16cpu_16ram,hosting_tier_e2_micro:C.s2.HostingTierE2Micro,hosting_tier_e2_small:C.s2.HostingTierE2Small,hosting_tier_e2_medium:C.s2.HostingTierE2Medium,hosting_tier_n1_custom_1_4:C.s2.HostingTierN1Custom_1_4,hosting_tier_e2_standard_2:C.s2.HostingTierE2Standard_2,hosting_tier_e2_standard_4:C.s2.HostingTierE2Standard_4},S=n(28585),E=n(90777),T=n(1498),R=n(68514),I=n(15146),D=n(93918),G=n(52924),B=n(88936),P=n(99656),A=n(91685),N=n(88817),U=n(43429),L=n(40699),O=n(98965),X=n(93295),M=n(23982),F=n(33248),W=n(19762),H=n(43910);function V(){var e=(0,X._)(["\n  query RefetchPowerUps($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        ...MultiBoostReplPowerUps\n        ...ReplPowerUpMutationReturnFields\n      }\n    }\n    currentUser {\n      ...PowerUpMutationReturnFields\n    }\n  }\n  ","\n  ","\n  ","\n"]);return V=function(){return e},e}var z={},j=(0,M.Ps)(V(),F.s1,W.sh,W.E_),q=function(e){var t,n=e.productCost,r=e.cyclesBalance;if(n<=r)return{cyclesToBePurchased:0,cyclesBalanceAfterUpgrade:r,excessPurchaseExplanation:"no-purchase"};var i=n-r,o="no-excess";i>=L.gp?(t=i,o="no-excess"):(t=L.gp,o="minimum");var a=r+t-n;return{cyclesToBePurchased:t,cyclesBalanceAfterUpgrade:a,excessPurchaseExplanation:o}};function Y(e){var t=e.cycles,n=e.description;return(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,r.tZ)(y.xv,{color:"dimmest",multiline:!1,children:n}),(0,r.tZ)(R.R,{}),(0,r.tZ)(w,{amount:t,includeUsd:!1,color:"dimmest"})]})}var $=(0,D.X)({iconBackground:[g.l0.width(40),g.l0.height(40),g.l0.borderRadius(8),g.l0.justify.center,g.l0.align.center,g.l0.backgroundColor.blueDimmer],loadingContainer:[g.l0.justify.center,g.l0.align.center,g.l0.minHeight(80)]});function J(e){var t=e.powerUpCategory,n=e.cyclesCost,o=e.description,a=i.S0[t];return(0,r.tZ)(b.G,{css:[g.l0.colWithGap(16)],children:(0,r.BX)(b.G,{css:[g.l0.flex.row,g.l0.justify.spaceBetween],children:[(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,r.tZ)(b.G,{css:$.iconBackground,children:(0,r.tZ)(a.iconComponent,{size:24})}),(0,r.BX)(b.G,{css:[g.l0.px(8),g.l0.py(2),g.l0.colWithGap(4),g.l0.justify.spaceBetween],children:[(0,r.tZ)(y.xv,{variant:"subheadDefault",multiline:!1,children:a.name}),(0,r.tZ)(y.xv,{variant:"small",color:"dimmer",multiline:!1,children:o})]})]}),(0,r.BX)(b.G,{css:[g.l0.px(8),g.l0.py(2),g.l0.colWithGap(4),g.l0.justify.spaceBetween,g.l0.align.end],children:[(0,r.tZ)(w,{amount:n,includeUsd:!0}),(0,r.BX)(y.xv,{variant:"small",color:"dimmer",multiline:!1,children:["per / ",a.orderDuration]})]})]})})}function K(e){var t,n,o,a=e.product,v=e.goToCheckoutSuccess,Z=e.goToNewPaymentMethodForm,w=(0,f.useStripe)(),C=(0,h.Z)({forceFetch:!0}),D=C.cycles,X=C.loading,M=(0,E.Q)(),F=M.paymentMethod,W=M.loading,V=i.S0[a.powerUpCategory],K=i.$[a.powerUpSku].provisionDescription,Q=(0,u._)((0,U.useState)(null),2),ee=Q[0],et=Q[1],en=(0,u._)((0,U.useState)(!1),2),er=en[0],ei=en[1],eo=(0,u._)((0,U.useState)(!1),2),ea=eo[0],el=eo[1],ec=(0,S.M)().createCheckoutSession,es=(0,u._)((t={variables:{replId:a.replId}},n=(0,c._)({},z,t),H.t(j,n)),1)[0],eu=(0,O.B)().startPolling,ed=(0,p.kr)({defaultAutoRefillEnabledValue:!0}),ef=ed.autoRefillEnabled,eh=ed.autoRefillMonthlyBudget,ep=ed.autoRefillHasError,em=ed.autoRefillHasChanged,ev=ed.cardAutoRefillPreferencesProps,eg=q({productCost:a.cyclesCostNow,cyclesBalance:null!=D?D:0}),ey="This will purchase ".concat(eg.cyclesToBePurchased.toLocaleString()," Cycles for ").concat((0,L.qJ)(eg.cyclesToBePurchased)," and activate your ").concat(V.name,".");"minimum"===eg.excessPurchaseExplanation&&(ey="This will purchase the minimum purchase amount of ".concat(eg.cyclesToBePurchased.toLocaleString()," Cycles for ").concat((0,L.qJ)(eg.cyclesToBePurchased)," and activate your ").concat(V.name,"."));var eb=(0,u._)((0,U.useState)("Processing..."),2),eZ=eb[0],ew=eb[1],ex=(0,N.i)(),eC=ex.isPurchaseAllowed,e_=ex.reasonPurchaseNotAllowed;if(!eC&&e_)return(0,r.tZ)(A.Z,{reason:e_});var ek=function(){ei(!1)},eS=(o=(0,l._)(function(){return(0,d.Jh)(this,function(e){switch(e.label){case 0:var t;if(ei(!0),null==F)throw Error("paymentMethod is null");if(null==w)throw Error("stripe is null");return ew("Checking out..."),[4,ec({input:{cyclesQuantity:eg.cyclesToBePurchased,postPurchasePowerUp:{replPowerUp:{replId:a.replId,sku:k[a.powerUpSku],type:_[a.powerUpCategory]}},cyclesAutoRefillConfiguration:em?{enabled:ef,monthlyBudget:eh}:null},onError:function(e){et(e),ek()},onSucceed:(t=(0,l._)(function(e){var t,n;return(0,d.Jh)(this,function(r){switch(r.label){case 0:return ew("Processing payment..."),[4,w.confirmCardPayment(e.clientSecret)];case 1:if(t=r.sent().error)return et(null!==(n=t.message)&&void 0!==n?n:"An error occurred. Please try again."),ek(),[2];return ew("Provisioning Power Up..."),eu({checkoutSessionId:{checkoutSessionId:e.checkoutSessionId}.checkoutSessionId,onSucceeded:function(){el(!0),es(),v(a)},onFailed:function(){et("Payment failed. Please try again."),ek(),es()},onError:function(e){et(e),ek(),es()}}),[2]}})}),function(e){return t.apply(this,arguments)})})];case 1:return e.sent(),[2]}})}),function(){return o.apply(this,arguments)}),eE=W||X||null==D,eT=null!=F&&!eE&&!er;return(0,r.BX)(b.G,{css:[g.l0.colWithGap(16)],children:[(0,r.tZ)(J,{powerUpCategory:a.powerUpCategory,cyclesCost:L.z4[a.powerUpSku],description:K}),(0,r.tZ)(R.R,{}),eE?(0,r.tZ)(b.G,{css:$.loadingContainer,children:(0,r.tZ)(B.Z,{})}):(0,r.tZ)(b.G,{css:[g.l0.colWithGap(12),g.l0.align.start],children:null==F?(0,r.BX)(r.HY,{children:[(0,r.tZ)(y.xv,{color:"dimmer",children:"You need to add a payment method to complete this purchase."}),(0,r.tZ)(T.zx,{iconLeft:(0,r.tZ)(P.Z,{}),text:"Add Payment Method",size:"big",onClick:Z,colorway:"primary",stretch:!0})]}):(0,r.tZ)(r.HY,{children:(0,r.tZ)(b.G,{css:[g.l0.colWithGap(16)],children:(0,r.BX)(b.G,{css:[g.l0.colWithGap(4)],children:[(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,r.tZ)(I.hU,{alt:"Update Payment Method",onClick:Z,children:(0,r.tZ)(G.Z,{})}),(0,r.tZ)(m.R,{last4:F.last4})]}),(0,r.tZ)(b.G,{css:[g.l0.pl(24),g.l0.pr(16),g.l0.colWithGap(8)],children:(0,r.tZ)(p.OK,(0,s._)((0,c._)({},ev),{loading:ev.loading||er,showSaveButton:!1}))})]})})})}),null!==F?(0,r.BX)(r.HY,{children:[(0,r.tZ)(R.R,{}),(0,r.tZ)(y.xv,{variant:"small",css:[g.l0.color.foregroundDimmer],children:ey}),(0,r.tZ)(x.q,{isMakingPayment:!0,showSuccessState:ea,showProcessingState:er,disabled:!eT||ep,initialStateTextOverride:"Purchase ".concat(eg.cyclesToBePurchased.toLocaleString()," Cycles & Upgrade ").concat(V.name),processingStateTextOverride:eZ,size:"big",onClick:eS}),null!=ee?(0,r.tZ)(y.xv,{css:[g.l0.color.accentNegativeDefault],children:ee}):null,(0,r.BX)(b.G,{css:[g.l0.colWithGap(4)],children:[(0,r.tZ)(Y,{description:"Cycles balance after purchase",cycles:eg.cyclesToBePurchased}),(0,r.tZ)(Y,{description:"1st ".concat(V.orderDuration," of ").concat(V.name),cycles:-1*a.cyclesCostNow}),(0,r.tZ)(Y,{description:"Cycles balance after upgrade",cycles:eg.cyclesBalanceAfterUpgrade})]})]}):null]})}var Q=n(66039);function ee(){var e=(0,X._)(["\n  query CheckOutSuccess($replId: String!) {\n    currentUser {\n      id\n      cyclesAutoRefillConfiguration {\n        ... on CyclesAutoRefillConfiguration {\n          id\n          enabled\n          refillAmount\n          monthlyBudget\n        }\n        ... on UnauthorizedError {\n          message\n        }\n      }\n    }\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return ee=function(){return e},e}var et={},en=(0,M.Ps)(ee()),er=n(37951),ei=n(57122),eo=n(20573),ea=(0,D.X)({powerUpIconBackground:[g.l0.width(32),g.l0.height(32),g.l0.borderRadius(8),g.l0.justify.center,g.l0.align.center,g.l0.backgroundColor.blueDimmer],autoRefillIconBackground:[g.l0.width(32),g.l0.height(32),g.l0.borderRadius(8),g.l0.justify.center,g.l0.align.center,g.l0.backgroundColor.greyDimmer]});function el(e){var t,n,o,a,l,s,u,d=e.product,f=e.goToCardPreferences,p=e.goToPowerUpDetails,m=(0,h.Z)({forceFetch:!0}).cycles,v=(t={variables:{replId:d.replId}},n=(0,c._)({},et,t),Q.a(en,n)),Z=v.data,x=v.loading,C=(null==Z?void 0:null===(s=Z.currentUser)||void 0===s?void 0:null===(l=s.cyclesAutoRefillConfiguration)||void 0===l?void 0:l.__typename)==="CyclesAutoRefillConfiguration"?Z.currentUser.cyclesAutoRefillConfiguration:null,_=(null==Z?void 0:Z.repl.__typename)==="Repl"&&(null===(u=Z.repl.owner)||void 0===u?void 0:u.__typename)==="Team",k=!!(null==C?void 0:C.enabled),S=i.S0[d.powerUpCategory],E=i.$[d.powerUpSku];return(0,r.BX)(b.G,{css:[g.l0.colWithGap(16)],children:[(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.justify.spaceBetween,g.l0.align.center],children:[(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,r.tZ)(b.G,{css:ea.powerUpIconBackground,children:(0,r.tZ)(S.iconComponent,{size:20})}),(0,r.BX)(b.G,{css:[g.l0.flex.column],children:[(0,r.BX)(y.xv,{multiline:!1,children:[S.name," activated"]}),(0,r.BX)(b.G,{css:g.l0.rowWithGap(8),children:[(0,r.tZ)(y.xv,{variant:"small",color:"dimmer",multiline:!1,children:E.provisionDescription}),_?null:(0,r.BX)(b.G,{css:[g.l0.rowWithGap(4)],children:[(0,r.tZ)(w,{amount:L.z4[d.powerUpSku],includeUsd:!0,variant:"small",color:"dimmer"}),(0,r.BX)(y.xv,{variant:"small",color:"dimmer",multiline:!1,children:["/ ",S.orderDuration]})]})]})]})]}),(0,r.tZ)(y.xv,{multiline:!1,children:(0,r.tZ)("a",{role:"button",tabIndex:0,onKeyDown:function(){return p(d.powerUpCategory)},onClick:function(){return p(d.powerUpCategory)},css:[g.l0.color.foregroundDimmer,{textDecoration:"underline"}],children:"Edit"})})]}),_||x?null:(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.justify.spaceBetween,g.l0.align.center],children:[(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,r.tZ)(b.G,{css:ea.autoRefillIconBackground,children:(0,r.tZ)(ei.Z,{size:20})}),(0,r.BX)(b.G,{css:[g.l0.flex.column],children:[(0,r.BX)(y.xv,{multiline:!1,children:["Auto-Refill is"," ",(a=(o={autoRefillEnabled:k,loadingAutoRefill:x}).autoRefillEnabled,o.loadingAutoRefill?"...":a?"on":"off")]}),(0,r.tZ)(b.G,{css:g.l0.rowWithGap(4),children:null==m?(0,r.tZ)(B.Z,{}):(0,r.BX)(r.HY,{children:[(0,r.tZ)(w,{amount:m,includeUsd:!1,variant:"small",color:"dimmer"}),(0,r.tZ)(y.xv,{variant:"small",color:"dimmer",multiline:!1,children:"left"})]})})]})]}),(0,r.tZ)(y.xv,{multiline:!1,children:(0,r.tZ)("a",{role:"button",tabIndex:0,onKeyDown:function(){return f(d.powerUpCategory)},onClick:function(){return f(d.powerUpCategory)},css:[g.l0.color.foregroundDimmer,{textDecoration:"underline"}],children:"Edit"})})]}),x||k||_?null:(0,r.tZ)(er.E,{colorway:"warning",icon:(0,r.tZ)(eo.Z,{}),text:"Add a payment method and enable Auto-Refill to prevent your ".concat(S.name," Power Up from being disabled when you run out of Cycles.")})]})}var ec=n(97764),es=n(40102),eu=n(32377),ed=n(40028),ef=n(66766),eh=n(48272),ep=n(38080),em=n(51384),ev=n(66932),eg={tier:(0,em.iv)([g.l0.borderRadius(12),g.l0.colWithGap(12),g.l0.p(12)]),tierHeader:(0,em.iv)([g.l0.rowWithGap(8),g.l0.flex.grow(1),g.l0.justify.spaceBetween,g.l0.align.baseline]),tierHeaderTitle:(0,em.iv)(g.l0.rowWithGap(8)),tierHeaderCost:(0,em.iv)([g.l0.rowWithGap(4),g.l0.align.baseline]),tierFeatures:(0,em.iv)(g.l0.colWithGap(8)),tierFeature:(0,em.iv)(g.l0.rowWithGap(4),g.l0.align.center),tierPicker:(0,em.iv)([g.l0.border({color:g.TV.outlineDefault})])},ey=function(e){var t=e.selectedOption,n=e.onChange,i=e.disabled,o=L.r4[t.sku].egress,a="INCLUDED_IN_SUBSCRIPTION"!==t.cost.explanation&&"NOT_SUPPORTED_FOR_TEAMS"!==t.cost.explanation;return(0,r.BX)(ep.Tg,{elevated:!0,css:eg.tier,children:[(0,r.BX)(b.G,{css:eg.tierHeader,children:[(0,r.tZ)(b.G,{css:eg.tierHeaderTitle,children:(0,r.tZ)(y.xv,{variant:"subheadBig",multiline:!1,children:"Reserved VM"})}),(0,r.tZ)(b.G,{css:g.l0.rowWithGap(4),children:a?(0,r.BX)(b.G,{css:[g.l0.rowWithGap(2),g.l0.align.center],children:[(0,r.tZ)(Z.Z,{}),(0,r.BX)(b.G,{css:[eg.tierHeaderCost],children:[(0,r.tZ)(y.xv,{variant:"subheadDefault",multiline:!1,children:t.cost.cyclesCostRecurring}),(0,r.tZ)(y.xv,{color:"dimmer",variant:"small",multiline:!1,children:"per day"})]})]}):null})]}),(0,r.tZ)(eh.P,{css:eg.tierPicker,initialSelectedItem:{title:(0,ev.$)(t.sku),sku:t.sku},items:Object.keys(L.r4).map(function(e){return{title:(0,ev.$)(e),sku:e}}),onChange:function(e){return n(e.sku)},disabled:i}),(0,r.tZ)(b.G,{css:eg.tierFeatures,children:["".concat(o," GiB egress"),"Deploy to any URL, cover page optional","Configurable machine","Always on"].map(function(e,t){return(0,r.BX)(b.G,{css:eg.tierFeature,children:[(0,r.tZ)(eu.Z,{}),(0,r.tZ)(y.xv,{multiline:!1,children:e})]},t)})})]})},eb=n(50782),eZ=n(30983),ew=n(97615),ex=n(73524),eC=n(48900),e_=n(12834),ek=n(55534),eS=n(12874),eE=n(58378),eT=function(e){var t,n,i=e.context,a=e.selectedOption,c=e.currentOption,s=e.onBuyMoreCycles,f=e.onPowerUpUpdated,h=e.onPowerUpRequested,m=(0,eb.Z)(),v=(0,e_.Z)(),y=(0,ek.Z)().showError,b=(0,u._)(U.useState(!1),2),Z=b[0],w=b[1],x=(0,p.kr)({}).autoRefillEnabled,_=(0,u._)((0,eE.IN)({onCompleted:(t=(0,l._)(function(e){var t;return(0,d.Jh)(this,function(n){switch(n.label){case 0:if("UserError"===(t=e.setHostingTier).__typename)return y(t.message),[2];return w(!0),[4,new Promise(function(e){return setTimeout(e,2e3)})];case 1:return n.sent(),f({type:"powerUp",powerUpCategory:"hosting_tier",powerUpSku:a.sku,cyclesCostNow:a.cost.cyclesCostNow,replId:m}),v.current,[2]}})}),function(e){return t.apply(this,arguments)}),onError:function(e){h(!1),eC.Tb(e),y(e.message)}}),2),k=_[0],S=_[1].loading;if(Z)return(0,r.tZ)(T.zx,{text:"Tier Purchased",colorway:"positive",loading:!0,css:{color:"".concat(g.TV.accentPositiveStronger," !important")}});var E=(null==c?void 0:c.sku)===a.sku,R=!0;switch(a.cost.explanation){case C.Ch.IncludedInExistingOrder:case C.Ch.ActivateExistingOrder:case C.Ch.SpendCycles:case C.Ch.NeedsCycles:case C.Ch.IncludedInSubscription:R=!1}return S?(R=!0,n="Processing"):E?(R=!0,n="Current tier"):n="INCLUDED_IN_SUBSCRIPTION"===a.cost.explanation?"Activate and deploy":"NOT_SUPPORTED_FOR_TEAMS"===a.cost.explanation?"Not available for teams":"Purchase and deploy",(0,r.tZ)(T.zx,{text:n,disabled:R,loading:S,colorway:S||!R?"primary":void 0,iconRight:S?void 0:(0,r.tZ)(eS.Z,{}),onClick:function(){var e;if(h(!0),!S){if(a.cost.explanation===C.Ch.NeedsCycles){s({type:"powerUp",powerUpCategory:"hosting_tier",powerUpSku:a.sku,cyclesCostNow:a.cost.cyclesCostNow,replId:m});return}k({variables:{input:{replId:m,sku:a.sku}}}),null!==(e=a.cost.cyclesCostNow)&&void 0!==e&&e&&((0,o.j)(o.U3.CHECKOUT_REQUESTED,{source:i,powerUpCategory:"boost"}),(0,o.j)(o.U3.CYCLES_USED,{powerUp:"hosting_tier",sku:a.sku,source:i}),(0,o.j)(o.U3.CHECKOUT_COMPLETED,{source:i,powerUpCategory:"boost",autoRefill:x}))}},css:S&&{color:"".concat(g.TV.accentPrimaryStronger," !important")}})},eR=function(e){var t=e.context,n=e.onBuyMoreCycles,i=e.onPowerUpUpdated,o=(0,eb.Z)(),a=(0,u._)(U.useState("ready"),2),l=a[0],c=a[1],s=(0,u._)(U.useState(null),2),d=s[0],f=s[1],h=(0,u._)(U.useState(null),2),p=h[0],m=h[1],Z=(0,u._)(U.useState(null),2),w=Z[0],x=Z[1];if((0,eE.s7)({fetchPolicy:"network-only",ssr:!1,variables:{replId:o},onCompleted:function(e){if((null==e?void 0:e.repl.__typename)==="Repl"&&(null===(n=e.repl)||void 0===n?void 0:null===(t=n.powerUps)||void 0===t?void 0:t.__typename)==="ReplPowerUpTypes"&&(null===(i=e.repl)||void 0===i?void 0:null===(r=i.powerUpCosts)||void 0===r?void 0:r.__typename)==="PowerUpCostsType"){var t,n,r,i,o,a,l=null===(o=e.repl.powerUps.hostingTier)||void 0===o?void 0:o.sku,c=l||((null===(a=e.repl.owner)||void 0===a?void 0:a.__typename)==="Team"?C.DZ.HostingTierE2Micro:C.DZ.HostingTierE2Small),s=(0,ev.i)(e.repl.powerUpCosts,l),u=(0,ev.i)(e.repl.powerUpCosts,c);s&&l&&m({sku:l,cost:s}),u&&f({sku:c,cost:u}),x(e.repl.powerUpCosts)}}}).loading||!d||!w)return(0,r.tZ)(b.G,{css:[g.l0.flex.row,g.l0.justify.center],children:(0,r.tZ)(B.Z,{})});var _=null;if("INCLUDED_IN_SUBSCRIPTION"===d.cost.explanation)_="Included in your subscription plan.";else if(d.cost.cyclesCostRecurring>0){var k=(0,v.$E)(d.cost.cyclesCostRecurring),S=(0,v.$E)(d.cost.cyclesCostRecurring*ex.Dj);_="".concat(k,"/day (Approximately ").concat(S,"/month).")}var E=null;switch(d.cost.explanation){case C.Ch.IncludedInExistingOrder:break;case C.Ch.NeedsCycles:E="You'll be able to purchase Cycles while activating.";break;case C.Ch.SpendCycles:E="Today's charge will be ".concat(d.cost.cyclesCostNow," Cycles.")}return(0,r.BX)(b.G,{css:g.l0.colWithGap(16),children:[(0,r.tZ)(ey,{selectedOption:d,onChange:function(e){var t=(0,ev.i)(w,e);t&&f({sku:e,cost:t})},disabled:"requesting"===l}),(0,r.tZ)(b.G,{css:[g.l0.colWithGap(12)],children:(0,r.BX)(b.G,{css:[g.l0.colWithGap(8)],children:[(0,r.BX)(b.G,{css:[g.l0.minHeight(50),g.l0.colWithGap(16),g.l0.justify.end,g.l0.mb(16)],children:[null!=_?(0,r.tZ)(y.xv,{css:[g.l0.textAlign.center],multiline:!1,children:_}):null,null!=E?(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.justify.center,g.l0.color.foregroundDimmer],children:[(0,r.tZ)(y.xv,{multiline:!1,children:E}),(0,r.tZ)(eZ.u,{tooltip:"Upgrades and downgrades are immediate. Upgrading within a 24 hour period following a downgrade will incur a charge.",children:(0,r.tZ)(ew.Z,{})})]}):null]}),(0,r.tZ)(eT,{context:t,selectedOption:d,currentOption:p,onBuyMoreCycles:n,onPowerUpUpdated:i,onPowerUpRequested:function(e){return c(e?"requesting":"ready")}})]})})]})},eI=n(47957),eD=n(56337),eG=n(44887),eB=n(25491),eP=(0,D.X)({self:[g.l0.flex.column]}),eA=function(){var e=(0,eD.Z)(),t=(0,u._)((0,U.useState)(!1),2),n=t[0],i=t[1],o=(0,eI.Pf)({fetchPolicy:"network-only",ssr:!1,notifyOnNetworkStatusChange:!0}),a=o.data,l=o.loading,c=o.refetch;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(b.G,{css:eP.self,children:(0,r.tZ)(eG.h,{loading:l,isInDesktopApp:e,data:a,setShowUpgradeModal:i,slim:!0})}),(0,r.tZ)(eB.Z,{isOpen:n,context:"workspace_info_modal",powerUp:"storage",uponPurchaseGoTo:"workspace",onRequestClose:function(){c(),i(!1)}})]})},eN=n(15670),eU=n(24635),eL=n(47648),eO="workspace_info_modal";function eX(e){var t=e.powerUpCategory,n=e.goToCheckout,i=e.goToCheckoutSuccess,o=e.onRequestPowerUp,a=(0,u._)(U.useState(null),2),l=a[0],c=a[1];switch(t){case"boost":return(0,r.tZ)(ef.Z,{isCheckoutFlow:!0,powerUp:t,onPowerUpUpdated:i,onBuyMoreCycles:n,context:eO});case"hosting_tier":return(0,r.tZ)(eR,{context:"workspace_hosting_pane",onPowerUpUpdated:i,onBuyMoreCycles:n});case"storage":return(0,r.tZ)(eA,{});case"always-on":return(0,r.BX)(r.HY,{children:[(0,r.tZ)(eL.Z,{initialTab:"default",isOpen:l===eU.x.BuyCycles,onRequestClose:function(){return c(null)},uponPurchaseGoTo:"workspace",context:eO,allowCyclesPage:!1}),(0,r.tZ)(eN.Z,{onRequestBuyMore:function(){return c(eU.x.BuyCycles)},powerUp:"always-on",context:eO,onRequestPowerUp:o})]});case"gpu":return(0,r.BX)(r.HY,{children:[(0,r.tZ)(eL.Z,{initialTab:"default",isOpen:l===eU.x.BuyCycles,onRequestClose:function(){return c(null)},uponPurchaseGoTo:"workspace",context:eO,allowCyclesPage:!1}),(0,r.tZ)(eN.Z,{onRequestBuyMore:function(){return c(eU.x.BuyCycles)},powerUp:"gpu",context:eO,onRequestPowerUp:o})]});default:throw Error("Unknown power up category: ".concat(t))}}function eM(e){var t=e.title,n=e.children,i=e.goBack,o=e.canGoBack,a=e.allowBack;return(0,r.BX)(r.HY,{children:[(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.p(8),g.l0.align.center],children:[(void 0===a||a)&&o?(0,r.tZ)(I.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return i()},dataCy:"purchase-flow-back-button",children:(0,r.tZ)(es.Z,{})}):null,"string"==typeof t?(0,r.tZ)(y.xv,{variant:"subheadDefault",multiline:!1,children:t}):t]}),(0,r.tZ)(b.G,{css:[g.l0.colWithGap(8),g.l0.p(8)],children:n})]})}function eF(e){var t=e.currentStep,n=e.goBack,l=e.canGoBack,c=e.goTo,s=e.analyticsContext,u=e.onRequestPowerUp;switch(t.step){case"power_up_details":var d=t.powerUpCategory,f=i.S0[d];return(0,r.tZ)(eM,{goBack:n,canGoBack:l,title:f.name,children:(0,r.tZ)(eX,{powerUpCategory:d,goToCheckout:function(e){c({step:"checkout",product:e}),(0,o.j)(o.U3.CHECKOUT_REQUESTED,{source:s,powerUpCategory:d})},goToCheckoutSuccess:function(e){c({step:"checkout_success",product:e})},onRequestPowerUp:u})});case"checkout":return(0,r.tZ)(eM,{goBack:n,canGoBack:l,title:"Checkout",children:(0,r.tZ)(K,{product:t.product,goToCheckoutSuccess:function(e){c({step:"checkout_success",product:e})},goToNewPaymentMethodForm:function(){return c({step:"new_payment_method_form"})},context:s})});case"checkout_success":return(0,r.tZ)(eM,{goBack:n,canGoBack:l,allowBack:!1,title:(0,r.BX)(b.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[l?(0,r.tZ)(I.hU,{tooltipHidden:!0,alt:"Back",onClick:function(){return n()},children:(0,r.tZ)(es.Z,{})}):null,(0,r.tZ)(y.xv,{multiline:!1,css:[g.l0.color.accentPositiveStronger],children:"Success"}),(0,r.tZ)(eu.Z,{color:g.TV.accentPositiveStronger})]}),children:(0,r.tZ)(el,{product:t.product,goToCardPreferences:function(e){return c({step:"card_preferences",powerUpCategory:e})},goToPowerUpDetails:function(e){return c({step:"power_up_details",powerUpCategory:e})}})});case"card_preferences":var h=t.powerUpCategory;return(0,r.tZ)(eM,{goBack:n,canGoBack:l,title:"Card Preferences",children:(0,r.tZ)(a.t,{goToNewPaymentMethodForm:function(){return c({step:"new_payment_method_form",powerUpCategory:h})}})});case"new_payment_method_form":var p=t.powerUpCategory;return(0,r.tZ)(eM,{goBack:n,canGoBack:l,title:"Update Payment Method",children:(0,r.tZ)(ec.q,{onSuccess:function(){return l&&n()},powerUpCategory:p,context:s})});case"not_shown":throw Error("This step should never be rendered");default:(0,ed.Z)(t)}}},56353:function(e,t,n){n.d(t,{FW:function(){return h},NH:function(){return v}});var r=n(45903),i=n(93295),o=n(23982),a=n(80428),l=n(41538),c=n(66039);function s(){var e=(0,i._)(["\n  fragment PublishReplData on Repl {\n    id\n    url\n    title\n    description\n    iconUrl\n    lastPublishedAt\n    publishedAs\n    imageUrl\n    isRenamed\n    templateInfo {\n      iconUrl\n    }\n    replViewSettings {\n      id\n      defaultView\n      replImage\n      replFile\n    }\n    tags {\n      id\n      isOfficial\n    }\n    currentUserPermissions {\n      containerWrite\n      publish\n      changeIconUrl\n    }\n    ...CrosisContextRepl\n    ...PublishedReplShareInfoReplData\n  }\n  ","\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  fragment PublishCurrentUser on CurrentUser {\n    id\n    image\n    isTemplateDeveloper: hasRole(role: TEMPLATE_DEVELOPER)\n    ...CrosisContextCurrentUser\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  query PublishCurrentUser {\n    currentUser {\n      id\n      ...PublishCurrentUser\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var f={},h=(0,o.Ps)(s(),a.C,l.B),p=(0,o.Ps)(u(),a.D),m=(0,o.Ps)(d(),p);function v(e){var t=(0,r._)({},f,e);return c.a(m,t)}},63204:function(e,t,n){n.d(t,{e9:function(){return h},wd:function(){return d}});var r=n(45903),i=n(93295),o=n(23982),a=n(41538),l=n(66039);function c(){var e=(0,i._)(["\n  fragment PublishReleaseFormRepl on Repl {\n    id\n    title\n    description\n    slug\n    user {\n      username\n    }\n    ...PublishedReplShareInfoReplData\n    deployment {\n      id\n      activeRelease {\n        id\n      }\n    }\n    releases {\n      items {\n        id\n        timeCreated\n        description\n      }\n    }\n  }\n  ","\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  query PublishReleaseFormCurrentUser {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return s=function(){return e},e}var u={},d=(0,o.Ps)(c(),a.B),f=(0,o.Ps)(s());function h(e){var t=(0,r._)({},u,e);return l.a(f,t)}},41538:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(93295);function i(){var e=(0,r._)(["\n  fragment PublishedReplShareInfoReplData on Repl {\n    id\n    url\n    publishedAs\n    title\n  }\n"]);return i=function(){return e},e}var o=(0,n(23982).Ps)(i())},25061:function(e,t,n){n.d(t,{Z:function(){return k}});var r=n(34142),i=n(87682),o=n(8182);n(43429);var a=n(18836),l=n(56596),c=n(74833),s=n(29287),u=n(1498),d=n(37951),f=n(10981),h=n(75582),p=n(72310),m=n(20573),v=n(69273),g=n(59868),y=n(74883),b=n(75246),Z=(0,n(93918).X)({content:[s.l0.p(8),s.l0.colWithGap(16)],section:[s.l0.colWithGap(8)]});function w(e){var t=e.header;return(0,o.tZ)(b.Q,{headerContent:t,children:(0,o.BX)(l.G,{css:Z.content,children:[(0,o.BX)(l.G,{css:Z.section,children:[(0,o.tZ)(c.xv,{multiline:!1,children:"Bold Text"}),(0,o.tZ)(c.xv,{color:"dimmer",multiline:!1,children:"**bold**"})]}),(0,o.BX)(l.G,{css:Z.section,children:[(0,o.tZ)(c.xv,{multiline:!1,children:"Italic Text"}),(0,o.tZ)(c.xv,{color:"dimmer",multiline:!1,children:"__italic__"})]}),(0,o.BX)(l.G,{css:Z.section,children:[(0,o.tZ)(c.xv,{multiline:!1,children:"Links"}),(0,o.tZ)(c.xv,{color:"dimmer",multiline:!1,children:"[Link Name](https://yourlink.com)"})]}),(0,o.BX)(l.G,{css:Z.section,children:[(0,o.tZ)(c.xv,{multiline:!1,children:"Images"}),(0,o.tZ)(c.xv,{color:"dimmer",multiline:!1,children:"![Image alt text](https://linktoyourimage.com)"})]}),(0,o.BX)(l.G,{css:Z.section,children:[(0,o.tZ)(c.xv,{multiline:!1,children:"Header Text"}),(0,o.tZ)(c.xv,{color:"dimmer",multiline:!1,children:"# Header"})]}),(0,o.BX)(l.G,{css:[s.l0.colWithGap(8)],children:[(0,o.tZ)(c.xv,{multiline:!1,children:"Code Blocks"}),(0,o.BX)(c.xv,{color:"dimmer",multiline:!1,children:["```",(0,o.tZ)("br",{}),"this is for large, multiline code blocks",(0,o.tZ)("br",{}),"```"]})]}),(0,o.BX)(l.G,{css:[s.l0.colWithGap(8)],children:[(0,o.tZ)(c.xv,{multiline:!1,children:"Inline Code"}),(0,o.tZ)(c.xv,{color:"dimmer",multiline:!1,children:"`this is for code in the middle of sentences`"})]}),(0,o.BX)(l.G,{css:[s.l0.colWithGap(8)],children:[(0,o.tZ)(c.xv,{multiline:!1,children:"Horizontal Rules"}),(0,o.tZ)(c.xv,{color:"dimmer",multiline:!1,children:"***"})]})]})})}var x=l.K.form;function C(e){return 0===e.trim().length?{message:"You cannot leave this empty."}:e.length>100?{message:"The title should not be longer than ".concat(100," characters.")}:void 0}function _(e){return 0===e.trim().length?{message:"You cannot leave this empty."}:e.length>5e3?{message:"The description should not be longer than ".concat(5e3," characters.")}:void 0}function k(e){var t,n,b,Z=e.repl,k=e.source,S=e.onDone,E=(0,f.U)(),T=E("titleIdInput"),R=E("descriptionIdInput"),I=(0,p.Y)("",C),D=(0,p.Y)("",_),G=(0,v.O)();return(0,o.BX)(x,{onSubmit:(t=(0,r._)(function(e){return(0,i.Jh)(this,function(t){switch(t.label){case 0:if(e.preventDefault(),I.validate()||D.validate())return[2];return[4,G.publish({input:{replId:Z.id,title:I.value,body:D.value}})];case 1:return t.sent().error||((0,g.j)(g.U3.UPDATE_SHARED,{source:k,replType:Z.publishedAs===h.O2.Template?"template_repl":"regular_repl"}),S()),[2]}})}),function(e){return t.apply(this,arguments)}),css:[s.l0.colWithGap(16)],children:[(0,o.tZ)(c.h4,{level:1,variant:"headerDefault",children:"Add an update"}),(0,o.BX)(c.xv,{multiline:!1,children:["Explain what has changed about this"," ",Z.publishedAs===h.O2.Template?"Template":"Repl","."]}),(0,o.BX)(l.G,{css:s.l0.colWithGap(8),children:[(0,o.BX)(l.G,{css:s.l0.colWithGap(4),children:[(0,o.tZ)("label",{css:s.l0.color.foregroundDimmer,htmlFor:T,children:"Title"}),(0,o.tZ)(a.II,{id:T,onChange:function(e){I.setValue(e.target.value)},disabled:G.loading,placeholder:"Give your post a title"})]}),I.error?(0,o.tZ)(d.E,{icon:(0,o.tZ)(m.Z,{}),text:null===(n=I.error)||void 0===n?void 0:n.message,colorway:"negative"}):null]}),(0,o.BX)(l.G,{css:s.l0.colWithGap(8),children:[(0,o.BX)(l.G,{css:s.l0.colWithGap(4),children:[(0,o.tZ)("label",{css:s.l0.color.foregroundDimmer,htmlFor:R,children:"Description"}),(0,o.tZ)(a.B,{id:R,onChange:function(e){D.setValue(e.target.value)},css:[s.l0.width("100%"),{minHeight:s.TV.space128,maxHeight:s.TV.space256,resize:"vertical",lineHeight:s.TV.lineHeightDefault}],disabled:G.loading,placeholder:"Write something about this post"})]}),D.error?(0,o.tZ)(d.E,{icon:(0,o.tZ)(m.Z,{}),text:null===(b=D.error)||void 0===b?void 0:b.message,colorway:"negative"}):null]}),(0,o.tZ)(w,{header:"Style your description with Markdown"}),G.error?(0,o.tZ)(d.E,{icon:(0,o.tZ)(m.Z,{}),colorway:"negative",text:G.error}):null,(0,o.tZ)(u.zx,{text:G.loading?"Sharing update...":"Share update",type:"submit",colorway:"primary",disabled:!!(G.loading||I.error||D.error),css:{alignSelf:"end"},iconLeft:(0,o.tZ)(y.Z,{})})]})}},69273:function(e,t,n){n.d(t,{O:function(){return m}});var r=n(34142),i=n(32477),o=n(87682),a=n(45903),l=n(93295),c=n(23982),s=n(56353),u=n(13440);function d(){var e=(0,l._)(["\n  mutation PublishReplCreatePost($input: CreateReplPost2Input!) {\n    createReplPost2(input: $input) {\n      ... on Post {\n        id\n        repl {\n          id\n          ...PublishReplData\n        }\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var f={},h=(0,c.Ps)(d(),s.FW);function p(e){var t,n,r,i,o,a,l;return e.error?e.error.message||"Something went wrong publishing your Repl":(null===(n=e.data)||void 0===n?void 0:null===(t=n.createReplPost2)||void 0===t?void 0:t.__typename)==="NotFoundError"||(null===(i=e.data)||void 0===i?void 0:null===(r=i.createReplPost2)||void 0===r?void 0:r.__typename)==="UnauthorizedError"||(null===(a=e.data)||void 0===a?void 0:null===(o=a.createReplPost2)||void 0===o?void 0:o.__typename)==="UserError"?e.data.createReplPost2.message:(null===(l=e.data)||void 0===l?void 0:l.createReplPost2)&&"Post"!==e.data.createReplPost2.__typename?"Something went wrong publishing your Repl":void 0}function m(){var e,t,n=(0,i._)((e=(0,a._)({},f,void 0),u.D(h,e)),2),l=n[0],c=n[1];return{publish:(t=(0,r._)(function(e){var t,n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:if(t=e.input,c.loading)return[2,{data:null,error:null}];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l({variables:{input:t}})];case 2:return[2,{data:(n=r.sent()).data,error:p(n)}];case 3:return r.sent(),[2,{data:null,error:"Something went wrong publishing your Repl"}];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),data:c.data,loading:c.loading,error:p(c)}}},30609:function(e,t,n){n.d(t,{Z:function(){return h},_:function(){return v}});var r=n(32477),i=n(8182),o=n(94450),a=n.n(o),l=n(43429),c=n(9617),s=n(35972),u=n(79217),d=n(83848),f=n(29287);function h(e){var t=(0,r._)(l.useState(!1),2),n=t[0],o=t[1],a=[],u=[];if(e.variables.length>0){var f=e.variables[0].parentVariableReference,h=!0,p=!1,m=void 0;try{for(var g,y=e.variables[Symbol.iterator]();!(h=(g=y.next()).done);h=!0){var b=g.value;b.parentVariableReference===f?a.push(b):u.push(b)}}catch(e){p=!0,m=e}finally{try{h||null==y.return||y.return()}finally{if(p)throw m}}}return(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.Z,{truncate:!0,level:5,children:"Variables"}),(0,i.BX)(s.gC,{align:"stretch",constrainWidth:!0,children:[a.map(function(t){return(0,i.tZ)(v,{depth:0,variable:t,client:e.client},t.parentVariableReference+"/"+t.name)}),u.length>0&&(0,i.BX)(i.HY,{children:[(0,i.BX)(d.Z,{filled:!1,border:!1,onClick:function(){return o(function(e){return!e})},children:["See ",n?"Less":"More"]}),n&&u.map(function(t){return(0,i.tZ)(v,{depth:0,variable:t,client:e.client},t.parentVariableReference+"/"+t.name)})]})]})]})}function p(e){var t=e.variable,n=e.expanded;return t.variablesReference>0?(0,i.tZ)("div",{css:[f.l0.transition.snappy,{transform:"rotate(".concat(n?0:-90,"deg)")}],children:(0,i.tZ)(u.Z,{})}):null}function m(e){var t=e.expanded,n=e.depth,r=e.variable;return 0!==n||"parentVariableReference"in r?(0,i.tZ)("div",{css:[f.l0.flex.grow(0),f.l0.flex.shrink(0),f.l0.width(f.TV.space16),f.l0.display.flex,f.l0.align.center,f.l0.justify.end],children:(0,i.tZ)(p,{expanded:t,variable:r})}):(0,i.tZ)(p,{expanded:t,variable:r})}function v(e){var t=e.depth,n=e.variable,o=e.client,c=(0,r._)(l.useState(!1),2),u=c[0],d=c[1],f=(0,r._)(l.useState([]),2),h=f[0],p=f[1];return l.useEffect(function(){u&&o.fetchVariables(n.variablesReference).then(function(e){return p(e)},function(){return d(!1)})},[u,o,n.variablesReference]),(0,i.BX)(i.HY,{children:[(0,i.BX)("div",{onClick:function(){n.variablesReference>0&&d(function(e){return!e})},className:a().dynamic([["9b0d681b25e8b2b5",[t]]])+" variable",children:[(0,i.tZ)(m,{expanded:u,variable:n,depth:t}),(0,i.BX)("div",{className:a().dynamic([["9b0d681b25e8b2b5",[t]]])+" label",children:[n.name,n.type?(0,i.BX)("span",{className:a().dynamic([["9b0d681b25e8b2b5",[t]]])+" type",children:[" ",n.type]}):null,""!==n.value&&": "]}),(0,i.tZ)("div",{className:a().dynamic([["9b0d681b25e8b2b5",[t]]])+" label value",children:(0,i.tZ)("pre",{className:a().dynamic([["9b0d681b25e8b2b5",[t]]]),children:n.value})})]}),u?(0,i.tZ)(s.gC,{align:"stretch",constrainWidth:!0,children:h.map(function(e){return(0,i.tZ)(v,{depth:t+1,variable:e,client:o},"parentVariableReference"in e?e.parentVariableReference+"/"+e.name:e.name)})}):null,(0,i.tZ)(a(),{id:"9b0d681b25e8b2b5",dynamic:[t],children:".variable.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%;height:var(--space-32);min-height:var(--space-32);cursor:pointer;color:var(--foreground-dimmer);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);font-size:var(--font-size-default);padding-left:-webkit-calc(".concat(t," * var(--space-16));padding-left:-moz-calc(").concat(t," * var(--space-16));padding-left:calc(").concat(t," * var(--space-16));font-family:var(--font-family-code)}.variable.__jsx-style-dynamic-selector:hover{background-color:var(--background-higher);color:var(--foreground-default)}.label.__jsx-style-dynamic-selector{font-size:var(--font-size-default);padding-left:var(--space-8);padding-right:var(--space-8);overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap;-webkit-box-flex:1;-webkit-flex:1 0 auto;-moz-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}.type.__jsx-style-dynamic-selector{opacity:.5}.value.__jsx-style-dynamic-selector{text-align:right;-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1}")})]})}},62749:function(e,t,n){n.d(t,{JL:function(){return C},L8:function(){return b},M6:function(){return y},QH:function(){return Z},nr:function(){return g}});var r=n(39698),i=n(45903),o=n(32477),a=n(21289),l=n(8182),c=n(43429),s=n(56596),u=n(29287),d=n(74833),f=n(98190),h=n(55550),p=n(64157),m=n(18142),v=n(98655);function g(e,t){var n,r=(null===(n=t.tags)||void 0===n?void 0:n.length)?t.tags.join(","):null;return{href:{pathname:"/postsFeed",query:{boardSlug:r,q:e}},as:{pathname:r?"/community/".concat(r):"/community/all",query:{q:e}}}}function y(e,t){return t?{href:{pathname:"/postsFeed",query:{boardSlug:e,order:t.order}},as:{pathname:"/community/".concat(e),query:(0,i._)({},t.order!==h.eR?{order:t.order.toLowerCase()}:{})}}:{href:{pathname:"/postsFeed",query:{boardSlug:e}},as:"/community/".concat(e)}}function b(e){return y("all",e)}function Z(e,t){var n=t.tags?t.tags.join(","):"all";return{href:{pathname:"/postsFeed",query:{boardSlug:n,order:(0,h.Zb)(e)}},as:{pathname:"/community/".concat(n),query:(0,i._)({},e!==h.eR?{order:(0,h.Zb)(e)}:{})}}}var w=s.K.div,x=v.Mz+32;function C(e){var t,n,i=e.tagGroups,h=e.params,g=(0,a._)(i.official).concat((0,a._)(i.community)).map(function(e){var t,n=!!(null===(t=h.tags)||void 0===t?void 0:t.includes(e.id)),r=n?b(h):y(e.id,h);return(0,l.tZ)(p.t,{tag:e,link:r,isActive:n},e.id)}),Z=(0,o._)((0,c.useState)(!1),2),C=Z[0],_=Z[1],k=(0,c.useRef)(null);return(0,c.useEffect)(function(){if(k.current){var e=new window.IntersectionObserver(function(e){e.forEach(function(e){if(window.scrollY<e.boundingClientRect.top-x){_(!1);return}_(!e.isIntersecting)})},{root:null,rootMargin:"".concat(-x,"px 0px 0px 0px"),threshold:1}),t=k.current;return e.observe(t),function(){e.unobserve(t),e.disconnect()}}},[]),(0,l.BX)(s.G,{children:[(0,l.tZ)(w,{ref:k}),(0,l.BX)(s.G,{css:[u.l0.colWithGap(16),C&&(0,r._)({},f.A.desktop,[u.l0.position.fixed,u.l0.overflowY("auto"),u.l0.height("calc(100vh - ".concat(v.Mz,"px)")),u.l0.py(32),{top:v.Mz}])],children:[(0,l.tZ)(d.xv,{color:"dimmer",multiline:!1,children:"TOP TAGS"}),(0,l.BX)(s.G,{children:[(0,l.tZ)(m.Z,{gap:8,inset:16,css:[(t={},(0,r._)(t,f.A.desktop,[u.l0.display.none]),(0,r._)(t,"marginLeft","calc(-1 * ".concat(u.TV.space16,")")),(0,r._)(t,"marginRight","calc(-1 * ".concat(u.TV.space16,")")),t)],children:g}),(0,l.tZ)(s.G,{css:(n={},(0,r._)(n,f.A.mobile,[u.l0.display.none]),(0,r._)(n,f.A.desktop,[u.l0.colWithGap(32)]),n),children:(0,l.tZ)(s.G,{css:[u.l0.colWithGap(8),u.l0.align.start],children:g})})]})]})]})}},4618:function(e,t,n){n.d(t,{Vs:function(){return _},ZP:function(){return S},p0:function(){return k}});var r=n(45903),i=n(25e3),o=n(8182),a=n(51384),l=n(25770),c=n(62749),s=n(96345),u=n(64157),d=n(2161),f=n(93496),h=n(29287),p=n(56596),m=n(38080),v=n(74833),g=n(79378),y=n(50862),b=n(5542),Z=n(36010),w=n.n(Z);n(43429);var x=p.K.a,C=(0,a.iv)([h.l0.focusRingOnAfter,{"::after":{borderRadius:h.TV.space8,content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,display:"block",zIndex:1}}]);function _(e){var t=e.tags,n=e.maxVisible,r=e.onTagClick,i=t.slice(0,void 0===n?3:n),a=t.length-i.length;return(0,o.BX)(p.G,{css:[h.l0.rowWithGap(4),h.l0.align.center],children:[i.map(function(e){return(0,o.tZ)(u.t,{small:!0,tag:e,link:(0,c.M6)(e.id),onClick:r},e.id)}),a>0?(0,o.BX)(v.xv,{variant:"small",color:"dimmest",multiline:!1,children:["+",a]}):null]})}function k(e){var t=e.repl,n=e.showOwner,a=e.maxVisibleTags,c=e.smallerTitle,u=e.onReplClick,f=e.onUserClick,m=e.onTagClick,Z=t.owner;return(0,o.BX)(p.G,{css:[h.l0.colWithGap(16),h.l0.justify.spaceBetween,h.l0.height("100%")],children:[(0,o.BX)(p.G,{css:[h.l0.rowWithGap(8),h.l0.align.start,h.l0.flex.growAndShrink(1)],children:[(0,o.tZ)(d.ZP,{size:84,iconUrl:t.iconUrl,alt:t.title}),(0,o.BX)(p.G,{css:[h.l0.flex.growAndShrink(1),h.l0.colWithGap(4)],children:[(0,o.tZ)(w(),(0,i._)((0,r._)({legacyBehavior:!0,passHref:!0},(0,l.j3)(t)),{children:(0,o.tZ)(x,{css:[{color:"inherit"},C],onClick:u,children:(0,o.tZ)(v.xv,{variant:c?"subheadDefault":"subheadBig",multiline:!1,children:t.title})})})),n&&Z?(0,o.tZ)(p.G,{css:[{maxWidth:"fit-content",zIndex:1}],children:(0,o.tZ)(y.Z,{username:Z.username,children:(0,o.tZ)(b.ZP,{user:Z,children:(0,o.BX)(x,{css:[{color:"inherit"},h.l0.rowWithGap(4),h.l0.align.center,h.l0.focusRing,{"&:focus":{outlineOffset:2}},h.l0.borderRadius(8)],onClick:f,children:[(0,o.tZ)(g.q,{src:Z.image,username:Z.username,size:16,layout:"intrinsic"}),(0,o.tZ)(v.xv,{multiline:!1,children:Z.username})]})})})}):null,t.description?(0,o.tZ)(v.xv,{color:"dimmer",maxLines:2,css:[h.l0.maxWidth(450)],multiline:!1,children:t.description}):null]})]}),(0,o.BX)(p.G,{css:[h.l0.rowWithGap(8),h.l0.justify.spaceBetween,h.l0.flex.wrap],children:[(0,o.tZ)(s.Z,{css:[h.l0.pb(2)],repl:t}),a?(0,o.tZ)(p.G,{css:[h.l0.position.relative,h.l0.pt(2),{zIndex:1}],children:(0,o.tZ)(_,{tags:t.tags,maxVisible:a,onTagClick:m})}):null]})]})}function S(e){var t=e.repl,n=e.showOwner,r=e.maxVisibleTags,i=e.smallerTitle,a=e.onReplClick,l=e.onUserClick,c=e.onTagClick,s=e.dataCy;return(0,o.tZ)(m.Tg,{css:[h.l0.borderRadius(8),h.l0.p(8),h.l0.position.relative,f.gU.filledAndOutlined,{border:"1px solid "+h.TV.outlineDimmest}],dataCy:s,children:(0,o.tZ)(k,{repl:t,showOwner:n,maxVisibleTags:r,smallerTitle:i,onReplClick:a,onUserClick:l,onTagClick:c})})}},96345:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(8182);n(43429);var i=n(56596),o=n(29287),a=n(43474),l=n(15250),c=n(74883),s=n(77187),u=n(73157);function d(e){var t=e.repl;return(0,r.BX)(i.G,{css:[o.l0.rowWithGap(16),o.l0.align.center],children:[(0,r.tZ)(a.Z,{small:!0,count:t.runCount,tooltip:(0,u.Z)("runs",t.runCount),children:(0,r.tZ)(l.Z,{})}),(0,r.tZ)(a.Z,{small:!0,count:t.commentCount,tooltip:(0,u.Z)("comment",t.commentCount),children:(0,r.tZ)(c.Z,{})}),(0,r.tZ)(a.Z,{small:!0,count:t.likeCount,tooltip:(0,u.Z)("like",t.likeCount),children:(0,r.tZ)(s.Z,{})})]})}},64157:function(e,t,n){n.d(t,{g:function(){return x},t:function(){return Z}});var r=n(45903),i=n(25e3),o=n(8182);n(43429);var a=n(51384),l=n(36010),c=n.n(l),s=n(56596),u=n(38080),d=n(29287),f=n(74833),h=n(93496),p=n(58719),m=n(39082),v=(0,a.iv)({border:"1px solid "+d.TV.accentPrimaryDefault,backgroundColor:"transparent"}),g=function(e){var t=e.isActive,n=e.small;return(0,a.iv)([d.l0.p(n?4:8),d.l0.align.center,d.l0.rowWithGap(4),d.l0.fontSize(12),t?v:h.gU.outlined,d.l0.borderRadius(16),{color:"inherit","&:active":v,height:n?"auto":d.TV.space32}])};function y(e){var t=e.tag,n=e.isActive,r=e.isRemovable,i=e.small,a=i?"small":"text";return(0,o.tZ)(u.Tg,{elevated:!0,css:[d.l0.borderRadius(16)],children:(0,o.BX)(u.Tg,{elevated:n,css:[g({isActive:n,small:i})],children:[(0,o.BX)(s.G,{css:[d.l0.flex.row,d.l0.align.center,d.l0.flex.shrink(1)],children:[(0,o.tZ)(f.xv,{variant:a,color:"dimmest",multiline:!1,children:"#"}),(0,o.tZ)(f.xv,{color:"dimmer",variant:a,css:[d.l0.flex.shrink(1)],multiline:!1,children:t.id})]}),t.isOfficial&&!i?(0,o.tZ)(m.Z,{}):null,r?(0,o.tZ)(p.Z,{size:i?12:16}):null]})})}var b=s.K.a;function Z(e){var t=e.tag,n=e.link,a=e.isActive,l=e.small,s=e.onClick;return(0,o.tZ)(c(),(0,i._)((0,r._)({legacyBehavior:!0},n),{passHref:!0,css:[d.l0.flex.shrink(1)],children:(0,o.tZ)(b,{css:[{color:"inherit",zIndex:1},d.l0.flex.shrink(1),d.l0.focusRing,d.l0.borderRadius(16)],onClick:s,children:(0,o.tZ)(y,{tag:t,isActive:a,small:l,isRemovable:a})})}))}var w=s.K.button;function x(e){var t=e.tag,n=e.onClick,r=e.isActive,i=e.small;return(0,o.tZ)(w,{css:[d.l0.reset.button],onClick:n,children:(0,o.tZ)(y,{tag:t,isActive:r,small:i,isRemovable:!0})})}},98190:function(e,t,n){n.d(t,{A:function(){return i}});var r=n(29479),i={mobile:"@media (max-width: ".concat(r.j.tabletMin,"px)"),desktop:"@media (min-width: ".concat(r.j.tabletMin+1,"px)")}},55550:function(e,t,n){n.d(t,{eR:function(){return o},Zb:function(){return l},Qf:function(){return c}});var r=n(75582);function i(e,t){if(!e)return null;var n=e[t];return!n||Array.isArray(n)?null:n}var o=r.vX.Hot,a={hot:r.vX.Hot,new:r.vX.New,top:r.vX.Top,votes:r.vX.Top};function l(e){return e.toLowerCase()}function c(e){var t=i(e,"after")||void 0,n=i(e,"q")||void 0,r=i(e,"boardSlug")||void 0,c=r&&"all"!==r?r.split(","):void 0,s=a[i(e,"order")||l(o)]||o,u=i(e,"count"),d=u?parseInt(u,10):void 0;return void 0!==d&&Number.isNaN(d)&&(d=void 0),{tags:c,order:s,count:d,searchQuery:n,after:t}}},43474:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(8182),i=n(43429),o=n(74833),a=n(29287),l=n(56596),c=n(22326);function s(e){var t=e.count,n=e.children,s=e.tooltip,u=e.small,d=(0,c.d)(t);return(0,r.BX)(l.G,{"aria-label":s,"data-microtip-position":"left",role:"tooltip",css:[a.l0.rowWithGap(4),a.l0.align.center,a.l0.color.foregroundDimmer,{userSelect:"none",lineHeight:1}],children:[i.cloneElement(n,{size:u?12:void 0}),(0,r.tZ)(o.xv,{variant:u?"small":void 0,color:"dimmer",multiline:!1,children:d})]})}},5693:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(32477),i=n(8182);n(43429);var o=n(56596),a=n(29287),l=n(74833),c=n(1498),s=n(75582),u=n(45903),d=n(93295),f=n(23982),h=n(73931),p=n(13440);function m(){var e=(0,d._)(["\n  mutation UnpublishReplUnpublish($input: UnpublishReplFromCommunityInput!) {\n    unpublishReplFromCommunity(input: $input) {\n      ... on Repl {\n        id\n        ...ReplViewReplActionsPermissions\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}var v={},g=(0,f.Ps)(m(),h.jN),y=n(55534),b=n(59868),Z=n(98859),w=o.K.form;function x(e){var t,n,d=e.repl,f=e.source,h=e.onDone,m=(0,y.Z)(),x=m.showConfirm,C=m.showError,_=(0,r._)((t={variables:{input:{replId:d.id}},onCompleted:function(e){if("Repl"===e.unpublishReplFromCommunity.__typename){var t=e.unpublishReplFromCommunity,n=t.runCount,r=t.likeCount,i=t.commentCount;(0,b.j)(b.U3.REPL_UNPUBLISHED,{source:f,numRuns:n,numLikes:r,numComments:i,replType:d.publishedAs===s.O2.Template?"template_repl":"regular_repl"}),x("Repl removed from the community.")}else"NotFoundError"===e.unpublishReplFromCommunity.__typename||"UnauthorizedError"===e.unpublishReplFromCommunity.__typename?C(e.unpublishReplFromCommunity.message):C("An unexpected error occurred.");h()},onError:function(){C("Something went wrong. Please try again.")},update:function(e){e.modify({id:e.identify({__typename:"Repl",id:d.id}),fields:{comments:function(e,t){return t.DELETE},tags:function(e,t){return t.DELETE}}})}},n=(0,u._)({},v,t),p.D(g,n)),2),k=_[0],S=_[1].loading;return(0,i.BX)(o.G,{css:[a.l0.colWithGap(24)],children:[(0,i.tZ)(l.xv,{variant:"subheadBig",children:"Unpublish this Repl from the Community"}),(0,i.BX)(w,{onSubmit:function(e){e.preventDefault(),k()},css:[a.l0.colWithGap(32)],children:[(0,i.tZ)(l.xv,{children:"Unpublishing a Repl will remove it from the Community. This action will delete all associated posts and tags. The Repl and all its comments will still be visible in your profile, but will not be shown in the Community or Trending views anymore. You can always re-publish the Repl again later."}),(0,i.BX)(o.G,{css:[a.l0.rowWithGap(8),a.l0.justify.end],children:[(0,i.tZ)(o.G,{children:(0,i.tZ)(c.zx,{type:"button",text:"Cancel",onClick:function(){return h()}})}),(0,i.tZ)(o.G,{children:(0,i.tZ)(c.zx,{disabled:S,colorway:"negative",text:S?"Unpublishing...":"Yes, unpublish this Repl",type:"submit",iconLeft:(0,i.tZ)(Z.Z,{})})})]})]})]})}},51780:function(e,t,n){n.d(t,{d:function(){return l}});var r=n(93295),i=n(23982),o=n(20708);function a(){var e=(0,r._)(["\n  fragment BulkDeleteConfirmationModalRepl on Repl {\n    id\n    iconUrl\n    title\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        replitAppSubdomain\n        ...BuildStatusBadgeHostingDeployment\n      }\n    }\n  }\n  ","\n"]);return a=function(){return e},e}var l=(0,i.Ps)(a(),o.u)},15053:function(e,t,n){var r=n(32477),i=n(8182),o=n(43429),a=n(49344),l=n(56596),c=n(74833),s=n(29287),u=n(73157),d=n(1498),f=n(52682),h=n(2161),p=n(93918),m=n(84096),v=n(37951),g=n(20573),y=n(18836),b=(0,p.X)({wrapper:[s.l0.colWithGap(16)],repls:[s.l0.maxHeight("60vh"),s.l0.overflow("auto"),{"& > div":[s.l0.py(8),{borderTop:"1px solid "+s.TV.outlineDimmest}],"& > div:last-of-type":{borderBottom:"1px solid "+s.TV.outlineDimmest}}],row:[s.l0.colWithGap(8)],replRow:[s.l0.rowWithGap(8),s.l0.align.center],additionalReplsCount:[s.l0.pl(12),s.l0.pt(8)],buttons:[s.l0.rowWithGap(12),s.l0.justify.end]}),Z=function(e){var t,n=e.repl,a=e.onConfirmedChange,s=(0,r._)((0,o.useState)(""),2),u=s[0],d=s[1],f=(null===(t=n.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?n.hostingDeployment:null,p=(0,o.useRef)(!1);return(0,i.BX)(l.G,{css:b.row,children:[(0,i.BX)(l.G,{css:b.replRow,children:[(0,i.tZ)(h.ZP,{size:24,iconUrl:n.iconUrl,alt:""}),(0,i.tZ)(c.xv,{height:"singleLine",multiline:!1,children:n.title}),f?(0,i.tZ)(m.e,{deployment:f}):null]},n.id),f?(0,i.BX)(i.HY,{children:[(0,i.tZ)(v.E,{icon:(0,i.tZ)(g.Z,{}),colorway:"red",text:"This repl has been deployed. If you delete this Repl, the associated\nproduction deployment will also be shut down and deleted. To\nproceed, please type: ".concat(f.replitAppSubdomain)}),(0,i.tZ)(y.II,{placeholder:"Type here",value:u,onChange:function(e){var t=e.currentTarget.value;d(t);var n=t===f.replitAppSubdomain;n!==p.current&&a(n),p.current=n}})]}):null]})};t.Z=function(e){var t=e.selectedRepls,n=e.isOpen,s=e.onClose,h=e.onDelete,p=e.deleting,m=t.length,v=(0,u.Z)("Repl",m),g=t.filter(function(e){var t;return(null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"}).length,y=(0,u.Z)("Deployment",g),w=g>0?" & ".concat(g>1?g+" ":""," ").concat(y):"",x=(0,r._)((0,o.useState)(0),2),C=x[0],_=x[1];return(0,o.useEffect)(function(){n||_(0)},[n]),(0,i.tZ)(a.u,{isOpen:n,onRequestClose:s,children:(0,i.BX)(l.G,{css:b.wrapper,children:[(0,i.BX)(c.h4,{variant:"subheadBig",level:2,children:["Delete ",v,g>0?" & ".concat(y):"","?"]}),(0,i.tZ)(c.xv,{color:"dimmer",children:"Are you sure? This cannot be undone. Some Repls may take a few minutes to finish deleting."}),(0,i.tZ)(l.G,{css:b.repls,children:t.map(function(e){return(0,i.tZ)(Z,{css:b.row,repl:e,onConfirmedChange:function(e){return _(function(t){return t+(e?1:-1)})}},e.id)})}),(0,i.BX)(l.G,{css:b.buttons,children:[(0,i.tZ)(d.zx,{text:"Cancel",onClick:s,disabled:p}),(0,i.tZ)(d.zx,{iconLeft:(0,i.tZ)(f.Z,{}),onClick:h,disabled:p||C<g,text:"Yes, delete ".concat(m>1?m+" ":""," ").concat(v).concat(w),colorway:"negative"})]})]})})}},26338:function(e,t,n){n.d(t,{Z:function(){return C}});var r=n(45903),i=n(25e3),o=n(70322),a=n(8182),l=n(51384),c=n(43429),s=n(10981),u=n(56596),d=n(18836),f=n(29287),h=n(74833),p=n(88936),m=n(32377),v=n(15006),g=n(20573),y={success:(0,l.iv)({":not([disabled])":{borderColor:f.TV.accentPositiveStrongest}}),error:(0,l.iv)({":not([disabled])":{borderColor:f.TV.accentNegativeStrongest}}),warning:(0,l.iv)({":not([disabled])":{borderColor:f.TV.yellowStrongest}}),default:void 0,loading:void 0},b={success:(0,l.iv)([{color:f.TV.accentPositiveStrongest}]),error:(0,l.iv)([{color:f.TV.accentNegativeStrongest}]),warning:(0,l.iv)([{color:f.TV.yellowStrongest}]),default:void 0,loading:void 0},Z={success:(0,a.tZ)(m.Z,{}),error:(0,a.tZ)(v.Z,{}),warning:(0,a.tZ)(g.Z,{}),default:void 0,loading:(0,a.tZ)(p.Z,{})},w=function(e){var t=Z[e.state];return(0,a.BX)(u.G,{css:[b[e.state],f.l0.rowWithGap(4)],children:[c.isValidElement(t)?c.cloneElement(t,{size:12}):null,(0,a.tZ)(h.xv,{variant:"small",multiline:!1,children:e.message})]})},x=(0,l.iv)("display:grid;grid-gap:",f.TV.space8,";grid-template-areas:'label . status'\n    'input input input'\n    'validation validation validation'\n    'details details details';> .label{grid-area:label;}> .status{grid-area:status;}> .input{grid-area:input;}> .details{grid-area:details;}> .validation{grid-area:validation;}"),C=function(e){var t,n=e.id,l=e.label,c=e.status,u=e.description,p=e["aria-describedby"],m=e.error,v=e.isValid,g=e.touched,Z=e.value,C=e.warning,_=e.successText,k=(0,o._)(e,["id","label","status","description","aria-describedby","error","isValid","touched","value","warning","successText"]),S=(0,s.U)(),E=n||S("input"),T=c&&S("status"),R=u?S("description"):void 0,I=[T,R,p].filter(Boolean).join(" "),D=!(t={description:u,error:m,isValid:v,touched:g,value:Z,warning:C,successText:_}).touched&&t.description?{state:"default",message:t.description}:t.error?{message:t.error.message,state:"error"}:t.warning?{message:t.warning.message,state:"warning"}:t.isValid?{message:t.successText||"",state:"success"}:t.touched?{message:"",state:"loading"}:void 0;return(0,a.BX)("div",{css:x,children:[(0,a.tZ)("label",{htmlFor:E,className:"label",children:(0,a.tZ)(h.xv,{variant:"small",color:"dimmer",multiline:!1,children:l})}),c?(0,a.tZ)(h.xv,{multiline:!1,variant:"small",color:"dimmer",css:[f.l0.textAlign.right],className:"status",children:c}):null,(0,a.tZ)(d.II,(0,i._)((0,r._)({id:E,className:"input",value:Z,css:[y[(null==D?void 0:D.state)||"default"]]},k),{"aria-describedby":I,"aria-invalid":(null==D?void 0:D.state)==="error"})),(0,a.tZ)("div",{id:R,className:"validation",css:[b[(null==D?void 0:D.state)||"default"]],"aria-live":(null==D?void 0:D.state)!=="default"?"polite":void 0,children:D?(0,a.tZ)(w,(0,r._)({},D)):null})]})}},47075:function(e,t,n){var r=n(45903),i=n(25e3),o=n(8182),a=n(51384),l=function(e){return{animationDuration:e?"2000ms":"800ms",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"}},c=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  25% { transform: translate(0px, 80px) }\n  50% { transform: translate(100px, 80px) }\n  75% { transform: translate(100px, 160px) }\n  100% { transform: translate(0px, 160px) }\n"),s=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  25% { transform: translate(0px, -80px) }\n  50% { transform: translate(-100px, -80px) }\n  100% { transform: translate(-100px, -80px) }\n"),u=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  50% { transform: translate(0px, 0px) }\n  75% { transform: translate(0px, -80px) }\n  100% { transform: translate(100px, -80px) }\n");t.Z=function(e){var t=e.height,n=void 0===t?24:t,a=e.color,d=e.slow,f=void 0!==d&&d,h={width:84,height:64,fill:void 0===a?"#F26207":a,rx:12};return(0,o.BX)("svg",{width:n/1.2,height:n,viewBox:"0 0 200 240",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:c}]},h),{x:8,y:8})),(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:s}]},h),{x:108,y:88})),(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:u}]},h),{x:8,y:168}))]})}},36227:function(e,t,n){n.d(t,{O:function(){return p}});var r=n(8182),i=n(87659),o=n(74833),a=n(29287),l=n(56596),c=n(15146),s=n(1498),u=n(58719),d=n(4995),f=n(9331),h=n(89019);function p(e){var t=e.title,n=e.content,h=e.colorway,p=void 0===h?"primary":h,v=e.totalSteps,g=void 0===v?1:v,y=e.currentStepIndex,b=void 0===y?0:y,Z=e.onDismiss,w=e.onCurrentStepChange,x=e.cypressCloseData;return(0,r.BX)(l.G,{css:[a.l0.p(8),{paddingBottom:12,paddingRight:t?void 0:32,backgroundColor:i.Br[p].dimmest,border:"1px solid "+i.Br[p].dimmer,position:"relative"},a.l0.borderRadius(8),a.l0.shadow(2),a.l0.colWithGap(8)],children:[(0,r.tZ)(c.hU,{alt:"Close",colorway:p,css:{position:"absolute",top:a.TV.space8,right:a.TV.space8},onClick:Z,dataCy:x,children:(0,r.tZ)(u.Z,{})}),t?(0,r.tZ)(o.xv,{variant:"subheadBig",multiline:!1,children:t}):null,"function"==typeof n?(0,r.tZ)(n,{}):(0,r.tZ)(o.xv,{children:n}),g>1&&w?(0,r.BX)(l.G,{css:[a.l0.flex.row,a.l0.align.center,a.l0.justify.spaceBetween],children:[(0,r.tZ)(s.zx,{css:{visibility:b<=0?"hidden":void 0},colorway:p,text:"Back",iconLeft:(0,r.tZ)(d.Z,{}),onClick:function(){return w(b-1)}}),(0,r.tZ)(m,{colorway:p,total:g,current:b}),(0,r.tZ)(s.zx,{"data-autofocus":!0,colorway:p,text:b>=g-1?"Done":"Next",iconLeft:(0,r.tZ)(f.Z,{}),onClick:function(){return b>=g-1?Z():w(b+1)}})]}):null]})}function m(e){var t=e.total,n=e.current,o=e.colorway;return(0,r.BX)(l.G,{children:[(0,r.tZ)(h.T,{children:(0,r.tZ)("progress",{value:n+1,max:t,"aria-label":"Step"})}),(0,r.tZ)(l.G,{"aria-hidden":!0,css:a.l0.rowWithGap(8),children:Array(t).fill(0).map(function(e,t){return(0,r.tZ)(l.G,{css:[a.l0.borderRadius("full"),{width:a.TV.space8,height:a.TV.space8,backgroundColor:t===n?i.Br[o].stronger:i.Br[o].dimmer}]},t)})})]})}},57118:function(e,t,n){n.d(t,{RY:function(){return m},U5:function(){return g},dW:function(){return v},iz:function(){return y},lq:function(){return p}});var r=n(45903),i=n(25e3),o=n(70322),a=n(8182);n(43429);var l=n(29287),c=n(56596),s=n(38080),u=n(60769),d=n(48272);n(54843);var f=c.K.label,h=function(e){var t=e.children,n=(0,o._)(e,["children"]);return(0,a.tZ)(f,(0,i._)((0,r._)({css:[l.l0.justify.spaceBetween,l.l0.align.center,l.l0.flex.row,{fontSize:l.TV.fontSizeDefault,lineHeight:l.TV.lineHeightDefault}]},n),{children:t}))},p=function(e){e.onChange;var t=(0,o._)(e,["onChange"]);return(0,a.tZ)(b,(0,i._)((0,r._)({label:"Date created"},t),{children:(0,a.tZ)(d.P,(0,r._)({},e))}))},m=function(e){e.onChange;var t=(0,o._)(e,["onChange"]);return(0,a.tZ)(b,(0,i._)((0,r._)({label:"Sort"},t),{children:(0,a.tZ)(d.P,(0,r._)({},e))}))},v=function(e){return(0,a.tZ)(s.Tg,{css:[l.l0.p(8)],children:(0,a.BX)(h,{htmlFor:e.id,children:["Exact match ",(0,a.tZ)(u.X,(0,r._)({},e))]})})},g=function(e){return(0,a.tZ)(s.Tg,{css:[l.l0.p(8)],children:(0,a.BX)(h,{htmlFor:e.id,children:["My code only ",(0,a.tZ)(u.X,(0,r._)({},e))]})})},y=function(){return(0,a.tZ)("div",{css:[l.l0.p(0),l.l0.m(0),{borderBottom:"1px solid",borderBottomColor:l.TV.backgroundHighest}]})},b=function(e){var t=e.children,n=e.label,r=e.className,i=(0,o._)(e,["children","label","className"]);return(0,a.BX)(c.G,{className:r,css:[l.l0.colWithGap(8),l.l0.pb(8)],children:[(0,a.tZ)(s.Tg,{css:[l.l0.p(8),l.l0.mb(0),l.l0.position.relative],children:(0,a.tZ)(h,{htmlFor:i.id,children:n})}),(0,a.tZ)(c.G,{css:[l.l0.px(8)],children:t})]},n)}},72067:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(32477),i=n(43429),o={isConnecting:!0,channel:null,context:null};function a(e){var t=e.container,n=e.service,a=e.name,l=e.skip,c=void 0!==l&&l,s=(0,r._)(i.useState(o),2),u=s[0],d=s[1];return i.useEffect(function(){d(o);var e=!1,r=t.openChannel({service:n,name:a,skip:function(){return c}},function(t){if(!e)return d({context:t.context,channel:t.channel,isConnecting:!1}),function(t){e||d({isConnecting:t.willReconnect,channel:null,context:null})}});return function(){e=!0,r()}},[t,n,a,c]),u}},81106:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(34142),i=n(32477),o=n(87682),a=n(43429),l=n(72067),c=n(7444);function s(e){var t=(0,l.Z)({container:e,service:"exec"}).channel,n=(0,a.useRef)(!1),s=(0,a.useRef)([]),u=(0,c.Z)((0,r._)(function(){var e,r,a,l,c,d,f,h,p,m;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(n.current||!s.current.length||(null==t?void 0:t.status)!=="open")return[2];if(!(e=s.current.pop()))throw Error("Expected request");return l=(a=(r=(0,i._)(e,2))[0]).args,c=a.env,d=r[1],f="",h=t.onCommand(function(e){e.output&&(f+=e.output)}),n.current=!0,[4,t.request({exec:{args:l,env:c}})];case 1:return p=o.sent(),n.current=!1,h(),m=p.channelClosed?"Channel closed":p.error,d(m?{error:m,output:f||null}:{output:f,error:null}),u.current(),[2]}})})),d=null==t?void 0:t.status;return(0,a.useEffect)(function(){"open"===d&&u.current()},[d,u]),(0,a.useCallback)(function(e){var t=e.args,n=e.env;return new Promise(function(e){s.current.push([{args:t,env:n},e]),u.current()})},[u])}},66349:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(32477),i=n(43429),o=n(54916),a=n(47001);function l(){var e,t,n=(0,o.Z)().container,l=(0,r._)(i.useState(null!==(t=null===(e=n.getContext())||void 0===e?void 0:e.repl)&&void 0!==t?t:null),2),c=l[0],s=l[1];return i.useEffect(function(){return n.onConnectionStateChanged(function(e){var t,r;e===a.em.CONNECTED&&s(null!==(r=null===(t=n.getContext())||void 0===t?void 0:t.repl)&&void 0!==r?r:null)})},[s,n]),c}},32627:function(e,t,n){n.d(t,{H:function(){return nl}});var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y=n(34142),b=n(45903),Z=n(32477),w=n(87682),x=n(47001),C=n(90487);(r=d||(d={})).USER_JOIN="USER_JOIN",r.USER_LEAVE="USER_LEAVE",r.USERS_UPDATE="USERS_UPDATE",r.USER_OPENED_FILE="USER_OPENED_FILE",r.FOLLOWED_USER_CHANGED="FOLLOWED_USER_CHANGED",r.FOLLOWING_USERS_CHANGED="FOLLOWING_USERS_CHANGED";var _=n(21289),k=n(58962),S=n(80388),E=n(83493),T=n(29559),R=n(7730),I=n.n(R),D=n(25e3);(i=f||(f={})).DEEPLINK_CHANGED="DEEPLINK_CHANGED",i.SESSION_STATE_CHANGED="SESSION_STATE_CHANGED";var G=n(85492),B=n(33829),P=n(1660),A=n(48900),N=n(32902);(h||(h={})).MESSAGE_RECEIVED="MESSAGE_RECEIVED";var U=n(63092),L=n(24418),O=n(47507),X=n(64540),M=n(93295),F=n(23982);function W(){var e=(0,M._)(["\n  query GitHubAuth {\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n      }\n    }\n  }\n"]);return W=function(){return e},e}var H=(0,F.Ps)(W()),V=n(59868);function z(){return(z=(0,y._)(function(){var e;return(0,w.Jh)(this,function(t){switch(t.label){case 0:if(!X.l)throw Error("Expected apollo");return[4,X.l.query({query:H})];case 1:if(!(null==(e=t.sent().data)?void 0:e.currentUser))throw Error("Expected current user");return[2,e.currentUser]}})})).apply(this,arguments)}function j(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}(o=p||(p={})).OUTPUT="OUTPUT",o.ERROR="ERROR",o.STATE_CHANGED="STATE_CHANGED",o.CHANNEL_OPENED="CHANNEL_OPENED";var q=n(53941),Y=n(5038),$=n(36098),J=n(96164),K=n.n(J),Q=n(8701),ee=n(3756),et=n.n(ee),en=n(70322),er=n(4755),ei=n(19012),eo=function(e){var t=e.configurationSupport;return{textDocument:{synchronization:{dynamicRegistration:!0,didSave:!0},signatureHelp:{dynamicRegistration:!0,signatureInformation:{documentationFormat:["markdown","plaintext"]}},publishDiagnostics:{relatedInformation:!0,tagSupport:{valueSet:[1,2]}},formatting:{dynamicRegistration:!0},documentSymbol:{dynamicRegistration:!0,hierarchicalDocumentSymbolSupport:!0,symbolKind:{valueSet:ei.Z}},definition:{dynamicRegistration:!0,linkSupport:!0},typeDefinition:{dynamicRegistration:!0},implementation:{dynamicRegistration:!0},references:{dynamicRegistration:!0},rename:{dynamicRegistration:!0,prepareSupport:!0},completion:{dynamicRegistration:!0,completionItem:{documentationFormat:["markdown","plaintext"],snippetSupport:!0}},codeAction:{dynamicRegistration:!0,codeActionLiteralSupport:{codeActionKind:{valueSet:Object.values(er.CodeActionKind)}}},hover:{dynamicRegistration:!0,contentFormat:["markdown","plaintext"]}},workspace:{applyEdit:!0,didChangeConfiguration:t.clientToServer||t.serverToClient?{dynamicRegistration:!0}:void 0,configuration:t.serverToClient,executeCommand:{dynamicRegistration:!0},workspaceEdit:{documentChanges:!0,resourceOperations:[er.ResourceOperationKind.Create,er.ResourceOperationKind.Delete,er.ResourceOperationKind.Rename]}}}},ea=n(20298),el=n(36846),ec=n.n(el),es=n(79543),eu=n(23026),ed=function(){"use strict";function e(){(0,eu._)(this,e)}var t=e.prototype;return t.supports=function(e){return e.includes("css-language-server")},t.onResponse=function(e,t){return"textDocument/hover"===e?this.onHover(t):t},t.onHover=function(e){if("error"in e)return e;var t=e.result;return"cancelled"in e&&!1!==e.cancelled||!t?e:(Array.isArray(t.contents)&&(t.contents={kind:"markdown",value:["```html",t.contents[0],"```",t.contents[1],""].join("\n")}),(0,D._)((0,b._)({},e),{result:t}))},e}(),ef=[new(function(){"use strict";function e(){(0,eu._)(this,e)}var t=e.prototype;return t.supports=function(e){return e.includes("typescript-language-server")},t.onResponse=function(e,t){return"textDocument/completion"===e?this.onCompletion(t):t},t.onCompletion=function(e){if("error"in e||"cancelled"in e&&!1!==e.cancelled)return e;var t=e.result;if(!t)return e;Array.isArray(t)&&(t={isIncomplete:!1,items:t});for(var n=0;n<t.items.length;n++){var r=t.items[n];r.sortText&&r.sortText.startsWith("")&&(r.sortText=r.sortText.replace("",""))}return(0,D._)((0,b._)({},e),{result:t})},e}()),new ed],eh=function(){"use strict";function e(){(0,eu._)(this,e)}var t=e.prototype;return t.supports=function(){return!0},t.onResponse=function(e,t){return t},e}(),ep=n(73164),em=n(88422).lW;function ev(e,t){var n,r;return null!==(r=null===(n=ep.$R.from(e))||void 0===n?void 0:n.id)&&void 0!==r?r:t}function eg(e,t){return e.line<t.line||e.line===t.line&&e.character<=t.character}function ey(){return Math.floor(2147483647*Math.random())}function eb(e){var t=JSON.stringify((0,D._)((0,b._)({},e),{jsonrpc:"2.0"})),n=em.byteLength(t,"utf8");return"Content-Length: ".concat(n,"\r\n\r\n").concat(t)}(a=m||(m={})).INITIALIZED="INITIALIZED",a.READY="READY",a.DIAGNOSTICS="DIAGNOSTICS",a.SERVER_STATE_CHANGE="SERVER_STATE_CHANGE",a.SERVER_HEALTH_CHANGE="SERVER_HEALTH_CHANGE",a.SERVER_CAPABILITIES_CHANGE="SERVER_CAPABILITIES_CHANGE",a.REQUEST="REQUEST",a.RESPONSE="RESPONSE",a.CANCEL_REQUEST="CANCEL_REQUEST",a.SEND_NOTIFICATION="SEND_NOTIFICATION";var eZ=n(72526),ew=n(15482);function ex(e,t){var n,r,i,o,a,l;return t&&t?!!(et()(null==e?void 0:e.fileTypeAttrs,t.fileTypeAttrs)&&et()(null==e?void 0:null===(n=e.config)||void 0===n?void 0:n.startCommand,null===(r=t.config)||void 0===r?void 0:r.startCommand)&&et()(null==e?void 0:null===(i=e.config)||void 0===i?void 0:i.initializationOptionsJson,null===(o=t.config)||void 0===o?void 0:o.initializationOptionsJson)&&et()(null==e?void 0:null===(a=e.config)||void 0===a?void 0:a.configurationJson,null===(l=t.config)||void 0===l?void 0:l.configurationJson)):!!t==!!t}function eC(e,t){return e_.apply(this,arguments)}function e_(){return(e_=(0,y._)(function(e,t){var n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:return[4,e.exec("pwd")];case 1:if(null!==(n=r.sent()).error){if(!t())return[2,{error:Error("LSPNix: Could not get working directory "+n.error),workingDirectory:null}];return[2,eC(e,t)]}return[2,{error:null,workingDirectory:n.output.replace("\n","")}]}})})).apply(this,arguments)}var ek=n(39698),eS=n(10122);(l=v||(v={})).CHANNEL_OPENED="CHANNEL_OPENED",l.EVENT_SENT="EVENT_SENT";var eE=n(50431),eT=["git diff -z --name-only --diff-filter=U","echo -n ".concat("\x1f"),"{ git grep -z -l -E '<{7,}|={7,}|>{7,}' || exit $(( $? == 1 ? 0 : $? )); }"].join(" && ");function eR(e){return eI.apply(this,arguments)}function eI(){return(eI=(0,y._)(function(e){var t,n,r,i,o,a,l,c,s,u,d;return(0,w.Jh)(this,function(f){switch(f.label){case 0:return[4,e(eT,{serviceMethod:"git-get-conflicting-files"})];case 1:if((t=f.sent()).error)return[2,t];if(r=(n=(0,Z._)(t.output.split("\x1f").map(function(e){return(0,eE.so)(e,"\x00")}),2))[0],i=n[1],!r.length)return[2,{files:new Map,error:null}];o=new Map,a=!0,l=!1,c=void 0;try{for(s=r[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)d=u.value,o.set(d,!i.includes(d))}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}return[2,{files:o,error:null}]}})})).apply(this,arguments)}var eD=n(57369),eG=n(75813);function eB(e){return eP.apply(this,arguments)}function eP(){return(eP=(0,y._)(function(e){var t,n,r,i,o,a;return(0,w.Jh)(this,function(l){switch(l.label){case 0:return[4,(0,eD.ZP)(e)];case 1:if((t=l.sent()).error)return[2,t];if(t.state!==eD.yG.MERGING)return[2,{error:eG.aq.INVALID_STATE}];return[4,e("cat '.git/MERGE_HEAD'",{serviceMethod:"git-get-merging-refs"})];case 2:if((n=l.sent()).error)return[2,n];if(!(r=(0,eE.so)(n.output,"\n")).length)return[2,{commits:[],branches:[],error:null}];return i="{ grep -F '".concat(r.join("\n"),"' || exit 0; }"),[4,e("".concat('git for-each-ref --format="%(objectname)	%(refname)" refs/heads/ refs/remotes/'," | ").concat(i),{serviceMethod:"git-get-merging-refs"})];case 3:if((o=l.sent()).error)return[2,o];if(!o.output)return[2,{commits:r,branches:[],error:null}];return a=(0,eE.so)(o.output,"\n").map(function(e){return e.split("	")[1]}).map(eE.C),[2,{commits:r,branches:a,error:null}]}})})).apply(this,arguments)}function eA(e){return eN.apply(this,arguments)}function eN(){return(eN=(0,y._)(function(e){var t,n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:return[4,e("if [ -f '.git/FETCH_HEAD' ]; then stat -c %Y '.git/FETCH_HEAD'; fi",{serviceMethod:"git-last-fetched"})];case 1:if((t=r.sent()).error)return[2,t];if(!t.output||isNaN(n=parseInt(t.output,10)))return[2,{lastFetched:null,error:null}];return[2,{lastFetched:new Date(n*=1e3),error:null}]}})})).apply(this,arguments)}var eU=n(21076),eL=n(80433);function eO(e,t){return eX.apply(this,arguments)}function eX(){return(eX=(0,y._)(function(e,t){var n,r,i,o,a,l;return(0,w.Jh)(this,function(c){switch(c.label){case 0:if(n=(t=(0,eU.Qj)(t)).startsWith("refs/heads/"),r=t.startsWith("refs/remotes/"),n)return[3,2];return i=r?t:"refs/remotes/".concat(t),[4,e("git show-ref --verify ".concat(i),{serviceMethod:"git-branch-exists"})];case 1:if(!(o=c.sent()).error)return[2,{exists:!0,ref:(0,eL.L)(i),error:null}];if(o.error!==eG.aq.INVALID_REFERENCE)return[2,o];c.label=2;case 2:if(r)return[3,4];return a=n?t:"refs/heads/".concat(t),[4,e("git show-ref --verify ".concat(a),{serviceMethod:"git-branch-exists"})];case 3:if(!(l=c.sent()).error)return[2,{exists:!0,ref:(0,eL.L)(a),error:null}];if(l.error!==eG.aq.INVALID_REFERENCE)return[2,l];c.label=4;case 4:return[2,{exists:!1,ref:null,error:null}]}})})).apply(this,arguments)}function eM(e,t,n){return eF.apply(this,arguments)}function eF(){return(eF=(0,y._)(function(e,t,n){var r,i,o;return(0,w.Jh)(this,function(a){switch(a.label){case 0:if((0,eU.Pi)(t,n)){if(t=(0,eU.bF)(t,!0),n=(0,eU.bF)(n),t===n)return[2,{canMerge:!0,error:null}]}else t=(0,eU.bF)(t),n=(0,eU.bF)(n);return t=(0,eE.Gw)(t),n=(0,eE.Gw)(n),r="git merge-base ".concat(t," ").concat(n),i='git merge-tree "$('.concat(r,')" ').concat(t," ").concat(n),[4,e("set -eo pipefail; (".concat(i," | ").concat("( (grep -q -e '^+<* \\.our$' && echo '1') || echo '0')",") || test $? -eq 141"),{serviceMethod:"git-can-merge-branches"})];case 1:if((o=a.sent()).error)return[2,o];return[2,{canMerge:"0"===o.output,error:null}]}})})).apply(this,arguments)}function eW(e,t){return eH.apply(this,arguments)}function eH(){return(eH=(0,y._)(function(e,t){var n,r,i,o,a,l,c,s,u;return(0,w.Jh)(this,function(d){switch(d.label){case 0:return n=t.branch,r=t.message,o=void 0!==(i=t.allowConflicts)&&i,[4,(0,eD.ZP)(e)];case 1:if((a=d.sent()).error)return[2,a];if(l=a.state,a.type!==eD.y5.NORMAL||l===eD.yG.DIRTY_WORKTREE||l===eD.yG.DIRTY_INDEX)return[2,{error:eG.aq.INVALID_STATE}];return[4,eO(e,n)];case 2:if((c=d.sent()).error)return[2,c];if(!c.exists)return[2,{error:eG.aq.INVALID_REFERENCE}];if(o)return[3,4];return[4,eM(e,n,"HEAD")];case 3:if((s=d.sent()).error)return[2,s];if(!s.canMerge)return[2,{error:eG.aq.MERGE_CONFLICT}];d.label=4;case 4:var f,h,p,m;return h=(f={branch:n,message:r}).branch,p=f.message,h=(0,eU.Qj)(h),m=["--quiet","--no-edit","--no-ff","--overwrite-ignore","--commit"],p&&m.push("-m",(0,eE.Gw)(p)),m.push((0,eE.Gw)(h)),[4,e("git merge ".concat(m.join(" ")),{serviceMethod:"git-merge"})];case 5:if((u=d.sent()).error!==eG.aq.MERGE_CONFLICT)return[3,8];if(o)return[3,7];return[4,e("git merge --abort")];case 6:return d.sent(),[2,u];case 7:return[2,{hasConflicts:!0,error:null}];case 8:if(u.error)return[2,u];return[2,{hasConflicts:!1,error:null}]}})})).apply(this,arguments)}function eV(e){return ez.apply(this,arguments)}function ez(){return(ez=(0,y._)(function(e){var t;return(0,w.Jh)(this,function(n){switch(n.label){case 0:return[4,e("git merge --abort",{serviceMethod:"git-merge-abort"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{error:null}]}})})).apply(this,arguments)}function ej(e){return eq.apply(this,arguments)}function eq(){return(eq=(0,y._)(function(e){var t;return(0,w.Jh)(this,function(n){switch(n.label){case 0:return[4,e("GIT_EDITOR=/bin/true git merge --continue",{serviceMethod:"git-merge-continue"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{error:null}]}})})).apply(this,arguments)}var eY=n(55103);function e$(e,t,n){return eJ.apply(this,arguments)}function eJ(){return(eJ=(0,y._)(function(e,t,n){var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g;return(0,w.Jh)(this,function(y){switch(y.label){case 0:if("string"==typeof t){if(""===t)return[2,{error:null}];t=[t]}if(!0!==t&&0===t.length)return[2,{error:null}];if(!(void 0!==n))return[3,2];return r=["--quiet","--no-overlay","--worktree","--source=".concat(n),!0===t?".":"-- ".concat(t.join(" "))],[4,e("git --literal-pathspecs restore ".concat(r.join(" ")),{serviceMethod:"git-restore-files"})];case 1:if((i=y.sent()).error)return[2,i];return[2,{error:null}];case 2:return[4,(0,eY.Z)(e)];case 3:if((o=y.sent()).error)return[2,o];a=[],l=[],c=!0,s=!1,u=void 0;try{for(d=o.changes[Symbol.iterator]();!(c=(f=d.next()).done);c=!0)if(h=f.value,!0===t||t.includes(h.path))switch(h.type.worktree){case eY.h.UNMODIFIED:continue;case eY.h.UNTRACKED:a.push((0,eE.Gw)(h.path));break;default:l.push((0,eE.Gw)(h.path))}}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}if(0===a.length&&0===l.length&&void 0===n)return[2,{error:null}];return p=[],a.length&&(m=["--quiet","--force","--",a.join(" ")],p.push("git --literal-pathspecs clean ".concat(m.join(" ")))),l.length&&(v=["--quiet","--no-overlay","--worktree","-- ".concat(l.join(" "))],p.push("git --literal-pathspecs restore ".concat(v.join(" ")))),[4,e(p,{serviceMethod:"git-restore-files"})];case 4:if((g=y.sent()).error)return[2,g];return[2,{error:null}]}})})).apply(this,arguments)}var eK=n(69451),eQ=n.n(eK);function e0(e,t){return e1.apply(this,arguments)}function e1(){return(e1=(0,y._)(function(e,t){var n,r,i;return(0,w.Jh)(this,function(o){switch(o.label){case 0:if(n=t.name,r=t.url,n=(0,eE.ss)(n),!(0,eU.GE)(n))return[2,{error:eG.aq.INVALID_REFERENCE}];return n=(0,eE.Gw)(n),r=(0,eE.Gw)(r),[4,e("git remote add ".concat(n," ").concat(r),{serviceMethod:"git-add-remote"})];case 1:if((i=o.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}function e2(e,t){return e8.apply(this,arguments)}function e8(){return(e8=(0,y._)(function(e,t){var n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:var i,o,a;return[4,e((i=t.message,o=t.files,a=["--allow-empty","--allow-empty-message","--cleanup=whitespace","--no-edit","--quiet","-m ".concat((0,eE.Gw)(i))],o&&a.push.apply(a,["--only","--"].concat((0,_._)(o.map(eE.Gw)))),"git --literal-pathspecs commit ".concat(a.join(" "))),{serviceMethod:"git-commit"})];case 1:if((n=r.sent()).error)return[2,n];return[2,{error:null}]}})})).apply(this,arguments)}function e4(e,t){return e3.apply(this,arguments)}function e3(){return(e3=(0,y._)(function(e,t){var n,r,i,o,a,l;return(0,w.Jh)(this,function(c){switch(c.label){case 0:return[4,eO(e,t=(0,eU.Qj)(t,!0))];case 1:if((n=c.sent()).error)return[2,n];if(!n.exists)return[2,{error:eG.aq.INVALID_REFERENCE}];if(r=["--quiet","--no-guess"],n.ref.type!==eL.l.REMOTE_BRANCH)return[3,3];return i=n.ref.branch,o=n.ref.name,[4,eO(e,"refs/heads/".concat(i))];case 2:if((a=c.sent()).error)return[2,a];return a.exists?r.push((0,eE.Gw)(i),"--"):r.push("-t","-b",(0,eE.Gw)(i),(0,eE.Gw)(o),"--"),[3,4];case 3:r.push((0,eE.Gw)(n.ref.name),"--"),c.label=4;case 4:return[4,e("git checkout ".concat(r.join(" ")),{serviceMethod:"git-switch-branch"})];case 5:if((l=c.sent()).error)return[2,l];return[2,{error:null}]}})})).apply(this,arguments)}function e5(e,t){return e6.apply(this,arguments)}function e6(){return(e6=(0,y._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f;return(0,w.Jh)(this,function(h){switch(h.label){case 0:return n=t.name,i=void 0===(r=t.startPoint)?"HEAD":r,o=t.track,l=void 0!==(a=t.checkout)&&a,[4,eO(e,n=(0,eE.C)(n))];case 1:if((c=h.sent()).error)return[2,c];if(c.exists)return[2,{error:eG.aq.BRANCH_ALREADY_EXISTS}];if("HEAD"===i){if(!0===o)return[2,{error:eG.aq.INVALID_REFERENCE}];o=!1}if(!(!1!==o))return[3,3];return[4,eO(e,i)];case 2:if((s=h.sent()).error)return[2,s];if(!s.exists&&!0===o)return[2,{error:eG.aq.INVALID_REFERENCE}];s.exists&&s.ref.type===eL.l.REMOTE_BRANCH&&void 0===o&&(o=!0),h.label=3;case 3:return u=["--quiet",o?"--track":"--no-track",(0,eE.Gw)(n),(0,eE.Gw)(i)],[4,e("git branch ".concat(u.join(" ")),{serviceMethod:"git-create-branch"})];case 4:if((d=h.sent()).error)return[2,d];if(!l)return[3,6];return[4,e4(e,n)];case 5:if((f=h.sent()).error)return[2,f];h.label=6;case 6:return[2,{error:null}]}})})).apply(this,arguments)}function e9(e){return e7.apply(this,arguments)}function e7(){return(e7=(0,y._)(function(e){var t,n,r,i,o=arguments;return(0,w.Jh)(this,function(a){switch(a.label){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},n=["--quiet"],t.depth&&(r=t.deepen?"--deepen":"--depth",n.push("".concat(r,"=").concat(t.depth))),t.remote?n.push((0,eE.Gw)(t.remote)):n.push("--all"),[4,e("git fetch ".concat(n.join(" ")),{serviceMethod:"git-fetch"})];case 1:if((i=a.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}var te=["main","master","trunk","dev","develop","development","staging","prod","production"].map(function(e){return'if [ $(git rev-parse --verify --quiet "heads/'.concat(e,'") ]; then\n      echo "refs/heads/').concat(e,'"\n    fi')}).join("\n"),tt='\ngit remote | while IFS= read -r remote; do\n  if [ -z "$remote" ]; then continue; fi\n  branch="$('.concat('\nif [ -f ".git/refs/remotes/$remote/HEAD" ]; then\n  echo "$(sed -e "s/^ref: refs\\/remotes\\/$remote\\///" < .git/refs/remotes/$remote/HEAD)"\nelse\n  remote_result="$(git ls-remote --symref "$remote" HEAD)"\n  if [ -z "$remote_result" ]; then\n    echo ""\n  else\n    echo "$(\n      echo "$remote_result" | \\\n      head -1 | \\\n      awk \'{print $2}\' | \\\n      sed -e "s/^refs\\/heads\\///"\n    )"\n  fi\nfi\n'.trim(),')"\n  if [ -z "$branch" ]; then continue; fi\n  echo "refs/remotes/$remote/$branch"\n  if [ $(git rev-parse --verify --quiet "heads/$branch") ]; then\n    echo "refs/heads/$branch"\n  fi\ndone\n').concat(te,"\n").trim();function tn(e){return tr.apply(this,arguments)}function tr(){return(tr=(0,y._)(function(e){var t;return(0,w.Jh)(this,function(n){switch(n.label){case 0:return[4,e(tt,{serviceMethod:"git-find-default-branches"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{refs:(0,_._)(new Set((0,eE.so)(t.output,"\n"))).map(function(e){return(0,eL.L)(e)}),error:null}]}})})).apply(this,arguments)}var ti=n(75647);function to(e,t){return ta.apply(this,arguments)}function ta(){return(ta=(0,y._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f,h;return(0,w.Jh)(this,function(p){switch(p.label){case 0:if(t=(0,eU.bF)(t,!0),!(0,eU.Dc)(t))return[2,{error:eG.aq.INVALID_REFERENCE}];return n=(0,eE.C)(t),i=(r=(0,Z._)((0,eE.Tg)(t),2))[0],o=r[1],a=["refs/heads/".concat(n),"refs/remotes/*/".concat(n)],i&&o&&(a.push("refs/heads/".concat(o)),a.push("refs/remotes/".concat(i,"/").concat(o))),[4,(0,ti.ZP)(e,{pattern:a})];case 1:if((l=p.sent()).error)return[2,l];if(0===l.branches.length)return[2,{error:eG.aq.INVALID_REFERENCE}];c=!0,s=!1,u=void 0;try{for(d=l.branches[Symbol.iterator]();!(c=(f=d.next()).done);c=!0)if((h=f.value).type!==ti.HO.REMOTE&&h.name===n||i&&o&&h.type!==ti.HO.LOCAL&&h.remote===i&&h.name===o)return[2,{branch:h,error:null}]}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}return[2,{error:eG.aq.INVALID_REFERENCE}]}})})).apply(this,arguments)}function tl(e,t){return tc.apply(this,arguments)}function tc(){return(tc=(0,y._)(function(e,t){var n,r,i,o,a,l;return(0,w.Jh)(this,function(c){switch(c.label){case 0:if(n=t.path,i=void 0===(r=t.revision)?"":r,o=(0,eE.Gw)(""===i?n:"".concat(null!=i?i:"",":").concat(n)),""!==i)return[3,2];return[4,e("cat ".concat(n),{verbatim:!0,serviceMethod:"git-get-file-contents"})];case 1:return l=c.sent(),[3,4];case 2:return[4,e("git --no-pager show --textconv ".concat(o),{verbatim:!0,serviceMethod:"git-get-file-contents"})];case 3:l=c.sent(),c.label=4;case 4:if((a=l).error){if(a.error===eG.aq.PATH_MATCHED_NO_FILES)return[2,{content:null,error:null}];return[2,a]}return[2,{content:a.output,error:null}]}})})).apply(this,arguments)}function ts(e){return tu.apply(this,arguments)}function tu(){return(tu=(0,y._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p;return(0,w.Jh)(this,function(m){switch(m.label){case 0:return[4,e("git remote -v",{serviceMethod:"git-get-remotes"})];case 1:if((t=m.sent()).error)return[2,t];if(""===t.output)return[2,{remotes:new Map,error:null}];n=new Map,r=!0,i=!1,o=void 0;try{for(a=(0,eE.so)(t.output,"\n")[Symbol.iterator]();!(r=(l=a.next()).done);r=!0)c=l.value,u=(s=(0,Z._)(c.split(/\s+/),3))[0],d=s[1],f=s[2],u&&d&&f&&(p=null!==(h=n.get(u))&&void 0!==h?h:{name:u,fetch:"",push:""},"(fetch)"===f?(p.fetch=d,""===p.push&&(p.push=d),n.set(u,p)):"(push)"===f&&(p.push=d,""===p.fetch&&(p.fetch=d),n.set(u,p)))}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return[2,{remotes:n,error:null}]}})})).apply(this,arguments)}var td='git commit --allow-empty --no-edit --quiet -m "Initial commit"',tf='git add -A && git commit --allow-empty --no-edit --quiet -m "Initial commit"';function th(e){return tp.apply(this,arguments)}function tp(){return(tp=(0,y._)(function(e){var t,n,r,i,o,a,l,c,s,u=arguments;return(0,w.Jh)(this,function(d){switch(d.label){case 0:return r=void 0===(n=(t=u.length>1&&void 0!==u[1]?u[1]:{}).initialCommit)||n,o=void 0===(i=t.includeAllInitialFiles)||i,[4,(0,eD.ZP)(e)];case 1:if((a=d.sent()).error)return[2,a];if(a.type!==eD.y5.INITIALIZING)return[2,{error:eG.aq.ALREADY_INITIALIZED}];if(a.state!==eD.yG.ON_UNBORN_BRANCH)return[3,4];if(!r)return[3,3];return[4,e(o?tf:td,{serviceMethod:"git-init"})];case 2:if((l=d.sent()).error)return[2,l];d.label=3;case 3:return[2,{error:null}];case 4:return[4,e(["git init","git checkout -b main"],{serviceMethod:"git-init"})];case 5:if((c=d.sent()).error)return[2,c];if(!r)return[3,7];return[4,e(o?tf:td,{serviceMethod:"git-init"})];case 6:if((s=d.sent()).error)return[2,s];d.label=7;case 7:return[2,{error:null}]}})})).apply(this,arguments)}function tm(e){return tv.apply(this,arguments)}function tv(){return(tv=(0,y._)(function(e){var t;return(0,w.Jh)(this,function(n){switch(n.label){case 0:return[4,e("git rev-parse --is-inside-work-tree",{serviceMethod:"git-is-initialized"})];case 1:if((t=n.sent()).error){if(t.error===eG.aq.NOT_INITIALIZED)return[2,{initialized:!1,error:null}];return[2,t]}return[2,{initialized:"true"===t.output,error:null}]}})})).apply(this,arguments)}function tg(e){var t=(0,Z._)(e.trimStart().split("\x1f"),11),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],l=t[5],c=t[6],s=t[7],u=t[8],d=t[9],f=t[10],h=[],p=i?i.split(" "):null,m=!1,v=!0,g=!1,y=void 0;try{for(var b,w=(0,eE.so)(n,",")[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){var x=b.value;if("grafted"===x){m=!0;continue}h.push((0,eL.L)(x))}}catch(e){g=!0,y=e}finally{try{v||null==w.return||w.return()}finally{if(g)throw y}}return{refs:h,hash:r,parents:p,grafted:m,author:{name:o,email:a,date:1e3*parseInt(l,10)},committer:{name:c,email:s,date:1e3*parseInt(u,10)},subject:d?d.trim():"",body:f?f.trim():""}}function ty(e){return tb.apply(this,arguments)}function tb(){return(tb=(0,y._)(function(e){var t,n=arguments;return(0,w.Jh)(this,function(r){switch(r.label){case 0:var i,o,a,l,c,s,u;return[4,e((a=void 0===(o=(i=n.length>1&&void 0!==n[1]?n[1]:{}).max)?25:o,l=i.skip,c=i.revRange,s=i.path,u=["-z","--decorate=full","--full-history",'--format="format:%D%x1f%H%x1f%P%x1f%an%x1f%ae%x1f%at%x1f%cn%x1f%ce%x1f%ct%x1f%s%x1f%b"'],a=Math.max(1,Math.min(a,200)),u.push("-n ".concat(a)),l&&u.push("--skip ".concat(l)),c&&u.push(c),u.push("--"),s&&u.push(s),"git log ".concat(u.join(" "))),{serviceMethod:"git-log"})];case 1:if((t=r.sent()).error){if(t.error===eG.aq.NO_COMMITS)return[2,{commits:[],error:null}];return[2,t]}return[2,{commits:(0,eE.so)(t.output,"\x00").map(tg),error:null}]}})})).apply(this,arguments)}function tZ(e){return tw.apply(this,arguments)}function tw(){return(tw=(0,y._)(function(e){var t,n=arguments;return(0,w.Jh)(this,function(r){switch(r.label){case 0:return[4,e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return e.cached&&t.push("--cached"),e.deleted&&t.push("--deleted"),e.modified&&t.push("--modified"),e.others&&t.push("--others"),e.ignored&&t.push("--ignored"),e.directory&&t.push("--directory"),e.noEmptyDirectory&&t.push("--no-empty-directory"),"git ls-files ".concat(t.join(" "))}(n.length>1&&void 0!==n[1]?n[1]:{}),{serviceMethod:"git-ls-files"})];case 1:if((t=r.sent()).error)return[2,t];return[2,{files:t.output.split("\n").filter(function(e){return e.length>0}),error:null}]}})})).apply(this,arguments)}var tx=n(91075);function tC(e){return t_.apply(this,arguments)}function t_(){return(t_=(0,y._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f=arguments;return(0,w.Jh)(this,function(h){switch(h.label){case 0:return t=f.length>1&&void 0!==f[1]?f[1]:{},[4,(0,eY.Z)(e)];case 1:if((n=h.sent()).error)return[2,n];if(!n.branch)return[2,{error:eG.aq.HEAD_DETACHED}];if(r=null,i=null,t.publish){if(n.upstream)return[2,{error:eG.aq.BRANCH_ALREADY_EXISTS}];r=t.publish.remote,i=null!==(o=t.publish.name)&&void 0!==o?o:n.branch,r=(0,eE.C)(r),i=(0,eE.C)(i)}else{if(!n.upstream)return[2,{error:eG.aq.UPSTREAM_NOT_SET}];if(!t.force&&n.upstream.behind>0)return[2,{error:eG.aq.PUSH_REJECTED}];r=(a=(0,Z._)((0,eE.Tg)(n.upstream.branch),2))[0],i=a[1]}if(!r||!i)return[2,{error:eG.aq.UPSTREAM_NOT_SET}];if(t.force)return[3,3];return[4,e9(e,{remote:r})];case 2:if((l=h.sent()).error)return[2,l];h.label=3;case 3:if(!t.publish)return[3,5];return[4,eO(e,"refs/remotes/".concat(r,"/").concat(i))];case 4:if((c=h.sent()).error)return[2,c];if(c.exists&&c.ref.type===eL.l.REMOTE_BRANCH)return[2,{error:eG.aq.BRANCH_ALREADY_EXISTS}];h.label=5;case 5:return s=["--quiet"],t.force&&!t.publish&&s.push("--force-with-lease"),t.publish&&s.push("--set-upstream"),u="refs/heads/".concat(n.branch,":refs/heads/").concat(i),s.push((0,eE.Gw)(r),(0,eE.Gw)(u)),[4,e("git push ".concat(s.join(" ")),{serviceMethod:"git-push"})];case 6:if((d=h.sent()).error)return[2,d];return[2,{error:null}]}})})).apply(this,arguments)}function tk(e,t){return tS.apply(this,arguments)}function tS(){return(tS=(0,y._)(function(e,t){var n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:if(t=(0,eE.ss)(t),!(0,eU.GE)(t))return[2,{error:eG.aq.INVALID_REFERENCE}];return[4,e("git remote rm ".concat((0,eE.Gw)(t)),{serviceMethod:"git-remove-remote"})];case 1:if((n=r.sent()).error)return[2,n];return[2,{error:null}]}})})).apply(this,arguments)}function tE(e,t){return tT.apply(this,arguments)}function tT(){return(tT=(0,y._)(function(e,t){var n,r,i;return(0,w.Jh)(this,function(o){switch(o.label){case 0:if(n=t.remote,r=t.url,n=(0,eE.ss)(n),!(0,eU.GE)(n)||!(0,eU.LY)(r))return[2,{error:eG.aq.INVALID_REFERENCE}];return n=(0,eE.Gw)(n),r=(0,eE.Gw)(r),[4,e("git remote set-url ".concat(n," ").concat(r),{serviceMethod:"git-set-remote-url"})];case 1:if((i=o.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}function tR(e,t){return tI.apply(this,arguments)}function tI(){return(tI=(0,y._)(function(e,t){var n,r;return(0,w.Jh)(this,function(i){switch(i.label){case 0:if(!(n=function(e){if("all"in e)return e.all?["git add -A"]:["git reset -q -- ."];var t=e.add,n=e.reset;if(!(null==t?void 0:t.length)&&!(null==n?void 0:n.length))return null;var r=[];if(t){var i=t.map(eE.Gw).join(" ");r.push("git --literal-pathspecs add -- ".concat(i))}if(n){var o=n.map(eE.Gw).join(" ");r.push("git --literal-pathspecs reset -q -- ".concat(o))}return r}(t)))return[2,{error:null}];return[4,e(n,{serviceMethod:"git-stage-files"})];case 1:if((r=i.sent()).error)return[2,r];return[2,{error:null}]}})})).apply(this,arguments)}var tD=n(63043);function tG(){var e=(0,M._)(['\n  fragment GitServiceGitHubUser on CurrentUser {\n    image\n    username\n    email\n    gitHubInfo {\n      accessToken\n      userInfo {\n        username\n        email\n        avatarUrl\n      }\n    }\n    repositories(count: 1, after: "0") {\n      ... on RepositoryConnection {\n        items {\n          id\n        }\n      }\n    }\n  }\n']);return tG=function(){return e},e}function tB(){var e=(0,M._)(["\n  query GitServiceCurrentUser {\n    currentUser {\n      id\n      ...GitServiceGitHubUser\n    }\n  }\n  ","\n"]);return tB=function(){return e},e}var tP=(0,F.Ps)(tG()),tA=(0,F.Ps)(tB(),tP);function tN(e){return tU.apply(this,arguments)}function tU(){return(tU=(0,y._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y;return(0,w.Jh)(this,function(b){switch(b.label){case 0:return t=e.defaultUsername,n=e.defaultUserId,r=e.onProfiles,a=new Map,[4,null===X.l||void 0===X.l?void 0:X.l.query({query:tA,fetchPolicy:"network-only",context:{noBatch:!0}})];case 1:var Z,w;return d=(u=null!==(s=null==(c=(null!==(l=b.sent())&&void 0!==l?l:{data:null}).data)?void 0:c.currentUser)&&void 0!==s?s:{username:t,id:n}).id,f=u.username,d&&f&&(m={provider:eG.rG.REPLIT_DEFAULT,email:"".concat(d,"-").concat(f,"@").concat(tD.J),username:f,avatar:null!==(p=null==c?void 0:null===(h=c.currentUser)||void 0===h?void 0:h.image)&&void 0!==p?p:null},a.set(m.provider,m)),(v=null==c?void 0:null===(o=c.currentUser)||void 0===o?void 0:null===(i=o.gitHubInfo)||void 0===i?void 0:i.userInfo)&&v.email&&v.username&&(null==c?void 0:null===(w=c.currentUser)||void 0===w?void 0:null===(Z=w.repositories)||void 0===Z?void 0:Z.__typename)==="RepositoryConnection"&&(y={provider:eG.rG.GITHUB,email:v.email,username:v.username,avatar:null!==(g=v.avatarUrl)&&void 0!==g?g:null},a.set(y.provider,y)),r(a),[2]}})})).apply(this,arguments)}function tL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.author,n=e.committer,r={GIT_AUTHOR_NAME:"",GIT_AUTHOR_EMAIL:"",GIT_COMMITTER_NAME:"",GIT_COMMITTER_EMAIL:"",GIT_ASKPASS:"replit-git-askpass",GIT_PAGER:"",GIT_EDITOR:"",PAGER:"",EDITOR:""};if(t){r.GIT_AUTHOR_NAME=t.username,r.GIT_COMMITTER_NAME=t.username;var i=tO(t);r.GIT_AUTHOR_EMAIL=i,r.GIT_COMMITTER_EMAIL=i,n&&(r.GIT_COMMITTER_NAME=n.username,r.GIT_COMMITTER_EMAIL=tO(n))}return r}function tO(e){if("id"in e)return"".concat(e.id,"-").concat(e.username,"@users.noreply.replit.com");if("email"in e)return e.email;throw Error("Invalid user")}var tX=n(39756),tM=n(30084),tF=".git",tW=n(59173),tH=function(){"use strict";function e(t,n){(0,eu._)(this,e),this.cache=new Map,this.lastInvalidation=0,this.ttl=t,this.debounceTime=n}var t=e.prototype;return t.has=function(e){return this.cache.has(e)},t.get=function(e){var t=this.cache.get(e);if(!t)throw Error("No value found for key: ".concat(e));return t.result},t.set=function(e,t){var n=this,r=this.cache.get(e);r&&(clearTimeout(r.timeout),this.cache.delete(e));var i={result:t,timeout:setTimeout(function(){return n.cache.delete(e)},this.ttl),pending:!0};t.finally(function(){return i.pending=!1}),this.cache.set(e,i)},t.invalidate=function(){if(!(Date.now()-this.lastInvalidation<this.debounceTime)){var e=new Map,t=!0,n=!1,r=void 0;try{for(var i,o=this.cache[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=(0,Z._)(i.value,2),l=a[0],c=a[1];c.pending?e.set(l,c):clearTimeout(c.timeout)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.cache=e,this.lastInvalidation=Date.now()}},t.clear=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.cache.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;clearTimeout(o.timeout)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.cache.clear(),this.lastInvalidation=0},e}(),tV=n(97631),tz=/^(fatal: |error: |remote: error: |CONFLICT \([^)]+\): )/im,tj=/^cat: .*: No such file or directory$/im;function tq(e){return RegExp("^fatal: ".concat(e.source),"im")}function tY(e){return RegExp("^error: ".concat(e.source),"im")}var t$=[{error:eG.aq.NOT_INITIALIZED,match:[tq(/not a git repository/)]},{error:eG.aq.UNAUTHENTICATED,match:[tq(/Authentication failed/),tq(/unable to access/),tq(/repository \S+ not found/),tq(/could not read Username/),tq(/could not read Password/),tq(/Could not read from remote/)]},{error:eG.aq.INDEX_FILE_CORRUPT,match:[tq(/index file corrupt/),tq(/index file smaller than expected/),tY(/index file .*?\.idx is too small/)]},{error:eG.aq.UNKNOWN_REMOTE,match:[tq(/No such remote/),tY(/No such remote/)]},{error:eG.aq.INDEX_LOCKED,match:[tq(/Unable to create .*?\.git\/index\.lock/),tY(/Unable to create .*?\.git\/index\.lock/)]},{error:eG.aq.NO_COMMITS,match:[tq(/your current branch '.*?' does not have any commits yet/)]},{error:eG.aq.PATH_MATCHED_NO_FILES,match:[tq(/pathspec '.*?' did not match any files/),tq(/pathspec '.*?' did not match any file\(s\) known to git/),tq(/path '.*?' does not exist/),tq(/path '.*?' exists on disk, but not in/)]},{error:eG.aq.USER_NOT_CONFIGURED,match:[tq(/unable to auto-detect email address/),tq(/unable to auto-detect name/),tq(/empty ident name \(for <.*?>\) not allowed/)]},{error:eG.aq.INVALID_REFERENCE,match:[tq(/invalid reference: .*?$/),tq(/'.*?' - not a valid ref/)]},{error:eG.aq.BRANCH_ALREADY_EXISTS,match:[tq(/A branch named '.*?' already exists/)]},{error:eG.aq.MERGE_CONFLICT,match:[tq(/Not possible to fast-forward, aborting/),tq(/refusing to merge unrelated histories/),tq(/Exiting because of an unresolved conflict/),tq(/Exiting because of unfinished merge/),tY(/Failed to merge in the changes/),RegExp("^CONFLICT \\([^\\)]+\\): ".concat(/Merge conflict in/.source),"im")]},{error:eG.aq.UPSTREAM_NOT_SET,match:[tq(/The current branch \S+ has no upstream branch/),tq(/No configured push destination/)]},{error:eG.aq.HEAD_DETACHED,match:[tq(/HEAD does not point to a branch/),tq(/ref HEAD is not a symbolic ref/)]},{error:eG.aq.DIRTY_WORKTREE,match:[tY(/Your local changes to the following files would be overwritten/),tY(/The following untracked working tree files would be overwritten/),tY(/\S+ is not possible because you have unmerged files/),tY(/cannot rebase: You have unstaged changes/)]},{error:eG.aq.PROTECTED_BRANCH,match:[RegExp("^remote: error: ".concat(/.*? Protected branch update failed/.source),"im")]},{error:eG.aq.PUSH_REJECTED,match:[tY(/failed to push some refs to/)]},{error:eG.aq.REMOTE_ALREADY_EXISTS,match:[tq(/remote .*? already exists/),tY(/remote .*? already exists/)]},{error:eG.aq.INVALID_STATE,match:[tq(/There is no merge in progress/),tq(/There is no merge to abort/),tq(/No rebase in progress/)]}],tJ=n(26572);function tK(){return(tK=(0,y._)(function(e,t,n,r){var i,o,a,l,c,s,u;return(0,w.Jh)(this,function(d){switch(d.label){case 0:if("open"!==e.status)return[2,{output:"JS Error\nchannel closed before command was run",error:eG.aq.CHANNEL_CLOSED}];d.label=1;case 1:return d.trys.push([1,3,,4]),i="",o=e.onCommand(function(e){null!==e.output&&void 0!==e.output&&(i+=e.output)}),a=void 0,(l=Promise.race([new Promise(function(e){return a=setTimeout(e,9e4)}),e.request({exec:{env:n,args:t,blocking:!0}})])).finally(function(){o(),clearTimeout(a)}),[4,l];case 2:if(void 0===(c=d.sent()))return O.kg.error("Git request timed out.",(0,b._)({appService:"git",command:t,gitEnv:JSON.stringify(n),TIMEOUT:9e4},r)),[2,{output:i,error:eG.aq.TIMEOUT}];if(!c.ok&&c.channelClosed)return[2,{output:"JS Error\nchannel closed during command execution",error:eG.aq.CHANNEL_CLOSED}];if(c.error||!c.ok)return[2,{output:s="".concat(c.error,"\n").concat(i),error:function(e){if(tz.test(e)){for(var t=0;t<t$.length;t++)for(var n=0;n<t$[t].match.length;n++)if(t$[t].match[n].test(e))return t$[t].error;return eG.aq.UNKNOWN}return tj.test(e)?eG.aq.PATH_MATCHED_NO_FILES:eG.aq.UNKNOWN_NOT_GIT}(s)}];return[2,{output:i,error:null}];case 3:return u=d.sent(),A.$e(function(e){e.setTag("service","git"),e.setExtra("command",t),e.setExtra("env",n),r&&e.setExtra("options",r),A.Tb(u)}),[2,{output:"JS Error\n".concat(String(u)),error:eG.aq.UNKNOWN_NOT_GIT}];case 4:return[2]}})})).apply(this,arguments)}var tQ=function(){"use strict";function e(t){var n=t.container,r=t.getEnv,i=t.awaitPromise,o=this;(0,eu._)(this,e),this.cache=new tH(3e4,2e3),this.running=(0,tW.u)(!1),this.queue=[],n.openChannel({service:"exec"},function(e){var t,n,a=e.channel,l=(t=(0,y._)(function(e,t){var n,o;return(0,w.Jh)(this,function(l){switch(l.label){case 0:if(0===e.length)throw Error("Expected at least one command");if(!i)return[3,2];return[4,i];case 1:l.sent(),l.label=2;case 2:return n=Date.now(),[4,function(e,t,n,r){return tK.apply(this,arguments)}(a,["bash","-c",Array.isArray(e)?e.join(" && "):e],r(),t)];case 3:if(o=l.sent(),(0,tV.J)(e,o,!1,n),o.error)return[2,o];return[2,{output:(null==t?void 0:t.verbatim)?o.output:o.output.trim(),error:null}]}})}),function(e,n){return t.apply(this,arguments)}),c=function(e,t){if(0===e.length)throw Error("Expected at least one command");var n=Array.isArray(e)?e.join(" && "):e;if(o.cache.has(n)){var r=o.cache.get(n);return r.then(function(t){(0,tV.J)(e,t,!0)}),r}var i=l(n,t);return o.cache.set(n,i),i},s=function(e,t){return o.cache.clear(),l(e,t)},u=(n=(0,y._)(function(){var e;return(0,w.Jh)(this,function(t){switch(t.label){case 0:if(!(o.queue.length>0)||"open"!==a.status)return[3,7];if(!(e=o.queue.shift()))return[3,6];if("read"!==e.type)return[3,2];return[4,e.fn(c)];case 1:case 3:return t.sent(),[3,6];case 2:if("write"!==e.type)return[3,4];return[4,e.fn(s)];case 4:return[4,e.fn(l)];case 5:t.sent(),t.label=6;case 6:return[3,0];case 7:return 0===o.queue.length&&o.running.set(!1),[2]}})}),function(){return n.apply(this,arguments)});return o.running.current&&u(),o.running.subscribe(function(e){e&&u()})})}var t=e.prototype;return t.add=function(e,t){var n,r=(0,tJ.Z)();return this.queue.push({type:t,fn:(n=(0,y._)(function(t){var n;return(0,w.Jh)(this,function(i){switch(i.label){case 0:return[4,e(t)];case 1:return n=i.sent(),r.resolve(n),[2]}})}),function(e){return n.apply(this,arguments)})}),this.running.current||this.running.set(!0),r.promise},t.wrap=function(e,t){var n=this;if("function"!=typeof e)throw Error("Expected a function");return function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return n.add(function(t){return e.apply(void 0,[t].concat((0,_._)(i)))},t)}},e}();function t0(e,t){return t1.apply(this,arguments)}function t1(){return(t1=(0,y._)(function(e,t){var n,r,i,o;return(0,w.Jh)(this,function(a){switch(a.label){case 0:return n=t.upstream,r=t.branchName,i=["--set-upstream-to",n],r&&i.push((0,eE.Gw)(r)),[4,e("git branch ".concat(i.join(" ")),{serviceMethod:"git-set-branch-upstream"})];case 1:if((o=a.sent()).error)return[2,o];return[2,{error:null}]}})})).apply(this,arguments)}function t2(e){switch(e){case"A":return"ADDED";case"C":return"COPIED";case"D":return"DELETED";case"M":return"MODIFIED";case"R":return"RENAMED";case"T":return"TYPE_CHANGED";case"U":return"UNMERGED";case"X":default:return"UNKNOWN";case"B":return"BROKEN"}}(c=g||(g={})).ADDED="ADDED",c.COPIED="COPIED",c.DELETED="DELETED",c.MODIFIED="MODIFIED",c.RENAMED="RENAMED",c.TYPE_CHANGED="TYPE_CHANGED",c.UNMERGED="UNMERGED",c.UNKNOWN="UNKNOWN",c.BROKEN="BROKEN";var t8=(s=(0,y._)(function(e,t){var n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:return[4,e("git log -1 --pretty=%P ".concat(t))];case 1:if((n=r.sent()).error)return[2,!1];return[2,n.output.trim().length>0]}})}),function(e,t){return s.apply(this,arguments)}),t4=(u=(0,y._)(function(e,t){var n,r,i,o,a,l,c,s,u;return(0,w.Jh)(this,function(d){switch(d.label){case 0:return[4,e("git ls-tree --name-only -r ".concat(t),{serviceMethod:"git-get-files-for-commit"})];case 1:if((n=d.sent()).error)return[2,n];r=[],i=n.output.split("\n").filter(Boolean),o=!0,a=!1,l=void 0;try{for(c=i[Symbol.iterator]();!(o=(s=c.next()).done);o=!0)u=s.value,r.push({path:u,type:"ADDED"})}catch(e){a=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}return[2,{files:r,error:null}]}})}),function(e,t){return u.apply(this,arguments)});function t3(){return(t3=(0,y._)(function(e){return(0,w.Jh)(this,function(t){return[2,Array.from(e.matchAll(t6)).map(function(e){var t=(0,Z._)(e,4),n=t[1],r=t[2];return{path:t[3],originalPath:r,type:t2(n)}})]})})).apply(this,arguments)}var t5=/([ADMUXBT])\0([^\0]+)/g,t6=/([RC])\d*\0([^\0]+)\0([^\0]+)/g;function t9(e,t){return t7.apply(this,arguments)}function t7(){return(t7=(0,y._)(function(e,t){var n,r,i;return(0,w.Jh)(this,function(o){switch(o.label){case 0:return[4,t8(e,t)];case 1:if(!o.sent())return[2,t4(e,t)];return[4,e("git diff-tree --no-commit-id --name-status -z -r -M ".concat(t),{serviceMethod:"git-get-files-for-commit"})];case 2:if((n=o.sent()).error)return[2,n];return[4,function(e){return t3.apply(this,arguments)}(n.output)];case 3:return r=o.sent(),i=Array.from(n.output.matchAll(t5)).map(function(e){var t=(0,Z._)(e,3),n=t[1];return{path:t[2],type:t2(n)}}),[2,{files:(0,_._)(r).concat((0,_._)(i)),error:null}]}})})).apply(this,arguments)}var ne=n(23015),nt=n(67795),nn=n(43429),nr=n(35375),ni=n(17789),no=n(30671),na=n(10653);function nl(e){return(0,Z._)((0,nn.useState)(function(){var t,n,r,i,o,a,l,c,s,u,m,g,R,X,M,F,W,H,J,ee,et,er,ei,el,eu,ed,ep,em,e_,eE,eT,eI,eP,eN,eU,eL,eX,eF,eH,ez,eq,eJ,eK,e1,e8,e3,e6,e7,te,tt,tr,ta,tc,tu,td,tf,tp,tv,tg,tb,tw,t_,tS,tT,tI,tD,tG,tB,tP,tA,tU,tO,tW;return eH=(t=e).pid2,eq=void 0===(ez=t.runnerMode)?"outputs":ez,eJ=t.onUnrecoverableError,eK=t.openFile,e1=t.openMultipleFiles,e8=t.openMultipleURLs,e3=t.onFirewallDenied,e6=t.channelRequestPriority,e7=t.enableUserEvents,te=t.autoUpdateDotReplitOnPortInfo,tt=t.dotdevUrlEnabled,tr=t.onPresenceCommand,ta=t.getColorForUser,tc=t.openTelemetryTracing,td=function(e){var t=e.container,n=e.enabled,r=e.onEventSent,i=(0,E.ZP)();r&&i.on(v.EVENT_SENT,r);var o=null;function a(e,t){return l.apply(this,arguments)}function l(){return(l=(0,y._)(function(e,r){var o,a,l,s,u,d,f,h;return(0,w.Jh)(this,function(p){switch(p.label){case 0:if(!n)return[2];return[4,function(){return c.apply(this,arguments)}()];case 1:if(l=p.sent(),u=null==(s=t.getContext())?void 0:null===(o=s.currentUser)||void 0===o?void 0:o.id,d=null==s?void 0:null===(a=s.repl)||void 0===a?void 0:a.id,f=window.location.href,h={userEvent:{eventName:e,eventData:function e(t){if(!("object"==typeof t&&null!==t&&null!==Object.getPrototypeOf(t)))throw Error("encodeBareStruct must be called with a plain object");return{fields:Object.entries(t).reduce(function(t,n){var r=(0,Z._)(n,2),i=r[0],o=r[1];return void 0===o||"object"==typeof o&&o&&0===Object.keys(o).length?t:(0,D._)((0,b._)({},t),(0,ek._)({},i,function t(n){switch(void 0===n?"undefined":(0,eS._)(n)){case"string":return{kind:"stringValue",stringValue:n};case"number":return{kind:"numberValue",numberValue:n};case"boolean":return{kind:"boolValue",boolValue:n};case"object":if(null===n)return{kind:"nullValue",nullValue:null};if(Array.isArray(n))return{kind:"listValue",listValue:{values:n.map(t)}};return{kind:"structValue",structValue:e(n)};default:throw Error("Unexpected value: ".concat(n))}}(o)))},{})}}((0,b._)({userId:u,replId:d,url:f},r))}},"open"!==l.status)return A.$e(function(e){e.setTag("service","user-events"),e.setExtra("command",h),e.setExtra("userId",u),e.setExtra("replId",d),e.setExtra("url",f),e.setExtra("channelId",l.id),A.Tb(Error("UserEvents channel is not open: ".concat(l.status)))}),[2];return i.emit(v.EVENT_SENT,e,r),l.send(h),[2]}})})).apply(this,arguments)}function c(){return(c=(0,y._)(function(){return(0,w.Jh)(this,function(e){return o?[2,o]:[2,new Promise(function(e){i.once(v.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}return a("meta:start",{}),t.openChannel({service:"null",skip:function(){return!n}},function(e){var t=e.channel;return a("meta:ready",{}),o=t,i.emit(v.CHANNEL_OPENED,t),function(){o=null}}),{emit:a}}({container:tu=(0,x.ZP)({pid2:eH,onUnrecoverableError:eJ,onFirewallDenied:e3}),enabled:!!(void 0!==e7&&e7)}),tf=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,E.ZP)();t.setMaxListeners(1e3);var n=null,r={openFiles:[],activeTab:0};function i(e){I()(r,e)||(r=e,t.emit(f.SESSION_STATE_CHANGED,r))}return{onSessionStateChanged:function(e){return t.on(f.SESSION_STATE_CHANGED,e),function(){t.removeListener(f.SESSION_STATE_CHANGED,e)}},onDeeplinkUpdated:function(e){return t.on(f.DEEPLINK_CHANGED,e),n&&(e(n),n=null),function(){t.removeListener(f.DEEPLINK_CHANGED,e)}},openFile:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.openFile){e.openFile({path:t,newTab:n.newTab,newPane:n.newPane,newPaneEdge:n.newPaneEdge,col:n.col,line:n.line});return}var o=n.tabIndex,a=n.newTab;if(void 0!==o){!function(e,t){var n=t||r.openFiles.length;if(e<0||e>=n||!Number.isInteger(e))throw Error("Invalid index: ".concat(e,". Index must be an integer between 0 and ").concat(n))}(o,r.openFiles.length+1);var l=r.openFiles.slice(),c=r.openFiles.indexOf(t);if(-1===c){l.splice(o,1,t),i({openFiles:l,activeTab:l.indexOf(t)});return}if(c===o){i((0,D._)((0,b._)({},r),{activeTab:l.indexOf(t)}));return}l.splice(c,1),l.splice(o,0,t);var s=l.indexOf(t);i({openFiles:l,activeTab:s});return}if(r.openFiles.includes(t)){i((0,D._)((0,b._)({},r),{activeTab:r.openFiles.indexOf(t)}));return}var u=r.openFiles.slice();if(a){var d=0===u.length?0:r.activeTab+1;u.splice(d,0,t),i({openFiles:u,activeTab:d});return}var f=r.activeTab;u.splice(f,1,t),i({openFiles:u,activeTab:f})},updateDeeplink:function(e){t.emit(f.DEEPLINK_CHANGED,e),n=e},getActiveFile:function(){var e=r.openFiles,t=r.activeTab;if(0!==e.length)return e[t]},getState:function(){return r}}}({openFile:eK}),tp=(0,B.Z)({container:tu,channelRequestPriority:null==e6?void 0:e6.fs}),tv=function(e){var t=e.container,n=e.onCommand,r=e.getColorForUser,i=(0,E.ZP)();i.setMaxListeners(1/0);var o=[],a=null,l=[],c={},s=null;function u(){return f.apply(this,arguments)}function f(){return(f=(0,y._)(function(){return(0,w.Jh)(this,function(e){return s?[2,s]:[2,new Promise(function(e){i.once(d.USERS_UPDATE,function(){if(!s)throw Error("Expected presenceChannel to be set");e(s)})})]})})).apply(this,arguments)}function h(e){I()(a,e)||(a=e,i.emit(d.FOLLOWED_USER_CHANGED,e))}function p(){return(p=(0,y._)(function(e){var t,n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:if((null==a?void 0:a.username)===e)throw Error("Already following user with username ".concat(e));if(!a)return[3,2];return[4,m()];case 1:r.sent(),r.label=2;case 2:return[4,u()];case 3:if(t=r.sent(),!(n=o.find(function(t){return t.username===e})))return[2];return h(n),n.sessions.forEach(function(e){t.send({followUser:{session:e.id}})}),[2]}})})).apply(this,arguments)}function m(){return v.apply(this,arguments)}function v(){return(v=(0,y._)(function(){var e,t;return(0,w.Jh)(this,function(n){switch(n.label){case 0:if(!a)throw Error("No user to unfollow");return e=a,h(null),[4,u()];case 1:return t=n.sent(),e.sessions.forEach(function(e){t.send({unfollowUser:{session:e.id}})}),[2]}})})).apply(this,arguments)}return t.openChannel({service:"presence",name:"presencer"},function(e){var t=e.channel;return t.onCommand(function(e){null==n||n(e);var t={cmd:e,emitter:i,activeUsers:o,userIdToFile:c,followedUser:a,setFollowedUser:h,followingUsers:l,getColorForUser:r};switch(e.body){case"roster":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.followedUser,a=e.followingUsers,l=e.setFollowedUser,c=e.getColorForUser,s=t.roster;if(s){var u=s.user,f=s.files;if(u&&f){var h=new Set;if(r.splice(0,r.length),u.forEach(function(e){if(!(!e.id||!e.name||!e.roles||h.has(e.id))){var t=f.filter(function(t){return t.userId===e.id}).map(function(e){if(!e.session||!e.timestamp)throw Error("Expected session and associated with user");return{id:e.session,activeFile:e.file||null,timestamp:(0,S.gs)(e.timestamp)}}),n=null==c?void 0:c({userId:e.id});r.push({id:e.id,username:e.name,roles:e.roles,color:null!=n?n:(0,S.i7)(r),sessions:t}),h.add(e.id)}}),r.forEach(function(e){i[e.id]=(0,S.f0)(e)}),n.emit(d.USERS_UPDATE,(0,_._)(r)),a.filter(function(e){return!r.some(function(t){return t.id===e.id})}).forEach(function(e){var t=a.indexOf(e);-1!==t&&(a.splice(t,1),n.emit(d.FOLLOWING_USERS_CHANGED,{followingUsers:(0,_._)(a),user:e,type:"unfollow"}))}),o){if(!r.some(function(e){return e.id===o.id})){l(null);return}var p=i[o.id];n.emit(d.USER_OPENED_FILE,{user:o,file:p})}}}}(t);break;case"join":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.getColorForUser,a=t.join;if(a.id&&a.name&&a.roles&&a.session){var l=r.find(function(e){return e.id===a.id}),c=Math.floor(Date.now()/1e3),s=k.google.protobuf.Timestamp.create({seconds:c}),u=(0,S.gs)(s);if(l)l.sessions.push({id:a.session,activeFile:null,timestamp:u});else{var f=null==o?void 0:o({userId:a.id}),h={id:a.id,username:a.name,roles:a.roles,color:null!=f?f:(0,S.i7)(r),sessions:[{id:a.session,activeFile:null,timestamp:u}]};i[a.id]=null,r.push(h),n.emit(d.USER_JOIN,h),n.emit(d.USERS_UPDATE,(0,_._)(r))}}}(t);break;case"part":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.followedUser,a=e.followingUsers,l=e.setFollowedUser;if(t.part&&t.part.id&&t.part.session){var c=t.part,s=c.id,u=c.session,f=r.findIndex(function(e){return e.id===s}),h=r[f];if(1===h.sessions.length){r.splice(f,1),delete i[h.id],n.emit(d.USER_LEAVE,h),n.emit(d.USERS_UPDATE,(0,_._)(r)),o&&l(null);var p=a.findIndex(function(e){return e.id===h.id});-1!==p&&(a.splice(p,1),n.emit(d.FOLLOWING_USERS_CHANGED,{followingUsers:(0,_._)(a),user:h,type:"unfollow"}))}else{h.sessions=h.sessions.filter(function(e){return e.id!==u});var m=(0,S.f0)(h);i[h.id]!==m&&(i[h.id]=m,n.emit(d.USER_OPENED_FILE,{user:h,file:m}))}}}(t);break;case"fileOpened":!function(e){var t=e.emitter,n=e.cmd,r=e.activeUsers,i=e.userIdToFile;if(n.fileOpened){var o=n.fileOpened,a=o.userId,l=o.file,c=o.timestamp,s=o.session,u=l||null;if(!a||!c)throw Error("Expected userId and timestamp associated with file opened command");var f=r.find(function(e){return e.id===a});if(!f)throw Error("Expected user with ID ".concat(a));var h=f.sessions.find(function(e){return e.id===s});if(!h)throw Error("Expected session with ID ".concat(h));h.activeFile=u,h.timestamp=(0,S.gs)(c),i[a]=u,t.emit(d.USER_OPENED_FILE,{user:f,file:u})}}(t);break;case"followUser":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.followingUsers,o=t.followUser;if(!o.session)throw Error("Expected session associated with follow user");var a=o.session,l=(0,S.N5)(a,r);i.some(function(e){return e.id===l.id})||(i.push(l),n.emit(d.FOLLOWING_USERS_CHANGED,{followingUsers:(0,_._)(i),user:l,type:"follow"}))}(t);break;case"unfollowUser":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.followingUsers,o=t.unfollowUser;if(!o.session)throw Error("Expected session associated with follow user");var a=o.session,l=(0,S.N5)(a,r),c=i.findIndex(function(e){return e.id===l.id});-1!==c&&(i.splice(c,1),n.emit(d.FOLLOWING_USERS_CHANGED,{followingUsers:(0,_._)(i),user:l,type:"unfollow"}))}(t);break;case"sessionTimestampUpdated":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=t.sessionTimestampUpdated;if(!o.session||!o.timestamp)throw Error("Expected session and tiemstamp associated with update");var a=o.session,l=(0,S.N5)(a,r),c=i[l.id],s=l.sessions.find(function(e){return e.id===a});if(!s)throw Error("Expected user ".concat(l.id," to have a session with ID ").concat(a));s.timestamp=(0,S.gs)(o.timestamp);var u=s.activeFile;u!==c&&(i[l.id]=u,n.emit(d.USER_OPENED_FILE,{user:l,file:u}))}(t)}}),s=t,function(){s=null}}),{onUserLeave:function(e){return i.on(d.USER_LEAVE,e),function(){i.removeListener(d.USER_LEAVE,e)}},onUserJoin:function(e){return i.on(d.USER_JOIN,e),function(){i.removeListener(d.USER_LEAVE,e)}},onActiveUsersChange:function(e){return i.on(d.USERS_UPDATE,e),function(){i.removeListener(d.USERS_UPDATE,e)}},onUserOpenedFile:function(e){return i.on(d.USER_OPENED_FILE,e),function(){i.removeListener(d.USER_OPENED_FILE,e)}},onFollowedUserChanged:function(e){return i.on(d.FOLLOWED_USER_CHANGED,e),function(){i.removeListener(d.FOLLOWED_USER_CHANGED,e)}},onFollowingUsersChanged:function(e){return i.on(d.FOLLOWING_USERS_CHANGED,e),function(){i.removeListener(d.FOLLOWING_USERS_CHANGED,e)}},getActiveFileForUser:function(e){var t=c[e];if(void 0===t)throw Error("Expected file for user with ID ".concat(e," to be defined"));return t},updateOpenFile:function(e){return(0,y._)(function(){return(0,w.Jh)(this,function(t){switch(t.label){case 0:return[4,u()];case 1:return t.sent().send({openFile:{file:e}}),[2]}})})()},updateSessionTimestamp:function(){return(0,y._)(function(){return(0,w.Jh)(this,function(e){switch(e.label){case 0:return[4,u()];case 1:return e.sent().send({updateSessionTimestamp:{}}),[2]}})})()},followUser:function(e){return p.apply(this,arguments)},unfollowUser:m,getActiveUsers:function(){return o},getFollowedUser:function(){return a},getFollowingUsers:function(){return l},getUserIdToFile:function(){return c},getPathToUserIds:function(){var e=new Map;return o.forEach(function(t){var n=t.id,r=c[n];r&&function t(n,r){if(""!==n){e.has(n)||e.set(n,[]);var i,o=e.get(n);if(!o)throw Error("Expected user Ids");o.some(function(e){return e===r})||(null===(i=e.get(n))||void 0===i||i.push(r),t((0,T.Il)(n),r))}}(r,n)}),e}}}({container:tu,onCommand:tr,getColorForUser:ta}),tg=(0,L.Z)({container:tu,fs:tp,channelRequestPriority:null==e6?void 0:e6.dotReplit}),tb=function(e){var t,n,r,i=e.container,o=(0,E.ZP)(),a=null;function l(){return c.apply(this,arguments)}function c(){return(c=(0,y._)(function(){return(0,w.Jh)(this,function(e){return a&&"open"===a.status?[2,a]:[2,new Promise(function(e){o.once(p.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}function s(){return u.apply(this,arguments)}function u(){return(u=(0,y._)(function(){return(0,w.Jh)(this,function(e){return[2,(0,q.Y)({container:i,service:"nix"})]})})).apply(this,arguments)}return i.openChannel({service:"nix"},function(e){var t=e.channel;return a=t,o.emit(p.CHANNEL_OPENED,t),function(){a=null}}),{searchPackages:(t=(0,y._)(function(e){var t,n,r,i;return(0,w.Jh)(this,function(o){switch(o.label){case 0:return[4,s()];case 1:return n=(t=Z._.apply(void 0,[o.sent(),2]))[0],r=t[1],[4,n.request({nixPackageSearchRequest:{query:e}})];case 2:if((i=o.sent()).channelClosed)return[2,{error:"Channel closed",packages:null}];if(r(),i.error)return[2,{error:i.error,packages:null}];if(!i.nixPackageSearchResponse)return[2,{error:"Response expected but none received",packages:null}];return[2,{packages:i.nixPackageSearchResponse.packages,error:null}]}})}),function(e){return t.apply(this,arguments)}),listPackages:(0,y._)(function(){var e,t,n,r;return(0,w.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=Z._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixPackageListRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",packages:null}];if(n(),r.error)return[2,{error:r.error,packages:null}];if(!r.nixPackageListResponse)return[2,{error:"Response expected but none received",packages:null}];return[2,{packages:r.nixPackageListResponse.packages,error:null}]}})}),getChannels:(0,y._)(function(){var e,t,n,r;return(0,w.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=Z._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixChannelsRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",channels:null}];if(n(),r.error)return[2,{error:r.error,channels:null}];if(!r.nixChannelsResponse)return[2,{error:"Response expected but none received",channels:null}];return[2,{channels:r.nixChannelsResponse.channels,error:null}]}})}),getLatestStableChannel:(0,y._)(function(){var e,t,n,r;return(0,w.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=Z._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixChannelLatestStableRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",channel:null}];if(n(),r.error)return[2,{error:r.error,channel:null}];if(!r.nixChannelLatestStableResponse)return[2,{error:"Response expected but none received",channel:null}];return[2,{channel:r.nixChannelLatestStableResponse.channel,error:null}]}})}),addPackages:(n=(0,y._)(function(e){var t;return(0,w.Jh)(this,function(n){switch(n.label){case 0:return[4,l()];case 1:return[4,n.sent().request({nixPackageAddRequest:{packages:e}})];case 2:if((t=n.sent()).channelClosed)return[2,"channel closed"];if(t.error)return[2,t.error];if(!t.nixPackageAddResponse)return[2,"response expected but non received"];return[2,null]}})}),function(e){return n.apply(this,arguments)}),removePackages:(r=(0,y._)(function(e){var t;return(0,w.Jh)(this,function(n){switch(n.label){case 0:return[4,l()];case 1:return[4,n.sent().request({nixPackageRemoveRequest:{packages:e}})];case 2:if((t=n.sent()).channelClosed)return[2,"channel closed"];if(t.error)return[2,t.error];if(!t.nixPackageRemoveResponse)return[2,"response expected but non received"];return[2,null]}})}),function(e){return r.apply(this,arguments)})}}({container:tu}),tw=(0,ne.Z)({container:tu,dotReplit:tg}),t_=(0,C.Z)({container:tu,forceTrace:tc,track:V.j}),tS=(r=(n={container:tu,fs:tp,openMultipleFiles:e1,openMultipleURLs:e8}).container,i=n.fs,o=n.openMultipleFiles,a=n.openMultipleURLs,l=new Set,c=!1,s=null,r.openChannel({service:"open"},function(e){e.channel.onCommand(function(e){if("replspaceApiOpenMultipleFiles"===e.body){if(!e.replspaceApiOpenMultipleFiles)throw Error("Expected replspaceApiOpenMultipleFiles");var t=e.replspaceApiOpenMultipleFiles,n=t.files,r=t.urls;o&&n.length>0&&(j(),o({paths:n})),a&&r.length>0&&(j(),a({urls:r}))}})}),r.openChannel({service:"git"},function(e){var t,n=e.channel;return n.onCommand((t=(0,y._)(function(e){var t,r,a,u,d,f,h,p,m,v,g,y,b,Z,x,C;return(0,w.Jh)(this,function(w){switch(w.label){case 0:switch(e.body){case"replspaceApiOpenFile":return[3,1];case"replspaceApiGetGitHubToken":return[3,7]}return[3,9];case 1:if(!e.replspaceApiOpenFile)throw Error("Expected replspaceApiOpenFile");if(r=(t=e.replspaceApiOpenFile).file,a=t.waitForClose,u=t.nonce,o)return[3,3];if(!r.endsWith(".git/COMMIT_EDITMSG"))return a&&n.send({replspaceApiCloseFile:{file:r,nonce:u}}),window.alert("tried to open ".concat(r," but failed")),[2];return d=window.prompt("Enter a commit message"),[4,i.writeFile(r,null!=d?d:"")];case 2:if(w.sent(),!a)return[2];return[3,5];case 3:if(j(),o({paths:[r]}),!a||!s)return[2];return[4,s(r)];case 4:w.sent(),w.label=5;case 5:return[4,i.flush()];case 6:if(w.sent(),"open"!==n.status)return[2];return n.send({replspaceApiCloseFile:{file:r,nonce:u}}),[2];case 7:if(!e.replspaceApiGetGitHubToken)throw Error("Expected replspaceApiGetGitHubToken");return f=function(){var t;"open"===n.status&&n.send({replspaceApiGitHubToken:{token:"",nonce:null===(t=e.replspaceApiGetGitHubToken)||void 0===t?void 0:t.nonce}})},[4,function(){return z.apply(this,arguments)}()];case 8:if(null==(h=w.sent()).gitHubInfo)return f(),[2];if(!l.size)return f(),O.kg.error("Got a replspaceApiGetGitHubToken command but no confirm listener is set up"),[2];if(p=function(){var t,r;"open"===n.status&&n.send({replspaceApiGitHubToken:{token:null===(t=h.gitHubInfo)||void 0===t?void 0:t.accessToken,nonce:null===(r=e.replspaceApiGetGitHubToken)||void 0===r?void 0:r.nonce}})},c)return p(),[2];m=!1,v=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=l[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)(0,r.value)(null)}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},g=!0,y=!1,b=void 0;try{for(Z=l[Symbol.iterator]();!(g=(x=Z.next()).done)&&(C=x.value,!m);g=!0)C(function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!m){if(m=!0,!e){f(),v();return}t&&(c=e),p(),v()}})}catch(e){y=!0,b=e}finally{try{g||null==Z.return||Z.return()}finally{if(y)throw b}}w.label=9;case 9:return[2]}})}),function(e){return t.apply(this,arguments)})),function(){}}),r.openChannel({service:"shelltracker"},function(e){e.channel.onCommand(function(e){null!=e.replspaceApiShellTracker&&(0,V.j)(V.U3.SHELL_COMMAND_EVALED,{context:e.replspaceApiShellTracker.cmd,api:"replspace",pwd:e.replspaceApiShellTracker.pwd})})}),{onConfirmSendToken:function(e){var t=function(t){return e(t)};return l.add(t),function(){l.delete(t)}},setWaitForFileClose:function(e){s=e}}),tT=(u=(0,y._)(function(e,t){var n;return(0,w.Jh)(this,function(r){var i;return n=(null==t?void 0:t.ctx)||na.D.active(),[2,(0,no.nO)(n,"beforeRun",(i=(0,y._)(function(n){var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y;return(0,w.Jh)(this,function(Z){switch(Z.label){case 0:return[4,(0,no.nO)(n,"toolchain.getConfigs",function(){return tw.getConfigs()})];case 1:if((r=Z.sent()).disableInstallBeforeRun)return[2];return i=(0,b._)({},t),delete i.ctx,td.emit("user:run:prerun",(0,b._)({runnerMode:eq},i)),[4,(0,no.nO)(n,"fs.flush",function(){return tp.flush({consistency:k.api.Flush.Consistency.Disk})})];case 2:if(Z.sent(),e&&e("prerun flush finished"),!(null==r?void 0:r.packagers))return[3,10];o=!0,a=!1,l=void 0,Z.label=3;case 3:Z.trys.push([3,8,9,10]),c=r.packagers[Symbol.iterator](),Z.label=4;case 4:if(o=(s=c.next()).done)return[3,7];if(!(u=s.value).guessImports)return[3,6];return d=performance.now(),f=r.disableGuessImports,[4,t_.installPackages(n,u.id,f)];case 5:h=Z.sent(),p=performance.now()-d,e&&(h.error?e("prerun packager install finished",{packagerId:u.id,language:u.language,errorMessage:h.error,success:!1}):(g=(v=(null==(m=h.value)?void 0:m.guessedPkgs)||[]).length,e("prerun packager install finished",{packagerId:u.id,language:u.language,guessedPkgs:v,guessedPkgsCount:g,guessedAnyPkgs:g>0,upmGuessDurationMs:null==m?void 0:m.upmGuessDurationMs,upmAddDurationMs:null==m?void 0:m.upmAddDurationMs,upmLockDurationMs:null==m?void 0:m.upmLockDurationMs,backendTotalDurationMs:null==m?void 0:m.totalDurationMs,frontendTotalDurationMs:p,success:!0}),g>0&&(0,V.j)(nt.U3.PACKAGER_PACKAGES_GUESSED,{packages:v}))),Z.label=6;case 6:return o=!0,[3,4];case 7:return[3,10];case 8:return y=Z.sent(),a=!0,l=y,[3,10];case 9:try{o||null==c.return||c.return()}finally{if(a)throw l}return[7];case 10:return td.emit("user:run:initiate",{}),[2]}})}),function(e){return i.apply(this,arguments)}))]})}),function(e,t){return u.apply(this,arguments)}),tI=(0,U.Z)({container:tu,beforeRun:tT}),tD=(0,nr.TE)({container:tu,dotReplit:tg,dotdevUrlEnabled:void 0!==tt&&tt,enableBetterPortHandling:void 0!==te&&te}),tG=(0,G.Z)({mode:eq,container:tu,toolchain:tw,beforeRun:tT,packager:t_,debuggest:tI}),tB=(g=(0,E.ZP)(),R=new Promise(function(e){return m=e}),X=null,M=new Map,tu.openChannel({service:"chat",name:"broadcaster"},function(e){var t=e.channel,n=e.context;return n.currentUser&&(X=n.currentUser.username),t.onCommand(function(e){if("chatMessage"===e.body){var t=e.chatMessage;if(!t||!t.username||!t.text)throw Error("unexpected broadcast without a message");g.emit(h.MESSAGE_RECEIVED,{text:t.text,username:t.username})}}),m(t),function(){R=new Promise(function(e){return m=e})}}),{broadcastMessage:function(e,t){var n=t.text;return(0,y._)(function(){var t,r,i,o,a,l,c,s,u,d;return(0,w.Jh)(this,function(f){switch(f.label){case 0:return[4,R];case 1:if(t=f.sent(),!X)throw Error("Cannot broadcast without as username. Is currentUser in context?");r={text:n,username:X},i=!0,o=!1,a=void 0;try{for(l=M[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)u=(s=(0,Z._)(c.value,2))[0],d=s[1],u!==e&&d(r)}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return t.send({chatMessage:r}),[2]}})})()},onBroadcastReceived:function(e,t){return M.set(e,t),g.on(h.MESSAGE_RECEIVED,t),function(){g.removeListener(h.MESSAGE_RECEIVED,t),M.delete(e)}}}),tP=function(e){var t=e.container,n=e.toolchain,r=e.fs,i=new Map,o=new Map,a={},l=!0;function c(e){var t=a[e];if(!t)throw Error("LSPNix: removeLanguage called with lspId never configured");var n=t.client;if(n){t.client=null,n.destroy();var r=!0,l=!1,c=void 0;try{for(var s,u=i[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var d=(0,Z._)(s.value,2),f=d[0],h=d[1];if(o.get(f)===n){o.delete(f);var p=!0,m=!1,v=void 0;try{for(var g,y=h[Symbol.iterator]();!(p=(g=y.next()).done);p=!0)(0,g.value)(null)}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}}}}catch(e){l=!0,c=e}finally{try{r||null==u.return||u.return()}finally{if(l)throw c}}}t.closeChannel(),delete a[e]}function s(e,t){if(a[e])throw Error("LSPNix: addLanguage called with lspId already configured");a[e]={client:null,option:t,closeChannel:function(){}},l&&f(e)}var u=new Map;function d(e){if(!l)return!1;var t=a[e];return!!t&&!t.client}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,y._)(function(e){var n,c,s,h,p,m,v,g,x=arguments;return(0,w.Jh)(this,function(C){switch(C.label){case 0:if(n=x.length>1&&void 0!==x[1]?x[1]:0,!l)throw Error("LSPNix: Called startClient while not enabled");if(!a[e])throw Error("LSPNix: No config found for lspId: ".concat(e));if(!u.get(e))return[3,2];return[4,u.get(e)];case 1:if(C.sent())return[2];C.label=2;case 2:if(s=(c=a[e]).client,c.closeChannel,h=c.option,s)throw Error("LSPNix: A previous client is already set for language: ".concat(e));return p=function(){},m=new Promise(function(e){p=e}),u.set(e,m),v=[],g=t.openChannel({service:"lsp2",skip:function(e){var t=e.repl.language,n=t.startsWith("nix")||t.startsWith("html");return n||(O.kg.error("Skipped opening lsp channel for non-nix repl",{language:t,appService:"lspnix"}),p(null)),!n}},function(c){var s=c.channel,m=null,x=!1,C=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!x){x=!0,t||(p(null),u.delete(e)),v.forEach(function(e){return e()}),null==m||m.destroy(),(null===(s=a[e])||void 0===s?void 0:s.client)===m&&(a[e].client=null),t&&l||g();var n=!0,r=!1,c=void 0;try{for(var s,d,f=i[Symbol.iterator]();!(n=(d=f.next()).done);n=!0){var h=(0,Z._)(d.value,2),y=h[0],b=h[1];if(o.get(y)===m){o.delete(y);var w=!0,C=!1,_=void 0;try{for(var k,S=b[Symbol.iterator]();!(w=(k=S.next()).done);w=!0)(0,k.value)(null)}catch(e){C=!0,_=e}finally{try{w||null==S.return||S.return()}finally{if(C)throw _}}}}}catch(e){r=!0,c=e}finally{try{n||null==f.return||f.return()}finally{if(r)throw c}}}};if("open"!==s.status){O.kg.error("LSPNix got a channel that wasn't open. This is expected to be impossible.",{lspId:e,appService:"lspnix"});return}var _=new Date;return s.request({startLSP:{languageServerId:e}}).then(function(c){if(!c.ok){O.kg.error("LSP server failed to start",{lspId:e,appService:"lspnix",serverError:c.error});return}if(l&&a[e]){v.push(s.onCommand(function(t){if(t.state===k.api.State.Stopped){var r;O.kg.error("LSP server unexpectedly disconnected",{lspId:e,appService:"lspnix"}),C(),l&&(r=n,new Date().getTime()-_.getTime()<5e3?r<3?setTimeout(function(){d(e)&&f(e,r+1)},1e3*Math.pow(2,r)):O.kg.error("LSP server is crash-looping. Giving up.",{lspId:e,appService:"lspnix"}):setTimeout(function(){d(e)&&f(e)}))}}));var g=0;eC(t,function(){return g++<5&&l&&ex(a[e].option,h)&&"open"===s.status}).then(function(t){if(!ex(a[e].option,h)){O.kg.info("LSPNix: configuration changed while getting working directory",{lspId:e,appService:"lspnix"});return}if("open"!==s.status){O.kg.error("LSPNix: channel wasn't open after getting working directory",{lspId:e,appService:"lspnix"});return}if(t.error){O.kg.error("LSPNix: failed to get working directory",{lspId:e,appService:"lspnix",originalError:null===(c=t.error)||void 0===c?void 0:c.message});return}if(m=function(e){var t,n=e.connection,r=e.isSupportedFile,i=e.clientId,o=e.clientName,a=e.getWorkspaceConfiguration,l=e.onWorkspaceConfigurationChange,c=e.applyWorkspaceEdit,s=(0,E.ZP)();s.setMaxListeners(1/0);var u=null,d=Q.a.OFFLINE,f=Q.N.NOT_READY,h=null,p=!1,m=new Map,v=new Map,g=null;function Z(e){if(!u)throw Error("Expected rootUri");var t=e.slice(u.length+1);try{return decodeURIComponent(t)}catch(e){throw A.$e(function(n){n.setExtra("fragment_to_decode",t),A.Tb(e)}),e}}function x(e){if(!u)throw Error("Expected rootUri");if(e.startsWith("/"))throw Error("Path must be relative. Got: ".concat(e));return u+"/"+e}function C(e){d!==e&&(d!==Q.a.INITIALIZED&&_(Q.N.NOT_READY),d=e,s.emit("SERVER_STATE_CHANGE",d))}function _(e){f!==e&&(f=e,s.emit("SERVER_HEALTH_CHANGE",f))}function k(e){s.emit("SEND_NOTIFICATION",e),n.write(eb(e))}function S(e){return T.apply(this,arguments)}function T(){return(T=(0,y._)(function(e){var t,r,o,a,l,c,u,f;return(0,w.Jh)(this,function(h){if(a=void 0===(o=(r=void 0===(t=e.options)?{}:t).id)?ey():o,l=r.signal,c=r.tap,u=(0,en._)(e,["options"]),!Number.isInteger(a))throw Error("Request ID must be an integer");return n.didClose()?[2,Promise.resolve({result:null,cancelled:!0})]:(s.emit("REQUEST",{id:a,data:u}),null==l||l.addEventListener("abort",function(){G(a)},{once:!0}),n.write(eb((0,D._)((0,b._)({},u),{id:a}))),null===g&&(g=setTimeout(function(){_(Q.N.STALLED)},3e4)),f=new Promise(function(e){v.set(a,e)}),c&&c(f),[2,f.then(function(e){return null!==g&&(clearTimeout(g),g=null),d!==Q.a.INITIALIZED||e.cancelled||_(Q.N.READY),(function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=ef[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.supports(e))return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return new eh})(i).onResponse(u.method,e)})])})})).apply(this,arguments)}function R(e,t){n.write(eb((0,D._)((0,b._)({},t),{id:e})))}function G(e){var t=v.get(e);t&&(s.emit("CANCEL_REQUEST",e),t({result:null,cancelled:!0}),v.delete(e),k({method:"$/cancelRequest",params:{id:e}}))}var B=new ea.s(function(e){var t=v.get(e.id);if(e.id&&t){v.delete(e.id);var n=e.result,r=e.error;if((void 0!==n||r)&&s.emit("RESPONSE",e),void 0!==n){t({result:n,cancelled:!1});return}if(r){var o=r.code,l=r.message,u=r.data;O.kg.error("LSP request failed",{code:o,lspId:i,errorMessage:l,data:JSON.stringify(u)}),t({error:r});return}throw O.kg.error("LSP response message contained neither error nor result"),new es.Z("Expected either message or error in LSP response").setExtra("message",JSON.stringify(e))}var d=e.method;if("client/registerCapability"===d){var f=e.params.registrations;if(!f||!Array.isArray(f))throw Error("Expected registrations array");f.forEach(function(e){var t=e.method;if(!t)throw Error("Expected registration method");if(!h)throw Error("Expected server capabilities");var n=e.registerOptions||!0;switch(t){case"textDocument/definition":h.definitionProvider=!0;break;case"textDocument/typeDefinition":h.typeDefinitionProvider=!0;break;case"textDocument/implementation":h.implementationProvider=!0;break;case"textDocument/references":h.referencesProvider=!0;break;case"textDocument/hover":h.hoverProvider=!0;break;case"textDocument/completion":h.completionProvider=n;break;case"textDocument/formatting":h.documentFormattingProvider=n;break;case"textDocument/rename":h.renameProvider=n;break;case"textDocument/codeAction":h.codeActionProvider=n;break;case"textDocument/signatureHelp":h.signatureHelpProvider=n;break;case"textDocument/didSave":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,D._)((0,b._)({},h.textDocumentSync||{}),{save:n});break;case"textDocument/willSaveWaitUntil":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,D._)((0,b._)({},h.textDocumentSync||{}),{willSave:!0});break;case"textDocument/didChange":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,D._)((0,b._)({},h.textDocumentSync||{}),{change:n});break;case"textDocument/didOpen":case"textDocument/didClose":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,D._)((0,b._)({},h.textDocumentSync||{}),{openClose:!0});break;case"workspace/executeCommand":h.executeCommandProvider=n;break;default:O.kg.info("Unexpected dynamically registered capability in LSP client",{method:t})}s.emit("SERVER_CAPABILITIES_CHANGE",h)}),R(e.id,{result:null,cancelled:!1});return}if("workspace/applyEdit"===d){var p=c(e.params);R(e.id,{result:p,cancelled:!1});return}if("textDocument/publishDiagnostics"===d){var g=Z(e.params.uri),y=m.get(g);if(!y)return;var w=e.params.diagnostics;if(I()(y.diagnostics,w))return;y.diagnostics=w,s.emit("DIAGNOSTICS",{path:g,diagnostics:w});return}if("workspace/configuration"===d){var x,C=e.params,_=Array(C.items.length).fill(null),k=null!==(x=null==a?void 0:a())&&void 0!==x?x:null;k&&(_=C.items.map(function(e){return e.section?ec()(k,e.section):k})),R(e.id,{result:_,cancelled:!1})}});function P(e){if(!h)throw Error("Expected client to be initialized");if(!h[e])throw Error("LSP Server does not support ".concat(e.replace(/Provider$/,"")));return h[e]}function N(e){return u&&e?e.filter(function(e){return"uri"in e?e.uri.startsWith(u):e.targetUri.startsWith(u)}):e}n.read(B.read);var U=function(){};return{initialize:function(e){var n=e.pwd,r=e.initializationOptions;return(0,y._)(function(){var e,i;return(0,w.Jh)(this,function(o){switch(o.label){case 0:return C(Q.a.INITIALIZING),u="file://".concat(n),[4,S({method:"initialize",params:{initializationOptions:r,capabilities:eo({configurationSupport:{serverToClient:!!a,clientToServer:!!l}}),processId:null,rootUri:u,workspaceFolders:[{name:u,uri:u}]}})];case 1:if("error"in(e=o.sent()))throw Error("Something went wrong initializing the LSP client: ".concat(e.error.message));if(e.cancelled)throw Error("Initialize request cancelled");if(!e.result)throw Error("Expected result in initialize request");return k({method:"initialized",params:{}}),h=e.result.capabilities,t=e.result.serverInfo,s.emit("SERVER_CAPABILITIES_CHANGE",h),C(Q.a.INITIALIZED),l&&(U=l(function(e){k({method:"workspace/didChangeConfiguration",params:{settings:e}})})),a&&(i=a())&&k({method:"workspace/didChangeConfiguration",params:{settings:i}}),[2]}})})()},generateId:ey,notify:{didOpen:function(e,t){if(!r(e))throw Error("Path not supported");var n,o=m.get(e);if(o&&0!==o.buffers){o.buffers++,m.set(e,o);return}var a=null!==(n=null==o?void 0:o.version)&&void 0!==n?n:0;m.set(e,{version:a,buffers:1,diagnostics:[]}),k({method:"textDocument/didOpen",params:{textDocument:{uri:x(e),languageId:ev(e,i),text:t,version:a}}})},didChange:function(e,t){var n=m.get(e);if(!n)throw Error('Document for "'.concat(e,'" is not open'));n.version++,k({method:"textDocument/didChange",params:{textDocument:{uri:x(e),version:n.version},contentChanges:t}})},didSave:function(e){if(!m.get(e))throw Error('Document for "'.concat(e,'" is not open'));P("textDocumentSync"),k({method:"textDocument/didSave",params:{textDocument:{uri:x(e)}}})},didClose:function(e){var t=m.get(e);if(!t)throw Error('Document for "'.concat(e,'" is not open'));t.buffers--,t.buffers>0||(k({method:"textDocument/didClose",params:{textDocument:{uri:x(e)}}}),m.delete(e))},cancelRequest:function(e){G(e)}},request:{completion:function(e,t,n,r){return P("completionProvider"),S({options:r,method:"textDocument/completion",params:{textDocument:{uri:x(e)},position:t,context:n}})},resolveCompletionItem:function(e){if(!P("completionProvider").resolveProvider)throw Error("LSP Server does not support resolving completion items");return S({method:"completionItem/resolve",params:e})},signatureHelp:function(e,t,n){return S({options:n,method:"textDocument/signatureHelp",params:{textDocument:{uri:x(e)},position:t}})},hover:function(e,t,n){return S({options:n,method:"textDocument/hover",params:{textDocument:{uri:x(e)},position:t}})},codeActions:function(e,t){var n=m.get(e);if(!n)throw Error("Document for path ".concat(e," is not open."));var r=n.diagnostics.filter(function(e){var n;return eg((n=e.range).start,t.end)&&eg(t.start,n.end)});return S({method:"textDocument/codeAction",params:{textDocument:{uri:x(e)},range:t,context:{diagnostics:r}}})},executeCommand:function(e,t){return S({method:"workspace/executeCommand",params:{command:e,arguments:t}})},format:function(e,t){return P("documentFormattingProvider"),S({method:"textDocument/formatting",params:{textDocument:{uri:x(e)},options:t}})},findDefinitions:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,y._)(function(){var i,o;return(0,w.Jh)(this,function(a){switch(a.label){case 0:return P("definitionProvider"),[4,S({options:n,method:"textDocument/definition",params:{textDocument:{uri:x(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=N(Array.isArray(o)?o:[o])),[2,(0,D._)((0,b._)({},i),{result:o})]}})})()},findTypeDefinitions:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,y._)(function(){var i,o;return(0,w.Jh)(this,function(a){switch(a.label){case 0:return P("typeDefinitionProvider"),[4,S({options:n,method:"textDocument/typeDefinition",params:{textDocument:{uri:x(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=N(Array.isArray(o)?o:[o])),[2,(0,D._)((0,b._)({},i),{result:o})]}})})()},findImplementations:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,y._)(function(){var i,o;return(0,w.Jh)(this,function(a){switch(a.label){case 0:return P("implementationProvider"),[4,S({options:n,method:"textDocument/implementation",params:{textDocument:{uri:x(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=N(Array.isArray(o)?o:[o])),[2,(0,D._)((0,b._)({},i),{result:o})]}})})()},findReferences:function(e,t,n){return P("referencesProvider"),S({method:"textDocument/references",params:{textDocument:{uri:x(e)},position:t,context:n}})},rename:function(e,t,n,r){return P("renameProvider"),S({options:r,method:"textDocument/rename",params:{textDocument:{uri:x(e)},position:t,newName:n}})},prepareRename:function(e,t){var n=P("renameProvider");if("boolean"==typeof n||!n.prepareProvider)throw Error("LSP server does not support prepare rename");return S({method:"textDocument/prepareRename",params:{textDocument:{uri:x(e)},position:t}})},documentHighlights:function(e,t,n){return(0,y._)(function(){return(0,w.Jh)(this,function(r){switch(r.label){case 0:return[4,S({options:n,method:"textDocument/documentHighlight",params:{position:t,textDocument:{uri:x(e)}}})];case 1:return[2,r.sent()]}})})()},documentSymbol:function(e,t){return(0,y._)(function(){var n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:return[4,S({options:t,method:"textDocument/documentSymbol",params:{textDocument:{uri:x(e)}}})];case 1:if(!("result"in(n=r.sent())))return[2,n];if(n.result)return[2,{result:n.result,cancelled:!1}];return[2]}})})()}},onDiagnostics:(0,E.JV)(s,"DIAGNOSTICS"),onServerStateChange:(0,E.JV)(s,"SERVER_STATE_CHANGE"),onServerHealthChange:(0,E.JV)(s,"SERVER_HEALTH_CHANGE"),onServerCapabilitiesChange:(0,E.JV)(s,"SERVER_CAPABILITIES_CHANGE"),onRequest:(0,E.JV)(s,"REQUEST"),onResponse:(0,E.JV)(s,"RESPONSE"),onCancelRequest:(0,E.JV)(s,"CANCEL_REQUEST"),onSendNotification:(0,E.JV)(s,"SEND_NOTIFICATION"),shutdown:function(){for(var e in C(Q.a.EXITING),m.clear(),v)G(Number(e));U(),S({method:"shutdown"}).then(function(){k({method:"exit"}),C(Q.a.EXITED),s.removeAllListeners()})},isDestroyed:function(){return p},destroy:function(){for(var e in p=!0,m.clear(),v)G(Number(e));U(),C(Q.a.EXITED),s.removeAllListeners()},getServerState:function(){return d},getServerHealth:function(){return f},getServerCapabilities:function(){return h},getServerInfo:function(){return t},getDiagnostics:function(e){var t=m.get(e);if(!t)throw Error("File with path ".concat(e," is not open."));return t.diagnostics},isOpen:function(e){return m.has(e)},documentUriToPath:Z,pathToDocumentURI:x,isSupportedFile:r,getLanguageId:function(e){return ev(e,i)},clientId:i,clientName:o}}({connection:{read:function(e){"open"===s.status&&s.onCommand(function(t){t.output&&e(t.output)})},write:function(e){if("open"!==s.status){(null==m?void 0:m.isDestroyed())&&O.kg.error("LSPNix: tried to write to channel but the lsp client is already destroyed");return}s.send({input:e})},didClose:function(){return"open"!==s.status}},clientId:e,clientName:a[e].option.name,isSupportedFile:function(e){return(0,ew.F)(e,h)},applyWorkspaceEdit:function(e){var t=e.edit;return m?(0,eZ.w)({edit:t,fs:r,client:m}):{applied:!1}},getWorkspaceConfiguration:function(){if(!(null===(e=h.config)||void 0===e?void 0:e.configurationJson))return null;var e,t=null;try{t=JSON.parse(h.config.configurationJson)}catch(e){O.kg.error("Failed to parse LSP workspace configuration",{configurationJson:h.config.configurationJson})}return t}}),null===(l=h.config)||void 0===l?void 0:l.initializationOptionsJson)try{d=JSON.parse(h.config.initializationOptionsJson)}catch(e){O.kg.error("Failed to parse LSP initializationOptions",{initializationOptionsJson:h.config.initializationOptionsJson})}var n,l,c,d,f=m.initialize({pwd:t.workingDirectory,initializationOptions:d}).catch(function(t){if((null==t?void 0:t.message)!=="Initialize request cancelled")throw O.kg.error("LSPNix: failed to initialize client",{lspId:e,appService:"lspnix",originalError:null==t?void 0:t.message}),t});v.push(m.onServerStateChange((n=(0,y._)(function(t){var n,r,l,c,d,v,g,y,b,x,_,k,S;return(0,w.Jh)(this,function(w){switch(w.label){case 0:if("open"!==s.status)return O.kg.info("LSPNix: channel wasn't open on state change",{lspId:e,appService:"lspnix",state:t}),C(),[2];if(!m)return O.kg.info("LSPNix: client was null on state change. This should never happen",{lspId:e,appService:"lspnix",state:t}),C(),[2];if(!ex(a[e].option,h))return O.kg.info("LSPNix: configuration changed and received state change",{lspId:e,appService:"lspnix",state:t}),C(),[2];if(t===Q.a.EXITED)return O.kg.info("LSP server exited via 'exit' notification",{lspId:e,appService:"lspnix"}),C(),[2];if(t!==Q.a.INITIALIZED)return[2];return[4,f];case 1:if(w.sent(),"open"!==s.status)return O.kg.info("LSPNix: channel wasn't open after initialization",{lspId:e,appService:"lspnix"}),C(),[2];p(m),u.delete(e),a[e].client=m,n=!0,r=!1,l=void 0;try{for(c=i[Symbol.iterator]();!(n=(d=c.next()).done);n=!0)if(g=(v=(0,Z._)(d.value,2))[0],y=v[1],!(!(0,ew.F)(g,h)||o.has(g))){o.set(g,m),b=!0,x=!1,_=void 0;try{for(k=y[Symbol.iterator]();!(b=(S=k.next()).done);b=!0)(0,S.value)(m)}catch(e){x=!0,_=e}finally{try{b||null==k.return||k.return()}finally{if(x)throw _}}}}catch(e){r=!0,l=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw l}}return[2]}})}),function(e){return n.apply(this,arguments)})))})}}),function(e){C(e.willReconnect)}}),a[e].closeChannel=g,[2]}})})).apply(this,arguments)}function p(e){var t=null==e?void 0:e.languageServers;if(!t||0===t.length){var n=!0,r=!1,i=void 0;try{for(var o,l=Object.keys(a)[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var u=o.value;c(u)}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return}var d={},f=!0,h=!1,p=void 0;try{for(var m,v=t[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;d[g.id]=g}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}var y=!0,b=!1,Z=void 0;try{for(var w,x=Object.keys(a)[Symbol.iterator]();!(y=(w=x.next()).done);y=!0){var C=w.value;d[C]||c(C)}}catch(e){b=!0,Z=e}finally{try{y||null==x.return||x.return()}finally{if(b)throw Z}}var _=!0,k=!1,S=void 0;try{for(var E,T=Object.keys(d)[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){var R=E.value,I=a[R],D=d[R];if(!I){s(R,D);continue}ex(I.option,D)||(c(R),s(R,D))}}catch(e){k=!0,S=e}finally{try{_||null==T.return||T.return()}finally{if(k)throw S}}}function m(){return(m=(0,y._)(function(){var e;return(0,w.Jh)(this,function(t){try{e=n.configs.current,p(e),n.configs.subscribe(p)}catch(e){O.kg.error("LSP initialization failed: "+e.message)}return[2]})})).apply(this,arguments)}return!function(){m.apply(this,arguments)}(),{disable:function(){if(l){l=!1;var e=!0,t=!1,n=void 0;try{for(var r,c=Object.values(a)[Symbol.iterator]();!(e=(r=c.next()).done);e=!0){var s=r.value;s.closeChannel(),null===(h=s.client)||void 0===h||h.destroy(),s.client=null;var u=!0,d=!1,f=void 0;try{for(var h,p,m=i[Symbol.iterator]();!(u=(p=m.next()).done);u=!0){var v=(0,Z._)(p.value,2),g=v[0],y=v[1];if(o.has(g)){o.delete(g);var b=!0,w=!1,x=void 0;try{for(var C,_=y[Symbol.iterator]();!(b=(C=_.next()).done);b=!0)(0,C.value)(null)}catch(e){w=!0,x=e}finally{try{b||null==_.return||_.return()}finally{if(w)throw x}}}}}catch(e){d=!0,f=e}finally{try{u||null==m.return||m.return()}finally{if(d)throw f}}}}catch(e){t=!0,n=e}finally{try{e||null==c.return||c.return()}finally{if(t)throw n}}}},enable:function(){if(!l){l=!0;var e=!0,t=!1,n=void 0;try{for(var r,i=Object.keys(a)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;f(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},onClient:function(e,t){i.has(e)||i.set(e,[]),null===(s=i.get(e))||void 0===s||s.push(t);var n=o.get(e);if(n)t(n);else{var r=!0,l=!1,c=void 0;try{for(var s,u,d=Object.values(a)[Symbol.iterator]();!(r=(u=d.next()).done);r=!0){var f=u.value;if((0,ew.F)(e,f.option)){f.client&&t(f.client);break}}}catch(e){l=!0,c=e}finally{try{r||null==d.return||d.return()}finally{if(l)throw c}}}return function(){var n,r=null!==(n=i.get(e))&&void 0!==n?n:[];i.set(e,r.filter(function(e){return e!==t}))}}}}({container:tu,toolchain:tw,fs:tp}),tA=(W=(F={container:tu,beforeRun:tT}).container,H=F.beforeRun,J=(0,E.ZP)(),ee=$.Z.Idle,et=new Date(0),er=!1,J.on($.z.TEST_RESULT,function(e){er=er&&"passed"===e.body}),ei=function(e){J.emit($.z.STATE_CHANGED,e),ee=e},el=(0,y._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f;return(0,w.Jh)(this,function(h){switch(h.label){case 0:if(n=Y.api.Payload.fromObject(t),r=Y.api.Payload.verify(n))throw r;return i=new(K())(function(e){var t=Y.api.Response.fromObject(e),r=Y.api.Response.verify(t);if(r){A.Tb(TypeError("invalid payload received"),function(i){return i.setExtras({validationError:r,payload:n,message:e,response:t})});return}switch(t.body){case"error":return J.emit($.z.ERROR,t.error);case"instructionResult":return J.emit($.z.INSTRUCTION_RESULT,t.instructionResult);case"testResult":return J.emit($.z.TEST_RESULT,t.testResult);case"status":switch(t.status){case Y.api.Status.Ready:return ei($.Z.Ready);case Y.api.Status.Building:return ei($.Z.Building);case Y.api.Status.Running:return ei($.Z.Running)}}}),o=e.onCommand(function(e){if(e.output)try{i.submit(e.output)}catch(t){A.Tb(SyntaxError("invalid response received from i/o testing binary"),function(r){return r.setExtras({err:t,payload:n,cmd:e})})}}),a=e.request({exec:{args:["io-tester"],splitStderr:!0,lifecycle:k.api.Exec.Lifecycle.STDIN,splitLogs:!0}}),[4,new Promise(function(e,t){var n,r=function(){n(),e()};J.once($.z.STATE_CHANGED,r);var i=setTimeout(function(){n(),t(Error("timeout while waiting for iotester to start"))},2e4);n=function(){clearTimeout(i),J.off($.z.STATE_CHANGED,r)}})];case 1:return h.sent(),[4,e.request({input:JSON.stringify(n)+"\n"})];case 2:if(!(l=h.sent()).ok)throw s=Error(null!==(c=l.error)&&void 0!==c?c:"unexpected error occurred while sending input to i/o testing binary"),A.Tb(s,function(e){return e.setExtra("status",l)}),s;return[4,a];case 3:return(u=h.sent()).ok||(f=Error(null!==(d=u.error)&&void 0!==d?d:"unexpected error occurred while executing i/o testing binary"),A.Tb(f,function(e){return e.setExtra("result",u)})),o(),[2]}})}),{run:function(e){if(ee!==$.Z.Idle)throw Error("iotester already running");return ei($.Z.Starting),et=new Date,er=!0,H().then(function(){return new Promise(function(t){var n=W.openChannel({service:"exec"},function(r){var i="",o="",a=r.channel.onCommand(function(e){e.log?i+=e.log:e.stderr&&(o+=e.stderr)});return t((function(e,t){return el.apply(this,arguments)})(r.channel,e).finally(function(){a(),n(),(o||i)&&A.Tb(Error("logs received from IOTester"),function(t){return t.setExtras({logs:i,stderr:o,payload:e})})})),n})})}).catch(function(e){return er=!1,Promise.reject(e)}).finally(function(){return ei($.Z.Idle)})},get lastRunAt(){return et},get state(){return ee},get lastRunDidPass(){return er},onInstructionResult:function(e){return J.on($.z.INSTRUCTION_RESULT,e),function(){J.off($.z.INSTRUCTION_RESULT,e)}},onStateChanged:function(e){return J.on($.z.STATE_CHANGED,e),function(){J.off($.z.STATE_CHANGED,e)}},onTestResult:function(e){return J.on($.z.TEST_RESULT,e),function(){J.off($.z.TEST_RESULT,e)}},onError:function(e){return J.on($.z.ERROR,e),function(){J.off($.z.ERROR,e)}}}),tU=(ed=(eu={container:tu,fs:tp}).container,ep=eu.fs,e_=void 0===(em=eu.provideProfiles)?tN:em,(eE=(0,E.ZP)()).setMaxListeners(1/0),eT=tL(),eI=!1,eP=new Map,eN=null,eU=ed.getContext(),eF=new tQ({container:ed,getEnv:function(){return eT},awaitPromise:(eL=(0,y._)(function(e){var t,n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:return[4,e_({defaultUsername:null==eU?void 0:null===(t=eU.currentUser)||void 0===t?void 0:t.username,defaultUserId:null==eU?void 0:null===(n=eU.currentUser)||void 0===n?void 0:n.id,onProfiles:function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=(0,Z._)(o.value,2),c=l[0],s=l[1];eP.set(c,s),eE.emit(eG.dq.NEW_PROFILE)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t.has(eG.rG.GITHUB)||eP.delete(eG.rG.GITHUB);var u=eP.get(eG.rG.REPLIT_DEFAULT),d=eP.get(eG.rG.GITHUB);if(eN&&!e&&(e=eN.provider),e===eG.rG.GITHUB&&d)eN=d;else{if(!u)return;eN=u}eE.emit(eG.dq.CHANGED_PROFILE)}})];case 1:return[2,r.sent()]}})}),eX=function(e){return eL.apply(this,arguments)})(eG.rG.GITHUB)}),eE.on(eG.dq.FS_CHANGE,function(){return eF.cache.invalidate()}),eE.on(eG.dq.FORCED_REFRESH,function(){return eF.cache.invalidate()}),eE.on(eG.dq.NEW_PROFILE,function(){return eF.cache.invalidate()}),eE.on(eG.dq.CHANGED_PROFILE,function(){return eF.cache.invalidate()}),eE.on(eG.dq.CHANGED_PROFILE,function(){null!=eN&&(eT=tL({author:{username:eN.username,email:eN.email}}))}),{getEnv:function(){return eT},getProfiles:function(){return Array.from(eP.values())},hasProfile:function(e){return eP.has(e)},getProfile:function(e){var t=eP.get(e);if(!t)throw Error("Fetched a profile that has not been setup!");return t},addProfile:function(e){eP.set(e.provider,e),eE.emit(eG.dq.NEW_PROFILE)},getCurrentProfile:function(){return eN},setCurrentProfile:function(e){var t=eP.get(e);if(!t)throw Error("Can't set a non-existent profile!");eN=t,eT=tL({author:{username:t.username,email:t.email}}),eE.emit(eG.dq.CHANGED_PROFILE)},onProfileAdded:function(e){var t=function(){e(Array.from(eP.values()))};return eE.on(eG.dq.NEW_PROFILE,t),function(){eE.off(eG.dq.NEW_PROFILE,t)}},onCurrentProfileChanged:function(e){var t=function(){e(eN)};return eE.on(eG.dq.CHANGED_PROFILE,t),function(){eE.off(eG.dq.CHANGED_PROFILE,t)}},refreshProfiles:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preferredProvider;return eX(e)},onRefresh:function(e){eI||(function(e,t,n){var r,i,o,a,l,c,s,u,d,f,h=!1,p=!1,m=(r=function(){return n.emit(eG.dq.FS_CHANGE)},a=(i={wait:1e3,cooldown:5e3,maxWait:5e3}).wait,l=i.cooldown,c=i.maxWait,s=null,u=!1,d=eQ()(function(e){return s=setTimeout(function(){return s=null},l),u=!1,o=r.apply(void 0,(0,_._)(e))},a,{maxWait:c}),(f=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null!==s?o:(u||(u=!0),d(t))}).cancel=function(){null!==s?(clearTimeout(s),s=null):(d.cancel(),u=!1)},f.flush=function(){return null!==s?(clearTimeout(s),s=null,o):d.flush()},f.isPending=function(){return u},f.isInCooldown=function(){return null!==s},f);function v(){return(v=(0,y._)(function(){var n;return(0,w.Jh)(this,function(r){return n=!0,t.watchDir(tX.Ql,{onChange:function(r){!h&&r.find(function(e){return e.filename===tF&&e.type===tM.Tv.Directory})&&(function(){if(!h){h=!0;var n=!0;t.watchDir(tF,{onChange:function(){n?n=!1:m()},onMoveOrDelete:function(){h=!1,m()},onError:function(t,n){h=!1,RegExp(".+permission denied","im").test(t.message)||e.unrecoverableError(t,n)}})}}(),n||m()),n&&(n=!1)},onError:function(t,n){return e.unrecoverableError(t,n)}}),[2]})})).apply(this,arguments)}(function(){v.apply(this,arguments)})(),t.onStatusChange(function(e){h&&(e===tM.kO.Syncing&&m.isInCooldown()?p=!0:e===tM.kO.Clean&&(p||m(),p=!1))})}(ed,ep,eE),eI=!0);var t=function(){return e(eG.dq.FS_CHANGE)},n=function(){return e(eG.dq.FORCED_REFRESH)},r=function(){return e(eG.dq.NEW_PROFILE)},i=function(){return e(eG.dq.CHANGED_PROFILE)};return eE.on(eG.dq.FS_CHANGE,t),eE.on(eG.dq.FORCED_REFRESH,n),eE.on(eG.dq.NEW_PROFILE,r),eE.on(eG.dq.CHANGED_PROFILE,i),function(){eE.off(eG.dq.FS_CHANGE,t),eE.off(eG.dq.FORCED_REFRESH,n),eE.off(eG.dq.NEW_PROFILE,r),eE.off(eG.dq.CHANGED_PROFILE,i)}},forceRefresh:function(){eE.emit(eG.dq.FORCED_REFRESH)},isBusy:function(){return eF.running.current},onBusyChange:function(e){var t=!1,n=eQ()(e,200);return eF.running.subscribe(function(e){t&&!e?(n(!1),t=!1):!t&&e&&(n(!0),t=!0)})},init:eF.wrap(th,"write"),isInitialized:eF.wrap(tm,"read"),lsFiles:eF.wrap(tZ,"read"),status:eF.wrap(eY.Z,"read"),log:eF.wrap(ty,"read"),findDefaultBranches:eF.wrap(tn,"read"),listBranches:eF.wrap(ti.ZP,"read"),setBranchUpstream:eF.wrap(t0,"write"),stageFiles:eF.wrap(tR,"write"),commit:eF.wrap(e2,"write"),switchBranch:eF.wrap(e4,"write"),branchExists:eF.wrap(eO,"read"),createBranch:eF.wrap(e5,"write"),getRemotes:eF.wrap(ts,"read"),fetch:eF.wrap(e9,"write"),canMergeBranches:eF.wrap(eM,"read"),pull:eF.wrap(tx.Z,"write"),push:eF.wrap(tC,"write"),getRepositoryState:eF.wrap(eD.ZP,"read"),getFileContents:eF.wrap(tl,"read"),addRemote:eF.wrap(e0,"write"),removeRemote:eF.wrap(tk,"write"),setRemoteURL:eF.wrap(tE,"write"),getBranch:eF.wrap(to,"read"),restoreFiles:eF.wrap(e$,"write"),lastFetched:eF.wrap(eA,"read"),merge:eF.wrap(eW,"write"),mergeContinue:eF.wrap(ej,"write"),mergeAbort:eF.wrap(eV,"write"),getConflictingFiles:eF.wrap(eR,"read"),getMergingRefs:eF.wrap(eB,"read"),getFilesForCommit:eF.wrap(t9,"read")}),tO=function(e){var t,n,r=e.container,i=e.nixService;function o(e){return a.apply(this,arguments)}function a(){return(a=(0,y._)(function(e){return(0,w.Jh)(this,function(t){switch(t.label){case 0:if(e&&(n=void 0),!n){var r;n=new Promise((r=(0,y._)(function(e){var t,n;return(0,w.Jh)(this,function(r){switch(r.label){case 0:return[4,i.listPackages()];case 1:if(null==(n=r.sent())?void 0:null===(t=n.packages)||void 0===t?void 0:t.some(function(e){return"pkgs.postgresql"===e.name}))return[3,3];return[4,i.addPackages(["pkgs.postgresql"])];case 2:return r.sent(),e(),[3,4];case 3:e(),r.label=4;case 4:return[2]}})}),function(e){return r.apply(this,arguments)}))}return[4,n];case 1:return t.sent(),[2]}})})).apply(this,arguments)}return{ensureNixPsqlPackageInstalled:o,run:(t=(0,y._)(function(e){var t,n,i,a,l,c,s,u,d,f,h,p,m;return(0,w.Jh)(this,function(v){switch(v.label){case 0:return t=e.query,n=e.connectionString,[4,o()];case 1:v.sent(),i=(0,P.Z)({container:r}),a=[],l=null,c=new N.t(function(e){return a.push(e)}),s=null,u=!1,d=new Promise(function(e){var t=i.onStateChanged(function(n){var r=n.state,i=n.stderrBuffer;if(r===k.api.State.Running){u=!0;return}u&&(s=i,t(),e())})}),i.onOutput(function(e){try{c.process(e)}catch(t){l||(l=t,A.Tb(t,function(t){return t.setExtra("chunk",e)}))}}),v.label=2;case 2:return v.trys.push([2,,5,6]),[4,i.request({args:["psql",n,"--csv","--command",t],splitStderr:!0})];case 3:return f=v.sent(),[4,d];case 4:return v.sent(),f.error&&!s&&(s=f.error),c.flush(),[3,6];case 5:return i.dispose(),[7];case 6:if(s)return[2,{columns:c.headers(),rows:a,error:s}];if(l)return h=l.message,[2,{columns:null!==(p=c.headers())&&void 0!==p?p:[],rows:a,error:h}];return[2,{columns:null!==(m=c.headers())&&void 0!==m?m:[],rows:a,error:null}]}})}),function(e){return t.apply(this,arguments)})}}({container:tu,nixService:tb}),tW=(0,ni.Z)({fs:tp}),{session:tf,presence:tv,packager:t_,container:tu,fs:tp,runner:tG,debuggest:tI,broadcast:tB,dotReplit:tg,nixService:tb,lspnix:tP,iotester:tA,git:tU,psql:tO,userEvents:td,replspaceApi:tS,toolchain:tw,ports:tD,secrets:tW}}),1)[0]}},41062:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(32477),i=n(43429);function o(e,t){var n=(0,r._)(i.useState(null),2),o=n[0],a=n[1];return i.useEffect(function(){var n=!1;return e.readFile(t).then(function(e){n||a(e)}),function(){n=!0}},[e,t]),o}},57369:function(e,t,n){n.d(t,{ZP:function(){return f},y5:function(){return a},yG:function(){return o}});var r,i,o,a,l=n(34142),c=n(87682),s=n(75813);function u(e,t){return"{ ".concat(e,"; } > /dev/null 2>&1 && echo -n '").concat(t,"' && exit 0")}(r=o||(o={})).NOT_INITIALIZED="NOT_INITIALIZED",r.ON_UNBORN_BRANCH="ON_UNBORN_BRANCH",r.MERGING="MERGING",r.REBASING="REBASING",r.REVERTING="REVERTING",r.CHERRY_PICKING="CHERRY_PICKING",r.APPLYING_MAILBOX="APPLYING_MAILBOX",r.BISECTING="BISECTING",r.DIRTY_WORKTREE="DIRTY_WORKTREE",r.DIRTY_INDEX="DIRTY_INDEX",r.CLEAN="CLEAN",r.DETACHED_HEAD="DETACHED_HEAD",(i=a||(a={})).INITIALIZING="INITIALIZING",i.INTERMEDIATE="INTERMEDIATE",i.NORMAL="NORMAL",i.DETACHED_HEAD="DETACHED_HEAD";var d=[u("! git rev-parse --is-inside-work-tree","NOT_INITIALIZED"),u('[ "$(! git rev-parse HEAD -- 2>&1)" = "fatal: bad revision \'HEAD\'" ]',"ON_UNBORN_BRANCH"),u("git rev-parse -q --verify MERGE_HEAD","MERGING"),u("[ -d '.git/rebase-apply' ] && [ -f '.git/rebase-apply/applying' ]","APPLYING_MAILBOX"),u("[ -d '.git/rebase-apply' ] || [ -d '.git/rebase-merge' ]","REBASING"),u("git rev-parse -q --verify REVERT_HEAD","REVERTING"),u("git rev-parse -q --verify CHERRY_PICK_HEAD","CHERRY_PICKING"),u("[ -f '.git/BISECT_LOG' ]","BISECTING"),u("! git symbolic-ref -q HEAD","DETACHED_HEAD"),"git update-index -q --refresh > /dev/null || exit $?",u('{ ! git diff-files --quiet; } || [ -n "$(git ls-files --others --exclude-standard)" ]',"DIRTY_WORKTREE"),u("! git diff-index --cached --quiet HEAD --","DIRTY_INDEX"),'echo -n "CLEAN"'].join(";");function f(e){return h.apply(this,arguments)}function h(){return(h=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,e(d,{serviceMethod:"git-get-repository-state"})];case 1:if((t=i.sent()).error)return[2,t];if(!(t.output in o))return[2,{error:s.aq.UNKNOWN}];return r=function(e){switch(e){case"NOT_INITIALIZED":case"ON_UNBORN_BRANCH":return"INITIALIZING";case"MERGING":case"REBASING":case"REVERTING":case"CHERRY_PICKING":case"APPLYING_MAILBOX":case"BISECTING":return"INTERMEDIATE";case"DIRTY_WORKTREE":case"DIRTY_INDEX":case"CLEAN":return"NORMAL";case"DETACHED_HEAD":return"DETACHED_HEAD"}}(n=t.output),[2,{state:n,type:r,error:null}]}})})).apply(this,arguments)}},21076:function(e,t,n){n.d(t,{CH:function(){return v},Dc:function(){return d},GE:function(){return f},LY:function(){return h},Pi:function(){return g},Qj:function(){return m},bF:function(){return p},dC:function(){return u}});var r=n(32477),i=n(50431),o=n(80433),a=n(75647),l=/[~^:?*[\\\0-\x20\x7F]/,c=/^(([A-Za-z0-9]+@|http(|s):\/\/)|(http(|s):\/\/[A-Za-z0-9]+@))([A-Za-z0-9.]+(:\d+)?)(?::|\/)([\d/\w.-]+?)$/,s=new RegExp([l,/^$/,/^\//,/\/$/,/\.lock$/,/\/{2,}/,/^\./,/\.$/,/\/\./,/\.\./,/@\{/,/^@$/,/^-/].map(function(e){return"(?:".concat(e.source,")")}).join("|"));function u(e){return 0===e.length||!l.test(e)}function d(e){return!s.test(e)}function f(e){return!s.test(e)}function h(e){return c.test(e)}function p(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"string"==typeof e?(0,i.C)(e):"commit"in e?e.type===a.HO.LOCAL||t&&e.type===a.HO.TRACKED?e.name:"".concat(e.remote,"/").concat(e.name):e.name}function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e)return e;if("commit"in e)return e.type===a.HO.LOCAL||t&&e.type===a.HO.TRACKED?"refs/heads/".concat(e.name):"refs/remotes/".concat(e.remote,"/").concat(e.name);if(e.type===o.l.BRANCH)return"refs/heads/".concat(e.name);if(e.type===o.l.REMOTE_BRANCH)return"refs/remotes/".concat(e.remote,"/").concat(e.branch);throw Error("Unknown branch object")}function v(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e)return t&&!e.startsWith("refs/remotes/")?null:(0,r._)((0,i.Tg)(e),1)[0];if("commit"in e)return t&&e.type!==a.HO.REMOTE?null:e.remote;if(e.type===o.l.BRANCH)return null;if(e.type===o.l.REMOTE_BRANCH)return e.remote;throw Error("Unknown branch object")}function g(e,t){return e===t||null!==e&&null!==t&&m(e)===m(t)}},80433:function(e,t,n){n.d(t,{L:function(){return function e(t){var n;switch("HEAD"===(n=t)||"refs/HEAD"===n||n.startsWith(l)?"HEAD":n.startsWith(c)?"BRANCH":n.startsWith(s)?f.test(n)?"REMOTE_HEAD":"REMOTE_BRANCH":n.startsWith(d)||n.startsWith(u)?"TAG":"BRANCH"){case"HEAD":if(t.startsWith(l)){if(t.endsWith("(detached)"))return{type:"HEAD",name:"HEAD",detached:!0,ref:null};return{type:"HEAD",name:"HEAD",detached:!1,ref:e(t.slice(l.length))}}return{type:"HEAD",name:"HEAD",detached:!1,ref:null};case"REMOTE_HEAD":var r=t.slice(s.length);return{type:"REMOTE_HEAD",name:"HEAD",remote:(0,o._)(r.split("/"),1)[0]};case"BRANCH":return{type:"BRANCH",name:t.startsWith(c)?t.slice(c.length):t};case"REMOTE_BRANCH":var i=t.slice(s.length),h=(0,a._)(i.split("/"));return{type:"REMOTE_BRANCH",name:i,remote:h[0],branch:h.slice(1).join("/")};case"TAG":return t.startsWith(u)&&(t=t.slice(u.length)),t.startsWith(d)&&(t=t.slice(d.length)),{type:"TAG",name:t}}}},l:function(){return i}});var r,i,o=n(32477),a=n(95025),l="HEAD -> ",c="refs/heads/",s="refs/remotes/",u="tag: ",d="refs/tags/",f=/^refs\/remotes\/([^/]+)\/HEAD$/;(r=i||(i={})).HEAD="HEAD",r.REMOTE_HEAD="REMOTE_HEAD",r.BRANCH="BRANCH",r.REMOTE_BRANCH="REMOTE_BRANCH",r.TAG="TAG"},75647:function(e,t,n){n.d(t,{HO:function(){return i},ZP:function(){return h},p3:function(){return d}});var r,i,o=n(34142),a=n(32477),l=n(21289),c=n(87682),s=n(50431),u=n(80433);function d(e,t){return!!e&&!!t&&(e===t||e.name===t.name&&e.remote===t.remote)}function f(e){var t=(0,a._)(e.split("	"),6),n=t[0],r=t[1],i=t[2],o=t[3],l=t[4],c=t[5],d=(0,u.L)(n),f={hash:i,author:{name:o,email:(0,s.tc)(l),date:1e3*parseInt(c,10)}};if(d.type===u.l.BRANCH){var h=r?(0,u.L)(r):null,p=h&&(h.type===u.l.REMOTE_BRANCH||h.type===u.l.BRANCH)?h:null;return{type:"LOCAL",name:d.name,push:p,remote:null,tracking:null,commit:f}}return d.type===u.l.REMOTE_BRANCH?{type:"REMOTE",name:d.branch,remote:d.remote,push:null,tracking:null,commit:f}:null}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,o._)(function(e){var t,n,r=arguments;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1===e.local&&!1===e.remote)throw Error("Cannot specify both local and remote as false");var t=[];if(t.push('--format="%(refname)%09%(push)%09%(objectname)%09%(authorname)%09%(authoremail)%09%(authordate:unix)"'),e.max&&t.push("--count=".concat(e.max)),e.pattern){if("string"==typeof e.pattern)t.push((0,s.Gw)(e.pattern));else{var n,r,i=e.pattern.map(function(e){return(0,s.Gw)(e)});t.push.apply(t,(0,l._)(i))}}else(null===(n=e.local)||void 0===n||n)&&t.push("refs/heads"),(null===(r=e.remote)||void 0===r||r)&&t.push("refs/remotes");return"git for-each-ref ".concat(t.join(" "))}(r.length>1&&void 0!==r[1]?r[1]:{}),{serviceMethod:"git-list-branches"})];case 1:if((t=i.sent()).error)return[2,t];return(n=function(e){var t=[],n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var s=a.value;"LOCAL"===s.type?t.push(s):"REMOTE"===s.type&&n.push(s)}}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}var d=new Set,f=[],h=!0,p=!1,m=void 0;try{for(var v,g=n[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)!function(){var e=v.value,n=t.find(function(t){return t.push&&t.push.type===u.l.REMOTE_BRANCH&&t.push.remote===e.remote&&t.push.branch===e.name&&t.name===e.name});n&&(d.add(e),d.add(n),f.push({type:"TRACKED",name:n.name,remote:e.remote,push:n.push,tracking:e,commit:n.commit}))}()}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}var y=e.filter(function(e){return!d.has(e)});return(0,l._)(y).concat((0,l._)(f))}((0,s.so)(t.output,"\n").map(f).filter(function(e){return null!==e}))).sort(function(e,t){return t.commit.author.date-e.commit.author.date}),[2,{branches:n,error:null}]}})})).apply(this,arguments)}(r=i||(i={})).LOCAL="LOCAL",r.REMOTE="REMOTE",r.TRACKED="TRACKED"},91075:function(e,t,n){n.d(t,{T:function(){return i},Z:function(){return d}});var r,i,o=n(34142),a=n(32477),l=n(87682),c=n(75813),s=n(50431),u=n(55103);function d(e){return f.apply(this,arguments)}function f(){return(f=(0,o._)(function(e){var t,n,r,i,o,d,f,h,p,m=arguments;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=m.length>1&&void 0!==m[1]?m[1]:{},[4,(0,u.Z)(e)];case 1:if((n=l.sent()).error)return[2,n];if(!n.branch)return[2,{error:c.aq.HEAD_DETACHED}];if(!n.upstream||(i=(r=(0,a._)((0,s.Tg)(n.upstream.branch),2))[0],o=r[1],!i||!o))return[2,{error:c.aq.UPSTREAM_NOT_SET}];if(n.changes.length>0)return[2,{error:c.aq.DIRTY_WORKTREE}];if("FF_ONLY"===(f=null!==(d=t.mode)&&void 0!==d?d:"FF_ONLY")&&n.upstream.ahead>0)return[2,{error:c.aq.MERGE_CONFLICT}];switch("FF_ONLY"!==f&&0===n.upstream.ahead&&(f="FF_ONLY"),h=["--quiet","--no-edit"],f){case"FF_ONLY":h.push("--no-rebase","--ff-only");break;case"MERGE":h.push("--no-rebase","--ff");break;case"REBASE":h.push("--rebase")}return h.push((0,s.Gw)(i),(0,s.Gw)(o)),[4,e("git pull ".concat(h.join(" ")),{serviceMethod:"git-pull"})];case 2:if((p=l.sent()).error!==c.aq.MERGE_CONFLICT)return[3,8];if(t.allowConflicts)return[2,{hasConflicts:!0,error:null}];switch(f){case"MERGE":return[3,3];case"REBASE":return[3,5]}return[3,7];case 3:return[4,e("git merge --abort",{serviceMethod:"git-pull"})];case 4:case 6:return l.sent(),[3,7];case 5:return[4,e("git rebase --abort",{serviceMethod:"git-pull"})];case 7:return[2,p];case 8:if(p.error)return[2,p];return[2,{hasConflicts:!1,error:null}]}})})).apply(this,arguments)}(r=i||(i={})).FF_ONLY="FF_ONLY",r.MERGE="MERGE",r.REBASE="REBASE"},63043:function(e,t,n){n.d(t,{J:function(){return r},O:function(){return i}});var r="users.noreply.replit.com",i="users.noreply.github.com"},97631:function(e,t,n){n.d(t,{J:function(){return i},e:function(){return r}});var r=(0,n(59173).u)(null);function i(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Date.now();Array.isArray(e)||(e=[e]);var a=null!==(i=t.output)&&void 0!==i?i:"",l=t.error,c=n?o:Date.now(),s="".concat(o,"-").concat(Math.random());r.set({input:e,output:a,error:l,start:o,end:c,cached:n,key:s})}},75813:function(e,t,n){var r,i,o,a,l,c;n.d(t,{aq:function(){return r},dq:function(){return i},rG:function(){return o}}),(a=r||(r={})).UNKNOWN_NOT_GIT="UNKNOWN_NOT_GIT",a.UNKNOWN="UNKNOWN",a.TIMEOUT="TIMEOUT",a.CHANNEL_CLOSED="CHANNEL_CLOSED",a.NOT_INITIALIZED="NOT_INITIALIZED",a.UNAUTHENTICATED="UNAUTHENTICATED",a.INDEX_FILE_CORRUPT="INDEX_FILE_CORRUPT",a.UNKNOWN_REMOTE="UNKNOWN_REMOTE",a.INDEX_LOCKED="INDEX_LOCKED",a.NO_COMMITS="NO_COMMITS",a.PATH_MATCHED_NO_FILES="PATH_MATCHED_NO_FILES",a.USER_NOT_CONFIGURED="USER_NOT_CONFIGURED",a.INVALID_REFERENCE="INVALID_REFERENCE",a.BRANCH_ALREADY_EXISTS="BRANCH_ALREADY_EXISTS",a.MERGE_CONFLICT="MERGE_CONFLICT",a.UPSTREAM_NOT_SET="UPSTREAM_NOT_SET",a.HEAD_DETACHED="HEAD_DETACHED",a.DIRTY_WORKTREE="DIRTY_WORKTREE",a.PUSH_REJECTED="PUSH_REJECTED",a.REMOTE_ALREADY_EXISTS="REMOTE_ALREADY_EXISTS",a.ALREADY_INITIALIZED="ALREADY_INITIALIZED",a.INVALID_STATE="INVALID_STATE",a.PROTECTED_BRANCH="PROTECTED_BRANCH",(l=i||(i={})).FS_CHANGE="FS_CHANGE",l.FORCED_REFRESH="FORCED_REFRESH",l.NEW_PROFILE="NEW_PROFILE",l.CHANGED_PROFILE="CHANGED_PROFILE",(c=o||(o={})).REPLIT_DEFAULT="REPLIT_DEFAULT",c.GITHUB="GITHUB"},19858:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(32477),i=n(21289),o=n(7444),a=n(50199),l=n(75813),c=n(54916),s=n(43429),u=n(3756),d=n.n(u);function f(e){var t,n,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=(0,r._)((0,s.useState)(null),2),p=h[0],m=h[1],v=(0,o.Z)(p),g=null===(n=null!==(t=f.keepStaleResult)&&void 0!==t?t:f.refresh)||void 0===n||n,y=(0,s.useCallback)(function(e){d()(e,v.current)||m(e)},[v]),b=(0,a.Z)(function(){return e},(0,i._)(u)),Z=(0,c.Z)().git,w=(0,s.useRef)(null),x=(0,s.useCallback)(function(){w.current?w.current():g||y(null);var e=!1;b(Z).then(function(t){e||(y(t),w.current=null)}).catch(function(){e||(y({error:l.aq.UNKNOWN}),w.current=null)}),w.current=function(){e=!0,w.current=null,g||y(null)}},[y,b,Z,g]);return(0,s.useEffect)(function(){return x()},[x]),(0,s.useEffect)(function(){var e;if(null===(e=f.refresh)||void 0===e||e)return Z.onRefresh(x)},[Z,x,f.refresh]),p}},36098:function(e,t,n){var r,i,o,a;n.d(t,{Z:function(){return i},z:function(){return r}}),(o=r||(r={})).INSTRUCTION_RESULT="INSTRUCTION_RESULT",o.TEST_RESULT="TEST_RESULT",o.ERROR="ERROR",o.STATE_CHANGED="STATE_CHANGED",(a=i||(i={}))[a.Idle=0]="Idle",a[a.Starting=1]="Starting",a[a.Ready=2]="Ready",a[a.Building=3]="Building",a[a.Running=4]="Running"},72526:function(e,t,n){n.d(t,{w:function(){return l}});var r=n(21084),i=n(30084),o=n(41500);function a(e){var t=e.path,n=e.fs,o=e.edits,a=!1,l=n.watchTextFile(t,{onReady:function(e){var t=e.writeChange,n=e.initialContent;t((0,r.Z)(o,n.toString())),a=!0},onStatusChange:function(e){e===i.KF.Clean&&a&&l()}})}function l(e){var t=e.edit,n=e.fs,r=e.client,l=t.documentChanges,c=t.changes;if(l&&l.forEach(function(e){if("textDocument"in e){var t=e.edits,l=e.textDocument;a({path:r.documentUriToPath(l.uri),fs:n,edits:t});return}switch(e.kind){case"create":var c=r.documentUriToPath(e.uri),s=e.options,u=!!((null==s?void 0:s.overwrite)||!(null==s?void 0:s.ignoreIfExists)),d=function(){n.writeFile(c,o.Z.from("")).then(function(e){if(e.error)throw Error("Something went wrong writing to a file")})};if(u){d();break}n.stat(c).then(function(e){e.exists||d()});break;case"delete":var f=r.documentUriToPath(e.uri),h=e.options,p=!!(null==h?void 0:h.recursive),m=!!(null==h?void 0:h.ignoreIfNotExists);n.stat(f).then(function(e){if(!e.exists)throw Error("Expected file to exist");if(e.type===i.Tv.Directory&&!p)throw Error("Trying to delete a directory without recursive option enabled");n.deleteFile(f).then(function(e){var t=e.error;if((t!==i.Df.NotFound||!m)&&t)throw Error("Something went wrong deleting the file")})});break;case"rename":var v=r.documentUriToPath(e.oldUri),g=r.documentUriToPath(e.newUri),y=e.options,b=!!((null==y?void 0:y.overwrite)||!(null==y?void 0:y.ignoreIfExists)),Z=function(){n.moveFile(v,g).then(function(e){if(e.error)throw Error("Something went wrong moving the file")})};if(b){Z();break}n.stat(g).then(function(e){e.exists||Z()})}}),c)for(var s in c)a({path:r.documentUriToPath(s),fs:n,edits:c[s]});return{applied:!0}}},19012:function(e,t,n){var r=n(18672);t.Z=[r.SymbolKind.Array,r.SymbolKind.Boolean,r.SymbolKind.Class,r.SymbolKind.Constant,r.SymbolKind.Constructor,r.SymbolKind.Enum,r.SymbolKind.EnumMember,r.SymbolKind.Event,r.SymbolKind.Field,r.SymbolKind.File,r.SymbolKind.Function,r.SymbolKind.Interface,r.SymbolKind.Key,r.SymbolKind.Method,r.SymbolKind.Module,r.SymbolKind.Namespace,r.SymbolKind.Object,r.SymbolKind.Operator,r.SymbolKind.Package,r.SymbolKind.Property,r.SymbolKind.String,r.SymbolKind.Struct,r.SymbolKind.TypeParameter,r.SymbolKind.Variable]},21084:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(32477),i=n(84357),o=n(30087),a=n(74106);function l(e,t){var n=i.xv.of(t.split("\n")),l=i.as.empty(n.length);if(!e.length)return l;if(1===e.length){var c=(0,r._)(e,1)[0],s=c.range,u=s.start,d=s.end,f=c.newText,h=(0,a.R)(n,u);if(0===h||-1===h){var p=(0,a.R)(n,d);if(p===n.length||-1===p)return(0,o.F)(t,f)}}var m=[],v=!0,g=!1,y=void 0;try{for(var b,Z=e[Symbol.iterator]();!(v=(b=Z.next()).done);v=!0){var w=b.value,x=w.range,C=w.newText,_=(0,a.R)(n,x.start),k=(0,a.R)(n,x.end);m.push({from:_,to:k,insert:C})}}catch(e){g=!0,y=e}finally{try{v||null==Z.return||Z.return()}finally{if(g)throw y}}return i.as.of(m,t.length)}},8701:function(e,t,n){var r,i,o,a;n.d(t,{N:function(){return r},a:function(){return i}}),(o=r||(r={})).NOT_READY="NOT_READY",o.READY="READY",o.STALLED="STALLED",(a=i||(i={})).OFFLINE="OFFLINE",a.INITIALIZING="INITIALIZING",a.INITIALIZED="INITIALIZED",a.EXITING="EXITING",a.EXITED="EXITED"},69926:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(32477),i=n(43429),o=n(54916),a=n(45903),l=n(25e3),c=n(53304),s=n.n(c),u=n(47507),d=n(99071),f=n(8701);function h(e){return Math.floor(performance.now()-e.startTime)}var p=new WeakSet,m=n(50782);function v(e){var t=(0,m.Z)(),n=(0,o.Z)().lspnix,c=(0,r._)(i.useState(null),2),v=c[0],g=c[1];return i.useEffect(function(){if(e){var t=n.onClient(e,g);return function(){t(),g(null)}}},[n,e]),i.useEffect(function(){if(v)return function(e){var t=e.client,n=e.replId,r=e.language;if(!p.has(t)){p.add(t);var i=new Map,o=function(e){var i,o=t.getServerState(),a=null!==(i=t.getServerInfo())&&void 0!==i?i:{name:"unknown",version:"none"},l=o===f.a.INITIALIZED?"".concat(null==a?void 0:a.name,"@").concat(null==a?void 0:a.version):"not_ready: server is ".concat(o);return{method:e.method,replid:n,language:r,startTime:Math.floor(e.startTime),languageServerInfo:l,lspId:t.clientId}},c=s()(function(e,t){var n=h(t);n>1e4&&u.kg.time("LSP unresponsive request",n,o(t))}),m=setInterval(function(){i.forEach(function(e){c(e.id,e)})},2e3);return(0,d.uf)([t.onRequest(function(e){var t=e.id,n=e.data;.01>Math.random()&&i.set(t,{id:t,method:n.method,startTime:performance.now()})}),t.onResponse(function(e){var t=e.id,n=e.error,r=i.get(t);null!=r&&(i.delete(t),u.kg.time("LSP request",h(r),(0,l._)((0,a._)({},o(r)),{result:null==n?"ok":"error"})))}),t.onCancelRequest(function(e){var t=i.get(e);null!=t&&(i.delete(e),u.kg.time("LSP request",h(t),(0,l._)((0,a._)({},o(t)),{result:"cancelled"})))}),function(){return clearInterval(m)},function(){return p.delete(t)}])}}({client:v,replId:t,language:v.getLanguageId(e)})},[v,t,e]),v}},73660:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(32477),i=n(43429),o=n(54916);function a(){var e=(0,o.Z)().presence,t=(0,r._)(i.useState(e.getFollowedUser()),2),n=t[0],a=t[1];return i.useEffect(function(){return a(e.getFollowedUser()),e.onFollowedUserChanged(a)},[e]),n}},1518:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(73660);function i(){var e=(0,r.Z)();return e?e.color:null}},15482:function(e,t,n){n.d(t,{F:function(){return o}});var r=n(73164),i=n(40728);function o(e,t){var n=(0,r.rF)(t.fileTypeAttrs);return!n&&(null==t?void 0:t.language)&&(n=r.$R.from(t.language)),!!(n&&(0,i.JW)(e,n))}},26851:function(e,t,n){n.d(t,{K:function(){return l}});var r=n(45903),i=n(54916),o=n(43429),a=n(25425);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.Z)().userEvents,n=(0,a.P5)({controlName:"flag-null-diagnostics",logFlagToAnalytics:!1});return(0,o.useCallback)(function(i,o){n&&t.emit(i,(0,r._)({},e,o))},[t,e,n])}},30845:function(e,t,n){n.d(t,{M:function(){return k},l:function(){return _}});var r=n(39698),i=n(45903),o=n(25e3),a=n(32477),l=n(8182),c=n(50782),s=n(93918),u=n(29287),d=n(74833),f=n(56596),h=n(95492),p=n(32078),m=n(93302),v=n(8279),g=n(43429),y=n(34785),b=n(42588),Z=n(91612),w=n(85838),x=n(84731),C=(0,s.X)({storageBarWrapper:[u.l0.colWithGap(8)],summaryWrapper:[u.l0.colWithGap(8),u.l0.align.start],totalSummaryDot:[u.l0.backgroundColor.backgroundHigher,u.l0.width(8),u.l0.height(8),{borderRadius:"50%"}],replSummaryDot:[u.l0.backgroundColor.accentPrimaryDefault,u.l0.width(8),u.l0.height(8),{borderRadius:"50%"}],summaryRow:[u.l0.rowWithGap(8),u.l0.justify.start,u.l0.align.center,u.l0.fontSize(14),u.l0.height(14)],summaryRowWrap:[u.l0.rowWithGap(8),u.l0.justify.start,u.l0.align.center,u.l0.fontSize(14),{flexWrap:"wrap"}],replSummaryText:[u.l0.color.accentPrimaryStronger],replSummaryUsage:[u.l0.color.accentPrimaryStrongest],replSummaryTextPlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(78)],replUsagePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(64)],totalUsagePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(140)],availablePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(64)],availableText:[u.l0.color.foregroundDimmest,(0,r._)({},u.BC.max(390),u.l0.pl(16))]}),_=function(e){var t=e.data,n=e.hideAlerts,r=(0,c.Z)(),s=(0,a._)((0,g.useState)(!1),2),u=s[0],v=s[1],_=(0,x.Q)();if((0,g.useEffect)(function(){var e,n;t&&(null===(e=t.currentUser)||void 0===e?void 0:e.storageInfo.accountStorageUtilization.__typename)==="AccountStorageUtilization"&&(null===(n=t.currentUser.storageInfo.accountStorageUtilization.perRepl.find(function(e){return e.repl.id===r}))||void 0===n?void 0:n.__typename)==="ReplStorageUtilization"&&v(!0)},[t,r]),t&&(null===(S=t.currentUser)||void 0===S?void 0:S.__typename)==="CurrentUser"&&"StorageQuota"===t.currentUser.storageInfo.storageQuota.__typename&&"StorageGracePeriodQuota"===t.currentUser.storageInfo.storageGracePeriodQuota.__typename&&"AccountStorageUtilization"===t.currentUser.storageInfo.accountStorageUtilization.__typename&&"UserPowerUpsTypes"===t.currentUser.userPowerUpsByType.__typename&&u){var S,E,T,R=t.currentUser.username,I=t.currentUser.storageInfo.accountStorageUtilization,D=t.currentUser.storageInfo.storageQuota.quota,G=null!==(E=t.currentUser.userPowerUpsByType.storage.currentSku)&&void 0!==E?E:void 0,B=G?Z.zd[G]:void 0,P=I.total,A=I.perRepl,N=null!==(T=t.currentUser.userSubscriptionType)&&void 0!==T?T:void 0,U=N?Z.XR[N]:Z.XR.FREE,L=Math.max(Number(D)-Number(P),0),O="Bytes",X="(".concat((0,m.fZ)(L,{precision:1,resourceUsageType:O})," available)"),M=A.find(function(e){return e.repl.id===r}),F="0"!==D?(0,l.tZ)(d.xv,{css:C.availableText,multiline:!1,children:X}):null;return(0,l.BX)(f.G,{css:C.storageBarWrapper,children:[(0,l.tZ)(h.$,{context:{type:"workspace_info_modal",replId:r},summary:(0,p._4)((0,o._)((0,i._)({},I),{quota:D})),username:R,resourceUsageType:O}),(0,l.BX)(f.G,{css:C.summaryWrapper,children:[(0,l.BX)(f.G,{css:C.summaryRowWrap,children:[(0,l.BX)(d.xv,{multiline:!1,children:["Replit ",(0,y.s)(N,_)," storage:"," ",U," GiB",B?" + ".concat(B," GiB add-on"):null]}),F]}),(0,l.BX)(f.G,{css:C.summaryRow,children:[(0,l.tZ)("div",{css:C.replSummaryDot}),(0,l.tZ)(d.xv,{css:C.replSummaryText,multiline:!1,children:"This Repl:"}),M?(0,l.tZ)(d.xv,{css:C.replSummaryUsage,multiline:!1,children:(0,b.s)(Number(M.usage))}):(0,l.tZ)(f.G,{css:C.replUsagePlaceholder})]}),void 0!==n&&n?null:(0,l.tZ)(w.q,{})]})]})}return(0,l.tZ)(k,{})},k=function(){return(0,l.BX)(f.G,{css:C.storageBarWrapper,children:[(0,l.tZ)(h.X,{}),(0,l.BX)(f.G,{css:C.summaryWrapper,children:[(0,l.BX)(f.G,{css:C.summaryRow,children:[(0,l.tZ)(f.G,{css:C.totalUsagePlaceholder}),(0,l.tZ)(f.G,{css:C.availablePlaceholder})]}),(0,l.BX)(f.G,{css:C.summaryRow,children:[(0,l.tZ)(f.G,{css:C.replSummaryTextPlaceholder}),(0,l.tZ)(f.G,{css:C.replUsagePlaceholder})]})]})]})}},44887:function(e,t,n){n.d(t,{h:function(){return G},s:function(){return D}});var r=n(45903),i=n(25e3),o=n(32477),a=n(8182),l=n(43429),c=n(70002),s=n(93918),u=n(49344),d=n(29287),f=n(74833),h=n(56596),p=n(31850),m=n(28079),v=n(47957),g=n(1498),y=n(75582),b=n(8279),Z=n(5542),w=n(89106),x=n(56337),C=n(15146),_=n(40102),k=n(30845),S=n(25491),E=n(16166),T=n(67795),R=n(59868),I=(0,s.X)({self:[d.l0.flex.column],content:[d.l0.pt(16),d.l0.px(12),d.l0.pb(12),d.l0.colWithGap(16)],contentSlim:[d.l0.colWithGap(8)],header:[d.l0.p(12),d.l0.rowWithGap(8),d.l0.justify.start,d.l0.align.center,d.l0.border({color:d.TV.outlineDefault,width:1,style:"solid",direction:"bottom"})],actions:[d.l0.colWithGap(8)],footer:[d.l0.rowWithGap(16),d.l0.justify.spaceBetween,d.l0.align.center,d.l0.pt(4)],loadingWrapper:[d.l0.center],storageBarWrapper:[d.l0.colWithGap(8)],summaryWrapper:[d.l0.colWithGap(8),d.l0.align.start],totalSummaryDot:[d.l0.backgroundColor.backgroundHigher,d.l0.width(8),d.l0.height(8),{borderRadius:"50%"}],replSummaryDot:[d.l0.backgroundColor.accentPrimaryDefault,d.l0.width(8),d.l0.height(8),{borderRadius:"50%"}],summaryRow:[d.l0.rowWithGap(8),d.l0.justify.start,d.l0.align.center,d.l0.fontSize(14),d.l0.height(14)],replSummaryText:[d.l0.color.accentPrimaryStronger],replSummaryUsage:[d.l0.color.accentPrimaryStrongest],replUsagePlaceholder:[b.p.backgroundPulse(d.TV.backgroundHigher,d.TV.backgroundRoot),{opacity:.5},d.l0.borderRadius(4),d.l0.height("100%"),d.l0.width(64)],totalUsagePlaceholder:[b.p.backgroundPulse(d.TV.backgroundHigher,d.TV.backgroundRoot),{opacity:.5},d.l0.borderRadius(4),d.l0.height("100%"),d.l0.width(140)],availablePlaceholder:[b.p.backgroundPulse(d.TV.backgroundHigher,d.TV.backgroundRoot),{opacity:.5},d.l0.borderRadius(4),d.l0.height("100%"),d.l0.width(64)],availableText:[d.l0.color.foregroundDimmest]}),D=function(e){var t=e.isOpen,n=e.onRequestClose,r=(0,x.Z)(),i=(0,o._)((0,l.useState)(!1),2),c=i[0],s=i[1],d=(0,v.Pf)({fetchPolicy:"network-only",ssr:!1,notifyOnNetworkStatusChange:!0}),m=d.data,g=d.loading,y=d.refetch;return(0,a.BX)(u.u,{noPadding:!0,isOpen:t,onRequestClose:n,preventClose:c,hideCloseButton:!0,children:[(0,a.BX)(h.G,{css:I.self,children:[(0,a.BX)(h.G,{css:I.header,children:[(0,a.tZ)(C.hU,{onClick:n,alt:"Back",size:28,children:(0,a.tZ)(_.Z,{size:16})}),(0,a.tZ)(p.Z,{size:16}),(0,a.tZ)(f.xv,{variant:"subheadDefault",multiline:!1,children:"Repl Storage"})]}),(0,a.tZ)(G,{loading:g,isInDesktopApp:r,data:m,setShowUpgradeModal:s})]}),(0,a.tZ)(S.Z,{isOpen:c,context:"workspace_info_modal",powerUp:"storage",uponPurchaseGoTo:"workspace",onRequestClose:function(){y(),s(!1)}})]})},G=function(e){var t,n=e.isInDesktopApp,o=e.loading,s=e.data,u=e.setShowUpgradeModal,d=e.slim;if((0,l.useEffect)(function(){var e;if(s&&(null===(e=s.currentUser)||void 0===e?void 0:e.__typename)==="CurrentUser"&&"StorageQuota"===s.currentUser.storageInfo.storageQuota.__typename&&"AccountStorageUtilization"===s.currentUser.storageInfo.accountStorageUtilization.__typename&&!o)try{var t=parseInt(s.currentUser.storageInfo.storageQuota.quota,10),n=parseInt(s.currentUser.storageInfo.accountStorageUtilization.total,10);(0,R.j)(T.U3.MODAL_VIEWED,{modalName:"workspace_storage_modal",storageQuota:t,storageUtilization:n,storageUtilizationPercentage:n/t})}catch(e){}},[s,o]),o&&!s)return(0,a.BX)(h.G,{css:d?I.contentSlim:I.content,children:[(0,a.tZ)(k.M,{}),(0,a.tZ)(h.G,{css:I.footer,children:n?(0,a.tZ)(g.zx,{onClick:function(){w.X.openExternalUrl(m.$I.as)},text:"Manage Repls"}):(0,a.tZ)(c.Z,{href:m.$I.href,as:m.$I.as,text:"Manage Repls"})})]});if(s&&(null===(t=s.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"&&"StorageQuota"===s.currentUser.storageInfo.storageQuota.__typename&&"AccountStorageUtilization"===s.currentUser.storageInfo.accountStorageUtilization.__typename){var p=s.currentUser.username,v=s.currentUser.userSubscriptionType===y.HP.HackerPro;return(0,a.BX)(h.G,{css:d?I.contentSlim:I.content,children:[s?(0,a.tZ)(k.l,{data:s}):(0,a.tZ)(k.M,{}),(0,a.BX)(h.G,{css:I.footer,children:[(0,a.tZ)(c.Z,(0,i._)((0,r._)({},(0,Z.Ru)(p)),{text:"Manage Repls"})),(0,a.tZ)(E.U,{isPro:v,setShowUpgradeModal:u,source:"workspace_storage_modal_upgrade_button"})]})]})}return(0,a.BX)(h.G,{css:d?I.contentSlim:I.content,children:[(0,a.tZ)(f.xv,{color:"dimmest",multiline:!1,children:"We had trouble loading your storage information. Please try again later."}),(0,a.tZ)(h.G,{css:I.footer,children:(0,a.tZ)(c.Z,{href:m.$I.href,as:m.$I.as,text:"Manage Repls"})})]})}},65243:function(e,t,n){n.d(t,{g:function(){return o}});var r=n(8182),i=n(51384);function o(){return(0,r.tZ)(i.xB,{styles:[{body:{overflow:"hidden"}}]})}},30601:function(e,t,n){n.d(t,{w:function(){return h}});var r=n(45903),i=n(32477),o=n(8182),a=n(72282),l=n.n(a),c=n(43429),s=n(38927),u=n(51384),d=n(26508),f=n(29287);function h(e){var t=e.targetElement,n=(0,i._)((0,c.useState)(null),2),a=n[0],h=n[1],m=(0,d.Z)(function(){t&&h({rect:t.getBoundingClientRect(),docWidth:document.documentElement.clientWidth,docHeight:document.documentElement.clientHeight})},{type:"throttle",wait:100});if((0,c.useEffect)(function(){t&&m(t)},[t,m]),(0,c.useEffect)(function(){if(t){var e=l()(function(){h({rect:t.getBoundingClientRect(),docWidth:document.documentElement.clientWidth,docHeight:document.documentElement.clientHeight})},100);return window.addEventListener("resize",e),window.addEventListener("scroll",e),function(){window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}}},[t]),!a||!t)return null;var v=(0,u.iv)({backgroundColor:f.TV.backgroundOverlay,zIndex:f.n0+1,position:"fixed",transition:"all 0.5s ease-out"});return(0,s.createPortal)((0,o.BX)(o.HY,{children:[(0,o.tZ)("div",{id:"wat",css:[p((0,r._)({side:"left-top"},a)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"top-right"},a)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"right-bottom"},a)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"bottom-left"},a)),v]})]}),document.body)}function p(e){var t=e.side,n=e.rect,r=e.docWidth,i=e.docHeight;switch(t){case"left-top":return(0,u.iv)({top:0,left:0,width:Math.max(0,n.left),height:Math.max(0,n.bottom)});case"top-right":return(0,u.iv)({top:0,right:0,width:"calc(".concat(r,"px - ").concat(Math.max(0,n.left),"px)"),height:Math.max(0,n.top)});case"right-bottom":return(0,u.iv)({bottom:0,right:0,width:"calc(".concat(r,"px - ").concat(Math.max(0,n.right),"px)"),height:"calc(".concat(i,"px - ").concat(Math.max(0,n.top),"px)")});case"bottom-left":return(0,u.iv)({bottom:0,left:0,width:Math.max(0,n.right),height:"calc(".concat(i,"px - ").concat(Math.max(0,n.bottom),"px)")})}}},30869:function(e,t,n){n.d(t,{k:function(){return v}});var r=n(45903),i=n(25e3),o=n(32477),a=n(8182),l=n(30983),c=n(36227),s=n(43429),u=n(38927),d=n(2581),f=n(87659),h=n(29287),p=n(26508),m=n(22487);function v(e){var t=e.targetElement,n=e.activeStep,v=e.goto,g=e.currentStepIndex,y=e.totalSteps,b=e.done,Z=e.disableAnimation,w=e.placement,x=e.cypressCloseData,C=e.onClickOutside,_=e.innerRef,k=e.width,S=(0,o._)((0,s.useState)(null),2),E=S[0],T=S[1],R=(0,o._)((0,s.useState)(null),2),I=R[0],D=R[1],G=(0,d.D)(t,E,{placement:void 0===w?"right":w,modifiers:[{name:"arrow",options:{element:I,padding:8}},{name:"offset",options:{offset:[0,16]}},{name:"preventOverflow",options:{padding:8}},{name:"flip",options:{fallbackPlacements:["top","bottom","left","right"]}},{name:"computeStyles",options:{adaptive:!1}}]}),B=(0,p.Z)(function(){var e;null===(e=G.update)||void 0===e||e.call(G)},{type:"throttle",wait:100});(0,s.useEffect)(function(){B(t)},[t,B]),(0,s.useImperativeHandle)(_,function(){return{updateTooltip:function(){var e;null===(e=G.update)||void 0===e||e.call(G)}}});var P=(0,m.Z)(function(){C&&C()},[C]);return(0,u.createPortal)((0,a.BX)("div",(0,i._)((0,r._)({ref:function(e){P.current=e,T(e)},style:G.styles.popper,css:{transition:Z?"all":"all 0.5s ease-out",zIndex:h.n0+2,width:null!=k?k:320}},G.attributes.popper),{children:[(0,a.tZ)(c.O,{title:n.title,content:n.content,onDismiss:function(){b()},currentStepIndex:g,onCurrentStepChange:v,totalSteps:y,cypressCloseData:void 0===x?"tour-tooltip-close-button":x}),(0,a.tZ)("span",{style:G.styles.arrow,css:[l.wk,{"&::after":{backgroundColor:f.Br.primary.dimmest,border:"1px solid "+f.Br.primary.dimmer}}],ref:D})]})),document.body)}},70781:function(e,t,n){n.d(t,{r:function(){return g},e:function(){return y.e}});var r=n(39698),i=n(45903),o=n(25e3),a=n(32477),l=n(8182),c=n(26635),s=n(43429),u=n(14818),d=n(36227),f=n(49344);function h(){var e=(0,u.X)();if(!e)return null;var t=e.activeStep,n=e.goto,r=e.steps,i=e.done;return(0,l.tZ)(f.u,{preventClose:!0,isOpen:!!t.isModal,onRequestClose:function(){},centered:!0,maxWidth:"fit-content",noPadding:!0,children:(0,l.tZ)(d.O,{title:t.title,content:t.content,onDismiss:function(){i()},currentStepIndex:r.findIndex(function(e){return t.id===e.id}),onCurrentStepChange:n,totalSteps:r.length,cypressCloseData:"tour-tooltip-close-button"})})}var p=n(30601),m=n(30869),v=n(33212);function g(e){var t,n,d,f,g,y,b,Z,w,x,C,_=e.children,k=e.tour,S=e.isDoneInitialOverride,E=e.onStep,T=e.onDone,R=(0,a._)((0,s.useState)(k.steps[0]),2),I=R[0],D=R[1],G=(0,a._)((0,s.useState)({}),2),B=G[0],P=G[1],A=(t=k.id,f=(d=(0,c.Pp)({variables:{tours:t}})).data,g=d.loading,y=(0,a._)((0,c.oe)({variables:{name:t},optimisticResponse:{__typename:"RootMutationType",markTourAsSeen2:{__typename:"TourSeen",id:t,seen:!0}}}),1)[0],Z=(b=(0,a._)((0,s.useState)(S),2))[0],w=b[1],x=!!(null==f?void 0:null===(n=f.currentUser)||void 0===n?void 0:n.toursSeen[0].seen),"boolean"==typeof Z&&(x=Z),{isLoading:g,isDone:x,setIsDone:function(e){w(e),e&&y()}}),N=A.isDone,U=A.isLoading,L=A.setIsDone,O=k.steps.findIndex(function(e){return I.id===e.id});if(-1===O)throw Error("Current tour step is not in tour steps");function X(){L(!0),null==T||T(I.id)}var M=(0,s.useRef)();function F(e){M.current=I,null==E||E(e.id),D(e)}function W(e){if("number"==typeof e)t=e;else{var t;t=k.steps.findIndex(function(t){return e===t.id})}if(!(t<0)&&!(t>=k.steps.length)){for(var n=k.steps[t],r=t<O;!B[n.id]&&n.autoSkipIfNoTarget;){if((t=r?t-1:t+1)<0||t>=k.steps.length)return;n=k.steps[t]}F(n)}}function H(){W(0),L(!1)}var V=(0,s.useCallback)(function(e,t){var n=k.steps.findIndex(function(t){return e===t.id});if(-1===n)throw Error("Invalid step id");if(k.steps[n].isModal)throw Error("Trying to set a target element for a modal step");P(function(n){return n[e]===t?n:(0,o._)((0,i._)({},n),(0,r._)({},e,t))})},[k]),z=B[I.id],j=!N&&!U;window.startTour=function(){v.log("starting tour:",k.id,"from",k.steps[0].id),H()};var q=k.steps.filter(function(e){return!e.autoSkipIfNoTarget||!!B[e.id]}),Y=q.findIndex(function(e){return I.id===e.id});return(0,l.BX)(u.z,{value:(0,o._)((0,i._)({},k),{setStepTargetElement:V,activeStep:I,next:function(){var e=k.steps[O+1];if(e&&e.autoSkipIfNoTarget)for(var t=O+1;e&&e.autoSkipIfNoTarget&&!B[e.id];)t++,e=k.steps[t];if(!e){X();return}F(e)},prev:function(){var e=k.steps[O-1];if(e&&e.autoSkipIfNoTarget)for(var t=O-1;e&&e.autoSkipIfNoTarget&&!B[e.id];)t--,e=k.steps[t];e&&F(e)},goto:W,isDone:N,isLoading:U,done:X,restart:H}),children:[j&&I.isModal?(0,l.tZ)(h,{}):null,j&&z?(0,l.BX)(l.HY,{children:[(0,l.tZ)(p.w,{targetElement:z}),(0,l.tZ)(m.k,{targetElement:z,activeStep:I,currentStepIndex:Y,done:X,goto:function(e){W(e+O-Y)},totalSteps:q.length,disableAnimation:!!(0===O||(null===(C=M.current)||void 0===C?void 0:C.isModal))})]}):null,_]})}var y=n(89783)},24549:function(e,t,n){var r,i;n.d(t,{z:function(){return r}}),(i=r||(r={})).FileNode="FILE_NODE",i.FileHeaderTab="FILE_HEADER_TAB",i.Code="CODE",i.Pane="PANE",i.NewPane="NEW_PANE"},47648:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(45903),i=n(25e3),o=n(70322),a=n(8182),l=n(49344),c=n(51965),s=n(93295),u=n(23982),d=n(66039);function f(){var e=(0,s._)(["\n  query UpgradeModal {\n    currentUser {\n      id\n      cycles {\n        transactions(count: 1) {\n          items {\n            id\n            time_created\n          }\n        }\n      }\n    }\n  }\n"]);return f=function(){return e},e}function h(){var e=(0,s._)(["\n  query CurrentUserSubscriptionIdentify {\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return h=function(){return e},e}var p={},m=(0,u.Ps)(f()),v=(0,u.Ps)(h()),g=n(87001);function y(e){var t,n,s=e.isOpen,u=e.onRequestClose,f=e.onPlanCheckoutComplete,h=(0,o._)(e,["isOpen","onRequestClose","onPlanCheckoutComplete"]);return t=(0,r._)({},p,{ssr:!1,context:{noBatch:!0}}),d.a(m,t),n=(0,r._)({},p,void 0),d.a(v,n),(0,a.tZ)(l.u,(0,i._)((0,r._)({noPadding:!0,maxWidth:c.W,fitContent:!0,isOpen:s,onRequestClose:u},h),{children:(0,a.tZ)(c.Z,(0,i._)((0,r._)({},h),{onCyclesCheckoutComplete:u,onPlanCheckoutComplete:function(e){"function"==typeof f&&f(e),e!==g.Pg&&u()}}))}))}},62808:function(e,t,n){n.d(t,{Y:function(){return x},Z:function(){return S}});var r=n(8182),i=n(43429),o=n(74633),a=n(84357),l=n(38265),c=n(92994),s=n(40497),u=n(16643),d=n(59173),f=n(29287),h=n(56596),p=n(63461),m=n(99071),v=n(86790),g=(0,d.u)(null),y=(0,d.u)(null),b=(0,d.u)({from:0,to:0}),Z=l.p.mark({class:"ast-hover"}),w=l.tk.baseTheme({".ast-hover":{background:f.TV.backgroundHighest}});function x(e){var t=e.view,n=(0,c.Z)({view:t}),r=(0,v.k)();(0,i.useEffect)(function(){if(r&&t){g.current=t.state;var e=a.Py.define(),i=(0,m.uf)([y.subscribe(function(n){t.dispatch({effects:e.of(n)})}),b.subscribe(function(e){t.dispatch({selection:{anchor:e.from,head:e.to}})})]);return t.dispatch({effects:n.reconfigure([l.tk.updateListener.of(function(e){(e.selectionSet||e.docChanged)&&(g.current=e.state)}),a.QQ.define({create:function(){return l.p.none},update:function(t,n){return t=t.map(n.changes),(0,s.j)(n,e,function(e){t=null==e.value?l.p.none:l.p.set([Z.range(e.value.from,e.value.to)])}),t},provide:function(e){return l.tk.decorations.from(e)}}),w])}),function(){g.current=null,i(),t.dispatch({effects:n.reconfigure([])})}}},[t,r,n])}var C=(0,i.memo)(function(e){var t=e.node,n=e.index,i=e.active,o=e.terminal,a=t.type.name,l={from:t.from,to:t.to};return(0,r.BX)(h.G,{css:[{marginLeft:4*n+(o?4:0)},f.l0.mb(4),f.l0.rowWithGap(2),f.l0.align.center,f.l0.cursor.pointer],onMouseEnter:function(){y.current=l},onClick:function(){y.current=null,b.current=l},children:[(0,r.tZ)(p.Z,{size:"small",fontFamily:a.length>1?"sans-serif":"monospace",fontWeight:i?"bold":"regular",children:a}),(0,r.BX)(p.Z,{size:"xsmall",truncate:!0,children:["(",t.from,"  ",t.to,")"]})]})});function _(e,t){for(var n=[];t(e);)n.push(e.node);return n}var k=(0,i.memo)(function(e){var t=e.state,n=(0,o.qz)(t),a=t.selection.main.head,l=(0,i.useMemo)(function(){return _(n.cursorAt(a),function(e){return e.parent()}).reverse()},[n,a]),c=(0,i.useMemo)(function(){return _(n.cursorAt(a),function(e){return e.prevSibling()})},[n,a]),s=(0,i.useMemo)(function(){return _(n.cursorAt(a),function(e){return e.nextSibling()})},[n,a]);return(0,r.BX)(h.G,{css:f.l0.ml(4),onMouseLeave:function(){y.current=null},children:[l.map(function(e,t){return(0,r.tZ)(C,{node:e,index:t},t)}),c.map(function(e,t){return(0,r.tZ)(C,{node:e,index:l.length,terminal:!0},t)}),(0,r.tZ)(C,{node:n.resolveInner(t.selection.main.head),index:l.length,terminal:!0,active:!0}),s.map(function(e,t){return(0,r.tZ)(C,{node:e,index:l.length,terminal:!0},t)})]})});function S(e){var t=e.isHidden,n=(0,u.Z)(g);return t?null:n?(0,r.tZ)(k,{state:n}):null}},12621:function(e,t,n){n.d(t,{YX:function(){return Z},ho:function(){return w}});var r=n(23026),i=n(45903),o=n(25e3),a=n(32477),l=n(8182),c=n(43429),s=n(29287),u=n(74833),d=n(56596),f=n(71984),h=n(88936),p=n(34815),m=n(32377),v=n(61155),g=n(16643),y=n(59173),b=n(98463),Z=new(function(){"use strict";function e(){var t=this;(0,r._)(this,e),this.counter=0,this.enabled=!1,this.maxEntries=10,this.logs=(0,y.u)([]),this.clear=function(){t.logs.current=[]}}var t=e.prototype;return t.toggle=function(e){this.enabled=e},t.add=function(e){var t=this,n=this.counter++;if(!this.enabled)return{id:n};var r={id:n,request:e,requestTime:Date.now()};return this.logs.update(function(e){return[r].concat(e).slice(0,t.maxEntries)}),{id:n}},t.update=function(e,t){this.enabled&&this.logs.update(function(n){var r=n.findIndex(function(t){return t.id===e.id});if(-1===r)return n;var i=n.slice();return i[r]=t(i[r]),i})},t.complete=function(e,t){this.update(e,function(e){return(0,o._)((0,i._)({},e),{response:t,responseTime:Date.now()})})},t.abort=function(e){this.logs.update(function(t){return t.filter(function(t){return t.id!==e.id||null!=t.responseTime})})},e}()),w=function(e){var t=e.isHidden,n=(0,g.Z)(Z.logs);return t?null:(0,l.BX)(d.G,{css:[s.l0.flex.column],children:[(0,l.BX)(d.G,{css:[s.l0.flex.row,s.l0.align.center,s.l0.m(4),s.l0.position.sticky,s.l0.top(0),s.l0.backgroundColor.backgroundDefault,s.l0.zIndex(1)],children:[(0,l.tZ)(u.xv,{css:s.l0.flex.grow(1),multiline:!1,children:"Requests"}),(0,l.tZ)(f.Z,{onClick:Z.clear})]}),(0,l.BX)(d.G,{css:[s.l0.flex.grow(1),s.l0.flex.column,s.l0.overflow("auto")],children:[n.map(function(e){var t;return(0,l.tZ)(x,{log:e},null!==(t=e.id)&&void 0!==t?t:e.requestTime.valueOf())}),!n.length&&(0,l.tZ)(d.G,{css:s.l0.m(4),children:"\uD83D\uDE14 No logs yet..."})]})]})},x=(0,c.memo)(function(e){var t,n=e.log,r=n.requestTime,i=n.responseTime,o=n.request,c=n.response,f=(0,a._)((0,v.Z)(!0),2),g=f[0],y=f[1],Z=o.code.length>20?"...".concat(o.code.slice(-20)):o.code;return(0,l.BX)(d.G,{css:[s.l0.my(4),s.l0.mx(4)],children:[(0,l.BX)(d.G,{role:"button",onClick:y,onKeyDown:y,tabIndex:0,css:[s.l0.flex.row,s.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],children:[(0,l.BX)(d.G,{css:[s.l0.flex.grow(1),s.l0.rowWithGap(2)],children:[(0,l.tZ)(u.xv,{multiline:!1,children:(t=n.response)?"CompleteCodeResult"===t.__typename?(0,l.tZ)(m.Z,{}):(0,l.tZ)(p.Z,{}):(0,l.tZ)(h.Z,{})}),(0,l.tZ)(u.xv,{multiline:!1,children:(0,l.tZ)("code",{children:Z})})]}),(0,l.tZ)(d.G,{css:{opacity:.5},children:null!=i&&(0,l.BX)(u.xv,{css:s.l0.fontSize(13),multiline:!1,children:[i.valueOf()-r.valueOf()," ms"]})})]}),!g&&(0,l.BX)(l.HY,{children:[void 0!==o&&(0,l.tZ)(b.g,{name:"request",src:o}),void 0!==c&&("CompleteCodeResult"===c.__typename?(0,l.BX)("details",{children:[(0,l.tZ)("summary",{children:"Response"}),(0,l.tZ)("pre",{css:[s.l0.overflow("scroll"),s.l0.borderRadius(4),s.l0.p(4),{border:"1px solid ".concat(s.TV.outlineDimmest)}],children:c.code})]}):(0,l.tZ)(b.g,{name:"response",src:c}))]})]})})},87271:function(e,t,n){n.d(t,{Sj:function(){return l},Th:function(){return o},UB:function(){return c},a0:function(){return s},cF:function(){return i},ot:function(){return a}});var r=n(90234),i=function(e,t){var n=e.dir,r=e.channel,i=e.cmd;return(!t.direction||n===t.direction)&&(!t.regexp||!t.regexp.test||!!(r.name&&t.regexp.test(r.name))||!!(r.service&&t.regexp.test(r.service))||!!t.regexp.test(JSON.stringify(i)))},o=(0,r.cn)([]),a=(0,r.cn)({regexp:null,direction:"",highlightOnly:!1}),l=(0,r.cn)(function(e){var t,n;return t=e(o),((n=e(a)).regexp||n.direction)&&!n.highlightOnly?t.filter(function(e){return i(e,n)}):t}),c=(0,r.cn)(null,function(e,t){t(o,[])}),s=(0,r.cn)(!1)},28131:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(32477),i=n(21289),o=n(54916),a=n(71999),l=n(94106),c=n(43429),s=n(87271);function u(){var e=(0,l.useRouter)(),t=(0,o.Z)().container,n=(0,r._)((0,a.KO)(s.a0),2),u=n[0],d=n[1],f=(0,a.b9)(s.Th);(0,c.useEffect)(function(){e.query.debug&&d(!0)},[d,e.query.debug]),(0,c.useEffect)(function(){if(u)return t.client().onDebugLog(function(e){if("log"===e.type){if(e.log.channel){if(n={name:e.log.channel.name,service:null},"string"==typeof e.log.channel.service)n.service=e.log.channel.service;else if(e.log.channel.service){var n,r=t.getContext();r&&(n.service=e.log.channel.service(r))}}f(function(t){return(0,i._)(t).concat([{index:t[t.length-1]?t[t.length-1].index+1:0,channel:n,dir:e.log.direction,cmd:e.log.cmd,timestamp:window.performance.now()}])})}})},[u,f,t])}},98463:function(e,t,n){n.d(t,{L:function(){return B},g:function(){return A}});var r=n(39698),i=n(45903),o=n(25e3),a=n(32477),l=n(21289),c=n(8182),s=n(43429),u=n(10981),d=n(58091),f=n(69926),h=n(15146),p=n(18836),m=n(29287),v=n(74833),g=n(56596),y=n(71984),b=n(60769),Z=n(10099),w=n(88936),x=n(80339),C=n(87279),_=n(69640),k=n(12036),S=n(97615),E=n(21869),T=n(58719),R=n(32377),I=n(61155),D=n(99071),G=n(97703),B=function(e){var t,n,r,w,C=e.isHidden,_=(n=(t=(0,a._)((0,s.useState)(null),2))[0],r=t[1],w=(0,d.R3)(),(0,s.useEffect)(function(){w!==n&&null!=w&&r(w)},[w,n]),n),k=(0,f.Z)(_||""),S=(0,u.U)(),T=(0,a._)((0,I.Z)(!0),2),R=T[0],G=T[1],B=(0,a._)((0,s.useState)(""),2),A=B[0],U=B[1],L=(0,a._)((0,s.useState)(function(){return[]}),2),O=L[0],X=L[1],M=(0,a._)((0,I.Z)(!0),2),F=M[0],W=M[1],H=(0,a._)((0,I.Z)(!0),2),V=H[0],z=H[1],j=(0,s.useCallback)(function(e){X(function(t){return[e].concat((0,l._)(t)).slice(0,100)})},[]),q=(0,s.useCallback)(function(e,t){X(function(n){for(var r=0;r<n.length;r++)if(n[r].id===e){n[r]=t(n[r]);break}return n.slice(0,100)})},[]),Y=(0,s.useCallback)(function(){X([])},[]),$=null==k?void 0:k.isOpen(_||""),J=(0,s.useCallback)(function(){j({canceled:!1,notification:{method:"probe",params:{filePath:_,state:null==k?void 0:k.getServerState(),capabilities:null==k?void 0:k.getServerCapabilities(),diagnostics:$?null==k?void 0:k.getDiagnostics(_||""):[],isOpen:$,isSupportedFile:null==k?void 0:k.isSupportedFile(_||"")}},requestTime:new Date,type:"probe"})},[j,k,_,$]),K=(0,s.useMemo)(function(){var e=A.split(",").map(function(e){return e.trim()}).filter(Boolean);if(!e.length)return O;var t=O;return F||(t=t.filter(function(e){return null==e.notification})),V||(t=t.filter(function(e){return null==e.request})),A&&(t=t.filter(function(t){return e.some(function(e){var n;return null===(n=t.request||t.notification)||void 0===n?void 0:n.method.toLowerCase().includes(e.toLowerCase())})})),t},[O,F,V,A]);return((0,s.useEffect)(function(){return(0,D.uf)([null==k?void 0:k.onRequest(function(e){R&&j({id:e.id,canceled:!1,request:e.data,requestTime:new Date})}),null==k?void 0:k.onResponse(function(e){R&&q(e.id,function(t){return(0,i._)((0,o._)((0,i._)({},t),{responseTime:new Date}),void 0!==e.result?{response:e.result}:{error:e.error})})}),null==k?void 0:k.onCancelRequest(function(e){R&&q(e,function(e){return(0,o._)((0,i._)({},e),{canceled:!0})})}),null==k?void 0:k.onDiagnostics(function(e){var t=e.path,n=e.diagnostics;R&&j({canceled:!1,notification:{method:"textDocument/publishDiagnostics for "+t,params:n},requestTime:new Date,type:"diagnostics"})}),null==k?void 0:k.onServerStateChange(function(e){R&&j({canceled:!1,notification:{method:"state",params:{serverState:e}},requestTime:new Date,type:"state"})}),null==k?void 0:k.onServerCapabilitiesChange(function(e){R&&j({canceled:!1,notification:{method:"capabilities",params:{serverCapabilities:e}},requestTime:new Date,type:"capabilities"})}),null==k?void 0:k.onSendNotification(function(e){R&&j({canceled:!1,notification:e,requestTime:new Date})})])},[k,j,q,R]),C)?null:(0,c.BX)(g.G,{css:[m.l0.flex.column],children:[(0,c.BX)(g.G,{css:[m.l0.flex.row,m.l0.align.center,m.l0.m(4),m.l0.position.sticky,m.l0.top(0),m.l0.backgroundColor.backgroundDefault,m.l0.zIndex(1)],children:[(0,c.tZ)(v.xv,{multiline:!1,children:k?(0,c.BX)(c.HY,{children:[(0,c.tZ)(N,{})," logs for ",(0,c.tZ)("code",{children:_})]}):"No LSP client available"}),(0,c.tZ)(h.hU,{alt:"Probe LSP",onClick:J,children:(0,c.tZ)(x.Z,{})}),(0,c.tZ)(g.G,{css:m.l0.flex.grow(1)}),(0,c.tZ)(Z.Z,{id:"toggleIsLogging",isOn:R,onChange:G})," "]}),(0,c.BX)(g.G,{css:[m.l0.rowWithGap(8),m.l0.m(4),m.l0.mb(8)],children:[(0,c.BX)(g.G,{css:m.l0.rowWithGap(4),children:[(0,c.tZ)(E.Z,{}),(0,c.tZ)(v.xv,{multiline:!1,children:"Show"})]}),(0,c.BX)(g.G,{css:m.l0.rowWithGap(4),children:[(0,c.tZ)(b.X,{id:S("showNotifications"),checked:F,onChange:W}),(0,c.tZ)("label",{htmlFor:S("showNotifications"),children:" Notifications"})]}),(0,c.BX)(g.G,{css:m.l0.rowWithGap(4),children:[(0,c.tZ)(b.X,{id:S("showRequests"),checked:V,onChange:z}),(0,c.tZ)("label",{htmlFor:S("showRequests"),children:" Requests"})]}),(0,c.tZ)(g.G,{css:m.l0.flex.growAndShrink(1)}),(0,c.tZ)(g.G,{css:m.l0.rowWithGap(4),children:(0,c.tZ)(y.Z,{onClick:Y})})]}),(0,c.tZ)(g.G,{css:m.l0.rowWithGap(4),children:(0,c.tZ)(p.II,{id:S("filterLsp"),placeholder:"Filter by method (Separate by ,)",onChange:function(e){return U(e.target.value)},value:A})}),(0,c.BX)(g.G,{css:[m.l0.flex.grow(1),m.l0.flex.column,m.l0.overflow("auto")],children:[K.map(function(e,t){var n;return(0,c.tZ)(P,{log:e},null!==(n=e.id)&&void 0!==n?n:e.requestTime.valueOf()+""+t)}),!K.length&&(0,c.tZ)(g.G,{css:m.l0.m(4),children:"\uD83D\uDE14 No logs yet..."})]})]})},P=s.memo(function(e){var t,n,r,i,o,l=e.log,s=l.requestTime,u=l.responseTime,d=l.request,f=l.response,h=l.notification,p=l.id,y=(0,a._)((0,I.Z)(!0),2),b=y[0],Z=y[1];return(0,c.BX)(g.G,{css:[m.l0.my(4),m.l0.mx(4)],children:[(0,c.BX)(g.G,{role:"button",onClick:Z,onKeyDown:Z,tabIndex:0,css:[m.l0.flex.row,m.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],children:[(0,c.BX)(g.G,{css:[m.l0.flex.grow(1),m.l0.rowWithGap(2)],children:[(0,c.tZ)(v.xv,{className:"lspLog-emoji",multiline:!1,children:(t=l.type,n=l.canceled,r=l.response,i=l.notification,"state"===t?(0,c.tZ)(k.Z,{}):"diagnostics"===t?(0,c.tZ)(C.Z,{}):"capabilities"===t?(0,c.tZ)(_.Z,{}):"probe"===t?(0,c.tZ)(x.Z,{}):n?(0,c.tZ)(T.Z,{}):i?(0,c.tZ)(S.Z,{}):void 0!==r?(0,c.tZ)(R.Z,{}):(0,c.tZ)(w.Z,{}))}),(0,c.BX)(v.xv,{className:"lspLog-requestMethod",multiline:!1,children:[(0,c.tZ)("code",{children:null===(o=d||h)||void 0===o?void 0:o.method}),null!=p&&(0,c.BX)("code",{className:"lspLog-logId",css:{opacity:.5},children:["#",p]})]})]}),(0,c.tZ)(g.G,{css:{opacity:.5},children:null!=u&&(0,c.BX)(v.xv,{css:m.l0.fontSize(13),multiline:!1,children:[u.valueOf()-s.valueOf()," ms"]})})]}),!b&&(0,c.BX)(c.HY,{children:[void 0!==d&&(0,c.tZ)(A,{name:"request.params",src:d.params}),void 0!==h&&(0,c.tZ)(A,{name:"notification.params",src:h.params}),void 0!==f&&(0,c.tZ)(A,{name:"response",src:f})]})]})}),A=(0,s.memo)(function(e){var t=e.name,n=e.src;return(0,c.tZ)(g.G,{css:{marginTop:5,".node-ellipsis":{letterSpacing:-2},".object-key span":{letterSpacing:0},".object-key-val":{paddingBottom:"0 !important"},'.object-key + span[style*="margin"], .array-key + span[style*="margin"]':{marginLeft:"0 !important"},".variable-row, .pushed-content .object-key-val":{paddingLeft:"10px !important",paddingBottom:"0 !important"}},children:(0,c.tZ)(G.Z,{json:(0,r._)({},t,n)})})}),N=function(){return(0,c.tZ)(v.xv,{multiline:!1,css:{display:"inline",fontStyle:"italic",fontWeight:600,textShadow:"".concat(m.TV.redDimmer," 2px 2px")},children:"LSP"})}},61155:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(32477),i=n(43429);function o(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,r._)((0,i.useState)(e),2),n=t[0],o=t[1];return[n,(0,i.useCallback)(function(){return o(function(e){return!e})},[])]}},46689:function(e,t,n){n.d(t,{AA:function(){return _},CH:function(){return y},Gg:function(){return v},Ne:function(){return S},pV:function(){return x},vk:function(){return Z}});var r=n(45903),i=n(93295),o=n(23982),a=n(79962),l=n(66039),c=n(13440);function s(){var e=(0,i._)(["\n  fragment AutograderTest on ReplTemplateTest {\n    id\n    name\n    input\n    output\n    name\n    type\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  query Autograder($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        currentUserPermissions {\n          writeTests\n        }\n        template {\n          id\n        }\n        ioTests {\n          id\n          ...AutograderTest\n        }\n        unitTests {\n          meta {\n            id\n            ...UnitTestsReplUnitTestMeta\n          }\n          tests {\n            id\n            ...UnitTestsReplUnitTest\n            lastRun(replId: $replId) {\n              ... on ReplUnitTestLastRun {\n                status\n              }\n              ... on UserError {\n                message\n              }\n            }\n          }\n        }\n        isProject\n        isProjectFork\n        owner {\n          ... on Team {\n            id\n            isAdmin\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation SaveIOTestResults(\n    $teamId: Int!\n    $replId: String!\n    $results: [IOTestResultInput!]!\n  ) {\n    saveIOTestResults(teamId: $teamId, replId: $replId, results: $results) {\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation CreateAutograderTest($input: CreateTemplateTestInput!) {\n    createTemplateTest(input: $input) {\n      ... on ReplTemplateTest {\n        id\n        ...AutograderTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  mutation UpdateAutograderTest($input: UpdateTemplateTestInput!) {\n    updateTemplateTest(input: $input) {\n      ... on ReplTemplateTest {\n        id\n        ...AutograderTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation DeleteAutograderTest($testId: Int!) {\n    deleteTemplateTest(testId: $testId) {\n      ... on ReplTemplate {\n        id\n        tests {\n          id\n          ...AutograderTest\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}var m={},v=(0,o.Ps)(s()),g=(0,o.Ps)(u(),v,a.aA,a.Rb);function y(e){var t=(0,r._)({},m,e);return l.a(g,t)}var b=(0,o.Ps)(d());function Z(e){var t=(0,r._)({},m,e);return c.D(b,t)}var w=(0,o.Ps)(f(),v);function x(e){var t=(0,r._)({},m,e);return c.D(w,t)}var C=(0,o.Ps)(h(),v);function _(e){var t=(0,r._)({},m,e);return c.D(C,t)}var k=(0,o.Ps)(p(),v);function S(e){var t=(0,r._)({},m,e);return c.D(k,t)}},50586:function(e,t,n){n.d(t,{x:function(){return $},W:function(){return J}});var r,i=n(8182),o=n(38265),a=n(27308),l=n(23026),c=n(39698),s=n(45903),u=n(25e3),d=n(7730),f=n.n(d),h=n(75023),p=n(93918),m=n(29287),v=n(56596),g=n(74833),y=n(74652),b=n(54472),Z=n(7612),w=n(53466),x=n(13900),C=n(38080),_=n(93496),k=n(43429),S=n(91608),E=n(84357),T=n(44166),R=n(30983),I=n(95684),D=n(40497),G=(0,S.$)(["opacity","transform"]),B=G.cssVars,P=G.styleTokens,A=[m.l0.display.flex,m.l0.reset.button,m.l0.cursor.pointer,m.l0.center,_.gU.nofill,m.l0.height("100%"),m.l0.borderRadius(0)],N=[A,m.l0.width(28),{"& svg":m.l0.display.block}],U=(0,p.X)({root:[m.l0.align.stretch,m.l0.flex.row,m.l0.borderRadius(6),m.l0.border({color:m.TV.outlineDefault}),m.l0.position.relative,m.l0.height(30),{opacity:P.opacity,transform:P.transform,transition:"opacity 120ms, transform 120ms","button:first-of-type":{borderTopLeftRadius:6,borderBottomLeftRadius:6},"button:last-of-type":{borderTopRightRadius:6,borderBottomRightRadius:6}}],moreButton:N,button:[A,m.l0.rowWithGap(4),m.l0.align.center,m.l0.pl(4),m.l0.pr(6),m.l0.flex.growAndShrink(1),m.l0.border({direction:"right",color:m.TV.outlineDefault}),{fontFamily:m.TV.fontFamilyDefault,"*":{color:m.TV.foregroundDimmer},":hover *":{color:m.TV.foregroundDefault},".shortcut":{color:m.TV.foregroundDimmest},":hover .shortcut":{color:m.TV.foregroundDimmer}}],iconButton:[N,m.l0.border({direction:"right",color:m.TV.outlineDefault})],tooltip:[m.l0.rowWithGap(2),m.l0.align.center]}),L=new b.Jf(function(e){var t,n=e.controls,r=e.verticalPlacement,o=e.onMoreClick,a=(0,k.useRef)(null),l=(0,I.xx)();(0,k.useEffect)(function(){var e;l(),(0,T.A)(a,(e={},(0,c._)(e,B.opacity,"1"),(0,c._)(e,B.transform,"translateY(calc(".concat("top"===r?1:-1," * ").concat(m.TV.space4,"))")),e))},[r,l]);var d=(0,k.useRef)((0,I.qm)());return(0,i.BX)(C.Tg,{innerRef:a,elevated:!0,css:U.root,style:(t={},(0,c._)(t,B.opacity,"0"),(0,c._)(t,B.transform,"translateY(calc(".concat("top"===r?1:-1," * ").concat(m.TV.space16,"))")),t),children:[n.map(function(e){if(d.current){var t=(0,i.BX)(v.G,{css:U.tooltip,children:[(0,i.tZ)(g.xv,{variant:"small",multiline:!1,children:e.text}),e.shortcut?(0,i.tZ)(g.xv,{variant:"small",className:"shortcut",color:"dimmest",children:(0,y.Ih)(e.shortcut)}):null]});return(0,i.tZ)(R.u,{tooltip:t,children:function(t,n){return(0,i.tZ)(v.G,(0,u._)((0,s._)({},t),{innerRef:n,css:U.iconButton,onClick:e.onClick,tag:"button",children:e.icon}))}},e.text)}return(0,i.BX)(v.G,{css:U.button,onClick:e.onClick,tag:"button",children:[e.icon,(0,i.tZ)(g.xv,{variant:"small",multiline:!1,children:e.text}),e.shortcut?(0,i.BX)(g.xv,{variant:"small",className:"shortcut",children:["(",(0,y.Ih)(e.shortcut),")"]}):null]},e.text)}),(0,i.tZ)(v.G,{"aria-label":"More",css:U.moreButton,onClick:function(e){var t=(a.current||e.currentTarget).getBoundingClientRect();o({top:t.top,right:t.right})},tag:"button",children:(0,i.tZ)(x.Z,{size:16})})]})}),O={layer:"cm-selection-controls-layer",dom:"cm-selection-controls-dom"},X=o.tk.theme((r={},(0,c._)(r,".".concat(O.layer),{width:"100%"}),(0,c._)(r,".".concat(O.dom),{position:"absolute"}),r)),M=function(){"use strict";function e(t){(0,l._)(this,e),this.options=t}var t=e.prototype;return t.draw=function(){var e=this.options,t=e.controls,n=e.onMoreClick,r=e.top,i=e.align,o=e.verticalPlacement,a=L.create({controls:t,onMoreClick:n,verticalPlacement:o});return a.className=O.dom,a.style.top=r+"px","left"===i.side?(a.style.left=i.value+"px",a.style.right=""):(a.style.right=i.value+"px",a.style.left=""),a},t.eq=function(e){return f()(e.options,this.options)},e}(),F=E.Py.define(),W=E.QQ.define({create:function(){return null},update:function(e,t){var n;return!t.state.selection||(null===(n=t.state.selection)||void 0===n?void 0:n.main.empty)?null:((0,D.j)(t,F,function(t){e=t.value}),e)}}),H=E.QQ.define({create:function(e){return!e.selection.main.empty},update:function(e,t){return!t.state.selection.main.empty}}),V=o.lg.define(function(e){var t=function(){var t=e.state.selection.main;e.dispatch({effects:F.of(t.empty?null:Date.now())})},n=function(e){"Shift"===e.key&&t()},r=function(){document.addEventListener("mouseup",t),document.addEventListener("keyup",n)},i=function(){document.removeEventListener("mouseup",t),document.removeEventListener("keyup",n)};return{update:function(e){(0,Z.a)(e,H)&&(e.state.field(H)?r():i())},destroy:i}}),z=new h.j(function(e){return[X,(0,o.EY)({above:!0,class:O.layer,update:function(e){return(0,Z.a)(e,w.$,W)},markers:function(t){var n=t.state.field(W)?t.state.selection.main:null;if(!n||t.state.field(w.$,!1))return[];var r=function(e,t){for(var n=Math.min(t.from,t.to),r=Math.max(t.from,t.to),i=null;n<=r;){var o=e.lineAt(n);n=o.to+1,null!==i&&o.length<i.length||(i=o)}return i}(t.state.doc,n);if(!r)return[];var i=t.coordsAtPos(r.to);if(!i)return[];var o=t.lineBlockAt(Math.min(n.anchor,n.head)),a=t.dom.getBoundingClientRect(),l=t.contentDOM.getBoundingClientRect(),c=o.top+t.documentPadding.top-30,s=l.right-i.left<200?{side:"right",value:a.right-l.right+16}:{side:"left",value:i.left-a.left},u="top";if(c<t.scrollDOM.scrollTop){var d=t.lineBlockAt(n.to);c=d.top+d.height,u="bottom"}return[new M({top:c,align:s,controls:e.controls(t),onMoreClick:e.onMoreClick,verticalPlacement:u})]}}),H,W,V]}),j=n(19408),q=n(12880),Y=n(49932),$={id:"editor.generateOrModifyWithAI",name:"AI",description:"Generate or modify selection with AI",default:(0,a.l2)({cmdOrCtrl:!0,key:"i"})};function J(e){var t=e.editCode,n=e.explainCode,r=e.generateCode,a=e.onMoreClick,l=(0,y.gf)($.id),c=(0,k.useMemo)(function(){if(!l)return[];var e=Array.isArray(l)?l.join(" "):l;return o.$f.of([{key:e,scope:"editor",run:function(e){return e.state.selection.main.empty?r(e):t(e),!0}}])},[l,r,t]),s=(0,k.useMemo)(function(){return{controls:function(e){return[{text:"Modify",icon:(0,i.tZ)(q.Z,{size:16,color:Y.TV.blurpleStronger}),onClick:function(){return t(e)},shortcut:l},{text:"Explain",icon:(0,i.tZ)(j.Z,{size:16,color:Y.TV.blurpleStronger}),onClick:function(){return n(e)}}]},onMoreClick:a}},[t,n,a,l]),u=z.use(s);return(0,k.useMemo)(function(){return[u,c]},[u,c])}},11398:function(e,t,n){n.d(t,{Mp:function(){return l},ac:function(){return a},ev:function(){return o}});var r=n(51384),i=n(29287),o=(0,r.iv)({position:"relative",overflowY:"auto",width:"100%",height:"100%",zIndex:3}),a=(0,r.iv)({position:"relative",overflowY:"auto",width:"100%",height:"100%",fontSize:"14px",backgroundColor:i.TV.backgroundDefault}),l=(0,r.iv)({display:"flex",alignItems:"stretch",width:"100%",height:"100%","& > .cm-editor":{flex:"1 1 auto",width:"100%"}})},17225:function(e,t,n){n.d(t,{Q1:function(){return b},Rz:function(){return g},xy:function(){return Z}});var r=n(34142),i=n(21289),o=n(87682),a=n(8182),l=n(14339),c=n(69119),s=n(93918),u=n(29287),d=n(56596),f=n(57468),h=n(29559),p=(0,s.X)({root:[u.l0.rowWithGap(8),u.l0.align.center,u.l0.flex.growAndShrink(1),u.l0.px(8),{userSelect:"none"}],header:[{fontSize:u.TV.fontSizeSmall,opacity:.6},u.l0.color.foregroundDimmest,u.l0.truncate],result:[u.l0.colWithGap(0)],fileName:[u.l0.truncate,u.l0.flex.row]});function m(e){var t=e.height,n=e.active,r=e.match,i=r.directory,o=r.filename;return(0,a.BX)(d.G,{css:p.root,style:{height:t},children:[(0,a.tZ)(f.Z,{path:o.text,size:16}),(0,a.BX)(d.G,{css:p.result,children:[i?(0,a.tZ)(d.G,{css:p.header,children:(0,a.tZ)(c.x,{text:i.text+"/",highlight:i.ranges,dimmed:!n})}):null,(0,a.tZ)(d.G,{css:p.fileName,children:(0,a.tZ)(c.x,{text:o.text,highlight:o.ranges,dimmed:!n})})]})]})}var v={match:l.kN,forward:!1,tiebreakers:[function(e,t,n){return n(e.item).trim().length-n(t.item).trim().length}]};function g(e,t){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(e,t){return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,new l.Zn(t,v).find(e)];case 1:return[2,n.sent().map(function(e){return{path:e.item,score:e.score,ranges:function(e){for(var t=(0,i._)(e.values()).sort(function(e,t){return e-t}),n=[],r=t[0],o=t[0],a=1;a<t.length;a++)t[a]===o+1?o++:(n.push({from:r,to:o+1}),r=t[a],o=t[a]);return n.push({from:r,to:o+1}),n}(e.positions)}})]}})})).apply(this,arguments)}function b(e){var t=e.ranges,n=e.path,r=(0,h.UO)(n),i=(0,h.Il)(n);if(!i)return{filename:{text:r,ranges:t.length?t:void 0}};var o=i.length,a=o+1,l=[],c=[],s=!0,u=!1,d=void 0;try{for(var f,p=t[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var m=f.value;if(m.from<o){l.push({from:m.from,to:Math.min(m.to,o)});var v=m.to-a;if(v<=0)continue;c.push({from:0,to:v});continue}m.from<a||c.push({from:m.from-a,to:m.to-a})}}catch(e){u=!0,d=e}finally{try{s||null==p.return||p.return()}finally{if(u)throw d}}return{filename:{text:r,ranges:c.length?c:void 0},directory:{text:i,ranges:l.length?l:void 0}}}function Z(e){var t=e.path,n=e.ranges,r=b({path:t,ranges:null!=n?n:[]}),i=r.directory?44:32;return{height:i,content:(0,a.tZ)(m,{match:r,height:i})}}},7727:function(e,t,n){n.d(t,{i:function(){return Z},w:function(){return g}});var r=n(34142),i=n(32477),o=n(87682),a=n(8182);n(43429);var l=n(31070),c=n(20573),s=n(80259),u=n(57468),d=n(56596),f=n(74833),h=n(29287),p=n(41500),m=n(17225),v=n(81764);function g(e){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(e){var t,n,r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(t=e.search,n=e.paths,r=e.run,!t)return[2,n.map(function(e){return{data:{type:"action",label:e,icon:(0,a.tZ)(u.Z,{path:e}),run:function(){return r(e)}},match:function(){return{score:1,render:(0,m.xy)({path:e})}}}})];return[4,(0,m.Rz)(t,n)];case 1:return[2,i.sent().map(function(e){var t=e.path,n=e.score,i=e.ranges;return{data:{type:"action",label:t,icon:(0,a.tZ)(u.Z,{path:t}),run:function(){return r(t)}},match:function(){return{score:n,render:(0,m.xy)({path:t,ranges:i})}}}})]}})})).apply(this,arguments)}function b(){return(0,a.BX)(d.G,{css:[h.l0.rowWithGap(8)],children:[(0,a.tZ)(c.Z,{}),(0,a.tZ)(f.xv,{color:"dimmest",multiline:!1,children:"Something went wrong searching your Repl's files. Please try again."})]})}function Z(e){var t;return(0,s.fA)({type:"context",label:"Files",description:"Find a file",icon:(0,a.tZ)(l.Z,{}),keyboardShortcut:e.keyboardShortcut?e.keyboardShortcut:void 0},{match:(0,s.zf)({defaultScore:3}),commands:(t=(0,r._)(function(t){var n,l,s,d,f,h,m,y,Z,w,x,C,_,k,S,E;return(0,o.Jh)(this,function(T){switch(T.label){case 0:if(n=e.fs,l=e.shouldHideFile,!t.search&&(!t.active||e.lazyLoad))return[2,[]];return[4,Promise.resolve(e.getRecentFiles())];case 1:if(s=T.sent(),d=[],!(t.search||t.active))return[3,3];return[4,n.listFiles()];case 2:if((f=T.sent()).error)return[2,[{data:{type:"error",label:f.error,icon:(0,a.tZ)(c.Z,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(b,{})}}}}]];if(!f.files)throw Error("Expected files");h=!0,m=!1,y=void 0;try{for(Z=f.files[Symbol.iterator]();!(h=(w=Z.next()).done);h=!0)x=w.value,l(x)||s.includes(x)||d.push(x)}catch(e){m=!0,y=e}finally{try{h||null==Z.return||Z.return()}finally{if(m)throw y}}T.label=3;case 3:return C=[],[4,Promise.all([g({search:t.search,paths:s,run:function(t){e.openFile({path:t})}}),g({search:t.search,paths:d,run:function(t){e.openFile({path:t})}})])];case 4:return k=(_=i._.apply(void 0,[T.sent(),2]))[0],S=_[1],k.length&&C.push({data:{type:"context",label:"Recent",icon:(0,a.tZ)(v.Z,{})},commands:function(){return k}}),S.length&&C.push({data:{type:"group",key:"files"},commands:function(){return S}}),0===S.length&&0===k.length&&t.active&&(E=t.search,C.push({data:{label:E,description:"Create a new file",icon:(0,a.tZ)(u.Z,{path:E}),type:"action",run:(0,r._)(function(){return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,n.writeFile(E,p.Z.from(""))];case 1:if(t.sent().error)return[2,{type:"error",message:'Could not create "'+E+'"'}];return e.openFile({path:E}),[2]}})})},match:function(){return{score:1}}})),[2,C]}})}),function(e){return t.apply(this,arguments)})})}},56287:function(e,t,n){n.d(t,{F:function(){return k},q:function(){return _}});var r=n(34142),i=n(32477),o=n(87682),a=n(8182);n(43429);var l=n(43208),c=n(80259),s=n(39313),u=n(82723),d=n(20573),f=n(29287),h=n(56596),p=n(74833),m=n(93918),v=n(57468),g=n(27308),y=n(19924),b=(0,m.X)({root:[f.l0.colWithGap(4),f.l0.align.start,f.l0.flex.growAndShrink(1),f.l0.p(8)],header:[f.l0.rowWithGap(4),f.l0.align.center],singleLine:[{whiteSpace:"nowrap",fontFamily:f.TV.fontFamilyCode},f.l0.truncate,f.l0.color.foregroundDimmest]});function Z(e){var t=e.path,n=e.line;return(0,a.BX)(h.G,{css:b.root,children:[(0,a.BX)(h.G,{css:b.header,children:[(0,a.tZ)(v.Z,{path:t,size:12}),(0,a.BX)(p.xv,{variant:"small",color:"dimmest",multiline:!1,children:[t.replace(/^\.\//,""),":",n.lineNumber]})]}),(0,a.tZ)(h.G,{css:b.singleLine,children:(0,a.tZ)(s.xK,{source:n.content,matches:n.matches})})]})}function w(){return(0,a.BX)(h.G,{css:[f.l0.px(8),f.l0.rowWithGap(8),f.l0.align.center],children:[(0,a.tZ)(d.Z,{}),(0,a.tZ)(p.xv,{color:"dimmest",multiline:!1,children:"Something went wrong searching your Repl's contents. Please try again."})]})}function x(){return(0,a.BX)(h.G,{css:[f.l0.rowWithGap(8),f.l0.p(8),f.l0.align.center],children:[(0,a.tZ)(d.Z,{}),(0,a.tZ)(p.xv,{color:"dimmest",multiline:!1,children:"Displaying only part of the results, try being more specific with your search."})]})}function C(){return(0,a.tZ)(h.G,{css:[f.l0.rowWithGap(8),f.l0.p(8),f.l0.align.center],children:(0,a.tZ)(p.xv,{color:"dimmest",multiline:!1,children:"Nothing came up searching your Repl's content."})})}var _=(0,g.l2)({cmdOrCtrl:!0,shift:!0,key:"f"});function k(e){var t,n,s=(0,y.e)({container:e.container});return(0,c.fA)({type:"context",description:"Search through your files",label:"Search",icon:(0,a.tZ)(u.Z,{}),keyboardShortcut:e.keyboardShortcut?_:void 0},{match:(0,c.zf)({defaultScore:2}),commands:(t=(0,r._)(function(t){var r,c,u,f,p,m,g,y,b,_,k,S;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(!t.search||!t.active&&e.activeOnly)return[2,[]];return n=r=Math.random(),[4,s({query:t.search})];case 1:if(u=(c=o.sent()).results,f=c.error,p=c.isPartialResult,r!==n)return[2,[]];if(null!==f){if(!t.active)return[2,[]];return[2,[{data:{type:"error",label:"error",icon:(0,a.tZ)(d.Z,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(w,{})}}}}]]}m=[],g=!0,y=!1,b=void 0;try{for(_=function(){var n=(0,i._)(S.value,2),r=n[0];n[1].forEach(function(n){var i=n.matches[0].column;m.push({match:function(){var e=l.Z.match(t.search,n.content);return{score:(null==e?void 0:e.score)||1,render:{height:60,content:(0,a.tZ)(Z,{path:r,line:n})}}},data:{type:"action",label:r,icon:(0,a.tZ)(v.Z,{path:r}),key:[r,n.lineNumber,i].join(":"),run:function(){e.openFile({path:r,line:n.lineNumber,col:i})}}})})},k=Object.entries(u)[Symbol.iterator]();!(g=(S=k.next()).done);g=!0)_()}catch(e){y=!0,b=e}finally{try{g||null==k.return||k.return()}finally{if(y)throw b}}if(0===m.length&&t.active)return[2,[{data:{type:"output",label:"",icon:(0,a.tZ)(h.G,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(C,{})}}}}]];if(t.active){if(0===m.length)return[2,[{data:{type:"output",label:"",icon:(0,a.tZ)(h.G,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(C,{})}}}}]];p&&m.push({data:{type:"error",label:"error",icon:(0,a.tZ)(d.Z,{})},match:function(){return{score:1/0,render:{content:(0,a.tZ)(x,{})}}}})}return[2,m]}})}),function(e){return t.apply(this,arguments)})})}},15011:function(e,t,n){n.d(t,{Z:function(){return ew}});var r,i,o=n(34142),a=n(45903),l=n(25e3),c=n(32477),s=n(87682),u=n(8182),d=n(43429),f=n(39426),h=n(72392),p=n(9521),m=n(94450),v=n.n(m),g=function(e){var t=(0,h._)({},(0,p._)(e));return(0,u.BX)(u.HY,{children:[(0,u.tZ)(v(),{id:"fcfe85a13ecbf46b",children:".one.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:0s;-moz-animation-delay:0s;-o-animation-delay:0s;animation-delay:0s}.two.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:.1s;-moz-animation-delay:.1s;-o-animation-delay:.1s;animation-delay:.1s}.three.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:.2s;-moz-animation-delay:.2s;-o-animation-delay:.2s;animation-delay:.2s}@-webkit-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@-moz-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@-o-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}"}),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"one"),children:"."})),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"two"),children:"."})),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"three"),children:"."}))]})},y=n(18836),b=n(74833),Z=n(1498),w=n(93295),x=n(23982),C=n(66039),_=n(13440);function k(){var e=(0,w._)(["\n  query ConfigReplLanguage($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        language\n      }\n    }\n  }\n"]);return k=function(){return e},e}function S(){var e=(0,w._)(["\n  mutation ConfigUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n      }\n    }\n  }\n"]);return S=function(){return e},e}var E={},T=(0,x.Ps)(k()),R=(0,x.Ps)(S()),I=n(54916),D=n(49344),G=n(35972),B=n(29287),P=n(93496),A=n(56596),N=n(72310),U=n(20573),L=n(24418),O=n(50782),X=n(59639),M=n(12834),F=n(7444),W=n(35273),H=n(82723),V=n(43208),z=n(63130),j=n(79217),q=n(51384),Y=n(31366),$=n(42308),J=(0,q.iv)([B.l0.py(8),B.l0.pl(8),B.l0.pr(32),{color:"inherit",outline:"0 none",border:"1px solid",fontSize:"inherit",lineHeight:B.TV.space16,display:"block",width:"100%","::placeholder, :disabled":{color:B.TV.foregroundDimmer,borderColor:"transparent"},cursor:"text"}]),K=(0,q.iv)([B.l0.reset.button,P.gU.listItem,B.l0.borderRadius(8),B.l0.center,{width:24,height:24}]),Q=A.K.button;function ee(e){var t,n,r,i,o,s,f,h,p,m,v,g=e.id,Z=e.onSelect,w=e.onInit,x=e.options,C=e.initialSelectedOption,_=e.placeholderText,k=e.autoFocus,S=e.disabled,E=d.useRef(null),T=(0,c._)(d.useState(null!=C?C:""),2),R=T[0],I=T[1],D=(n=(t={options:x,initialSelectedOption:C,inputRef:E,setInputValue:I}).options,r=t.initialSelectedOption,i=t.inputRef,o=t.setInputValue,f=(s=(0,c._)(d.useState(""),2))[0],h=s[1],p={options:n,filter:f},m=d.useMemo(function(){return p.filter?V.Z.filter(p.filter.toLowerCase(),p.options).map(function(e){return e.original}):p.options},[p.options,p.filter]),v=(0,z.Kb)({items:m,initialHighlightedIndex:0,initialSelectedItem:r,stateReducer:function(e,t){var n,r,c=t.type,s=t.changes;return((c===z.Kb.stateChangeTypes.ItemClick||c===z.Kb.stateChangeTypes.InputKeyDownEnter&&s.selectedItem)&&(null===(n=i.current)||void 0===n||n.blur()),c!==z.Kb.stateChangeTypes.InputBlur||s.selectedItem)?(c===z.Kb.stateChangeTypes.InputBlur&&s.selectedItem&&o(null!==(r=s.selectedItem)&&void 0!==r?r:""),s):(0,l._)((0,a._)({},s),{isOpen:!0})}}),{filteredOptions:m,combobox:v,setFilter:h,filter:f}),G=D.filteredOptions,P=D.filter,N=D.combobox,U=D.setFilter,L=(0,F.Z)(Z),O=(0,F.Z)(w);return d.useEffect(function(){C&&(O.current(C),I(C),U(""))},[C]),(0,W.Z)(function(){var e;N.selectedItem&&(null===(e=E.current)||void 0===e||e.blur(),L.current(N.selectedItem),I(N.selectedItem),U(""))},[N.selectedItem,L]),d.useEffect(function(){C&&(N.selectItem(C),I(C),U(""))},[C]),(0,u.BX)(A.G,{children:[(0,u.tZ)("div",(0,l._)((0,a._)({},N.getComboboxProps()),{children:(0,u.BX)(A.G,{css:[B.l0.flex.row,{position:"relative"}],children:[(0,u.tZ)(A.G,{css:[B.l0.flex.growAndShrink(1)],children:(0,u.tZ)(y.II,(0,l._)((0,a._)({},N.getInputProps({id:g,spellCheck:!1,autoFocus:k,onChange:function(e){U(e.currentTarget.value.toLowerCase()),I(e.currentTarget.value)},ref:E,onFocus:function(e){N.openMenu(),e.currentTarget.select()}})),{value:R,placeholder:null!=C?C:_,css:[J],disabled:S}))}),S?null:(0,u.tZ)(A.G,{css:[{position:"absolute",top:0,right:0,height:"100%"},B.l0.center],children:(0,u.tZ)(Q,(0,l._)((0,a._)({},N.getToggleButtonProps()),{css:K,type:"button",children:N.inputValue&&!N.isOpen?(0,u.tZ)(j.Z,{}):(0,u.tZ)(H.Z,{})}))})]})})),(0,u.BX)("div",(0,l._)((0,a._)({},N.getMenuProps()),{css:{position:"relative"},children:[N.isOpen&&G.length?(0,u.tZ)(Y.Z,{children:(0,u.tZ)("ul",{css:[B.l0.pt(4),B.l0.pb(8)],children:G.map(function(e,t){return(0,u.tZ)("li",(0,l._)((0,a._)({},N.getItemProps({item:e,index:t})),{children:(0,u.tZ)($.Z,(0,l._)((0,a._)({},{title:e,key:e.toLowerCase()}),{filter:P,selected:N.selectedItem===e,highlighted:N.highlightedIndex===t}))}),e.toLowerCase())})})}):null,P&&!G.length&&N.isOpen?(0,u.tZ)(Y.Z,{children:(0,u.tZ)(A.G,{css:[B.l0.p(16),B.l0.colWithGap(4)],children:(0,u.BX)(b.xv,{color:"dimmer",multiline:!1,children:['No results for "',P,'"']})})}):null]}))]})}var et=n(38080),en=n(29559);(r=i||(i={})).Unknown="UNKNOWN",r.Npm="NPM",r.Django="DJANGO",r.Rails="RAILS",r.DotNet="DOTNET",r.Cargo="CARGO",r.Make="MAKE",r.RegularRun="REGULAR_RUN";var er=RegExp("((index)|(main)|(app)|(run)|(start)|(server))\\..+","i"),ei=RegExp("((node_modules)|(venv)|(bower_components)|(vendor)|(build)|(dist)|(target)|(\\.git)|(\\.vscode)|(\\.idea)).+$","i"),eo=n(59868),ea=n(78975),el=n(76433),ec=n(37229),es=n(43891),eu=n(30084),ed=n(43778),ef=function(e){var t=e.split("/");if(1===t.length)return t;for(var n=[],r=0;r<t.length;r++)n.push(t.slice(0,r+1).join("/"));return n},eh=function(){var e=(0,I.Z)(),t=e.fs,n=e.dotReplit,r=(0,es.P)(n),i=(0,M.Z)(),a=(0,c._)(d.useState(null),2),l=a[0],u=a[1];return d.useEffect(function(){var e;(e=(0,o._)(function(){var e,n,o,a;return(0,s.Jh)(this,function(l){switch(l.label){case 0:if(!r)return[2];return[4,t.listFiles()];case 1:if(e=l.sent(),!i.current)return[2];if(e.error||!e.files)return u([]),[2];return[4,t.readFile(L.l)];case 2:return n=l.sent(),o=e.files,a=ed.uP.concat(ed.nh),u(o.filter(function(e){return(n.error===eu.Df.NotFound||!r.some(function(t){return ef(e).some(function(e){return null!=e.match(t)})}))&&!a.includes(e)})),[2]}})}),function(){return e.apply(this,arguments)})()},[r,t,i]),l},ep=n(55552),em=n(59121),ev=n(88936);function eg(e){var t=e.children;return(0,u.BX)(et.Tg,{background:"default",css:[B.l0.borderRadius(8),{width:"100%",height:"calc(100% - var(--space-2))",backgroundColor:"var(--background-default)",overflowY:"auto",marginTop:"0px"}],children:[(0,u.tZ)(A.G,{children:(0,u.tZ)(b.xv,{multiline:!1,variant:"subheadDefault",css:[B.l0.color.foregroundDimmest,B.l0.pl(16),B.l0.pt(16)],children:".replit"})}),(0,u.tZ)(A.G,{css:[B.l0.p(16),B.l0.justify.center,B.l0.align.center,{flex:"1 1 auto"}],children:t})]})}function ey(e){var t,n=!!e.hasInterpreter,r=e.initialRun,o=null!==(t=e.initialCompile)&&void 0!==t?t:"",s=e.isFrameworkRecommended,h=!!e.projType&&e.projType===i.Rails,p=e.isApplyingConfig,m=(0,c._)(d.useState("Unknown"===f.ZP.get(e.initialLanguage).displayName?"bash":e.initialLanguage),2),v=m[0];m[1];var g=(0,N.Y)(e.initialRun,function(e){if(!e)return{message:"Add a run command"}}),w=(0,c._)(d.useState(e.initialCompile),2),x=w[0],C=w[1];d.useEffect(function(){g.setValue(r)},[r]),d.useEffect(function(){C(null!=o?o:"")},[o]);var _=(0,N.Y)("",function(e){if(!e)return{message:"Choose an entry point file"}}),k=(0,c._)(d.useState(!!(n&&!s)),2),S=k[0],E=k[1];d.useEffect(function(){E(!!(n&&!s))},[n,s]);var T=A.K.a,R=(0,c._)(d.useState([]),2),I=R[0],L=R[1],O=(0,M.Z)(),F=eh();return d.useEffect(function(){F&&O.current&&L(F)},[O,F]),(0,u.BX)("form",{onSubmit:function(t){if(t.preventDefault(),e.setIsApplyingConfig(!0),!g.value&&!S){g.validate();return}e.onSubmit({run:g.value,compile:null!=x?x:"",entry:_.value,deleteInterp:!S,onDone:e.closeConfigPane,runChanged:g.value!==r,compileChanged:x!==o,projType:e.projType})},css:[B.l0.maxWidth(400),{width:"100%"}],children:[(0,u.BX)(A.G,{css:[B.l0.colWithGap(8)],children:[e.hasProcfile?(0,u.tZ)(A.G,{css:[B.l0.colWithGap(8)],children:(0,u.BX)(b.xv,{variant:"small",css:[B.l0.mb(24)],children:["Looks like you came from Heroku!",(0,u.tZ)(T,{target:"_blank",href:"https://docs.replit.com/tutorials/import-heroku",rel:"noopener noreferrer",children:"Read more about Replit and Heroku here."})]})}):null,n?(0,u.tZ)(A.G,{css:[B.l0.pb(16)],children:(0,u.BX)(X.hE,{disabled:p,name:"interpreterView",value:S.toString(),row:!0,onChange:function(){return E(function(e){return!e})},stretch:!0,primary:!0,children:[(0,u.tZ)(X.rK,{id:"interpreterFalse",value:"false",text:"Use run command"}),(0,u.tZ)(X.rK,{id:"interpreterTrue",value:"true",text:"Use default interpreter"})]})}):null,(0,u.BX)(A.G,{css:[B.l0.height(e.initialCompile?210:170),B.l0.colWithGap(8)],children:[S?null:(0,u.BX)(A.G,{css:[B.l0.maxWidth(400),B.l0.colWithGap(8)],children:[e.initialCompile?(0,u.BX)(A.G,{css:[B.l0.colWithGap(4)],children:[(0,u.tZ)("label",{htmlFor:"compile-sel",children:"Configure the Compile Command"}),(0,u.tZ)(b.xv,{variant:"small",color:"dimmest",children:"This is optional, and is executed before your run command."}),(0,u.tZ)(y.II,{disabled:p,id:"compile-sel",type:"text",value:x,placeholder:"Enter a command to compile the program",onChange:function(e){C(e.currentTarget.value)},css:{"&:disabled":{color:B.TV.foregroundDimmer}}})]}):null,(0,u.tZ)("label",{htmlFor:"run-sel",css:[B.l0.mt(4)],"data-cy":"import-config-run-command",children:"Configure the Run Command"}),(0,u.tZ)(y.II,{disabled:p,id:"run-sel",dataCy:"import-config-run-command-input",type:"text",value:g.value,placeholder:"Enter a command to run the program",onChange:function(e){g.setValue(e.currentTarget.value)},css:[{"&:disabled":{color:B.TV.foregroundDimmer,cursor:"auto"},cursor:"text"}]}),h?(0,u.BX)(b.xv,{variant:"small",color:"dimmest",children:["We detected this is a Rails project. You will need",(0,u.BX)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.replit.com/misc/rails-on-replit",children:[" ","additional changes"," "]}),"to your config files to use all of Replits features."]}):null,g.error||!g.value?(0,u.BX)(A.G,{css:[B.l0.color.accentNegativeDefault,B.l0.rowWithGap(4),B.l0.align.center],children:[(0,u.tZ)(U.Z,{size:12}),(0,u.tZ)(A.G,{children:g.error?g.error.message:"Add a run command"})]}):null]}),S?(0,u.BX)(A.G,{css:[{maxWidth:400},B.l0.colWithGap(8)],children:[(0,u.tZ)("label",{htmlFor:"entry-sel",children:"Configure entry point"}),(0,u.tZ)(b.xv,{variant:"small",css:[B.l0.color.foregroundDimmest],children:"The entry point is the file thats run by default and shown first."}),0!==I.length?(0,u.tZ)(ee,(0,l._)((0,a._)({id:"config-selector",onSelect:_.setValue,onInit:_.setValue,options:I},I.length&&!!F&&{initialSelectedOption:I[0]}),{disabled:p})):(0,u.tZ)(y.II,{disabled:p,id:"entry-sel",type:"text",value:_.value,placeholder:"Choose entry point file",onChange:function(e){_.setValue(e.currentTarget.value)},css:[P.gU.filled,{cursor:"text"}]}),_.error?(0,u.BX)(A.G,{css:[{color:"var(--accent-negative-default)"},B.l0.rowWithGap(4),B.l0.align.center],children:[(0,u.tZ)(U.Z,{size:12}),(0,u.tZ)(A.G,{children:_.error.message})]}):null]}):null,(0,u.tZ)(T,{css:[B.l0.color.accentPrimaryStronger,{fontWeight:B.TV.fontWeightMedium}],target:"_blank",href:"https://docs.replit.com/programming-ide/running-github-repositories-replit",rel:"noopener noreferrer",children:"Not sure what to do?"}),(0,u.tZ)(A.G,{css:[B.l0.flex.row,B.l0.pt(16)],children:(0,u.tZ)(Z.zx,{colorway:"primary",variant:"outlined",type:"submit",text:p?"Saving...":"Done",disabled:p||!S&&(!!g.error||!g.value),css:[P.gU.filledAndOutlined,{fontWeight:B.TV.fontWeightMedium,color:B.TV.accentPrimaryStronger}],dataCy:"import-config-done"})})]})]}),(0,u.tZ)(D.u,{isOpen:!1,preventClose:!0,onRequestClose:function(){},children:(0,u.tZ)(A.G,{css:[B.l0.borderRadius(16),B.l0.p(32),{backgroundColor:"var(--background-default)"}],children:(0,u.BX)(G.gC,{align:"center",spacing:1,children:[(0,u.tZ)(ev.Z,{size:32}),(0,u.BX)(b.xv,{multiline:!1,children:["Upgrading to ",f.ZP.get(v).displayName]})]})})})]})}function eb(){return(0,u.BX)(A.G,{children:[(0,u.tZ)(A.G,{children:".replit looks a lil messed up :/"}),(0,u.tZ)("a",{css:[B.l0.pt(8),{fontSize:B.TV.fontSizeSmall}],target:"_blank",href:"https://docs.replit.com/programming-ide/configuring-repl",children:"View docs"})]})}function eZ(){return(0,u.tZ)(A.G,{children:(0,u.BX)("p",{children:["Initializing run configuration",(0,u.tZ)(g,{style:{color:"var(--foreground-default)"}})]})})}var ew=function(e){var t,n,r,l,f=(0,O.Z)(),h=(0,I.Z)(),p=h.fs,m=h.dotReplit,v=(0,c._)((t=(0,a._)({},E,void 0),_.D(R,t)),1)[0],g=(0,M.Z)(),y=(n=(0,a._)({},E,{variables:{replId:f}}),C.a(T,n)),b=(null===(l=y.data)||void 0===l?void 0:l.repl.__typename)==="Repl"?y.data.repl:null,Z=e.useReadFile(p,L.l),w=(0,c._)(d.useState(!1),2),x=w[0],k=w[1],S=(0,c._)(d.useState(!1),2),D=S[0],G=S[1],B=Z&&!Z.error?Z.content.toString("utf8"):"",P=(0,c._)(d.useState(""),2),A=P[0],N=P[1],U=(0,c._)(d.useState(""),2),X=U[0],F=U[1],W=(0,c._)(d.useState(!1),2),H=W[0],V=W[1],z=(0,c._)(d.useState(i.Unknown),2),j=z[0],q=z[1],Y=(0,c._)(d.useState(!1),2),$=Y[0],J=Y[1];d.useEffect(function(){function e(){return(e=(0,o._)(function(){var e,t,n,r,o,a,l,c,u,d,f,h,v,y,b,Z;return(0,s.Jh)(this,function(s){switch(s.label){case 0:return[4,m.getConfig()];case 1:if(t=(e=s.sent()).config,e.error)return[2];return r=(0,ep.Cq)(null!==(n=t.run)&&void 0!==n?n:void 0),a=(0,ep.Cq)(null!==(o=t.compile)&&void 0!==o?o:void 0),l=!!t.compile,c=!!t.interpreter,[4,p.listFiles()];case 2:if(u=s.sent(),!g.current||null!=u.error||null==u.files||0===u.files.length)return[2];return d=u.files,h=(f=function(e,t,n){if(0===n.length)return{projType:"UNKNOWN",runCommand:null,compileCommand:null};var r,i,o,a,l,c={initRunCommand:e,isCompiled:t,allFiles:n},s=(i=(r=c).initRunCommand,o=r.isCompiled,a=r.allFiles,(l=new Set(a)).has("Makefile")||l.has("makefile")?"MAKE":l.has("package.json")?"NPM":l.has("Cargo.toml")?"CARGO":o?"UNKNOWN":l.has("config/application.rb")?"RAILS":a.some(function(e){return"csproj"===(0,en.r6)(e)})?"DOTNET":l.has("manage.py")?"DJANGO":er.test(i)?"REGULAR_RUN":"UNKNOWN");return{projType:s,runCommand:function(e,t){var n=t.initRunCommand,r=t.allFiles;switch(e){case"NPM":return"npm run start";case"REGULAR_RUN":var i,o=null!==(i=r.filter(function(e){return!ei.test(e)}).find(function(e){return er.test(e)}))&&void 0!==i?i:null;if(null==o)return null;return n.replace(er,o);case"DJANGO":return"python3 manage.py runserver 0.0.0.0:3000";case"RAILS":return"bundle exec rails server --binding=0.0.0.0";case"DOTNET":return"dotnet run";case"CARGO":return"cargo run";default:return null}}(s,c),compileCommand:function(e){switch(e){case"MAKE":return"make";case"CARGO":case"DOTNET":case"NPM":return"";default:return null}}(s)}}(r,l,d)).projType,v=f.runCommand,y=f.compileCommand,b=x?null!=r?r:v:null!=v?v:r,Z=null!=y?y:a,k(d.includes(em.E)),N(b),F(Z),V(h!==i.Unknown&&h!==i.RegularRun),q(h),J(c),[2]}})})).apply(this,arguments)}B&&function(){e.apply(this,arguments)}()},[B,g]),d.useEffect(function(){(0,eo.j)(eo.U3.NIX_GH_IMPORT_USED,{action:ea.D.ImportEnded,replId:f})},[f]);var K=(0,el.Z)();d.useEffect(function(){K(!1)},[]);var Q=(r=(0,o._)(function(e){var t,n,r,i,o,a,l,c,u,d;return(0,s.Jh)(this,function(s){switch(s.label){case 0:var h;return t=e.run,n=e.compile,r=e.entry,i=e.deleteInterp,o=e.onDone,a=e.runChanged,l=e.compileChanged,c=e.projType,(0,eo.j)(eo.U3.NIX_GH_IMPORT_USED,{action:ea.D.ConfigDone,interpUsed:!i,isCompiled:""!==n,runChanged:a,compileChanged:l,projType:c,replId:f}),h=[],i?(h.push((0,ec.xz)("interpreter")),h.push((0,ec.xz)("entrypoint")),h.push((0,ec.KQ)(t)),h.push((0,ec.X6)(t)),n?(h.push((0,ec.D3)(n)),h.push((0,ec.pi)(n))):(h.push((0,ec.xz)("compile")),h.push((0,ec.xz)("deployment/build")))):(h.push((0,ec.xz)("run")),h.push((0,ec.If)(r))),u=h,d=v({variables:{input:{id:f}}}),[4,m.updateDotReplit(u)];case 1:return s.sent(),p.flush().then(function(){p.persist({skipDebounce:!0})}),[4,d];case 2:return s.sent(),o(),[2]}})}),function(e){return r.apply(this,arguments)});return b&&Z?(null==Z?void 0:Z.error)?(0,u.tZ)(eg,{children:(0,u.tZ)(eb,{})}):(0,u.tZ)(eg,{children:(0,u.tZ)(ey,{initialLanguage:"",initialRun:A,initialCompile:X,hasInterpreter:$,fs:p,hasProcfile:x,isApplyingConfig:D,setIsApplyingConfig:G,onSubmit:Q,isFrameworkRecommended:H,projType:j,closeConfigPane:e.closeConfigPane})}):(0,u.tZ)(eg,{children:(0,u.tZ)(eZ,{})})}},9626:function(e,t,n){var r=n(8182),i=n(43429),o=n(56596),a=n(1415),l=n(29287),c=n(47075),s=n(74833),u=function(e){var t=e.reason,n=e.children;return(0,r.BX)(o.G,{css:[l.l0.center,l.l0.minWidth(225),l.l0.height(225),l.l0.p(16),l.l0.color.foregroundDefault,l.l0.borderRadius(8),l.l0.backgroundColor.backgroundOverlay,l.l0.zIndex(5e5),{cursor:"not-allowed"}],children:[(0,r.tZ)(c.Z,{height:80}),(0,r.BX)(s.xv,{multiline:!1,variant:"subheadBig",css:[l.l0.mt(32)],dataCy:"import-loading-spinner",children:[t,"..."]}),n]})};t.Z=(0,i.memo)(function(e){var t=e.reason,n=e.children;return(0,r.tZ)(a.h,{children:(0,r.tZ)(o.G,{css:[l.l0.position.fixed,l.l0.flex.row,l.l0.align.center,l.l0.justify.center,l.l0.backgroundColor.backgroundOverlay,{top:0,bottom:0,left:0,right:0,zIndex:5e5,cursor:"not-allowed"}],children:(0,r.tZ)(u,{reason:null!=t?t:"Importing",children:n})})})})},27695:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(32477),i=n(8182),o=n(23026),a=function e(){"use strict";var t=this;(0,o._)(this,e),this.audioStart=0,this.feed=function(e){var n=t.getFormatedValue(e),r=new Float32Array(t.samples.length+n.length);r.set(t.samples,0),r.set(n,t.samples.length),t.samples=r},this.getFormatedValue=function(e){for(var t=new Float32Array(e.length),n=0;n<e.length;n++)t[n]=e[n]/2147483648;return t},this.stop=function(){if(t.bufferSource)try{t.bufferSource.stop()}catch(e){if("InvalidStateError"!==e.name&&"RangeError"!==e.name)throw e}},this.flush=function(e){if(t.audioCtx&&t.samples.length){var n,r,i,o=0,a=t.audioCtx.currentTime;if(0===e)t.startTime=a,t.audioStart=a;else{for(var l=Math.floor((a-t.audioStart)*44100);l>e-32896;)t.audioStart+=.7459410430839002,l-=32896;l>e&&(o=l-e,t.startTime=a),t.startTime=a}t.samples=t.samples.slice(o,t.samples.length);for(var c=t.audioCtx.createBufferSource(),s=t.samples.length/1,u=t.audioCtx.createBuffer(1,s,44100),d=0;d<1;d++)for(i=0,n=u.getChannelData(d),r=d;i<s;i++)n[i]=t.samples[r],r+=1;t.startTime<t.audioCtx.currentTime&&(t.startTime=t.audioCtx.currentTime),c.buffer=u,c.connect(t.gainNode),c.start(t.startTime),t.stop(),t.bufferSource=c,t.startTime+=u.duration,t.samples=new Float32Array}},this.samples=new Float32Array;var n=window.AudioContext||window.webkitAudioContext;this.audioCtx=new n,this.gainNode=this.audioCtx.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioCtx.destination),this.startTime=this.audioCtx.currentTime},l=n(43429),c=n(29287),s=n(49344),u=n(56596),d=n(1498),f=n(74833),h=n(47001),p=n(32377),m=n(17867);function v(e){var t=e.container,n=(0,r._)((0,l.useState)(!1),2),o=n[0],v=n[1],g=(0,r._)((0,l.useState)(!1),2),y=g[0],b=g[1],Z=(0,m.Z)(t);(0,l.useEffect)(function(){if(Z===h.em.CONNECTED&&!0!==y){var e=setTimeout(function(){b(!0)},1e3);return function(){clearTimeout(e)}}},[Z,y]);var w=(0,l.useRef)(null);(0,l.useEffect)(function(){if(y&&t.getConnectionState()!==h.em.DISCONNECTED)return t.openChannel({name:"audio",service:"audio"},function(e){var t=e.channel,n=null,r=!1;return t.onCommand(function(e){var t;r||(r=!0,w.current=function(){n=new a,w.current=null},v(!0)),n&&(null==e?void 0:null===(t=e.audio2)||void 0===t?void 0:t.data)&&(e.audio2.samples||(e.audio2.samples=0),n.feed(Int32Array.from(e.audio2.data)),n.flush(e.audio2.samples))}),function(){v(!1),n&&(n.stop(),n=null),w.current=null}})},[t,y]);var x=function(){v(!1)};return(0,i.tZ)(s.u,{isOpen:o,onRequestClose:x,children:(0,i.BX)(u.G,{css:[c.l0.colWithGap(24)],children:[(0,i.tZ)(f.h4,{variant:"headerDefault",level:1,children:"We hear audio!"}),(0,i.BX)(u.G,{css:[c.l0.colWithGap(8)],children:[(0,i.tZ)(f.xv,{children:"Hey! It appears that this Repl is playing audio."}),(0,i.tZ)(f.xv,{children:"In order for us to hear the audio youre receiving, please click confirm."})]}),(0,i.BX)(u.G,{css:[c.l0.rowWithGap(12),c.l0.justify.end],children:[(0,i.tZ)(d.zx,{onClick:x,text:"Cancel"}),(0,i.tZ)(d.zx,{colorway:"positive",onClick:function(){v(!1),w.current&&w.current()},text:"Confirm",iconLeft:(0,i.tZ)(p.Z,{})})]})]})})}},30249:function(e,t,n){n.d(t,{Z:function(){return y},e:function(){return w}});var r=n(45903),i=n(70322),o=n(8182),a=n(38080),l=n(74833),c=n(56596),s=n(93918),u=n(29287),d=n(29559),f=n(55534),h=n(15146),p=n(5344),m=n(1498),v=n(9331),g=(0,s.X)({code:[u.l0.font.code,u.l0.flex.grow(1)],surface:[u.l0.borderRadius(8),u.l0.p(8),u.l0.flex.row,u.l0.rowWithGap(8),u.l0.align.center]});function y(e){var t=w(e.filePath,e.keyName);if(!t)return null;var n=t.import,i=t.access;return(0,o.BX)(c.G,{css:u.l0.colWithGap(8),children:[n?(0,o.tZ)(b,(0,r._)({code:n},e)):null,(0,o.tZ)(b,(0,r._)({code:i},e))]})}function b(e){var t=e.code,n=e.onInsert,r=(0,i._)(e,["code","onInsert"]);return(0,o.BX)(a.Tg,{elevated:r.elevated,css:g.surface,children:[(0,o.tZ)(Z,{value:t}),(0,o.tZ)(l.xv,{variant:"small",css:g.code,multiline:!1,children:t}),n?(0,o.tZ)(m.zx,{variant:"outlined",size:"small",onClick:function(){return n(t)},text:"Insert",iconRight:(0,o.tZ)(v.Z,{})}):null]})}function Z(e){var t=e.value,n=(0,f.Z)();return(0,o.tZ)(h.hU,{alt:"Copy",tooltipHidden:!0,onClick:function(){navigator.clipboard.writeText(t).then(function(){n.showConfirm("Copied")})},children:(0,o.tZ)(p.Z,{})})}function w(e,t){if(!e)return null;switch((0,d.r6)(e)){case"js":case"ts":case"jsx":case"tsx":return{import:null,access:"const mySecret = process.env['".concat(t,"']")};case"py":return{import:"import os",access:"my_secret = os.environ['".concat(t,"']")};case"go":return{import:'import "os"',access:'mySecret := os.Getenv("'.concat(t,'")')};case"java":case"scala":return{import:null,access:'System.getenv("'.concat(t,'")')};case"rb":return{import:null,access:'ENV["'.concat(t,'"]')};case"c":case"cpp":return{import:"#include <stdlib.h>",access:'char* mySecret = getenv("'.concat(t,'")')};case"cs":return{import:"using System;",access:'string mySecret = System.Environment.GetEnvironmentVariable("'.concat(t,'");')};case"sh":return{import:null,access:'"$'.concat(t,'"')};default:return null}}},52489:function(e,t,n){n.d(t,{qi:function(){return el},$M:function(){return eu},u_:function(){return ep},BH:function(){return em},ZP:function(){return eZ}});var r=n(34142),i=n(45903),o=n(25e3),a=n(32477),l=n(87682),c=n(8182),s=n(43429),u=n(30084),d=n(28268),f=n(12834),h=n(52924),p=n(11516),m=n(66349),v=n(59868),g=n(88883),y=n(48900),b=n(68099),Z=n(38265),w=n(20142),x=n(81013),C=n(1498),_=n(49344),k=n(37951),S=n(38080),E=n(74833),T=n(56596),R=n(32377),I=n(52686),D=n(15006),G=n(29287),B=n(27308),P=v.U3.ENV_EDITOR_USED;function A(e){var t,n=e.secrets,i=e.update,o=(0,a._)((0,s.useState)(!1),2),u=o[0],d=o[1],f=(0,a._)((0,s.useState)(!1),2),h=f[0],p=f[1],m=(0,a._)((0,s.useState)(!1),2),g=m[0],A=m[1],U=(0,a._)((0,s.useState)(0),2),L=U[0],O=U[1],X=0===L,M=(0,s.useRef)();M.current||(M.current=(0,b.ir)(function(e){var t=N(e.state.doc.toString());return O(t),0!==t?(0,v.j)(P,{action:"rawEditorUpdatedError"}):(0,v.j)(P,{action:"rawEditorUpdated"}),[]}));var F=(0,x.Z)(),W=F.ref,H=F.view,V=function(){h||d(!1)},z=function(){A(!1),d(!0),(0,v.j)(P,{action:"rawEditorOpened"})},j=function(){if(!H)return!1;var e=N(H.state.doc.toString());return O(e),0===e},q=(t=(0,r._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(!H||!j())return[2];p(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i(JSON.parse(H.state.doc.toString()))];case 2:return t.sent(),p(!1),A(!0),setTimeout(function(){V(),setTimeout(function(){A(!1)},500)},500),[3,4];case 3:return e=t.sent(),y.Tb(e),(0,v.j)(P,{action:"rawEditorUpdatedError"}),O(3),p(!1),[3,4];case 4:return[2]}})}),function(){return t.apply(this,arguments)});return(0,s.useEffect)(function(){if(H){var e=JSON.stringify(n,null,2);"{}"===e&&(e="{\n  \n}"),H.dispatch({changes:{from:0,to:H.state.doc.length,insert:e}}),H.dispatch({selection:{anchor:H.state.doc.length-2}}),H.focus()}},[H,n]),(0,c.BX)(c.HY,{children:[(0,c.tZ)(C.zx,{onClick:function(){return z()},text:"Edit as JSON",iconLeft:(0,c.tZ)(I.Z,{}),size:"small"}),(0,c.tZ)(_.u,{isOpen:u,onRequestClose:function(){return V()},children:(0,c.BX)(T.G,{css:[G.l0.colWithGap(24)],children:[(0,c.tZ)(E.h4,{level:1,variant:"headerDefault",children:"Raw Secrets Editor"}),(0,c.tZ)(E.xv,{children:"Secrets are specified in JSON. Values must be strings."}),(0,c.tZ)(S.Tg,{css:[G.l0.borderRadius(8),G.l0.transition.snappy,G.l0.p(4),{border:"1px solid var(--outline-dimmer)",":hover":{borderColor:"var(--outline-stronger)"}}],elevated:!0,children:(0,c.tZ)(w.ZP,{ref:W,readOnly:h||g,extensions:[M.current,Z.$f.of([{key:(0,B.l2)({cmdOrCtrl:!0,key:"Enter"}),run:function(){return q(),!0},preventDefault:!0,stopPropagation:!0}])],language:"json",hideGutter:!0})}),(0,c.BX)(T.G,{css:[G.l0.rowWithGap(4),G.l0.justify.end],children:[!X&&(0,c.tZ)(k.E,{icon:(0,c.tZ)(D.Z,{}),colorway:"negative",text:function(e){switch(e){case 1:return"Make sure the data is valid JSON.";case 2:return"Make sure that all values are strings.";case 3:return"There was an error saving the secrets.";default:return""}}(L)}),(0,c.BX)(T.G,{css:[G.l0.rowWithGap(12)],children:[(0,c.tZ)(C.zx,{onClick:V,text:"Cancel"}),(0,c.tZ)(C.zx,{iconLeft:(0,c.tZ)(R.Z,{}),stretch:!0,colorway:g?"positive":"primary",text:g?"Saved!":"Save",disabled:!X||h||g,onClick:function(){return q()}})]})]})]})})]})}function N(e){try{var t=JSON.parse(e);for(var n in t)if("string"!=typeof n||"string"!=typeof t[n])return 2;return 0}catch(e){return 1}}var U=n(18836),L=n(88936),O=n(58091),X=n(15146),M=n(80339),F=n(98859),W=n(44680),H=n(99656),V=n(70002),z=n(52682),j=n(31900),q=n(55534),Y=n(5344),$=n(93918),J=n(48272),K=n(76588),Q=n(30249),ee=n(50199),et=n(18107),en=n(68514),er=n(30983),ei=(0,$.X)({addSecretContainer:[G.l0.flex.column,G.l0.colWithGap(8),G.l0.py(8)],secretItemEdit:[G.l0.colWithGap(8)],secretItemEditInputs:[G.l0.rowWithGap(8)],secretItem:[G.l0.flex.row,G.l0.rowWithGap(8),G.l0.align.center],headerStyle:[G.l0.flex.row,G.l0.rowWithGap(8),G.l0.align.center,G.l0.p(8)],accessSecrect:[G.l0.px(8),G.l0.py(16),G.l0.colWithGap(8)],accessSecrectHeader:[G.l0.rowWithGap(8),G.l0.align.center]}),eo={fontFamily:"text-security-disc"};function ea(e){var t=e.onClose,n=e.onAdd,r=e.otherKeys,l=(0,a._)(s.useState(!0),2),u=l[0],d=l[1],f=(0,a._)(s.useState({key:"",value:""}),2),h=f[0],p=f[1],m=h.key.length>0&&!r.includes(h.key);return(0,c.tZ)(c.HY,{children:(0,c.BX)(T.G,{css:ei.addSecretContainer,children:[(0,c.BX)(T.G,{css:G.l0.rowWithGap(8),children:[(0,c.BX)(T.G,{css:[G.l0.colWithGap(4),G.l0.width("40%")],children:[(0,c.tZ)(E.xv,{css:[G.l0.pt(2),G.l0.pb(4)],variant:"small",color:"dimmer",multiline:!1,children:"Key"}),(0,c.tZ)(U.II,{value:h.key,onChange:function(e){return p((0,o._)((0,i._)({},h),{key:e.target.value}))},placeholder:"SECRET_KEY",autoComplete:"off"}),r.includes(h.key)?(0,c.BX)(E.xv,{multiline:!1,variant:"small",css:{color:G.TV.accentNegativeDefault},children:['Secret "',h.key,'" already exists']}):null]}),(0,c.BX)(T.G,{css:[G.l0.colWithGap(4),G.l0.flex.growAndShrink(1)],children:[(0,c.BX)(T.G,{css:[G.l0.flex.row,G.l0.rowWithGap(4),G.l0.align.center],children:[(0,c.tZ)(E.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Value"}),(0,c.tZ)(X.hU,{alt:"Toggle Visibility",tooltipHidden:!0,onClick:function(){return d(!u)},children:u?(0,c.tZ)(M.Z,{}):(0,c.tZ)(F.Z,{})})]}),(0,c.tZ)(U.II,{value:h.value,onChange:function(e){return p((0,o._)((0,i._)({},h),{value:e.target.value}))},style:u?eo:void 0,autoComplete:"off",placeholder:"Value"})]})]}),(0,c.BX)(T.G,{css:[G.l0.rowWithGap(8),G.l0.justify.end],children:[(0,c.tZ)(C.zx,{size:"small",text:"Cancel",onClick:function(){return t()}}),(0,c.tZ)(C.zx,{size:"small",text:"Add Secret",colorway:"primary",disabled:!m,onClick:function(){n({key:h.key.trim(),value:h.value}),p({key:"",value:""})}})]})]})})}function el(e){var t=e.value,n=(0,q.Z)();return(0,c.tZ)(X.hU,{alt:"Copy",tooltipHidden:!0,onClick:function(){navigator.clipboard.writeText(t).then(function(){n.showConfirm("Copied")})},children:(0,c.tZ)(Y.Z,{})})}var ec=[G.l0.flex.row,G.l0.rowWithGap(8),G.l0.align.center],es=(0,$.X)({root:[G.l0.height("100%"),G.l0.borderRadius(8),{'& [aria-haspopup="listbox"]':[G.l0.height(32)]}],item:ec,itemDanger:[ec,{color:G.TV.accentNegativeStronger}]});function eu(e){var t=e.onEdit,n=e.onDelete;return(0,c.tZ)(S.Tg,{elevated:!0,css:es.root,children:(0,c.tZ)(j.Z,{label:"Options",items:[{label:(0,c.BX)(T.G,{css:es.item,children:[(0,c.tZ)(h.Z,{}),(0,c.tZ)(E.xv,{multiline:!1,children:"Edit"})]}),onClick:t},{label:(0,c.BX)(T.G,{css:es.itemDanger,children:[(0,c.tZ)(z.Z,{}),(0,c.tZ)(E.xv,{multiline:!1,children:"Delete"})]}),isDescructive:!0,onClick:n}],onItemClick:function(e){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e)}})})}var ed=[G.l0.p(4),G.l0.rowWithGap(4),G.l0.borderRadius(8)],ef=(0,$.X)({root:[ed,G.l0.width("40%"),G.l0.display.flex,G.l0.overflowX("hidden")],text:[G.l0.flex.growAndShrink(1)]}),eh=(0,$.X)({root:[ed,G.l0.flex.growAndShrink(1)],text:[G.l0.flex.growAndShrink(1),G.l0.truncate,{fontFamily:G.TV.fontFamilyCode}]});function ep(e){var t=e.value;return(0,c.BX)(S.Tg,{elevated:!0,css:ef.root,children:[(0,c.tZ)(el,{value:t}),(0,c.tZ)(er.u,{tooltip:(0,c.tZ)(E.xv,{children:t}),children:function(e,n){return(0,c.tZ)(E.xv,(0,o._)((0,i._)({ref:n},e),{multiline:!1,css:ef.text,children:t}))}})]})}function em(e){var t=e.value,n=(0,a._)(s.useState(!1),2),r=n[0],i=n[1];return(0,c.BX)(S.Tg,{elevated:!0,css:eh.root,children:[(0,c.tZ)(el,{value:t}),(0,c.tZ)(E.xv,{multiline:!1,css:eh.text,children:r?t:"".repeat(12)}),(0,c.tZ)(X.hU,{alt:"Toggle Secret",tooltipHidden:!0,onClick:function(){return i(!r)},children:r?(0,c.tZ)(F.Z,{}):(0,c.tZ)(M.Z,{})})]})}function ev(e){var t=(0,a._)(s.useState(""===e.secret.value?{key:e.secret.key,value:""}:null),2),n=t[0],r=t[1],l=(0,a._)(s.useState(!1),2),u=l[0],d=l[1],f=(0,a._)(s.useState(!0),2),h=f[0],p=f[1],m=e.secret;if(n&&!e.readOnly){var v,g=e.onDeleteSecret,y=e.onUpdateSecret;return(0,c.BX)(c.HY,{children:[(0,c.BX)(T.G,{css:ei.secretItemEdit,children:[(0,c.BX)(T.G,{css:ei.secretItemEditInputs,children:[(0,c.BX)(T.G,{css:[G.l0.colWithGap(2),G.l0.width("40%")],children:[(0,c.tZ)(E.xv,{multiline:!1,css:[G.l0.pt(2),G.l0.pb(4)],variant:"small",color:"dimmer",children:"Key"}),(0,c.tZ)(T.G,{children:(0,c.tZ)(U.II,{value:null!==(v=null==n?void 0:n.key)&&void 0!==v?v:"",onChange:function(e){return r(function(t){return t?(0,o._)((0,i._)({},t),{key:e.target.value}):t})},placeholder:"SECRET_KEY",autoComplete:"off"})})]}),(0,c.BX)(T.G,{css:[G.l0.flex.growAndShrink(1),G.l0.colWithGap(2)],children:[(0,c.BX)(T.G,{css:[G.l0.flex.row,G.l0.rowWithGap(4),G.l0.align.center],children:[(0,c.tZ)(E.xv,{multiline:!1,css:[G.l0.pt(2),G.l0.pb(4)],variant:"small",color:"dimmer",children:"Value"}),(0,c.tZ)(X.hU,{alt:"Toggle Visibility",tooltipHidden:!0,onClick:function(){return p(!h)},children:h?(0,c.tZ)(M.Z,{}):(0,c.tZ)(F.Z,{})})]}),(0,c.tZ)(T.G,{children:(0,c.tZ)(U.II,{value:n.value,style:h?eo:void 0,onChange:function(e){return r(function(t){return t?(0,o._)((0,i._)({},t),{value:e.target.value}):t})}})})]})]}),(0,c.BX)(T.G,{css:[G.l0.flex.row,G.l0.rowWithGap(8)],children:[(0,c.tZ)(C.zx,{size:"small",text:"Delete",colorway:"negative",onClick:function(){return d(!0)}}),(0,c.tZ)(T.G,{css:G.l0.flex.grow(1)}),(0,c.tZ)(C.zx,{size:"small",text:"Cancel",onClick:function(){return r(null)}}),(0,c.tZ)(C.zx,{size:"small",colorway:"primary",text:""===e.secret.value?"Add Secret":"Update Secret",disabled:!(null==n?void 0:n.key.length),onClick:function(){n&&(y(m.key,{key:n.key.trim(),value:n.value}),r(null))}})]})]}),(0,c.tZ)(_.u,{isOpen:u,onRequestClose:function(){return d(!1)},children:(0,c.BX)(T.G,{children:[(0,c.BX)(E.xv,{variant:"subheadDefault",multiline:!1,children:["Delete ",m.key,"?"]}),(0,c.tZ)(E.xv,{color:"dimmer",multiline:!1,children:"Are you sure you would like to delete this secret? This cannot be undone."}),(0,c.BX)(T.G,{css:[G.l0.justify.end,G.l0.flex.row,G.l0.rowWithGap(8)],children:[(0,c.tZ)(C.zx,{text:"Cancel",onClick:function(){return d(!1)}}),(0,c.tZ)(C.zx,{text:"Delete",colorway:"negative",onClick:function(){return g(m.key)}})]})]})})]})}return(0,c.BX)(T.G,{css:ei.secretItem,children:[(0,c.tZ)(ep,{value:m.key}),(0,c.tZ)(em,{value:m.value}),e.readOnly?null:(0,c.BX)(c.HY,{children:[(0,c.tZ)(T.G,{children:(0,c.tZ)(eu,{onEdit:function(){return r(m)},onDelete:function(){return d(!0)}})}),(0,c.tZ)(_.u,{isOpen:u,onRequestClose:function(){return d(!1)},children:(0,c.BX)(T.G,{css:[G.l0.colWithGap(24)],children:[(0,c.BX)(E.xv,{multiline:!1,variant:"headerDefault",children:["Delete ",m.key,"?"]}),(0,c.tZ)(E.xv,{color:"dimmer",multiline:!1,children:"Are you sure you would like to delete this secret? This cannot be undone."}),(0,c.BX)(T.G,{css:[G.l0.justify.end,G.l0.flex.row,G.l0.rowWithGap(12)],children:[(0,c.tZ)(C.zx,{text:"Cancel",onClick:function(){return d(!1)}}),(0,c.tZ)(C.zx,{iconLeft:(0,c.tZ)(z.Z,{}),text:"Yes, delete secret",colorway:"negative",onClick:function(){return e.onDeleteSecret(m.key)}})]})]})})]})]})}function eg(e){var t=e.secrets,n=e.onUpdateSecret,r=e.onDeleteSecret,i=e.onAddSecret,o=e.showAddSecret,l=e.onClose,s=Object.entries(t).filter(function(e){var t=(0,a._)(e,2);return""===(t[0],t[1])}),u=Object.entries(t).filter(function(e){var t=(0,a._)(e,2);return""!==(t[0],t[1])});return(0,c.BX)(T.G,{css:[G.l0.colWithGap(8),G.l0.px(8),G.l0.pb(8)],children:[0!==s.length&&(0,c.BX)(c.HY,{children:[(0,c.BX)(T.G,{css:[G.l0.colWithGap(8)],children:[(0,c.tZ)(E.xv,{variant:"subheadDefault",multiline:!1,children:"Configure missing Secret values"}),(0,c.tZ)(E.xv,{variant:"small",children:"This Repl contains Secrets that might be required. Add values to ensure the code runs as expected."}),(0,c.tZ)(T.G,{css:[G.l0.colWithGap(8)],children:s.map(function(e){var t=(0,a._)(e,2),i=t[0],o=t[1];return(0,c.tZ)(ev,{secret:{key:i,value:o},onUpdateSecret:n,onDeleteSecret:r},i)})})]}),(0,c.tZ)(en.R,{})]}),(0,c.BX)(T.G,{css:[G.l0.colWithGap(8)],children:[o?(0,c.tZ)(ea,{onClose:l,onAdd:i,otherKeys:Object.keys(t)}):null,u.map(function(e){var t=(0,a._)(e,2),i=t[0],o=t[1];return(0,c.tZ)(ev,{secret:{key:i,value:o},onUpdateSecret:n,onDeleteSecret:r},i)})]})]})}function ey(e){var t=e.secrets,n=e.activeFile,r=(0,a._)(s.useState(Object.keys(t)[0]),2),i=r[0],o=r[1];return(0,g.Z)(n)&&(0,Q.e)(n,i)&&0!==Object.keys(t).length?(0,c.BX)(T.G,{css:ei.accessSecrect,children:[(0,c.BX)(T.G,{css:ei.accessSecrectHeader,children:[(0,c.tZ)(E.xv,{multiline:!1,children:"Access secret"}),(0,c.tZ)(J.P,{css:G.l0.minWidth(48),items:Object.keys(t).map(function(e){return{title:e}}),selectedItem:{title:i},onChange:function(e){return o(e.title)}})]}),(0,c.tZ)(Q.Z,{elevated:!0,keyName:i,filePath:n})]}):null}function eb(e,t){var n=(0,i._)({},e);return"add"===t.type?n[t.key]=t.value:"update"===t.type?(delete n[t.oldKey],n[t.key]=t.value):delete n[t.key],n}function eZ(e){var t,n,o,h,g,y=e.readRawEnv,b=e.writeRawEnv,Z=e.getRunState,w=(0,O.R3)(),x=(0,f.Z)(),_=(0,a._)(s.useState(null),2),k=_[0],S=_[1],R=(0,a._)(s.useState(!1),2),I=R[0],D=R[1],B=function(){D(!1)},P=(0,m.Z)();s.useEffect(function(){(0,v.Cn)(v.U3.ENV_EDITOR_USED,{action:"opened"}),p.Z.set("enveditortour",!0)},[]),s.useEffect(function(){function e(){return(e=(0,r._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,y()];case 1:if((e=t.sent()).error===u.Df.NotFound)return x.current&&S({}),[2];if(e.error)throw Error("Error getting .env");if(!x.current)return[2];return S(d.Z.parse(e.content.toString())),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[y,S,x]);var N=s.useRef(null),U=s.useRef([]),X=(t=(0,r._)(function(e){var t,n,r,i;return(0,l.Jh)(this,function(o){switch(o.label){case 0:if(!k)throw Error("trying to write secrets before loading");return S(t=eb(k,e)),U.current.push(e),n=Math.random(),N.current=n,[4,y()];case 1:if(i=o.sent(),N.current!==n)return[2];return i.error?r=t:(r=d.Z.parse(i.content.toString()),U.current.forEach(function(e){r=eb(r,e)}),S(r)),U.current=[],[4,b(d.Z.serialize(r))];case 2:return o.sent(),[2]}})}),function(e){return t.apply(this,arguments)}),M=(0,q.Z)().showConfirm,F=(n=(0,r._)(function(e){return(0,l.Jh)(this,function(t){return(0,v.j)(v.U3.ENV_EDITOR_USED,{action:"created",multiline:e.value.includes("\n")}),X((0,i._)({type:"add"},e)),Z()===et.Ah.RUNNING&&M("Re-run your Repl to use this secret"),B(),[2]})}),function(e){return n.apply(this,arguments)}),z=(o=(0,r._)(function(e,t){return(0,l.Jh)(this,function(n){return(0,v.j)(v.U3.ENV_EDITOR_USED,{action:"updated",multiline:t.value.includes("\n")}),X((0,i._)({type:"update",oldKey:e},t)),[2]})}),function(e,t){return o.apply(this,arguments)}),j=(h=(0,r._)(function(e){return(0,l.Jh)(this,function(t){return(0,v.j)(v.U3.ENV_EDITOR_USED,{action:"deleted"}),X({type:"delete",key:e}),[2]})}),function(e){return h.apply(this,arguments)}),Y=(0,ee.Z)(function(){return k&&Object.keys(k).length>0},[k]);return k&&P?(0,c.BX)(T.G,{css:[G.l0.flex.column],children:[(0,c.BX)(T.G,{css:ei.headerStyle,children:[(0,c.tZ)(E.xv,{css:G.l0.flex.growAndShrink(1),variant:"subheadDefault",multiline:!1,children:"Secrets"}),(0,c.tZ)(A,{secrets:k,update:(g=(0,r._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return S(e),[4,b(d.Z.serialize(e))];case 1:return t.sent(),[2]}})}),function(e){return g.apply(this,arguments)})}),(0,c.tZ)(V.Z,{iconLeft:(0,c.tZ)(W.Z,{}),href:"https://docs.replit.com/programming-ide/workspace-features/secrets",size:"small",text:"Docs",target:"_blank"}),(0,c.tZ)(C.zx,{iconLeft:(0,c.tZ)(H.Z,{}),text:"New Secret",colorway:"primary",size:"small",onClick:function(){return D(!0)}})]}),(0,c.tZ)(T.G,{css:[G.l0.px(8)],children:(0,c.tZ)(en.R,{})}),0===Object.keys(k).length&&!1===I?(0,c.BX)(T.G,{css:[G.l0.center,G.l0.flex.shrink(1)],children:[(0,c.tZ)(K.Z,{alt:"A rotating key",src:"/public/images/secrets/secretskey.gif",height:200,width:200,objectFit:"contain"}),(0,c.tZ)(E.xv,{variant:"subheadDefault",multiline:!1,children:"Store sensitive information securely using Secrets."}),(0,c.tZ)(E.xv,{css:[G.l0.textAlign.center,G.l0.mt(8),G.l0.color],multiline:!1,children:(0,c.tZ)("a",{href:"https://docs.replit.com/programming-ide/workspace-features/secrets#how-replit-keeps-your-secrets-safe",target:"_blank",rel:"noopener",children:"How does Replit keep my Secrets safe?"})})]}):null,(0,c.tZ)(eg,{secrets:k,onUpdateSecret:z,onDeleteSecret:j,onAddSecret:F,showAddSecret:I,onClose:B}),w&&Y?(0,c.tZ)(ey,{secrets:k,activeFile:w}):null]}):(0,c.tZ)(T.G,{css:[G.l0.center,G.l0.coverContainer],children:(0,c.tZ)(L.Z,{size:24})})}},12506:function(e,t,n){n.d(t,{VY:function(){return B},HK:function(){return A},h4:function(){return R},Qc:function(){return D},H4:function(){return N},$E:function(){return P},Mp:function(){return U}});var r=n(34142),i=n(87682),o=n(8182),a=n(29287),l=n(56596),c=n(51384),s=n(66995),u=n(43429),d=n(52902),f=n(94106),h=n.n(f),p=n(50199),m=n(80259),v=n(5344),g=n(10041),y=n(38806),b=n(8017),Z=n(42463),w=n(58091),x=n(54916),C=n(24227),_=n(48728),k=n(29559);function S(){return(S=(0,r._)(function(e,t){var n,r,o,a,l;return(0,i.Jh)(this,function(i){return n=(0,k.yC)(e),r=(0,k.UO)(e),o=new Blob([t.toBuffer()],{type:n}),(a=document.createElement("a")).download=r,l=window.URL.createObjectURL(o),a.href=l,a.style.display="none",document.body.appendChild(a),a.click(),setTimeout(function(){document.body.removeChild(a),URL.revokeObjectURL(l)},1e4),[2]})})).apply(this,arguments)}var E=n(52682),T=(0,c.iv)([a.l0.height(28),a.l0.flex.row,a.l0.align.center,{borderBottom:"1px solid ".concat(a.TV.backgroundHigher),opacity:.8,":hover":{opacity:1}}]);function R(e){return"/replEnvironmentDesktop"!==h().pathname?null:(0,o.tZ)(l.G,{css:T,children:e.children})}var I=(0,c.iv)([a.l0.flex.row,a.l0.align.center,a.l0.flex.growAndShrink(1),a.l0.overflowX("auto"),a.l0.height("100%"),{"&::-webkit-scrollbar":{height:0},scrollbarWidth:"none"}]);function D(e){return(0,o.tZ)(l.G,{css:I,children:e.children})}var G=(0,c.iv)([a.l0.flex.growAndShrink(1),a.l0.position.relative,a.l0.overflow("hidden"),a.l0.borderRadius(0,0,8,8)]);function B(e){return(0,o.tZ)(l.G,{css:[G,e.children&&a.l0.center],children:e.children})}function P(e){return{type:(0,d.Dp)({path:e}),data:{path:e}}}function A(e){var t=e.path,n=e.performPaneOperation,r=(0,u.useCallback)(function(e){n({operation:"replace",pane:P(e)})},[n]);return(0,o.tZ)(R,{children:(0,o.tZ)(D,{children:(0,o.tZ)(s.tr,{path:t,onFileClick:r})})})}function N(e,t){return{match:m.pl,data:{label:"Download",icon:(0,o.tZ)(Z.Z,{}),type:"action",run:function(){return(0,r._)(function(){var n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return[4,t.readFile(e)];case 1:if((n=r.sent()).error)return[2,{type:"error",message:"Error downloading file"}];return[4,function(e,t){return S.apply(this,arguments)}(e,n.content)];case 2:return r.sent(),[2]}})})()}}}}function U(e){var t=e.path,n=e.performPaneOperation,l=(0,x.Z)(),c=(0,w._o)();return(0,p.Z)(function(){var e,s;return t?[{match:m.pl,data:{label:"Copy file path",icon:(0,o.tZ)(_.Z,{}),type:"action",run:function(){(0,g.Z)(t)}}},{match:m.pl,data:{label:"Copy link",icon:(0,o.tZ)(b.Z,{}),type:"action",run:function(){var e=(0,y.dr)({path:t});(0,g.Z)(e)}}},(e=l.fs,s=function(e){n({operation:"replace",pane:{type:(0,d.Dp)({path:e}),data:{path:e}}})},{match:m.pl,data:{label:"Duplicate file",icon:(0,o.tZ)(v.Z,{}),type:"action",run:function(){return(0,r._)(function(){var n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,C.Z)(t,e)];case 1:return n=r.sent(),[3,3];case 2:return r.sent(),[2,{type:"error",message:"Error duplicating file"}];case 3:return s(n),[2]}})})()}}}),N(t,l.fs),{match:m.pl,data:{label:"Delete",icon:(0,o.tZ)(E.Z,{color:a.TV.redDefault}),type:"action",run:function(){c(t)}}}]:null},[t,l.fs,n,c])}},85267:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(8182);n(43429);var i=n(29559),o=n(74833),a=n(56596),l=n(29287),c=n(1498),s=n(39469);function u(e){var t,n=e.paths,u=e.onCancel,d=e.onConfirm;return(0,r.BX)(a.G,{css:[l.l0.colWithGap(24)],children:[(0,r.tZ)(o.h4,{level:1,variant:"headerDefault",children:n.length>1?"Overwrite files?":"Overwrite file?"}),(0,r.BX)(o.xv,{children:[(t=(t=n).map(i.UO)).length<2?t[0]:"".concat(t.slice(0,-1).join(", ")," and ").concat(t.slice(-1))," already"," ",n.length>1?"exist":"exists"," in the destination, are you sure you want to overwrite ",n.length>1?"them":"it","? This cannot be undone."]}),(0,r.BX)(a.G,{css:[l.l0.rowWithGap(12),l.l0.justify.end],children:[(0,r.tZ)(c.zx,{onClick:function(){return u()},text:"Cancel"}),(0,r.tZ)(c.zx,{colorway:"negative",onClick:function(){return d()},text:"Yes, overwrite ".concat(n.length>1?"these files":"this file"),iconLeft:(0,r.tZ)(s.Z,{})})]})]})}},43409:function(e,t,n){n.d(t,{As:function(){return eI},v0:function(){return eG}});var r=n(45903),i=n(8182),o=n(29287),a=n(74833),l=n(56596),c=n(88936),s=n(43429),u=n(7730),d=n.n(u),f=n(78055),h=n(32477),p=n(59868),m=n(15146),v=n(1652),g=n(13660),y=n(36461),b=n(65434),Z=n(34815),w=n(75582),x=n(93295),C=n(23982),_=n(13440);function k(){var e=(0,x._)(["\n  mutation AIFeedback($input: CodexFeedback2Input!) {\n    giveCodexFeedback2(input: $input) {\n      ... on CodexFeedback2 {\n        id\n        __typename\n      }\n      ... on UnauthorizedError {\n        __typename\n      }\n      ... on NotFoundError {\n        __typename\n      }\n    }\n  }\n"]);return k=function(){return e},e}var S={},E=(0,C.Ps)(k()),T=n(92815),R=function(e){var t=e.provideFeedback;return(0,i.BX)(l.G,{css:[o.l0.rowWithGap(4),o.l0.align.center],children:[(0,i.tZ)(m.hU,{alt:"Helpful",colorway:"positive",children:(0,i.tZ)(y.Z,{css:{"&:not(:hover)":[o.l0.color.foregroundDimmer]},onClick:function(){return t(w.TY.Yes)}})}),(0,i.tZ)(m.hU,{alt:"Unhelpful",colorway:"negative",children:(0,i.tZ)(v.Z,{css:{"&:not(:hover)":[o.l0.color.foregroundDimmer]},onClick:function(){return t(w.TY.No)}})})]})},I=function(e){return e.feedback===w.TY.Yes?(0,i.tZ)(b.Z,{}):(0,i.tZ)(g.Z,{})};function D(e){var t,n=e.inferenceId,o=e.inferenceClass,a=(0,h._)((0,s.useState)(null),2),l=a[0],c=a[1],u=(0,T.v)(),d=(0,h._)((t=(0,r._)({},S,void 0),_.D(E,t)),2),f=d[0];return d[1].error?(0,i.tZ)(Z.Z,{}):(0,i.tZ)(i.HY,{children:l?(0,i.tZ)(I,{feedback:l}):(0,i.tZ)(R,{provideFeedback:function(e){o===w.Sg.Chat&&(0,p.j)(p.U3.GHOSTWRITER_CHAT_FEEDBACK_SUBMITTED,{feedback:e}),f({variables:{input:{feedback:e,inferenceClass:o,inferenceId:n}}}),c(e),u(!0)}})})}var G=n(96546),B=n.n(G),P=n(84657),A=n(45434),N=n(20573),U=n(50199),L=n(20766),O=n(83898),X=n(22580),M=n(48272),F=n(92101),W=n(93918),H=n(2038),V=n(1498),z=n(60769),j=n(30983),q=n(64992),Y=n(25e3),$=n(26);function J(e){return(0,i.tZ)($.Z,(0,Y._)((0,r._)({viewBox:"0 0 13 12"},e),{children:(0,i.tZ)("path",{d:"M6.25 0.721688C6.4047 0.632371 6.5953 0.632371 6.75 0.721688L10.9462 3.14434C11.1009 3.23365 11.1962 3.39872 11.1962 3.57735V8.42265C11.1962 8.60128 11.1009 8.76635 10.9462 8.85566L6.75 11.2783C6.5953 11.3676 6.4047 11.3676 6.25 11.2783L2.05385 8.85566C1.89915 8.76635 1.80385 8.60128 1.80385 8.42265V3.57735C1.80385 3.39872 1.89915 3.23365 2.05385 3.14434L6.25 0.721688Z",fill:"#5239CC",stroke:"#795EFF"})}))}var K=n(97615),Q=n(44124),ee=n(84731),et=(0,W.X)({footerContainer:[o.l0.rowWithGap(8),o.l0.flex.wrap],retryButton:[o.l0.width(100),{"@keyframes slideLeft":{"0%":{paddingLeft:30},"100%":{paddingLeft:8}},"@keyframes slideRight":{"0%":{paddingLeft:8},"100%":{paddingLeft:30}}}]}),en=function(e){var t,n=e.onRetry,r=e.limitReached,a=(0,h._)((0,Q.Ni)(),2),c=a[0],u=a[1],d=(0,s.useRef)(!1),f=(0,H.T3)(),v="advanced"===c&&!r,g=(0,s.useId)(),y=(0,Q.Lw)(),b=(0,ee.Q)();t=!d.current||r?void 0:v?"slideLeft 300ms ease-out":"slideRight 300ms ease-out";var Z=(0,i.BX)(i.HY,{children:[(0,i.tZ)(z.X,{onChange:function(e){d.current||(d.current=!0),(0,p.j)(p.U3.GHOSTWRITER_CHAT_MODEL_CHANGED,{source:"footer",model:e.target.checked?"advanced":"default"}),u(e.target.checked?"advanced":"basic")},id:g,disabled:r,checked:!r&&v}),(0,i.tZ)("label",{htmlFor:g,css:r?[o.l0.color.foregroundDimmer]:void 0,children:"Advanced model"})]}),w=y?"You have reached the weekly limit.":"Upgrade to Replit ".concat(b," for the advanced model");return(0,i.BX)(l.G,{css:[o.l0.rowWithGap(8),o.l0.flex.growAndShrink(1),{justifyContent:"flex-end"}],children:["advanced"!==c||d.current?(0,i.BX)(l.G,{css:[o.l0.rowWithGap(8),o.l0.align.center],children:[r?(0,i.tZ)(j.u,{tooltip:w,children:(0,i.tZ)(l.G,{css:[o.l0.rowWithGap(8)],children:Z})}):Z,f?null:(0,i.tZ)(m.hU,{alt:r?w:"Useful for more complex, vague, or creative requests.",size:24,children:(0,i.tZ)(K.Z,{})})]}):null,(0,i.tZ)(V.zx,{css:[et.retryButton,{paddingLeft:v?8:30,animation:t}],variant:"outlined",iconLeft:(0,i.tZ)(q.Z,{}),iconRight:(0,i.tZ)(J,{css:[{transition:"opacity 300ms ease-out",opacity:v?1:0}]}),text:"Retry",onClick:function(e){return n(!!v)}})]})},er=function(e){var t=e.onRetry,n=e.limitReached;return(0,i.tZ)(l.G,{css:et.footerContainer,children:(0,i.tZ)(en,{onRetry:t,limitReached:n})})},ei=n(99741),eo=n(67313),ea=function(e){var t=e.isOpen,n=e.onToggle,r=t?(0,i.tZ)(eo.Z,{}):(0,i.tZ)(ei.Z,{});return(0,i.tZ)(V.zx,{variant:"outlined",text:"Send feedback",iconRight:r,onClick:function(){(0,p.j)(p.U3.GHOSTWRITER_CHAT_INLINE_FEEDBACK_TOGGLED,{state:t?"closed":"opened"}),n()}})},el=n(18836);function ec(){var e=(0,x._)(["\n  mutation GiveChatGhostwriterFeedback($input: WorkflowFeedbackInputType!) {\n    giveWorkflowFeedback(input: $input) {\n      ... on WorkflowFeedbackOutputType {\n        __typename\n        id\n      }\n      ... on UnauthorizedError {\n        __typename\n        message\n      }\n      ... on UserError {\n        __typename\n        message\n      }\n      ... on TooManyRequestsError {\n        __typename\n        message\n      }\n    }\n  }\n"]);return ec=function(){return e},e}var es={},eu=(0,C.Ps)(ec()),ed=n(55534),ef=n(66820),eh=n(8279),ep=n(50782),em=(0,W.X)({wrapper:[o.l0.colWithGap(8)],textInput:[[o.l0.flex.growAndShrink(1),o.l0.width("100%"),o.l0.height(64),{resize:"none"}]],buttonGroup:[o.l0.rowWithGap(8),o.l0.justify.end]}),ev=function(e){var t,n=e.isOpen,a=e.message,u=e.closeFeedback,d=(0,h._)((0,s.useState)(""),2),f=d[0],m=d[1],v=(0,ed.Z)().showError,g=(0,O.zu)(),y=(0,ef.nS)(),b=(0,ep.Z)(),Z=(0,H.T3)(),w=(0,h._)((t=(0,r._)({},es,{onError:function(){v("Unable to provide feedback")},onCompleted:function(e){var t;(null===(t=e.giveWorkflowFeedback)||void 0===t?void 0:t.__typename)!=="WorkflowFeedbackOutputType"?v(e.giveWorkflowFeedback.message):(y({message:a,feedback:f}),m(""),u())}}),_.D(eu,t)),2),x=w[0],C=w[1].loading,k=(0,s.useCallback)(function(){(0,p.j)(p.U3.GHOSTWRITER_CHAT_INLINE_FEEDBACK_CANCELLED),u()},[u]),S=(0,s.useCallback)(function(){0!==f.length&&((0,p.j)(p.U3.GHOSTWRITER_CHAT_INLINE_FEEDBACK_SUBMITTED),x({variables:{input:{ghostwriterChatFeedback:{chatHistory:JSON.stringify(g),feedback:f,metadata:JSON.stringify({messageId:a.inferenceId,replId:b,chatMessageId:a.id,isMobile:Z})}}}}))},[g,x,Z,a.id,a.inferenceId,b,f]);if(!n)return null;var E=C?eh.p.backgroundPulse(o.TV.accentPrimaryDimmest,o.TV.accentPrimaryDimmer):null;return(0,i.BX)(l.G,{css:em.wrapper,children:[(0,i.tZ)(el.B,{css:[em.textInput],maxLength:5e3,autoFocus:!0,inputMode:"text",placeholder:"Let us know how we can improve this response",value:f,onChange:function(e){m(e.target.value)},onKeyDown:function(e){if("Escape"===e.key&&!C){k();return}"Enter"!==e.key||e.shiftKey||(e.stopPropagation(),S())}}),(0,i.BX)(l.G,{css:em.buttonGroup,children:[(0,i.tZ)(V.zx,{variant:"outlined",text:"Cancel",disabled:C,onClick:k}),(0,i.tZ)(V.zx,{css:E,iconLeft:C?(0,i.tZ)(c.Z,{}):void 0,text:C?"Submitting...":"Submit",disabled:C,colorway:"primary",onClick:S})]})]})},eg=n(38382),ey=n(4736),eb=n(67914),eZ=n(19408),ew=n(25934),ex=n(73030),eC=n(19615),e_=(0,W.X)({root:[o.l0.px(8),o.l0.py(12),o.l0.colWithGap(8)],header:[o.l0.rowWithGap(8),o.l0.align.center],headerLeft:[o.l0.flex.growAndShrink(1),o.l0.rowWithGap(8),o.l0.align.center],intent:[o.l0.rowWithGap(4),o.l0.align.center,o.l0.color.foregroundDimmest],intentSelect:[o.l0.color.foregroundDimmer,{backgroundColor:"transparent",padding:4,height:"auto","& div":o.l0.rowWithGap(4),"& div > span":{fontSize:o.TV.fontSizeSmall},"& div > svg":{width:"12px !important",height:"12px !important",minWidth:"12px !important",minHeight:"12px !important"}}],message:[o.l0.colWithGap(8),o.l0.flex.growAndShrink(1)],footerContainer:[o.l0.rowWithGap(4),o.l0.justify.spaceBetween,o.l0.flex.wrapReverse]}),ek=new Map([["GENERATE",(0,i.tZ)(ew.Z,{},"generate")],["EXPLAIN",(0,i.tZ)(eZ.Z,{},"explain")],["TRANSFORM",(0,i.tZ)(eb.Z,{},"transform")]]),eS=[{title:"Ask chat",value:"NONE"},{title:"Generate code",value:"GENERATE"},{title:"Explain code",value:"EXPLAIN"},{title:"Edit code",value:"TRANSFORM"},{title:"Ask Replit docs",value:"REPLIT_DOCS"}].map(function(e){return(0,r._)({icon:ek.get(e.value)||(0,i.tZ)(ex.Z,{})},e)}).sort(function(e,t){return e.title.localeCompare(t.title)}),eE=B()(function(){return n.e(4989).then(n.bind(n,54989))},{loadableGenerated:{webpack:function(){return[54989]}}}),eT=function(){return(0,i.BX)(l.G,{css:[o.l0.color.accentNegativeStronger,o.l0.flex.row,o.l0.rowWithGap(4),o.l0.align.center],children:[(0,i.tZ)(N.Z,{}),(0,i.tZ)(a.xv,{children:"Response reached maximum output length"})]})},eR=(0,W.X)({root:[o.l0.rowWithGap(4),o.l0.align.center,o.l0.color.foregroundDimmest]}),eI=function(e){var t=e.intent,n=eS.find(function(e){return e.value===t});return n?(0,i.BX)(l.G,{css:eR.root,children:[n.icon,(0,i.tZ)(a.xv,{variant:"small",color:"dimmest",children:n.title})]}):null},eD=function(e){var t=e.id,n=e.intent,r=e.regenerate,o=(0,O.gp)(),a="NONE"===n?null:eS.find(function(e){return e.value===n}),l=eS.filter(function(e){return e.value!==n});return(0,i.tZ)(M.P,{"aria-label":"Reclassify message",items:l,disabled:o,css:e_.intentSelect,placeholder:"Select action",selectedItem:a,onChange:function(e){(0,A.J1)(e.value)&&((0,p.j)(p.U3.GHOSTWRITER_CHAT_INTENT_RECLASSIFIED,{from:n,to:e.value}),r({responseId:t,action:e.value}))}})},eG=(0,s.memo)(function(e){var t=e.message,n=e.autoScroll,r=e.isLastAssistantMessage,u=void 0!==r&&r,d=t.text,h=t.loading,m=t.error,v=t.inferenceId,g=t.stopReason,y=(0,O.Gd)(),b=(0,L.d$)(),Z=!!(t.stopReason||t.aborted),x=(0,H.T3)(),C=(0,eg.ll)(),_=(0,ey.Tt)(),k=((t.tokenUsage||_)&&Z||t.aborted||t.error)&&u,S=(Z||void 0!==t.error)&&void 0!==v&&u,E=(0,T.M)(),R=(0,T.v)(),I=(0,s.useRef)(null),G=(0,P.rM)();(0,s.useLayoutEffect)(function(){n&&I.current&&requestAnimationFrame(function(){n&&I.current&&((0,f.Z)(I.current,{skipOverflowHiddenElements:!0,behavior:"auto",scrollMode:"always"}),G(!0))})},[d,n,G,k,E]);var B=(0,U.Z)(function(){return(0,F.BW)(t.id)},[t.id]);if("transformCode"===t.type&&!b)return null;var A="TRANSFORM"===t.intent?void 0:B,N="NONE"!==t.intent;return(0,i.BX)(l.G,{css:e_.root,children:[(0,i.tZ)(l.G,{css:e_.header,children:(0,i.BX)(l.G,{css:e_.headerLeft,children:[(0,i.tZ)(eC.R,{advanced:t.useAdvancedModel}),t.intent?(0,i.tZ)(l.G,{css:e_.intent,children:u?(0,i.tZ)(eD,{intent:t.intent,id:t.id,regenerate:y}):N&&(0,i.tZ)(eI,{intent:t.intent})}):null]})}),(0,i.BX)(l.G,{children:[h?(0,i.tZ)(c.Z,{}):null,(0,i.tZ)(l.G,{css:e_.message,children:(0,i.tZ)(X.J,{text:d,codeComponent:A})})]}),"string"==typeof m?(0,i.tZ)(l.G,{children:(0,i.tZ)(a.xv,{css:[o.l0.color.accentNegativeStronger,o.l0.fontSize(16)],children:m})}):null,"maxTokens"===g?(0,i.tZ)(eT,{}):null,(0,i.BX)(l.G,{css:e_.footerContainer,children:[S?(0,i.BX)(l.G,{css:[o.l0.rowWithGap(4)],children:[x?null:(0,i.tZ)(ea,{isOpen:E,onToggle:function(){return R(!E)}}),(0,i.tZ)(l.G,{css:[o.l0.rowWithGap(8),o.l0.align.center],children:(0,i.tZ)(D,{inferenceClass:w.Sg.Chat,inferenceId:v})})]}):null,k?(0,i.tZ)(er,{limitReached:!C,onRetry:function(e){(0,p.j)(p.U3.GHOSTWRITER_CHAT_RESPONSE_REGENERATED,{isAdvancedModel:e,timesRegenerated:(t.timesRegenerated||0)+1}),y({responseId:t.id,action:t.intent})}}):null]}),(0,i.tZ)(ev,{isOpen:S&&E,closeFeedback:function(){return R(!1)},message:t}),b?(0,i.tZ)(eE,{message:t}):null,n?(0,i.tZ)(l.G,{css:{marginTop:-8,marginBottom:0},innerRef:I}):null]})},function(e,t){return t.autoScroll===e.autoScroll&&t.isLastAssistantMessage===e.isLastAssistantMessage&&d()(t.message,e.message)})},22580:function(e,t,n){n.d(t,{J:function(){return m}});var r=n(45903),i=n(8182),o=n(68333),a=n(74833),l=n(56596),c=n(43429),s=n(8070),u=n(46299),d=[n(85768).Z,u.Z,s.Z],f=[],h=function(e){return(0,i.tZ)(l.G,{children:(0,i.tZ)(a.xv,{children:e.children})})},p={h1:h,h2:h,h3:h,h4:h,h5:h,h6:h},m=(0,c.memo)(function(e){var t=e.text,n=e.codeComponent;return(0,i.tZ)(o.ZP,{remarkPlugins:d,rehypePlugins:f,components:(0,r._)({},p,n?{code:n}:void 0),lineBreaks:!0,themed:!0,children:t})})},92101:function(e,t,n){n.d(t,{BW:function(){return D}});var r=n(45903),i=n(8182),o=n(57468),a=n(74833),l=n(56596),c=n(29287),s=n(73164),u=n(53326),d=n(32477),f=n(93918),h=n(1498),p=n(43429),m=n(51384),v=n(2532),g=n(10041),y=n(5344),b=n(59868),Z=n(30983),w=n(64992),x=(0,m.F4)({"0%":{opacity:0,transform:"translateX(8px)"},"10%":{opacity:1,transform:"translateX(0)"},"95%":{opacity:1},"100%":{opacity:0}}),C=(0,f.X)({buttonContainer:[c.l0.position.relative,{transition:"opacity 75ms linear",opacity:1}],buttonWrapper:[c.l0.flex.row],button:[c.l0.backgroundColor.backgroundDefault],buttonToast:{position:"absolute",display:"block",bottom:"100%",paddingBottom:c.TV.space4,paddingRight:c.TV.space8,animation:"".concat(x," 3s"),fontFamily:c.TV.fontFamilyDefault,fontSize:c.TV.fontSizeDefault,whiteSpace:"nowrap",userSelect:"none"}}),_=function(e){var t=e.code,n=e.language,r=(0,d._)((0,p.useState)(!1),2),o=r[0],a=r[1];return(0,i.BX)("div",{css:C.buttonContainer,children:[o?(0,i.tZ)("span",{css:C.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){a(!1)})},"aria-hidden":!0,children:"Copied!"}):null,(0,i.tZ)(h.zx,{css:C.button,text:"Copy",size:"small",iconLeft:(0,i.tZ)(y.Z,{}),onClick:function(){(0,b.j)(b.U3.GHOSTWRITER_CHAT_CODE_COPIED,{language:n}),(0,g.Z)(t),a(!0)}})]})},k=function(e){var t=e.code,n=e.disabled,r=e.insertCode,o=(0,d._)((0,p.useState)(!1),2),a=o[0],l=o[1],c=(0,i.tZ)(h.zx,{css:C.button,text:"Insert",disabled:n,size:"small",iconLeft:(0,i.tZ)(v.Z,{}),onClick:function(){r&&(r(t),l(!0))}});return(0,i.BX)("div",{css:C.buttonContainer,children:[a?(0,i.tZ)("span",{css:C.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){l(!1)})},"aria-hidden":!0,children:"Inserted!"}):null,(0,i.tZ)(Z.u,{placement:"bottom",tooltip:n?"Place cursor in a file to insert code":"Insert code at cursor position",children:c})]})},S=function(e){var t=e.revertCodeInsert,n=(0,d._)((0,p.useState)(!1),2),r=n[0],o=n[1],a=(0,i.tZ)(h.zx,{css:C.button,text:"Revert",size:"small",iconLeft:(0,i.tZ)(w.Z,{}),onClick:function(){t(),o(!0)}});return(0,i.BX)("div",{css:C.buttonContainer,children:[r?(0,i.tZ)("span",{css:C.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){o(!1)})},"aria-hidden":!0,children:"Reverting..."}):null,(0,i.tZ)(Z.u,{placement:"bottom",tooltip:"Revert code insertion",children:a})]})},E=n(38080),T=n(6079),R=n(58091),I=n(29217),D=function(e){return function(t){return B(t,e)}},G=(0,f.X)({root:[c.l0.borderRadius(4),c.l0.border({color:c.TV.outlineDimmest})],header:[c.l0.rowWithGap(8),c.l0.border({color:c.TV.outlineDimmest,direction:"bottom"}),{fontFamily:c.TV.fontFamilyDefault}],headerLeft:[c.l0.rowWithGap(0),c.l0.pl(4),c.l0.flex.growAndShrink(1),c.l0.align.center],headerRight:[c.l0.rowWithGap(0),{"& button":{borderRadius:0},"& > div:last-of-type button":{borderTopRightRadius:4}}],blockStyles:{backgroundColor:"transparent"}}),B=function(e,t){if(e.inline)return(0,i.tZ)(u.Z,(0,r._)({},e));var n=(0,u.F)(e.className),d=n&&function(e){switch(e){case"crystal":return"main.cr";case"python":case"py":return"main.py";case"sh":case"fish":case"zsh":case"bash":return"main.sh";case"javascript":case"js":return"index.js";case"typescript":case"ts":return"index.ts";case"csharp":case"cs":return"main.cs";case"java":return"Main.java";case"go":return"main.go";case"ruby":case"rb":return"main.rb";case"php":return"main.php";case"rust":return"main.rs";case"swift":return"main.swift";case"kotlin":return"main.kt";case"scala":return"main.scala";case"c":return"main.c";case"cpp":case"c++":return"main.cpp";case"dart":return"main.dart";case"elixir":return"main.ex";case"haskell":return"Main.hs";case"lua":return"main.lua";case"perl":return"main.pl";case"r":return"main.r";case"sql":return"main.sql";case"ocaml":return"main.ml";case"html":return"index.html";case"json":return"main.json";case"css":return"main.css";default:return}}(n),f=d?s.$R.from(d):void 0,h=null==f?void 0:f.name,p=String(e.children);return(0,i.BX)(E.Tg,{css:G.root,children:[(0,i.BX)(l.G,{css:G.header,children:[(0,i.BX)(l.G,{css:G.headerLeft,children:[d?(0,i.tZ)(o.Z,{size:12,path:d}):null,h?(0,i.tZ)(a.xv,{multiline:!1,css:[c.l0.pl(4),c.l0.fontSize(12),c.l0.color.foregroundDimmer],children:h}):null]}),(0,i.BX)(l.G,{css:G.headerRight,children:[(0,i.tZ)(_,{code:p,language:n}),(0,i.tZ)(N,{messageId:t,code:p,language:n})]})]}),(0,i.tZ)(u.Z,(0,r._)({blockStyles:G.blockStyles,disableCopy:!0},e))]})},P=function(e){(0,b.j)(b.U3.GHOSTWRITER_CHAT_CODE_INSERTED,{language:e})},A=function(){(0,b.j)(b.U3.GHOSTWRITER_CHAT_CODE_INSERT_REVERTED)},N=function(e){var t=e.code,n=e.messageId,r=e.language,o=(0,T.$L)(),a=o.onInsertCode,l=o.onRevertCode,c=(0,R.R3)(),s=(0,R.ex)(),u=(0,I.$0)();return(0,T.y6)(n)?(0,i.tZ)(S,{revertCodeInsert:function(){l(A),u(null)}}):(0,i.tZ)(k,{code:t,disabled:!(null!=c?c:s),insertCode:function(){a({toInsert:t,onInsert:function(){return P(r)}}),n&&u(n)}})}},57678:function(e,t,n){n.d(t,{r:function(){return c}});var r=n(8182),i=n(74833),o=n(56596),a=n(76588),l=n(29287);function c(e){var t=e.textVariant;return(0,r.BX)(i.xv,{variant:t,children:["AI Chat is currently unavailable. For more information, visit"," ",(0,r.tZ)("a",{href:"https://status.replit.com",target:"_blank",children:"our status page."})]})}t.Z=function(e){var t=e.textVariant,n=e.showImage;return(0,r.BX)(o.G,{css:[l.l0.center,l.l0.textAlign.center,l.l0.px(16),l.l0.colWithGap(8),l.l0.flex.growAndShrink(1)],children:[(0,r.tZ)(c,{textVariant:t}),n?(0,r.tZ)(a.Z,{src:"/public/images/ghostwriter/orb.png",css:[{userSelect:"none",mixBlendMode:"screen",filter:"brightness(110%) saturate(1.2)",maskImage:"linear-gradient(".concat(l.TV.backgroundRoot,", transparent)")}],width:200,height:200,objectFit:"contain","aria-hidden":"true",alt:"",draggable:!1}):null]})}},6079:function(e,t,n){n.d(t,{$L:function(){return d},$h:function(){return u},y6:function(){return f}});var r=n(32477),i=n(29217),o=n(52902),a=n(58091),l=n(76568),c=n(34581),s=n(43429);function u(){var e=(0,i.n3)(),t=(0,i.PM)(),n=(0,c.Vu)();(0,s.useEffect)(function(){e&&(n.includes(e)||t(null))},[e,n,t])}var d=function(){var e,t,n=(0,a.R3)(),u=(0,c.ex)(),d=(0,i.PM)(),f=null!=n?n:u,h=(e=(0,c.nC)(),t=(0,l.dr)(),(0,s.useCallback)(function(n){if(!n)return null;var i=e().find(function(e){var t=(0,r._)(e,2),i=(t[0],t[1]);return(0,o.Ur)(i)&&i.data.path===n});if(!i)return null;var a=t(i[0]);if((null==a?void 0:a.type)!=="codeEditor")throw Error("Expected code editor pane to insert into");if(!a||!a.insertGhostwriterChatCode||!a.revertGhostwriterChatCode)throw Error("Expected ghostwriter pane bindings");return{insert:a.insertGhostwriterChatCode,revert:a.revertGhostwriterChatCode}},[t,e]));return{onInsertCode:(0,s.useCallback)(function(e){var t=e.toInsert,n=e.overwrite,r=e.onInsert,i=h(f);i&&(i.insert(t,n),d(f),null==r||r())},[h,f,d]),onRevertCode:(0,s.useCallback)(function(e){var t=h(f);t&&(t.revert(),d(null),null==e||e())},[f,h,d])}},f=function(e){var t=(0,i.n3)(),n=(0,i.U4)();return!!e&&t&&n&&n===e}},65774:function(e,t,n){n.d(t,{fT:function(){return R},Th:function(){return I},c8:function(){return P}});var r=n(88032),i=n(95867),o=n(34142),a=n(5453),l=n(32477),c=n(21289),s=n(67073),u=n(87682),d=n(48900),f=n(92920),h=n(36617),p=n(50782),m=n(3590),v=n(4736),g=n(43429),y=n(27379),b=n(26572),Z=n(52297),w=n(83898),x=n(25425);function C(e,t){var n=Error(e);return d.$e(function(e){e.setTag("ghostwriter-chat",!0),t&&e.setExtras(t),d.Tb(n)}),n}var _=n(92809);n(34471),_.Type.Object({replId:_.Type.String({format:"uuid"})});var k=_.Type.Object({token:_.Type.String()});function S(e){return E.apply(this,arguments)}function E(){return(E=(0,o._)(function(e){var t;return(0,u.Jh)(this,function(n){switch(n.label){case 0:return[4,fetch("/ai/auth",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({replId:e})})];case 1:return[4,n.sent().json()];case 2:if(t=n.sent(),!h.B4.Check(k,t))throw C("Authentication to chat service failed",{detail:t});return[2,t.token]}})})).apply(this,arguments)}var T=n(15542),R={production:"wss://production-ai-chat.replit.com/ws",staging:"wss://staging-ai-chat.replit.com/ws",development:"ws://127.0.0.1:8000/ws"},I=function(){return(0,f.Z)().preferences.ghostwriterChatServiceEnvironment||R.production},D=function(e){if(h.B4.Check(Z.LD,e)||h.B4.Check(Z.t3,e))return e;throw C("Invalid model",{model:e})};function G(e){var t=h.B4.Convert(Z.EI,JSON.parse(e.data));if(!h.B4.Check(Z.EI,t)){var n=h.B4.Errors(Z.EI,t);throw C("Invalid Ghostwriter Chat service message",{errors:(0,c._)(n)})}return t}function B(e,t){return new Date(e.timeCreated).getTime()-new Date(t.timeCreated).getTime()}var P=function(){var e,t=(0,p.Z)(),n=(0,T.d)(),f=(0,m.jC)(),h=(0,w.kL)(),Z=(0,l._)((0,g.useState)(!1),2),_=Z[0],k=Z[1],E=(0,l._)((0,g.useState)(0),2),R=E[0],P=E[1],A=I(),N=(0,v.Lv)(),U=(0,l._)((0,g.useState)(function(){return(0,b.Z)()}),2),L=U[0],O=U[1],X=(0,x.P5)({controlName:"flag-blue-water-token"}),M=(0,x.P5)({controlName:"flag-ai-ws-client-2"}),F=(0,g.useCallback)((0,o._)(function(){var e,n;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return[4,S(t)];case 1:return e=r.sent(),(n=new URL(A)).searchParams.set("authToken",e),[2,n.toString()]}})}),[A,t]),W=(0,y.ZP)(X?F:A,{shouldReconnect:function(){return R<10},reconnectInterval:function(e){var t=Math.min(1e3*Math.pow(2,Math.max(e,R)),1e4);return t+Math.floor(t/2*Math.random())},reconnectAttempts:10,onClose:function(){O((0,b.Z)()),k(!1)},onReconnectStop:function(){var e=(0,b.Z)();e.resolve(!1),O(e)},onOpen:(0,o._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:if(X)return $?J():Y(),k(!0),L.resolve(!0),[2];return[4,q()];case 1:return H({authRequest:{authToken:e.sent()}},!1),[2]}})}),onError:function(e){R>=10&&C("Ghostwriter Chat websocket error",{endpoint:A,event:e})},onMessage:function(e){var r=G(e);r.authResponse?K(r):r.sessionCreationResponse?Q(r):r.usageQuota?en(r):r.chatReplSessions?et(r.chatReplSessions):r.invalidMessage&&C("Invalid request",{endpoint:A,replId:t,currentUserId:n,detail:r.invalidMessage.error})}},!M&&null!==n),H=W.sendJsonMessage,V=W.readyState,z=W.getWebSocket,j=V===y.kQ.OPEN&&_;(0,g.useEffect)(function(){if(j){var e,t=z();if(t){var n=function(){},r=!1;return(e=(0,o._)(function(){var e;return(0,u.Jh)(this,function(i){switch(i.label){case 0:if(!(!r&&t.readyState===y.kQ.OPEN))return[3,3];return[4,new Promise(function(e){var r=function(t){G(t).pong&&(n(),e({success:!0}))},i=setTimeout(function(){n(),e({success:!1})},2e3);t.addEventListener("message",r),n=function(){t.removeEventListener("message",r),clearTimeout(i),n=function(){}},H({ping:{}},!1)})];case 1:if(e=i.sent().success,r)return[2];if(!e)return t.close(),[2];return[4,new Promise(function(e){return setTimeout(e,2e4)})];case 2:return i.sent(),[3,0];case 3:return[2]}})}),function(){return e.apply(this,arguments)})(),function(){r=!0,n()}}}},[z,H,j]);var q=(0,g.useCallback)((0,o._)(function(){return(0,u.Jh)(this,function(e){return[2,S(t)]})}),[t]),Y=(0,g.useCallback)((0,o._)(function(){return(0,u.Jh)(this,function(e){if(!n)throw C("Cannot create session without a user id",{endpoint:A,replId:t});return H({sessionCreationRequest:{userId:n,replId:t}}),[2,null]})}),[n,A,t,H]),$=(0,x.P5)({controlName:"flag-gigantic-events"}),J=(0,g.useCallback)(function(){H({getReplSessionsRequest:{replId:t,includeFirstSessionEvents:!0,messagesLimit:1e3}})},[t,H]),K=(0,g.useCallback)(function(e){if(e.authResponse){if(e.authResponse.success)$?J():Y(),k(!0),L.resolve(!0),P(0);else throw P(function(e){return e+1}),C("Authentication failed",{endpoint:A,replId:t,currentUserId:n,detail:e.authResponse.error})}},[Y,n,A,t,P,$,J,L]),Q=(0,g.useCallback)(function(e){if(e.sessionCreationResponse){if(e.sessionCreationResponse.sessionId)f(e.sessionCreationResponse.sessionId);else throw C("Session creation failed",{endpoint:A,replId:t,currentUserId:n,detail:e.sessionCreationResponse.error})}},[n,A,t,f]),ee=(0,x.P5)({controlName:"flag-gigantic-events-display"}),et=(0,g.useCallback)(function(e){if(!e.sessions.length){Y();return}var t=function(e){var t=null,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(!t){t=l;continue}if(l.values.length){if(!t.values.length){t=l;continue}new Date(l.values[l.values.length-1].timeCreated)>new Date(t.values[t.values.length-1].timeCreated)&&(t=l)}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(e.sessions);if(t){ee&&h((function(e){try{var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if("this_message_was_retried"===l.parentEventId&&"Human"===l.role){if(t.length>1&&"Assistant"===t[t.length-1].role&&"Human"===t[t.length-2].role)t.pop(),t.pop();else throw Error("The last two messages do not have 'Assistant' and 'Human' roles.")}t.push(l)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}catch(t){return e}})((0,c._)(t.values).sort(B)).map(function(e){var t;return{id:e.id,text:e.content,attribution:"Human"===e.role?"Human":"Assistant",timeCreated:new Date(e.timeCreated),type:e.eventType,codeReference:e.codeReference,intent:null!==(t=e.intent)&&void 0!==t?t:"NONE"}})),f(t.sessionId);return}},[ee,Y,h,f]),en=(0,g.useCallback)(function(e){var t=e.usageQuota;t&&N({basicModelUsage:t.basicModelUsage,basicModelLimit:t.basicModelLimit,basicModelTTLEnd:1e3*t.basicLimitRefreshTime+Date.now(),advancedModelUsage:t.advancedModelUsage,advancedModelLimit:t.advancedModelLimit,advancedModelTTLEnd:1e3*t.advancedLimitRefreshTime+Date.now()})},[N]),er=(0,g.useCallback)((e=(0,o._)(function(e){var r,i,o,l,c,f,h,p,m,v,g,y,Z,w,x,k,S,E,T,R,I,B,P;return(0,u.Jh)(this,function(N){switch(N.label){case 0:return r=e.body,i=e.options,o=r.sessionId,l=r.message,c=r.chatHistory,f=r.model,h=r.context,p=r.useAdvancedModel,m={chatRequest:{sessionId:o,replId:t,message:l,chatHistory:c,model:D(f),context:h,useAdvancedModel:p}},v=[],g=(0,b.Z)(),y=!1,Z=0,w="",x=null,k=new Promise(function(e,r){x=setTimeout(function(){r(C("Authentication timed out while sending a message",{endpoint:A,replId:t,currentUserId:n,requestId:w,finished:y,dispatched:Z,isAuthed:_,timeout:6e4}))},6e4)}),[4,Promise.race([L.promise,k])];case 1:if(N.sent(),x&&clearTimeout(x),!(S=z()))throw C("Websocket is not ready to send messages",{endpoint:A,isAuthed:_,replId:t,currentUserId:n,sessionId:o});return E=function(){y=!0,S.removeEventListener("message",R),S.removeEventListener("close",T)},i.abortSignal.onabort=function(){if(!w)throw C("Cannot abort request",{endpoint:A,replId:t,currentUserId:n});H({abortRequest:{requestId:w}})},T=function(){if(!y){var e=C("Request did not finished - websocket closed",{endpoint:A,replId:t,currentUserId:n,dispatched:Z});g.reject(e)}},R=function(e){e.data&&"string"==typeof e.data||g.reject(C("Invalid Event - does not match Message Event",{event:e}));try{var r=G(e);if(r.invalidMessage&&!w)throw Error("Invalid request: ".concat(r.invalidMessage));if(r.chatResponseStart&&!w&&(w=r.chatResponseStart.requestId),r.chatResponseChunk){var i=r.chatResponseChunk;if(i.requestId!==w)return;v.push(i)}if(r.chatResponseEnd){var o,a=r.chatResponseEnd;if(a.requestId!==w)return;a.success||g.reject(Error("Chat request failed: ".concat(null!==(o=a.error)&&void 0!==o?o:"Unknown error"))),E()}if(r.abortResponse){var l=r.abortResponse;if((null==l?void 0:l.requestId)!==w)return;E()}g.resolve()}catch(e){d.$e(function(r){r.setExtra("requestId",w),r.setExtra("finished",y),r.setExtra("dispatched",Z),r.setExtra("userId",n),r.setExtra("replId",t),r.setTag("ghostwriter-chat",!0),d.Tb(e)}),g.reject(e)}},S.addEventListener("message",R),S.addEventListener("close",T),H(m),I=setTimeout(function(){var e=C("Message total timed out",{endpoint:A,replId:t,dispatched:Z});g.reject(e)},12e4),P=(B=function(){return setTimeout(function(){var e=C("Message chunk timed out",{endpoint:A,replId:t,dispatched:Z});g.reject(e)},2e4)})(),[2,(0,s._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:e.trys.push([0,,8,9]),e.label=1;case 1:if(y)return[3,7];return[4,(0,a._)(g.promise)];case 2:e.sent(),P&&(clearTimeout(P),P=B()),g=(0,b.Z)(),e.label=3;case 3:if(!(Z<v.length))return[3,6];return[4,v[Z]];case 4:e.sent(),e.label=5;case 5:return Z++,[3,3];case 6:return[3,1];case 7:return[3,9];case 8:return E(),clearTimeout(I),clearTimeout(P),[7];case 9:return[2]}})})()]}})}),function(t){return e.apply(this,arguments)}),[n,A,z,_,t,H,L]);return(0,g.useCallback)(function(){return{sendMessage:function(e){var t=e.body,n=e.options;return(0,s._)(function(){var e;return(0,u.Jh)(this,function(o){switch(o.label){case 0:return[4,(0,a._)(er({body:t,options:n}))];case 1:return e=o.sent(),[5,(0,u.XA)((0,r._)((0,i._)(e),a._))];case 2:return o.sent(),[2]}})})()},createNewSession:Y}},[Y,er])}},50455:function(e,t,n){n.d(t,{P:function(){return l}});var r=n(32477),i=n(38382),o=n(44124),a=n(45434);function l(e){var t=(0,r._)((0,o.Ni)(),1)[0],n=(0,i.ll)();return"advanced"===t&&n?a.hf.model:e}},99708:function(e,t,n){n.d(t,{yz:function(){return u}});var r=n(45903),i=n(93295),o=n(23982),a=n(66039);function l(){var e=(0,i._)(["\n  query GhostwriterChatCurrentUserQuery {\n    currentUser {\n      username\n      id\n      image\n      isStaff: hasRole(role: REPLIT_STAFF)\n      isVerified\n      userSubscriptionType\n      userPowerUpsByType {\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l());function u(e){var t=(0,r._)({},c,e);return a.a(s,t)}},92815:function(e,t,n){n.d(t,{M:function(){return a},v:function(){return o}});var r=n(78094),i=(0,n(90234).cn)(!1),o=function(){return(0,r.$X)(i)},a=function(){return(0,r.c1)(i)}},26485:function(e,t,n){n.d(t,{p:function(){return a}});var r=n(85172),i=n(38382),o=n(43429),a=function(){var e=(0,i.$e)(),t=(0,r.v)().isTeamWithAiDisabled;(0,o.useEffect)(function(){e({isTeamWithAiDisabled:t})},[e,t])}},96535:function(e,t,n){n.d(t,{b:function(){return R}});var r=n(34142),i=n(87682),o=n(54916),a=n(58091),l=n(45434),c=n(21289),s=n(29559),u=n(1574),d=n(39756),f=n(30084),h=n(37685),p=n(1228);function m(e){var t=(0,s.r6)(e),n=p.hI.some(function(t){return e.endsWith(t)}),r=p.HH.some(function(t){return e.endsWith(t)}),i=p.Fv.some(function(t){return e.split("/").some(function(e){return e.includes(t)})});return!t||n||r||i}var v=n(95683),g=n(39426),y=n(47507);function b(){return(b=(0,r._)(function(e){var t,n,r,o,a,l,u,p;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=e.files,n=e.fs,r=e.entrypointFile,o=e.hiddenFiles,!(r&&t.length<10))return[3,2];return t.push(r),u=""===(l=(0,s.Il)(r))?d.Ql:l,[4,n.readDir(u)];case 1:if(!("children"in(p=i.sent())))return[2];(a=t).push.apply(a,(0,c._)(p.children.filter(function(e){return e.type===f.Tv.File}).filter(function(e){return!(m(e.filename)||(0,h.lv)(e.filename,o)||!(0,s.Mb)(e.filename))}).map(function(e){return u===d.Ql?e.filename:"".concat(l,"/").concat(e.filename)}).filter(function(e){return!t.includes(e)}).slice(0,1))),i.label=2;case 2:return[2]}})})).apply(this,arguments)}function Z(){return(Z=(0,r._)(function(e){var t,n,r,o,a,l,d,f,p,Z,w,x,C,_,k,S,E,T,R,I,D,G,B,P,A,N,U,L,O,X,M,F,W,H;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return t=e.recentFiles,n=e.fs,r=e.dotReplit,o=e.maxCharacters,a=e.replLanguage,l=e.filePreferences,[4,r.getConfig()];case 1:return w=(null==(Z=i.sent().config)?void 0:Z.entrypoint)||g.ZP.getMainFileName(a)||null,x=((null==Z?void 0:Z.hidden)||[]).map(function(e){return(0,u.Z)(e)}).filter(Boolean),C=[],k=null!==(_=null==l?void 0:null===(p=l.filter(function(e){return"include"===e.preference}))||void 0===p?void 0:p.map(function(e){return e.path}))&&void 0!==_?_:[],(d=C).push.apply(d,(0,c._)(k)),S=k.length,E=t.slice(0,3),(f=C).push.apply(f,(0,c._)(E)),T=E.length,[4,function(e){return b.apply(this,arguments)}({files:C,entrypointFile:w,fs:n,hiddenFiles:x})];case 2:return i.sent(),R=C.length-T-S,y.kg.info("GhostwriterChat got file context",{numRecentFiles:T,numEntrypointFiles:R,maxFiles:10}),D=(I=function(e){var t=e.files,n=e.hiddenFiles,r=e.filePreferences,i=null!==(b=null==r?void 0:null===(v=r.filter(function(e){return"include"===e.preference}))||void 0===v?void 0:v.map(function(e){return e.path}))&&void 0!==b?b:[],o=null!==(Z=null==r?void 0:null===(g=r.filter(function(e){return"exclude"===e.preference}))||void 0===g?void 0:g.map(function(e){return e.path}))&&void 0!==Z?Z:[],a=0,l=[],u=[],d=!0,f=!1,p=void 0;try{for(var v,g,b,Z,w,x=(0,c._)(new Set(t))[Symbol.iterator]();!(d=(w=x.next()).done);d=!0){var C=w.value;if(!(!i.includes(C)&&(m(C)||(0,h.lv)(C,n)||o.includes(C)||!(0,s.Mb)(C)))){if(a>=10){u.push(C);continue}l.push(C),a+=1}}}catch(e){f=!0,p=e}finally{try{d||null==x.return||x.return()}finally{if(f)throw p}}return 0===l.length&&y.kg.info("GhostwriterChat filtered out all files for file context",{numFiles:t.length}),{validFilePaths:l,pathsExceedingMaxFilesLimit:u}}({files:C,hiddenFiles:x,filePreferences:l})).validFilePaths,G=I.pathsExceedingMaxFilesLimit,[4,Promise.all(D.map(function(e){return n.readFile(e)}))];case 3:for(L=0,B=i.sent(),P=[],A=[],N=G,U=o;L<D.length;L++){if(O=D[L],X=(0,v.S)(O),(M=B[L]).error){y.kg.info("GhostwriterChat failed to read file",{filePath:O});continue}if(function(e){var t=e.length;if(0===t)return!1;var n=0,r=Math.min(t,512);if(t>=3&&239===e[0]&&187===e[1]&&191===e[2]||t>=4&&0===e[0]&&0===e[1]&&254===e[2]&&255===e[3]||t>=4&&255===e[0]&&254===e[1]&&0===e[2]&&0===e[3]||t>=4&&132===e[0]&&49===e[1]&&149===e[2]&&51===e[3])return!1;if(r>=5&&"%PDF-"===e.slice(0,5).toString())return!0;if(t>=2&&254===e[0]&&255===e[1]||t>=2&&255===e[0]&&254===e[1])return!1;for(var i=0;i<r;i++){if(0===e[i])return!0;if((e[i]<7||e[i]>14)&&(e[i]<32||e[i]>127)){if(e[i]>193&&e[i]<224&&i+1<r){if(e[++i]>127&&e[i]<192)continue}else if(e[i]>223&&e[i]<240&&i+2<r&&e[++i]>127&&e[i]<192&&e[i+1]>127&&e[i+1]<192){i++;continue}if(n++,i>=32&&100*n/r>10)return!0}}return 100*n/r>10}(M.content.toBuffer())){y.kg.info("GhostwriterChat filtered out binary file",{filePath:O});continue}if(U<=0){N.push(O);continue}W=(F=M.content.toString()).slice(0,U),H=F.length>W.length,U<=0&&N.push(O),H?A.push(O):P.push({filePath:O,language:X,code:W}),U-=W.length}return U<=0?y.kg.info("GhostwriterChat hit character limit for file context",{numFilesIncluded:D.length,filesExcluded:D.length-P.length}):y.kg.info("GhostwriterChat has remaining file context characters",{remainingChars:U}),[2,{fileContext:P,truncatedFiles:A,overflowingFiles:N}]}})})).apply(this,arguments)}var w=n(43429),x=n(23394),C=n(50455),_=n(72129),k=n(29217),S=n(65774),E=function(){var e=(0,S.c8)();return(0,w.useCallback)(function(){return e()},[e])},T=n(25425);function R(e){var t,n,c,s,u,d,f,h,p=(0,T.P5)({controlName:"flag-ai-ws-client-2"}),m=(n=(t=(0,o.Z)()).fs,c=t.dotReplit,s=(0,_.v)(),u=(0,a.AA)(),d=(0,x.Z)(),f=(0,C.P)(s),(0,w.useCallback)((h=(0,r._)(function(e){var t,r,o,a,s;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(!n||!c)throw Error("Expected fs and dotReplit services");return t=(0,l.yL)(f).fileContextCharacters,[4,function(e){return Z.apply(this,arguments)}({recentFiles:r=u(),fs:n,dotReplit:c,maxCharacters:t,replLanguage:d,filePreferences:e})];case 1:return o=i.sent(),a=r[0],[2,{ghostwriterFileContext:o,mostRecentFile:(null!==(s=null==e?void 0:e.filter(function(e){return"exclude"===e.preference}).map(function(e){return e.path}))&&void 0!==s?s:[]).includes(a)?null:a}]}})}),function(e){return h.apply(this,arguments)}),[n,c,f,u,d])),v=E(),g=(0,k.e)(),y=(0,k.TP)();(0,w.useEffect)(function(){return y(m),function(){y(k.f9.getGhostwriterFileContext)}},[y,m]),(0,w.useEffect)(function(){if(!p)return g(v()),function(){g(null)}},[v,g,p]),(0,w.useEffect)(function(){if(!p)return},[p])}},46868:function(e,t,n){n.d(t,{CN:function(){return o},CT:function(){return i},bO:function(){return a}});var r=n(27308),i="git",o={gitCommit:{id:"git.commit",name:"Git: Commit",scope:i,default:(0,r.l2)({cmdOrCtrl:!0,key:"Enter"})}},a=Object.values(o)},31171:function(e,t,n){n.d(t,{Ai:function(){return g},BI:function(){return u},Jp:function(){return d},_H:function(){return f},_Z:function(){return v},bA:function(){return m},ox:function(){return y}});var r=n(45903),i=n(25e3),o=n(59173),a=n(90234),l=n(71999),c=n(43429),s=n(50199),u=(0,o.u)(function(){return null}),d=(0,o.u)(function(){return null});function f(e){var t=d.current();(0,c.useEffect)(function(){e!==t&&d.set(function(){return e})},[e,t])}var h=(0,a.cn)(null),p=(0,a.cn)(null,function(e,t,n){var o,a,l=e(h),c=l?(0,r._)({},l,n):(0,r._)({},n),s=null==c?void 0:c.changes,d=null==c?void 0:c.filePath;if(!d||!s)throw Error('"filePath", "changes", "users" required when initializing history state');var f=(a=(o=(0,i._)((0,r._)({},c),{changes:s,filePath:d})).changes.length,(0,r._)({users:{},count:a,version:Math.max(0,a-1),playing:!1,comparing:!1},o));u.set(function(){return f});var p=f.changes.length;if(0===p){t(h,f);return}(null==l?void 0:l.changes)&&f.changes!==l.changes&&(f.count=p,f.version=Math.min(f.version,p-1),f.playing=!1,f.comparing=!1),f.version===p-1&&(f.playing=!1),t(h,f)});function m(){return(0,l.Dv)(h,{store:b()})}function v(){return(0,l.b9)(p,{store:b()})}function g(){return(0,l.b9)((0,s.Z)(function(){return(0,a.cn)(null,function(e,t){t(h,null)})},[]),{store:b()})}var y=(0,c.createContext)(null);function b(){var e=(0,c.useContext)(y);if(!e)throw Error("Expected store in context");return e}},99418:function(e,t,n){n.d(t,{j:function(){return s},p:function(){return u}});var r=n(45903),i=n(59868),o=n(63009),a=n(43429),l=n(67795),c=n(31171);function s(){var e=(0,o.uV)();return(0,a.useCallback)(function(t,n,i){e({origin:"History2: useHistoryBSOD",error:t,tags:{source:"ws-history2",type:n},extras:(0,r._)({state:c.BI.current()},i)})},[e])}function u(e){(0,i.j)(l.U3.HISTORY_USED,{action:e,which:"ws"})}},92854:function(e,t,n){var r=n(8182);n(43429);var i=n(49344),o=n(74833),a=n(1498),l=n(56596),c=n(94106),s=n(39233),u=n(29287),d=(0,n(93918).X)({root:[u.l0.colWithGap(32)],header:[u.l0.rowWithGap(16),u.l0.align.center],icon:[u.l0.color.orangeStrongest],body:[u.l0.pr(32),u.l0.colWithGap(16)],list:[u.l0.colWithGap(16),u.l0.pl(16)],buttons:[u.l0.rowWithGap(16),u.l0.justify.end]});t.Z=function(e){var t=e.isOpen,n=(0,c.useRouter)();return(0,r.tZ)(i.u,{preventClose:!0,isOpen:t,centered:!0,onRequestClose:function(){},maxWidth:600,children:(0,r.BX)(l.G,{css:d.root,children:[(0,r.BX)(l.G,{css:d.header,children:[(0,r.tZ)(s.Z,{size:24,css:d.icon}),(0,r.tZ)(o.h4,{css:[{width:"fit-content"}],level:2,variant:"headerDefault",children:"You cant join this Repl from Firewall Mode."})]}),(0,r.BX)(l.G,{css:d.body,children:[(0,r.tZ)(o.xv,{children:"This Repl was started by someone not in Firewall Mode. If you would like to join, please do one of the following:"}),(0,r.BX)(l.G,{css:d.list,children:[(0,r.tZ)(o.xv,{multiline:!1,children:" Exit Firewall Mode."}),(0,r.tZ)(o.xv,{multiline:!1,children:" Ask the creator to open this Repl in Firewall Mode."})]})]}),(0,r.BX)(l.G,{css:d.buttons,children:[(0,r.tZ)(a.zx,{text:"Exit Firewall Mode",onClick:function(){window.location.href="https://www.replit.com".concat(n.asPath)}}),(0,r.tZ)(a.zx,{text:"Leave",onClick:function(){n.push("/home","~/")}})]})]})})}},94655:function(e,t,n){n.d(t,{h:function(){return S},w:function(){return _}});var r=n(45903),i=n(25e3),o=n(8182),a=n(95571),l=n(18836),c=n(43429),s=n(92153),u=n(90234),d=n(32477),f=n(71999);function h(){return(0,d._)((0,c.useState)(function(){return(0,u.MT)()}),1)[0]}var p=(0,c.createContext)(null),m=function(e){return(0,f.b9)(e,{store:function(){var e=(0,c.useContext)(p);if(!e)throw Error("Expected store in context");return e}()})},v=n(50199),g=(0,u.cn)(-1),y=(0,u.cn)([]),b=(0,u.cn)(void 0),Z=(0,u.cn)(null,function(e,t,n){var r=e(b);switch(r&&(clearTimeout(r.id),r.cb()),n){case"forward":t(g,function(t){return Math.min(e(y).length,t+1)});break;case"backward":t(g,function(e){return Math.max(0,e-1)})}var i=e(y),o=e(g);return o>=i.length?"":i[o]}),w=(0,u.cn)(null,function(e,t,n){clearTimeout(null===(r=e(b))||void 0===r?void 0:r.id);var r,i=function(){if(n.length>0){var r=!1;t(y,function(t){return(0,s.ZP)(t,function(t){if(n!==t[e(g)])for(r=!0,t.push(n);t.length>20;)t.shift()})}),r&&t(g,e(y).length-1)}t(b,void 0)};t(b,{id:setTimeout(i,2e3),cb:i})});function x(e){var t,n=m(w),o=(t=m(Z),{forward:(0,v.Z)(function(){return function(){return t("forward")}},[t]),backward:(0,v.Z)(function(){return function(){return t("backward")}},[t])}),l=o.forward,s=o.backward,u=(0,c.useRef)(e.value);return(0,c.useEffect)(function(){e.value!==(null==u?void 0:u.current)&&(e.value&&n(e.value),u.current=e.value)},[n,e.value]),(0,i._)((0,r._)({},e),{onKeyDown:(0,v.Z)(function(){return function(t){if(t.shiftKey||(0,a.j)(t)){null===(r=e.onKeyDown)||void 0===r||r.call(e,t);return}var n,r,i=t.currentTarget,o=!!i.value.match(/\n/);if("ArrowUp"===t.key){if(o&&i.selectionStart&&i.selectionStart>0)return;e.onChange(s()),t.preventDefault(),t.stopPropagation();return}if("ArrowDown"===t.key){if(o&&i.selectionEnd&&i.selectionEnd<i.value.length)return;e.onChange(l()),t.preventDefault(),t.stopPropagation();return}null===(n=e.onKeyDown)||void 0===n||n.call(e,t)}},[s,l,e]),onChange:(0,v.Z)(function(){return function(t){e.onChange(t.target.value)}},[e])})}var C=c.forwardRef(function(e,t){var n=x(e);return(0,o.tZ)(l.B,(0,r._)({ref:t},n))}),_=c.forwardRef(function(e,t){var n=h();return(0,o.tZ)(p.Provider,{value:n,children:(0,o.tZ)(C,(0,r._)({ref:t},e))})}),k=c.forwardRef(function(e,t){var n=x(e);return(0,o.tZ)(l.II,(0,r._)({ref:t},e,n))}),S=c.forwardRef(function(e,t){var n=h();return(0,o.tZ)(p.Provider,{value:n,children:(0,o.tZ)(k,(0,r._)({ref:t},e))})})},80499:function(e,t,n){n.d(t,{m:function(){return p}});var r=n(8182);n(43429);var i=n(51384),o=n(56596),a=n(29287),l=n(30983),c=n(73858),s=n(4901),u=n(59811),d=n(88546),f=(0,i.F4)("0%,100%{opacity:1;}50%{opacity:0.25;}"),h={root:(0,i.iv)([a.l0.height(20),a.l0.width(20),a.l0.center]),pulse:(0,i.iv)({animation:"".concat(f," 2s infinite")})};function p(){var e=(0,c.Z)(),t=e.isSaving;return e.isOffline?(0,r.tZ)(l.u,{tooltip:"Reconnecting, changes will be synced when youre online",placement:"right",children:(0,r.tZ)(o.G,{css:h.root,children:(0,r.tZ)(s.Z,{size:16,color:a.TV.redDefault})})}):t?(0,r.tZ)(l.u,{tooltip:"Saving",placement:"right",children:(0,r.tZ)(o.G,{css:[h.root,h.pulse],children:(0,r.tZ)(u.Z,{size:16,color:a.TV.foregroundDimmest})})}):(0,r.tZ)(l.u,{tooltip:"Saved",placement:"right",children:(0,r.tZ)(o.G,{css:h.root,children:(0,r.tZ)(d.Z,{size:16,color:a.TV.foregroundDimmest})})})}},16278:function(e,t,n){n.d(t,{I:function(){return f}});var r=n(45903),i=n(25e3),o=n(32477),a=n(25425),l=n(23896),c=n(66349),s=n(54916),u=n(43429),d={nodejs:["package.json","package-lock.json","yarn.lock","node_modules/"],python:["poetry.lock","pyproject.toml","requirements.txt",".venv/",".local"],ruby:["Gemfile","Gemfile.lock"],java:["pom.xml","target"]};function f(){var e=(0,c.Z)(),t=(0,l.T)(),n=(0,s.Z)(),f=(0,o._)((0,u.useState)(null),2),h=f[0],p=f[1],m=(0,a.P5)({controlName:"flag-system-dependencies-search-unstable"}),v=(0,a.P5)({controlName:"flag-system-dependencies-search-23_05"});return(0,u.useEffect)(function(){var e=n.dotReplit.watch(function(e){var t,n;null===e.error&&p(null!==(n=null===(t=e.config.nix)||void 0===t?void 0:t.channel)&&void 0!==n?n:null)});return function(){e()}},[n]),(0,u.useMemo)(function(){var n=(null==t?void 0:t.packagers)||[],o=(null==n?void 0:n.map(function(e){var t,n;return(0,i._)((0,r._)({},e),{title:e.language,packagerFiles:(null===(t=e.packagerFiles)||void 0===t?void 0:t.length)?e.packagerFiles:null!==(n=d[e.language])&&void 0!==n?n:[]})}))||[];((null==e?void 0:e.language)==="html"||(null==e?void 0:e.language)==="html_beta")&&o.push({id:"html",title:"html",name:"HTML Packager",language:"html",packageSearch:!0,guessImports:!1,packagerFiles:[]});var a="unstable"===h&&m||"stable-23_05"===h&&v;return o.push({id:"nix",title:"system",name:"System Dependencies",language:"nix",packageSearch:a,guessImports:!1,packagerFiles:["replit.nix"]}),o},[t,e,h,m,v])}},46801:function(e,t,n){n.d(t,{C:function(){return g}});var r,i,o,a=n(34142),l=n(39698),c=n(87682),s="index.html",u=/^\s*<script src="https:\/\/cdnjs\.cloudflare\.com\/ajax\/libs\/([^/]+)\/([^/]+)\/.+.js"><\/script>$/,d=(r={name:"html",getInstalledPackages:function(e){var t=e.services.fs;return(0,a._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,t.stat(s)];case 1:var n;if(!e.sent().exists)return[2,[]];return[2,new Promise((n=(0,a._)(function(e){var n;return(0,c.Jh)(this,function(r){return n=t.watchTextFile(s,{onReady:function(t){var r=t.initialContent,i=[],o=!0,a=!1,l=void 0;try{for(var c,s=r.split("\n")[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var d=c.value.match(u);d&&i.push({name:d[1],version:d[2]})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}n(),e(i)},onError:function(){n(),e([])}}),[2]})}),function(e){return n.apply(this,arguments)}))]}})})()},getPackageInfo:function(e){var t=e.name;return(0,a._)(function(){var e,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,fetch("/data/cdnjs/info/".concat(encodeURIComponent(t)),{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"}})];case 1:if(!(e=r.sent()).ok)return[2,void 0];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,e.json()];case 3:if(n=r.sent())return[2,{name:n.name,version:n.version,description:n.description,homepageURL:n.link,sourceCodeURL:n.include}];return[3,5];case 4:return r.sent(),[2,void 0];case 5:return[2]}})})()},search:function(e){var t=e.query;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,fetch("/data/cdnjs/search/".concat(encodeURIComponent(t)),{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"}})];case 1:if(!(e=n.sent()).ok)return[2,[]];return[4,e.json()];case 2:return[2,n.sent().map(function(e){return{name:e.name,version:e.version,description:e.description,homepageURL:e.link,sourceCodeURL:e.include}})]}})})()}},(0,l._)(r,"install",function(e){var t=e.pkgs,n=e.services.fs;return(0,a._)(function(){var e,r,i,o,l,u,d;return(0,c.Jh)(this,function(f){switch(f.label){case 0:return[4,n.stat(s)];case 1:if(!f.sent().exists)return[2];e=!0,r=!1,i=void 0,f.label=2;case 2:f.trys.push([2,7,8,9]),o=function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:var r;return e=u.value,[4,new Promise((r=(0,a._)(function(t){var r;return(0,c.Jh)(this,function(i){return r=n.watchTextFile(s,{onReady:function(i){var o=i.initialContent,l=i.writeChange;return(0,a._)(function(){var i,a;return(0,c.Jh)(this,function(c){switch(c.label){case 0:i='<script src="'.concat(e.sourceCodeURL,'"></script>\n'),-1===(a=o.indexOf("<script"))&&(a=o.indexOf("</body>")),-1===a&&(a=o.length),l({from:a,insert:i}),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,n.flush()];case 2:case 3:return c.sent(),[3,5];case 4:return r(),t(),[7];case 5:return[2]}})})()},onError:function(){r(),t()}}),[2]})}),function(e){return r.apply(this,arguments)}))];case 1:return t.sent(),[2]}})},l=t[Symbol.iterator](),f.label=3;case 3:if(e=(u=l.next()).done)return[3,6];return[5,(0,c.XA)(o())];case 4:f.sent(),f.label=5;case 5:return e=!0,[3,3];case 6:return[3,9];case 7:return d=f.sent(),r=!0,i=d,[3,9];case 8:try{e||null==l.return||l.return()}finally{if(r)throw i}return[7];case 9:return[2]}})})()}),(0,l._)(r,"uninstall",function(e){var t=e.pkgs,n=e.services.fs;return(0,a._)(function(){var e,r,i,o,l,d,f;return(0,c.Jh)(this,function(h){switch(h.label){case 0:return[4,n.stat(s)];case 1:if(!h.sent().exists)return[2];e=!0,r=!1,i=void 0,h.label=2;case 2:h.trys.push([2,7,8,9]),o=function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:var r;return e=d.value,[4,new Promise((r=(0,a._)(function(t){var r;return(0,c.Jh)(this,function(i){return r=n.watchTextFile(s,{onReady:function(i){var o=i.initialContent,l=i.writeChange;return(0,a._)(function(){var i,a,s,d,f,h,p,m,v;return(0,c.Jh)(this,function(c){switch(c.label){case 0:i=0,a=!0,s=!1,d=void 0;try{for(f=o.split("\n")[Symbol.iterator]();!(a=(h=f.next()).done);a=!0)(m=(p=h.value).match(u))&&(v=m[1],e.name===v&&l({from:i,to:i+p.length+1})),i+=p.length+1}catch(e){s=!0,d=e}finally{try{a||null==f.return||f.return()}finally{if(s)throw d}}c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,n.flush()];case 2:case 3:return c.sent(),[3,5];case 4:return r(),t(),[7];case 5:return[2]}})})()},onError:function(){r(),t()}}),[2]})}),function(e){return r.apply(this,arguments)}))];case 1:return t.sent(),[2]}})},l=t[Symbol.iterator](),h.label=3;case 3:if(e=(d=l.next()).done)return[3,6];return[5,(0,c.XA)(o())];case 4:h.sent(),h.label=5;case 5:return e=!0,[3,3];case 6:return[3,9];case 7:return f=h.sent(),r=!0,i=f,[3,9];case 8:try{e||null==l.return||l.return()}finally{if(r)throw i}return[7];case 9:return[2]}})})()}),r),f=(i={name:"upm",getInstalledPackages:function(e){var t=e.id,n=e.services.packager;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,n.listSpecfile(t)];case 1:if((e=r.sent()).error||null===e.packages)return[2,[]];return[2,e.packages]}})})()}},(0,l._)(i,"getPackageInfo",function(e){var t=e.id,n=e.name,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){return[2,r.fetchPackageInfo(n,t)]})})()}),(0,l._)(i,"search",function(e){var t=e.id,n=e.query,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){return[2,r.searchPackages(n,t)]})})()}),(0,l._)(i,"install",function(e){var t=e.id,n=e.pkgs,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,r.addPackages(n,t)];case 1:if(!e.sent())throw Error("Package install failed");return[2]}})})()}),(0,l._)(i,"uninstall",function(e){var t=e.id,n=e.pkgs,r=e.services.packager;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return e=n.filter(function(e){return e.name}).map(function(e){return e.name}),[4,r.removePackages(e,t)];case 1:if(!i.sent())throw Error("Package uninstall failed");return[2]}})})()}),i),h=n(93295),p=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.map(function(e,t){var r;return e+(null!==(r=n[t])&&void 0!==r?r:"")}).join("")};function m(){var e=(0,h._)(["\n        let\n          pkgs = import <nixpkgs> {};\n          pkg = pkgs."," or {};\n          meta = pkg.meta or {};\n        in {\n          name = pkg.pname or pkg.name or null;\n          version = pkg.version or null;\n          license = meta.license or null;\n          description = meta.description or null;\n          homepage = meta.homepage or null;\n         }\n     "]);return m=function(){return e},e}var v=(o={name:"nix",getInstalledPackages:function(e){var t=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,t.listPackages()];case 1:if(null!==(e=n.sent()).error)return[2,[]];return[2,e.packages.filter(function(e){return!!e.name}).map(function(e){return{name:e.name,version:e.version}})]}})})()}},(0,l._)(o,"getPackageInfo",function(e){var t=e.name,n=e.services.container;return(0,a._)(function(){var e,r,i,o,a,l,s,u,d,f;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return e=t.replace(/^pkgs\./,""),[4,n.exec("nix-instantiate","--strict","--json","--eval","--expr",p(m(),e))];case 1:if(null!==(r=c.sent()).error)return[2,{name:t}];return a=null!==(o=(i=JSON.parse(r.output)).license)&&void 0!==o?o:void 0,void 0!==i.license&&"string"!=typeof i.license&&(a=null===(l=i.license)||void 0===l?void 0:l.fullName),[2,{name:t,prettyName:null!==(s=i.name)&&void 0!==s?s:void 0,version:null!==(u=i.version)&&void 0!==u?u:void 0,license:a,description:null!==(d=i.description)&&void 0!==d?d:void 0,homepageURL:null!==(f=i.homepage)&&void 0!==f?f:void 0}]}})})()}),(0,l._)(o,"search",function(e){var t=e.query,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,n.searchPackages(t)];case 1:if(null!==(e=r.sent()).error)throw Error("Could not search Nix packages");return[2,e.packages.map(function(e){return{name:"pkgs.".concat(e.name),version:e.version}})]}})})()}),(0,l._)(o,"install",function(e){var t=e.pkgs,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return e=t.map(function(e){return e.name}).filter(function(e){return null!=e}),[4,n.addPackages(e)];case 1:return r.sent(),[2]}})})()}),(0,l._)(o,"uninstall",function(e){var t=e.pkgs,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return e=t.map(function(e){return e.name}).filter(function(e){return null!=e}),[4,n.removePackages(e)];case 1:return r.sent(),[2]}})})()}),o);function g(e){switch(e){case"html":return d;case"nix":return v;default:return f}}},71071:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(34142),i=n(87682),o=n(8182),a=n(55534),l=n(59868),c=n(54916),s=n(69451),u=n.n(s),d=n(43429),f=n(16278),h=n(46801),p=n(59072);function m(){var e=(0,c.Z)(),t=(0,p.Hg)(p.NC),n=(0,p.Hg)(p.w$),o=(0,p.XD)(p.w$),s=(0,p.$X)(p.w$),m=(0,p.Hg)(p.vO),v=(0,p.Mi)(),g=(0,p.Zq)(),y=(0,p.OO)(),b=(0,p.np)(),Z=(0,a.Z)(),w=(0,f.I)(),x=(0,p.T9)();return(0,d.useEffect)(function(){if(0!==w.length){var t=[],n=!1,r=!0,i=!1,a=void 0;try{for(var l,c=w[Symbol.iterator]();!(r=(l=c.next()).done);r=!0)!function(){var r=l.value,i=Promise.resolve(),a=g(r.id),c=u()(function(){var t=g(r.id),a=o();if(t===p.C0.Idle||(null==a?void 0:a.id)!==r.id){var l=(0,h.C)(r.id);i=i.then(function(){if(!n)return l.getInstalledPackages({id:r.id,services:e}).then(function(e){n||(y(r.id,e),v(r.id,p.C0.Idle))})})}},500);if(r.packagerFiles.length>0){var s=!0,d=!1,f=void 0;try{for(var m,b=r.packagerFiles[Symbol.iterator]();!(s=(m=b.next()).done);s=!0)!function(){var n=m.value;if(!n.endsWith("/")){var r=null!==a&&a!==p.C0.Initializing&&a!==p.C0.Uninitialized,i=e.fs.watchFilePath(n,{onChange:function(){if(!r){r=!0;return}c()}});t.push(i)}}()}catch(e){d=!0,f=e}finally{try{s||null==b.return||b.return()}finally{if(d)throw f}}}}()}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return function(){n=!0;var e=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)(0,o.value)()}catch(e){r=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(r)throw i}}}}},[w,e.fs]),(0,d.useEffect)(function(){var t,n=!1;return(t=(0,r._)(function(){var t,r,o,a,l,c;return(0,i.Jh)(this,function(i){t=!0,r=!1,o=void 0;try{for(a=function(){var t=c.value,r=g(t.id);if(r&&r!==p.C0.Uninitialized&&r!==p.C0.Initializing)return"continue";v(t.id,p.C0.Initializing),(0,h.C)(t.id).getInstalledPackages({id:t.id,services:e}).then(function(e){n||(y(t.id,e),v(t.id,p.C0.Idle))})},l=w[Symbol.iterator]();!(t=(c=l.next()).done);t=!0)a()}catch(e){r=!0,o=e}finally{try{t||null==l.return||l.return()}finally{if(r)throw o}}return[2]})}),function(){return t.apply(this,arguments)})(),function(){n=!0}},[w]),(0,d.useEffect)(function(){if(null===n&&0!==t.length){var e=t[0];g(e.id)===p.C0.Idle&&b(e)}},[m,n,t]),(0,d.useEffect)(function(){if(null!==n){var t,o=!1;return(t=(0,r._)(function(){var t,r,a,c,u,d,f,m,g,b,w,C,_,k,S,E,T,R;return(0,i.Jh)(this,function(i){switch(i.label){case 0:switch(t=(0,h.C)(n.id),n.kind){case p.TH.Install:return[3,1];case p.TH.Uninstall:return[3,6]}return[3,11];case 1:v(n.id,p.C0.Installing),r=!0,a=!1,c=void 0;try{for(u=n.pkgs[Symbol.iterator]();!(r=(d=u.next()).done);r=!0)f=d.value,(0,l.j)(l.U3.PACKAGE_MANAGER_USED,{action:"installed",packageId:f.name})}catch(e){a=!0,c=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw c}}i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.install({id:n.id,pkgs:n.pkgs,services:e})];case 3:return i.sent(),1===n.pkgs.length?Z.showNotice("Installed ".concat(null!==(m=n.pkgs[0].name)&&void 0!==m?m:"package")):Z.showNotice("Installed ".concat(n.pkgs.length," packages")),[3,5];case 4:return i.sent(),1===n.pkgs.length?Z.showError("Failed to install ".concat(null!==(g=n.pkgs[0].name)&&void 0!==g?g:"package")):Z.showError("Failed to install ".concat(n.pkgs.length," packages")),x(n.id,n.pkgs),[3,5];case 5:return[3,11];case 6:v(n.id,p.C0.Uninstalling),b=!0,w=!1,C=void 0;try{for(_=n.pkgs[Symbol.iterator]();!(b=(k=_.next()).done);b=!0)S=k.value,(0,l.j)(l.U3.PACKAGE_MANAGER_USED,{action:"removed",packageId:S.name})}catch(e){w=!0,C=e}finally{try{b||null==_.return||_.return()}finally{if(w)throw C}}i.label=7;case 7:return i.trys.push([7,9,,10]),[4,t.uninstall({id:n.id,pkgs:n.pkgs,services:e})];case 8:return i.sent(),1===n.pkgs.length?Z.showNotice("Removed ".concat(null!==(E=n.pkgs[0].name)&&void 0!==E?E:"package")):Z.showNotice("Removed ".concat(n.pkgs.length," packages")),[3,10];case 9:return i.sent(),1===n.pkgs.length?Z.showError("Failed to remove ".concat(null!==(T=n.pkgs[0].name)&&void 0!==T?T:"package")):Z.showError("Failed to remove ".concat(n.pkgs.length," packages")),x(n.id,n.pkgs),[3,10];case 10:return[3,11];case 11:if(o)return[2];return[4,t.getInstalledPackages({id:n.id,services:e})];case 12:if(R=i.sent(),o)return[2];return y(n.id,R),v(n.id,p.C0.Idle),s(null),[2]}})}),function(){return t.apply(this,arguments)})(),function(){o=!0}}},[n]),null}function v(e){var t=e.children,n=(0,p.ns)();return(0,o.BX)(p.vN.Provider,{value:n,children:[(0,o.tZ)(m,{}),t]})}},59072:function(e,t,n){n.d(t,{$X:function(){return Z},$z:function(){return T},B2:function(){return G},C0:function(){return o},Hg:function(){return x},Mi:function(){return I},NC:function(){return B},OO:function(){return U},T9:function(){return k},TH:function(){return a},Wx:function(){return M},XD:function(){return w},Zq:function(){return R},cW:function(){return P},jh:function(){return O},np:function(){return W},ns:function(){return g},pN:function(){return _},te:function(){return N},vN:function(){return y},vO:function(){return E},w$:function(){return D},wY:function(){return S},zi:function(){return V}});var r,i,o,a,l=n(39698),c=n(45903),s=n(25e3),u=n(32477),d=n(95025),f=n(92153),h=n(90234),p=n(71999),m=n(28999),v=n(43429);function g(){return(0,u._)((0,v.useState)(function(){return(0,h.MT)()}),1)[0]}(0,h.cn)({replId:"",packageManagers:{}}),(r=o||(o={})).Uninitialized="Uninitialized",r.Initializing="Initializing",r.Installing="Installing",r.Uninstalling="Uninstalling",r.Idle="Idle",(i=a||(a={})).Install="Install",i.Uninstall="Uninstall";var y=(0,v.createContext)(null);function b(){var e=(0,v.useContext)(y);if(!e)throw Error("Expected store in context");return e}var Z=function(e){return(0,p.b9)(e,{store:b()})};function w(e){return(0,m.lV)((0,v.useCallback)(function(t){return t(e)},[e]),{store:b()})}function x(e){return(0,p.Dv)(e,{store:b()})}(0,h.cn)(null),(0,h.cn)(null);var C=(0,h.cn)({});function _(e){var t,n=x(C);return e&&null!==(t=n[e])&&void 0!==t?t:[]}function k(){var e=Z(C);return function(t,n){e(function(e){return(0,f.ZP)(e,function(e){var r=e[t];if(!r||0===r.length){e[t]=n;return}var i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)!function(){var e=l.value;r.find(function(t){return t.name===e.name})||r.push(e)}()}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}})})}}function S(){var e=Z(C);return function(t,n){e(function(e){return(0,f.ZP)(e,function(e){var r=e[t];if(r&&0!==r.length){var i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)!function(){var e=l.value,t=r.findIndex(function(t){return t.name===e.name});-1!==t&&r.splice(t,1)}()}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}})})}}var E=(0,h.cn)({});function T(e){var t,n=x(E);return e&&null!==(t=n[e])&&void 0!==t?t:null}function R(){var e=w(E);return function(t){var n;return null!==(n=e()[t])&&void 0!==n?n:null}}function I(){var e=Z(E);return function(t,n){e(function(e){return(0,s._)((0,c._)({},e),(0,l._)({},t,n))})}}var D=(0,h.cn)(null);function G(){return x(D)}var B=(0,h.cn)([]);function P(){return x(B)}var A=(0,h.cn)({});function N(e){var t,n=x(A);return e&&null!==(t=n[e])&&void 0!==t?t:[]}function U(){var e=Z(A);return function(t,n){e(function(e){return(0,s._)((0,c._)({},e),(0,l._)({},t,n))})}}var L=(0,h.cn)(null,function(e,t,n){var r=n.id,i=n.pkg;if(!i.name)throw Error("Package does not have a name.");t(B,function(e){return(0,f.ZP)(e,function(e){if(!e.find(function(e){return e.pkgs.find(function(t){return e.id===r&&t.name===i.name})})){var t=e.find(function(e){return"Install"===e.kind});t?t.pkgs.push(i):e.push({kind:"Install",id:r,pkgs:[i]})}})})});function O(){return Z(L)}var X=(0,h.cn)(null,function(e,t,n){var r=n.id,i=n.pkg;if(!i.name)throw Error("Package does not have a name.");t(B,function(e){return(0,f.ZP)(e,function(e){if(!e.find(function(e){return e.pkgs.find(function(t){return e.id===r&&t.name===i.name})})){var t=e.find(function(e){return"Uninstall"===e.kind});t?t.pkgs.push(i):e.push({kind:"Uninstall",id:r,pkgs:[i]})}})})});function M(){return Z(X)}(0,h.cn)(null);var F=(0,h.cn)(null,function(e,t,n){var r=(0,d._)(e(B)),i=r[0],o=r.slice(1);n===i&&(t(B,o),t(D,n))});function W(){return Z(F)}var H=(0,h.cn)(null,function(e,t,n){t(B,function(e){return(0,f.ZP)(e,function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=o.value,c=l.pkgs.findIndex(function(e){return e.name===n});-1!==c&&l.pkgs.splice(c,1)}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}})})});function V(){return Z(H)}},4662:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(21289),i=n(8182),o=n(24448),a=n.n(o),l=n(58091);function c(e){var t=e.replTitle,n=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r._)(t.filter(Boolean)).concat(["Replit"]).join(" - ")}((0,l.ex)(),t);return(0,i.tZ)(a(),{children:(0,i.tZ)("title",{children:n},"title")})}},71914:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(8182),i=n(94450),o=n.n(i);n(43429);var a=n(96179),l=n(1518),c=n(29287);function s(e){var t=e.preventHighlightBorder,n=(0,l.Z)();return(0,r.BX)("div",{className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])+" loader",children:[(0,r.tZ)("div",{className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])+" wrap",children:(0,r.BX)(a.Z,{backgroundColor:c.TV.backgroundHighest,foregroundColor:c.TV.backgroundHigher,uniqueKey:"editorLoader",children:[(0,r.tZ)("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"80",y:"0",rx:"3",ry:"3",width:"100",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"190",y:"0",rx:"3",ry:"3",width:"10",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"20",rx:"3",ry:"3",width:"130",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"155",y:"20",rx:"3",ry:"3",width:"130",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"40",rx:"3",ry:"3",width:"90",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"115",y:"40",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"185",y:"40",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"30",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"80",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"95",y:"80",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"165",y:"80",rx:"3",ry:"3",width:"30",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"100",rx:"3",ry:"3",width:"110",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"135",y:"100",rx:"3",ry:"3",width:"100",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"0",y:"120",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])})]})}),(0,r.tZ)(o(),{id:"abfe52c92a5cedca",dynamic:[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"],children:".loader.__jsx-style-dynamic-selector{z-index:3;height:100%;width:100%;background-color:var(--background-default);overflow:hidden;padding:var(--space-16);-webkit-border-bottom-right-radius:var(--border-radius-4);-moz-border-radius-bottomright:var(--border-radius-4);border-bottom-right-radius:var(--border-radius-4);-webkit-border-bottom-left-radius:var(--border-radius-4);-moz-border-radius-bottomleft:var(--border-radius-4);border-bottom-left-radius:var(--border-radius-4);-webkit-box-shadow:".concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)",";-moz-box-shadow:").concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)",";box-shadow:").concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)","}.wrap.__jsx-style-dynamic-selector{overflow:hidden}.wrap.__jsx-style-dynamic-selector>svg{max-width:640px;min-width:500px;height:auto}@media screen and (min-width:900px){.loader.__jsx-style-dynamic-selector{padding:30px}}")})]})}},81662:function(e,t,n){n.d(t,{Ly:function(){return m},ZP:function(){return g},qm:function(){return b}});var r=n(32477),i=n(21289),o=n(8182),a=n(68514),l=n(18836),c=n(48272),s=n(4070),u=n(74833),d=n(93918),f=n(29287),h=n(18330),p=n(43429),m=[{value:"spaces",title:"spaces"},{value:"tabs",title:"tabs"}],v=(0,d.X)({sizeInput:[f.l0.py(6),f.l0.flex.growAndShrink(0),{border:"none"}]});function g(e){var t=e.preferences,n=e.update;return(0,o.BX)(o.HY,{children:[(0,o.tZ)(h.$,{id:"indentDetection",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Indentation detection"}),(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"Automatically detect indentation settings when opening a file."})]}),children:(0,o.tZ)(s.r,{"aria-label":"Indentation detection",isSelected:t.indentDetection,onChange:function(e){n({indentDetection:e})}})}),(0,o.tZ)(a.R,{}),(0,o.tZ)(h.$,{id:"indentFormatPastes",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Format pasted text indentation"}),(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"Automatically format the indentation of pasted text."})]}),children:(0,o.tZ)(s.r,{"aria-label":"Format pasted text indentation",isSelected:t.indentFormatPastes,onChange:function(e){n({indentFormatPastes:e})}})}),(0,o.tZ)(a.R,{}),(0,o.tZ)(h.$,{id:"indentType",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Indentation character"}),(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"The character used for indenting lines."})]}),children:(0,o.tZ)(c.P,{initialSelectedItem:m.find(function(e){return e.value===(t.indentIsSpaces?"spaces":"tabs")}),onChange:function(e){n({indentIsSpaces:(null==e?void 0:e.value)==="spaces"})},items:(0,i._)(m)})}),(0,o.tZ)(a.R,{}),(0,o.tZ)(h.$,{id:"indentSize",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Indentation size"}),(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"The number of columns taken up by an indentation level."})]}),children:(0,o.tZ)(b,{css:v.sizeInput,size:t.indentSize,onChange:function(e){n({indentSize:e})}})})]})}function y(e){return null==e?2:("string"==typeof e&&(e=parseInt(e,10)),isNaN(e))?2:(Number.isInteger(e)||(e=Math.round(e)),e<1)?1:e>16?16:e}function b(e){var t=e.size,n=e.onChange,i=e.className,a=(0,r._)((0,p.useState)(null),2),c=a[0],s=a[1],u=null!==c?c:t.toString(),d=""===u?"6ch":u.length+5.5+"ch";return(0,o.tZ)(l.II,{type:"number",style:{width:d},className:i,min:1,max:16,value:u,onBlur:function(){return s(null)},onChange:function(e){var t=e.target.value.trim(),r=e.target.valueAsNumber;if(""===t||isNaN(r)){s(t);return}e.target.validity.valid?(s(null),n(y(r))):(s(t),""===t||isNaN(parseInt(t,10))||n(y(t)))}})}},18330:function(e,t,n){n.d(t,{$:function(){return s}});var r=n(8182),i=n(43429),o=n(56596),a=n(74833),l=n(29287),c=n(10981);function s(e){var t=e.id,n=e.title,s=e.children,u=(0,c.U)()(t);return(0,r.BX)(o.G,{css:[l.l0.rowWithGap(8),l.l0.justify.spaceBetween,l.l0.align.center],children:[(0,r.tZ)(o.G,{css:l.l0.flex.growAndShrink(1),tag:"label",htmlFor:u,children:"string"==typeof n?(0,r.tZ)(a.xv,{multiline:!1,children:n}):n}),i.cloneElement(s,{id:u})]})}},66636:function(e,t,n){n.d(t,{Z:function(){return e1}});var r,i,o,a=n(8182),l=n(43429),c=n(56596),s=n(29287),u=n(2038),d=n(21289),f=n(74833),h=n(38080),p=n(48272),m=n(73722),v=n(88936),g=n(18330),y=n(15146),b=n(32477),Z=n(1498),w=n(90513),x=n(75582);function C(e){var t=e.context,n=e.text,r=(0,b._)(l.useState(!1),2),i=r[0],o=r[1];return(0,a.BX)(a.HY,{children:[(0,a.tZ)(Z.zx,{text:void 0===n?"Activate":n,colorway:"primary",onClick:function(){return o(!0)}}),(0,a.tZ)(w.Z,{isOpen:i,onClose:function(){return o(!1)},type:"purchase",analyticsContext:{upgrade:{context:t},trial:{context:x.$X.Workspace}}})]})}var _=n(39698),k=n(18597);(r=i||(i={})).None="None",r.Activate="Activate",r.Activated="Activated",r.TrialOngoing="TrialOngoing",r.TrialExpired="TrialExpired";var S=(o={},(0,_._)(o,x.e4.Activate,"Activate"),(0,_._)(o,x.e4.Activated,"Activated"),(0,_._)(o,x.e4.TrialOngoing,"TrialOngoing"),(0,_._)(o,x.e4.TrialExpired,"TrialExpired"),o),E=n(79490),T=n(40028),R=n(20916),I=n(25425),D=n(92920),G=n(59868),B=n(30983),P=n(75875),A=n(20798),N=n(45903),U=n(93295),L=n(23982),O=n(66039);function X(){var e=(0,U._)(["\n  query CodeSuggestionPreferences {\n    currentUser {\n      id\n      userSubscriptionType\n      userPowerUpsByType {\n        __typename\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n"]);return X=function(){return e},e}var M={},F=(0,L.Ps)(X()),W=n(68514),H=n(4070),V=n(84731),z=n(85172),j=Array.from(A.vw,function(e){return{title:e,value:e}}),q={titleContainer:[s.l0.rowWithGap(8),s.l0.align.center],upgradeRow:[s.l0.rowWithGap(8),s.l0.align.center,s.l0.justify.spaceBetween]};function Y(){var e,t,n,r,i=(0,I.P5)({controlName:"flag-code-suggestion-engine",logFlagToAnalytics:!1}),o=(0,I.P5)({controlName:"flag-gw-charizard"}),l=(e=(0,N._)({},M,void 0),O.a(F,e)).data,u=(null==l?void 0:null===(t=l.currentUser)||void 0===t?void 0:t.userSubscriptionType)===x.HP.HackerPro,h=(0,z.v)().isTeamWithAiDisabled,m=(o||(null==l?void 0:null===(n=l.currentUser)||void 0===n?void 0:n.userPowerUpsByType.__typename)==="UserPowerUpsTypes"&&l.currentUser.userPowerUpsByType.ghostwriter.active)&&!h,v=(0,D.Z)(),y=v.preferences,b=v.update,Z=(0,R.Z)().engine,w={value:null,title:"default"},k=function(e,t){b((0,_._)({},e,t)),(0,G.j)(G.U3.SETTINGS_TOGGLED,{settingChanged:e,updatedValue:t})},S=(0,V.Q)();return m?(0,a.BX)(c.G,{css:s.l0.colWithGap(12),children:[(0,a.tZ)(g.$,{id:"codeSuggestionToggle",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(c.G,{css:q.titleContainer,children:(0,a.tZ)(f.xv,{multiline:!1,children:"AI code completion"})}),(0,a.BX)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:["Code completion provides inline ghost text suggestions while you code.",(0,a.tZ)("br",{}),"Press tab or swipe right on your mobile device to accept."]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(H.r,{"aria-label":"Code complete",isSelected:y.codeSuggestion,onChange:function(e){k("codeSuggestion",e)}})})}),u?null:(0,a.BX)(c.G,{css:q.upgradeRow,children:[(0,a.tZ)(f.xv,{children:"Upgrade for full access to Replit AI"}),(0,a.tZ)(C,{text:"Upgrade to Replit ".concat(S),context:"workspace_settings_pane"})]}),i?(0,a.BX)(a.HY,{children:[(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"completeCodeEngine",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(c.G,{css:[s.l0.flex.row,s.l0.rowWithGap(8),s.l0.center,s.l0.justify.start],children:[(0,a.BX)(f.xv,{multiline:!1,children:[o?"AI":"Ghostwriter"," code completion engine"]}),(0,a.tZ)(B.u,{tooltip:"You are seeing this functionality because you have special permissions.",children:(0,a.tZ)(P.Z,{})})]}),(0,a.BX)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:["Current applied engine: ",Z]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(p.P,{css:[s.l0.minWidth(184)],initialSelectedItem:null!==(r=j.find(function(e){return e.value===y.completeCodeEngine}))&&void 0!==r?r:w,onChange:function(e){return k("completeCodeEngine",null==e?void 0:e.value)},items:[w].concat((0,d._)(j))})})})]}):null]}):null}var $={titleContainer:[s.l0.rowWithGap(8),s.l0.align.center],surface:[s.l0.p(8),s.l0.colWithGap(8),s.l0.borderRadius(8),s.l0.align.start]};function J(){var e=function(){var e,t,n=(0,k.JC)(),r=n.data;if(n.loading)return{loading:!0};if((null==r?void 0:null===(e=r.currentUser)||void 0===e?void 0:e.userPowerUpsByType.__typename)==="UnauthorizedError");else if((null==r?void 0:null===(t=r.currentUser)||void 0===t?void 0:t.userPowerUpsByType.__typename)==="UserPowerUpsTypes"){var i=r.currentUser.userPowerUpsByType.ghostwriter,o=i.CTA,a=i.timeTrialExpiry;if(null!=o){var l=S[o];if(("TrialOngoing"===l||"TrialExpired"===l)&&a)return{cta:l,trialExpiryDate:new Date(a),loading:!1};if("Activate"===l||"Activated"===l)return{cta:l,loading:!1}}}return{cta:"None",loading:!1}}(),t=e.cta,n=e.loading,r=(0,u.rv)(),o=(0,I.P5)({controlName:"flag-gw-charizard"});if(n)return(0,a.tZ)(g.$,{id:"ghostwriter",title:"Ghostwriter",children:(0,a.tZ)(v.Z,{})});if(o&&!r)return(0,a.tZ)(Y,{});switch(t){case i.None:return null;case i.Activated:case i.TrialOngoing:return(0,a.tZ)(Y,{});case i.TrialExpired:case i.Activate:if(r)return null;return(0,a.tZ)(g.$,{id:"ghostwriter",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(c.G,{css:$.titleContainer,children:[(0,a.tZ)(f.xv,{multiline:!1,children:"Ghostwriter"}),(0,a.tZ)(E.Z,{context:"workspace_settings_pane",powerUp:"ghostwriter"})]}),(0,a.tZ)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],multiline:!1,children:"Replit's AI pair programmer can complete, generate, explain, and edit code."})]}),children:(0,a.tZ)(C,{context:"workspace_settings_pane"})});default:(0,T.Z)(t)}}var K=n(72129),Q=n(99708),ee=n(18836),et=n(65774),en=n(32377),er=Array.from(n(45434).ce,function(e){return{title:e,value:e}}),ei=Array.from((0,d._)(Object.entries(et.fT)).concat([["custom",""]]),function(e){return{title:e[0],value:e[1]}});function eo(){var e,t,n,r=(0,I.P5)({controlName:"flag-ghostwriter-chat-engine-override",logFlagToAnalytics:!1}),i=(0,Q.yz)().data,o=(null==i?void 0:null===(e=i.currentUser)||void 0===e?void 0:e.isStaff)||!1,u=(0,D.Z)(),h=u.preferences,v=u.update,Z=(0,K.v)(),w={value:null,title:"default"},x=(0,et.Th)(),C=(0,b._)((0,l.useState)(!Object.values(et.fT).includes(x)),2),k=C[0],S=C[1],E=(0,b._)((0,l.useState)(""),2),T=E[0],R=E[1],A=function(e,t){v((0,_._)({},e,t)),(0,G.j)(G.U3.SETTINGS_TOGGLED,{settingChanged:e,updatedValue:t})};return(0,a.BX)(a.HY,{children:[r?(0,a.BX)(a.HY,{children:[(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"ghostwriterChatEngine",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(c.G,{css:[s.l0.flex.row,s.l0.rowWithGap(8),s.l0.center,s.l0.justify.start],children:[(0,a.BX)(f.xv,{multiline:!1,children:["AI"," chat engine"]}),(0,a.tZ)(B.u,{tooltip:'You are seeing this functionality because you have special permissions. If set, this preference overrides "Use Advanced model" preference.',children:(0,a.tZ)(P.Z,{})})]}),(0,a.BX)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:["Current applied engine: ",Z]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(p.P,{css:[s.l0.minWidth(184)],initialSelectedItem:null!==(t=er.find(function(e){return e.value===h.chatEngine}))&&void 0!==t?t:w,onChange:function(e){return A("chatEngine",null==e?void 0:e.value)},items:[w].concat((0,d._)(er))})})})]}):null,(0,a.BX)(a.HY,{children:[(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"ghostwriterChatUseAdvancedModel",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(c.G,{css:[s.l0.flex.row,s.l0.rowWithGap(8),s.l0.center,s.l0.justify.start],children:(0,a.BX)(f.xv,{multiline:!1,children:["AI"," advanced model"]})}),(0,a.tZ)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:"Advanced models require a lot of power and have usage limits. They're most useful for tasks that are ambiguous or require creativity."})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(H.r,{"aria-label":"Use Advanced model",isSelected:h.ghostwriterUseAdvancedModel,onChange:function(e){(0,G.j)(G.U3.GHOSTWRITER_CHAT_MODEL_CHANGED,{source:"settingsPane",model:e?"advanced":"default"}),A("ghostwriterUseAdvancedModel",e)}})})})]}),o?(0,a.BX)(a.HY,{children:[(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"ghostwriterChatService",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(c.G,{css:[s.l0.flex.row,s.l0.rowWithGap(8),s.l0.center,s.l0.justify.start],children:(0,a.tZ)(f.xv,{multiline:!1,children:"Ghostwriter Chat Service V2 "})}),(0,a.BX)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:["Current endpoint: ",x]})]}),children:(0,a.BX)(c.G,{css:s.l0.colWithGap(12),children:[(0,a.tZ)(p.P,{css:[s.l0.minWidth(184)],initialSelectedItem:null!==(n=ei.find(function(e){return e.value===h.ghostwriterChatServiceEnvironment}))&&void 0!==n?n:h.ghostwriterChatServiceEnvironment?ei[ei.length-1]:ei[0],onChange:function(e){(null==e?void 0:e.title)!=="custom"?(A("ghostwriterChatServiceEnvironment",null==e?void 0:e.value),S(!1)):S(!0)},items:ei}),k?(0,a.BX)(c.G,{css:s.l0.rowWithGap(4),children:[(0,a.tZ)(ee.II,{value:T,onChange:function(e){R(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&A("ghostwriterChatServiceEnvironment",T)}}),(0,a.tZ)(y.hU,{alt:"Update custom url",onClick:function(){return A("ghostwriterChatServiceEnvironment",T)},children:h.ghostwriterChatServiceEnvironment!==T?(0,a.tZ)(m.Z,{}):(0,a.tZ)(en.Z,{})})]}):null]})})]}):null]})}var ea=n(50560),el=n(67225),ec=n(95571),es=n(94106),eu=n(93918),ed=n(35034),ef=n(99656);function eh(e){return e.slice().sort(function(e,t){return e-t})}var ep=(0,eu.X)({ruler:[s.l0.py(4),s.l0.px(8),s.l0.rowWithGap(4),s.l0.align.center,s.l0.borderRadius(8)],remove:[s.l0.borderRadius(4)],title:[s.l0.pr(8),s.l0.overflow("visible"),s.l0.flex.shrink(0)],body:[s.l0.flex.row,s.l0.flex.wrapReverse,s.l0.align.start,s.l0.justify.end,s.l0.flex.growAndShrink(1),{gap:s.TV.space4}],list:[s.l0.flex.row,s.l0.flex.wrap,s.l0.flex.growAndShrink(1),s.l0.align.end,s.l0.justify.end,{gap:s.TV.space4}],add:[s.l0.rowWithGap(4),s.l0.align.center]});function em(e){var t=e.pos,n=e.onRemove;return(0,a.BX)(h.Tg,{css:ep.ruler,elevated:!0,children:[(0,a.tZ)(f.xv,{multiline:!1,children:t}),(0,a.tZ)(y.hU,{css:ep.remove,alt:"Remove ruler",onClick:n,children:(0,a.tZ)(ed.Z,{})})]})}function ev(){var e=(0,b._)((0,l.useState)(!1),2),t=e[0],n=e[1],r=(0,b._)((0,l.useState)(80),2),i=r[0],o=r[1],s=(0,l.useRef)(null),u=(0,l.useRef)(null),h=-1===i,p=i>=0&&i<=1e3,m=(0,D.Z)(),v=m.preferences,y=m.update,w=eh(v.rulers);return(0,a.tZ)(g.$,{id:"rulers",title:(0,a.tZ)(f.xv,{css:ep.title,multiline:!1,children:"Rulers"}),children:(0,a.BX)(c.G,{css:ep.body,children:[(0,a.tZ)(c.G,{css:ep.list,children:w.map(function(e,t){return(0,a.tZ)(em,{pos:e,onRemove:function(){y({rulers:w.filter(function(e,n){return n!==t})})}},t)})}),t?(0,a.BX)(c.G,{css:ep.add,children:[(0,a.tZ)(ee.II,{ref:s,type:"number",style:{width:h?"6ch":i.toString().length+5.5+"ch"},value:i>=0?i.toString():"",onChange:function(e){if(""===e.target.value)o(-1);else{var t=parseInt(e.target.value,10);isNaN(t)||o(t)}},onKeyDown:function(e){"Escape"===e.key?(o(80),n(!1)):"Enter"===e.key&&p&&(y({rulers:eh((0,d._)(w).concat([i]))}),n(!1),o(80))},onBlur:function(e){e.relatedTarget!==u.current&&(n(!1),o(80))},onFocus:function(e){e.target.select()},autoFocus:!0}),(0,a.tZ)(Z.zx,{ref:u,text:"Accept",colorway:"primary",iconLeft:(0,a.tZ)(en.Z,{}),disabled:!p,onClick:function(){p&&(y({rulers:eh((0,d._)(w).concat([i]))}),n(!1),o(80))},onBlur:function(e){e.relatedTarget!==s.current&&(n(!1),o(80))}})]}):(0,a.tZ)(a.HY,{children:w.length>=10?null:(0,a.tZ)(Z.zx,{text:"Add Ruler",iconLeft:(0,a.tZ)(ef.Z,{}),onClick:function(){return n(!0)}})})]})})}var eg=(0,eu.X)({container:[s.l0.flex.row,s.l0.justify.spaceBetween,s.l0.align.start],title:[s.l0.flex.growAndShrink(1)],body:[s.l0.colWithGap(12)],switch:[s.l0.rowWithGap(8),s.l0.align.center,s.l0.justify.end]});function ey(){var e=(0,D.Z)(),t=e.preferences,n=e.update;return(0,a.BX)(c.G,{css:eg.container,children:[(0,a.BX)(c.G,{css:eg.title,children:[(0,a.tZ)(f.xv,{children:"Show whitespace"}),(0,a.tZ)(f.xv,{multiline:!0,variant:"small",css:[s.l0.color.foregroundDimmest],children:"Make whitespace characters visible, such as tabs and spaces."})]}),(0,a.BX)(c.G,{css:eg.body,children:[(0,a.BX)(c.G,{css:eg.switch,tag:"label",children:[(0,a.tZ)(f.xv,{variant:"small",children:"Leading"}),(0,a.tZ)(H.r,{"aria-label":"Show leading whitespace",isSelected:t.showLeadingWhitespace,onChange:function(e){n({showLeadingWhitespace:e})}})]}),(0,a.BX)(c.G,{css:eg.switch,tag:"label",children:[(0,a.tZ)(f.xv,{variant:"small",children:"Enclosed"}),(0,a.tZ)(H.r,{css:[s.l0.flex.rowReverse],"aria-label":"Show enclosed whitespace",isSelected:t.showEnclosedWhitespace,onChange:function(e){n({showEnclosedWhitespace:e})}})]}),(0,a.BX)(c.G,{css:eg.switch,tag:"label",children:[(0,a.tZ)(f.xv,{variant:"small",children:"Trailing"}),(0,a.tZ)(H.r,{"aria-label":"Show trailing whitespace",isSelected:t.showTrailingWhitespace,onChange:function(e){n({showTrailingWhitespace:e})}})]}),(0,a.BX)(c.G,{css:eg.switch,tag:"label",children:[(0,a.tZ)(f.xv,{variant:"small",children:"Selected"}),(0,a.tZ)(H.r,{"aria-label":"Show selected whitespace",isSelected:t.showSelectedWhitespace,onChange:function(e){n({showSelectedWhitespace:e})}})]})]})]})}var eb=n(60442),eZ=n(37951),ew=n(81662);function ex(e){var t=e.onBeforePreferencesUpdate,n=e.hideLayoutControl,r=e.className,i=e.resetLayout,o=(0,D.Z)(),l=o.preferences,b=o.update,Z=(0,u.Vg)((0,es.useRouter)()),w=(0,u.T3)(),x=(0,eb.cR)(),C=(0,I.P5)({controlName:"flag-editor-visible-whitespace",logFlagToAnalytics:!1}),_=(0,I.P5)({controlName:"flag-chat-audio-notification"}),k=function(e){t&&t(e),Object.keys(e).forEach(function(t){var n=e[t];(0,G.j)(G.U3.SETTINGS_TOGGLED,{settingChanged:t,updatedValue:n})}),b(e)};if(!l)return null;var S=[{value:"side-by-side",title:"side-by-side"},{value:"stacked",title:"stacked"}],E=[{value:10,title:"tiny"},{value:12,title:"small"},{value:14,title:"normal"},{value:18,title:"large"},{value:24,title:"huge"}],T=[{value:"default",title:"default"},{value:"emacs",title:"emacs"},{value:"vim",title:"vim"}],R=[{value:"none",title:"none"},{value:"soft",title:"soft wrap"}],B=[{value:"none",title:"none"},{value:"blocks",title:"blocks"},{value:"characters",title:"characters"}],P=["cmdOrCtrlKey","altKey"].map(function(e){return{value:e,title:ec.U[e]}});return(0,a.BX)(h.Tg,{className:r,background:"default",css:[s.l0.p(16),s.l0.colWithGap(12)],children:[n?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(g.$,{id:"layout",title:"Default layout",children:(0,a.BX)(c.G,{css:[s.l0.align.center,s.l0.rowWithGap(8)],children:[i?(0,a.tZ)(y.hU,{alt:"Reset layout",onClick:function(){i.reset()},children:i.reseting?(0,a.tZ)(v.Z,{}):(0,a.tZ)(m.Z,{})}):null,(0,a.tZ)(p.P,{initialSelectedItem:S.find(function(e){return l.isLayoutStacked?"stacked"===e.value:"side-by-side"===e.value}),onChange:function(e){k({isLayoutStacked:(null==e?void 0:e.value)==="stacked"})},items:(0,d._)(S)})]})}),(0,a.tZ)(W.R,{})]}),(0,a.tZ)(g.$,{id:"fontSize",title:"Font size",children:(0,a.tZ)(p.P,{initialSelectedItem:E.find(function(e){return e.value===l.fontSize}),onChange:function(e){k({fontSize:"number"==typeof(null==e?void 0:e.value)?e.value:14})},items:(0,d._)(E)})}),(0,a.tZ)(W.R,{}),(0,a.tZ)(ew.ZP,{preferences:l,update:k}),(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"wrapping",title:"Wrapping",children:(0,a.tZ)(p.P,{initialSelectedItem:R.find(function(e){return e.value===(l.wrapping?"soft":"none")}),onChange:function(e){k({wrapping:(null==e?void 0:e.value)==="soft"})},items:(0,d._)(R)})}),(0,a.tZ)(W.R,{}),w?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(g.$,{id:"minimap",title:"Minimap",children:(0,a.tZ)(p.P,{initialSelectedItem:B.find(function(e){return e.value===l.minimapDisplay}),onChange:function(e){k({minimapDisplay:e.value})},items:(0,d._)(B)})}),(0,a.tZ)(W.R,{})]}),(0,a.tZ)(ev,{}),(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"keybinds",title:"Keybinds",children:(0,a.tZ)(p.P,{initialSelectedItem:T.find(function(e){return["vim","emacs"].includes(e.value)?e.value===l.keyboardHandler:"default"===e.value&&!l.keyboardHandler}),onChange:function(e){k({keyboardHandler:["vim","emacs"].includes(e.value)?e.value:null})},items:(0,d._)(T),dataCy:"keybinds"})}),(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"multiselectModifier",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(f.xv,{multiline:!1,children:"Multiselect modifier key"}),(0,a.tZ)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:"Modifier key for selecting multiple items in the filetree."})]}),children:(0,a.tZ)(p.P,{initialSelectedItem:P.find(function(e){return e.value===l.multiselectModifierKey}),onChange:function(e){k({multiselectModifierKey:e.value})},items:(0,d._)(P)})}),(0,a.tZ)(W.R,{}),(0,a.tZ)(J,{}),(0,a.tZ)(eo,{}),(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"codeIntelligence",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(f.xv,{multiline:!1,children:"Code intelligence"}),(0,a.tZ)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:"Code intelligence gives you autocomplete, syntax highlighting, and hints as you type."})]}),children:(0,a.tZ)(H.r,{"aria-label":"Code Intelligence",isSelected:l.codeIntelligence,onChange:function(e){k({codeIntelligence:e})}})}),(0,a.tZ)(W.R,{}),C?(0,a.BX)(a.HY,{children:[(0,a.tZ)(ey,{}),(0,a.tZ)(W.R,{})]}):null,(0,a.tZ)(g.$,{id:"accessibleTerminal",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(f.xv,{multiline:!1,children:"Accessible terminal output"}),(0,a.tZ)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:"Enable this setting to use a screen reader. Warning: this can affect performance."})]}),children:(0,a.tZ)(H.r,{"aria-label":"Accessible terminal output",isSelected:l.accessibleTerminal,onChange:function(e){k({accessibleTerminal:e})}})}),(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"webviewAutoOpenOnPortOpened",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(f.xv,{multiline:!1,children:x?"Automatic webview (unavailable in this Repl)":"Automatic webview"}),(0,a.tZ)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],multiline:!1,children:"Open a webview automatically when a port is open"}),x?(0,a.tZ)(c.G,{css:[s.l0.pt(8),s.l0.maxWidth("calc(100% - 12px)")],children:(0,a.tZ)(eZ.E,{colorway:"orange",text:'This preference is unavailable in Extension Repls. To view custom tools in dev mode, click the "Preview" button in Extension Devtools instead.'})}):null]}),children:(0,a.tZ)(H.r,{"aria-label":"Automatic Webview",isSelected:l.webviewAutoOpenOnPortOpened,isDisabled:x,onChange:function(e){k({webviewAutoOpenOnPortOpened:e})}})}),Z?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"theme",title:"Theme",children:(0,a.tZ)(ea.Z,{css:[s.l0.minWidth(184),s.l0.backgroundColor.backgroundHigher],context:el.HY.WorkspacePreferencesPane})})]}),_?(0,a.BX)(a.HY,{children:[(0,a.tZ)(W.R,{}),(0,a.tZ)(g.$,{id:"chat-audio",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(f.xv,{multiline:!1,children:"Chat Audio Notifications"}),(0,a.tZ)(f.xv,{variant:"small",css:[s.l0.color.foregroundDimmest],children:"Enables playing a sound when you receive a new chat message."})]}),children:(0,a.tZ)(H.r,{"aria-label":"Chat Audio Notifications",isSelected:l.chatAudioNotification,onChange:function(e){k({chatAudioNotification:e})}})})]}):null]})}var eC=n(10981),e_=n(96003),ek=n(93496),eS=n(20399),eE=n(52924),eT=n(1128),eR=n(22487),eI=n(79530),eD=n(20573),eG=n(27308),eB=n(25961),eP=n(43208),eA=n(89788),eN=n(69119),eU=n(13900),eL=n(50199),eO=n(51384);function eX(e){var t=(0,l.useRef)(null),n=(0,l.useRef)([]);function r(){t.current&&clearTimeout(t.current),n.current=[]}function i(t){e({type:"success",shortcut:t.length>1?[t[0],t[1]]:t[0]}),r()}return{onKeyDown:function(r){var o=t.current,a=n.current;r.preventDefault(),r.stopPropagation(),o&&clearTimeout(o);var l=(0,eG.lc)(r);if(l){if((0,eG.ZG)(l)){e({type:"update",recorded:a.length?[a[0],l]:[l]});return}if(a.length>0&&"Enter"===l){i(a);return}a.push(l),e({type:"update",recorded:a});var c=2===a.length?0:600;t.current=setTimeout(function(){return i(a)},c)}},startRecording:function(){r(),e({type:"start"})},stopRecording:function(){r(),e({type:"stop"})}}}var eM=(0,eu.X)({root:[s.l0.colWithGap(8)],row:[s.l0.rowWithGap(8),s.l0.align.center,s.l0.minHeight(28)],left:[s.l0.colWithGap(2),s.l0.flex.grow(0),s.l0.flex.shrink(1)],right:[s.l0.rowWithGap(4),s.l0.align.center,s.l0.justify.end,s.l0.position.relative,s.l0.flex.grow(1),s.l0.flex.shrink(0)],recordingRow:[s.l0.flex.column,s.l0.align.center,s.l0.justify.end,s.l0.pr(24)],recordingRowInner:[s.l0.rowWithGap(8),s.l0.align.center],recordingRowKeys:[s.l0.position.relative],recordingRowHint:[s.l0.position.absolute,s.l0.top(20),s.l0.right(0),{fontStyle:"italic"}],recordingRowPlaceholder:[s.l0.display.flex,s.l0.align.baseline,s.l0.rowWithGap(4),{fontStyle:"italic"}],keys:[s.l0.display.inlineFlex,s.l0.rowWithGap(12)],secondaryText:[s.l0.display.flex,s.l0.flex.row,s.l0.align.center,s.l0.rowWithGap(4)],secondaryTextId:[s.l0.flex.grow(1),s.l0.flex.shrink(0)],secondaryTextDescription:[s.l0.flex.grow(0),s.l0.flex.shrink(1),s.l0.color.foregroundDimmest],buttons:[s.l0.pl(8),s.l0.display.flex,s.l0.flex.row]}),eF=[s.l0.reset.button,ek.gU.listItem,s.l0.height(24),s.l0.width(24),s.l0.p(2)],eW=(0,eu.X)({root:[s.l0.rowWithGap(8),s.l0.align.center],recordingRow:[s.l0.rowWithGap(4),s.l0.align.center]});function eH(e){var t,n,r,i,o=e.command,s=e.filter,u=(0,e_.r3)(),d=(0,e_.wU)(),h=(0,e_.V_)(o.id),p=(0,b._)((0,l.useState)(null),2),m=p[0],v=p[1],g=(0,b._)((0,l.useState)(null),2),w=g[0],x=g[1],C=eX(function(e){switch(e.type){case"start":x({recorded:[]}),v(null);return;case"stop":x(null),v(null);return;case"update":x({recorded:e.recorded}),v(null);return;case"success":var t=(0,eG.SG)(e.shortcut);if(!t){x(null),v(null);return}var n=u(o.id,t);if(n){x(null),v('This shortcut conflicts with "'.concat(n.conflict.name,'"'));return}x(null);return;case"error":x(function(t){var n;return{error:e.message,recorded:null!==(n=null==t?void 0:t.recorded)&&void 0!==n?n:[]}});return}}),_=C.stopRecording,k=C.startRecording,S=C.onKeyDown,E=(0,eR.Z)(function(){return _()},[]),T=!!w;eY(T);var R=null!==(i=null==w?void 0:w.recorded)&&void 0!==i?i:[],I=null==w?void 0:w.error,D=s.length>0,G=null===(t=eP.Z.match(s,o.name))||void 0===t?void 0:t.ranges,B=null===(n=eP.Z.match(s,o.id))||void 0===n?void 0:n.ranges,P=(null==o?void 0:o.description)?null===(r=eP.Z.match(s,o.description))||void 0===r?void 0:r.ranges:void 0,A=(0,eL.Z)(function(){return s.replaceAll('"',"").split("-").map(function(e){return e.toLowerCase()})},[s]),N=[{label:"Remove",key:"remove"}];h&&h!==o.shortcut&&N.push({label:"Reset",key:"reset"});var U=(0,eL.Z)(function(){return function(e){switch(e){case"remove":d(o.id);break;case"reset":var t=u(o.id,h);t&&v("".concat(h,' conflicts with "').concat(t.conflict.name,'"'))}}},[o.id,h,u,d]);return(0,a.BX)(c.G,{css:eM.root,children:[(0,a.BX)(c.G,{css:eM.row,children:[(0,a.BX)(c.G,{css:eM.left,children:[(0,a.tZ)(eN.x,{text:o.name,highlight:G,dimmed:D}),(0,a.BX)(f.xv,{variant:"small",css:eM.secondaryText,multiline:!1,children:[D?(0,a.tZ)(eN.x,{css:eM.secondaryTextId,text:o.id,highlight:B,dimmed:D}):null,o.description?(0,a.BX)(a.HY,{children:[D?(0,a.tZ)(f.xv,{color:"dimmest",multiline:!1,children:""}):null,(0,a.tZ)(eN.x,{css:eM.secondaryTextDescription,text:o.description,highlight:P,dimmed:D})]}):null]})]}),(0,a.BX)(c.G,{innerRef:T?E:void 0,css:eM.right,children:[T?(0,a.tZ)(eI.MT,{autoFocus:!0,restoreFocus:!0,children:(0,a.tZ)("input",{onKeyDown:S,css:{opacity:0,width:1}})}):null,o.shortcut&&!T?(0,a.tZ)(eB.bM,{small:!0,keyCombo:o.shortcut,match:A}):null,o.shortcut||T?null:(0,a.tZ)(Z.zx,{size:"small",variant:"outlined",iconLeft:(0,a.tZ)(ef.Z,{}),text:"Add shortcut",onClick:function(){return k()}}),T?(0,a.tZ)(c.G,{css:eM.recordingRow,children:(0,a.BX)(c.G,{css:eM.recordingRowInner,children:[(0,a.tZ)(c.G,{css:eM.recordingRowKeys,children:R.length>0?(0,a.tZ)(c.G,{css:[eM.keys],children:R.map(function(e,t){return(0,a.tZ)(eB.bM,{small:!0,keyCombo:e},"".concat(e,"-").concat(t))})}):(0,a.tZ)(f.xv,{multiline:!1,color:"dimmest",css:eM.recordingRowPlaceholder,children:"Recording..."})}),(0,a.tZ)(y.hU,{alt:"Stop",onClick:function(){return _()},children:(0,a.tZ)(eK,{})})]})}):null,o.shortcut&&!T?(0,a.BX)(c.G,{css:eM.buttons,children:[(0,a.tZ)(y.hU,{alt:"Change",onClick:function(){return k()},children:(0,a.tZ)(eE.Z,{})}),(0,a.tZ)(eS.ZE,{"aria-label":"More",cssProps:eF,items:N,icon:(0,a.tZ)(eU.Z,{size:12}),placement:"bottom-end",onAction:U,children:N.map(function(e){return(0,a.tZ)(eS.ck,{textValue:e.label,children:(0,a.tZ)(f.xv,{multiline:!1,children:e.label})},e.key)})})]}):null]})]}),I?(0,a.tZ)(eZ.E,{icon:(0,a.tZ)(eD.Z,{}),colorway:"warning",text:I,closable:!0,closeAction:function(){return x(function(e){var t;return{recorded:null!==(t=null==e?void 0:e.recorded)&&void 0!==t?t:[]}})}}):null,m?(0,a.tZ)(eZ.E,{icon:(0,a.tZ)(eD.Z,{}),colorway:"warning",text:m,closable:!0,closeAction:function(){return v(null)}}):null]})}function eV(e){var t=e.flat();return t.length>1?t.map(function(e){return eV([e])}).join(" "):(0,eG.QR)(t[0]).map(function(e){return'"'.concat(e,'"')}).join("-").replaceAll(" ","space")}var ez=(0,eu.X)({root:[s.l0.colWithGap(8),s.l0.p(0)],surface:[s.l0.pt(8),s.l0.borderRadius(8),s.l0.colWithGap(12)]});function ej(e){var t=(0,b._)((0,l.useState)(""),2),n=t[0],r=t[1];function i(t){r(t),l.startTransition(function(){return e.onSearch(t)})}var o=(0,l.useRef)(null),s=(0,b._)((0,l.useState)(!1),2),u=s[0],d=s[1];eY(u);var h=eX(function(e){var t,n,r;switch(e.type){case"start":d(!0),i(""),null==o||null===(t=o.current)||void 0===t||t.focus();return;case"stop":case"error":d(!1),null==o||null===(n=o.current)||void 0===n||n.focus(),null==o||null===(r=o.current)||void 0===r||r.select();return;case"success":i(eV([e.shortcut]));return;case"update":i(eV(e.recorded));return}}),p=h.stopRecording,m=h.startRecording,v=h.onKeyDown;return(0,a.BX)(c.G,{css:eW.root,children:[(0,a.tZ)(eI.MT,{children:(0,a.tZ)(ee.II,{ref:o,placeholder:u?"Recording keys. Press Escape to exit":"Type to search keyboard shortcuts",onBlur:u?p:void 0,onChange:function(e){i(e.currentTarget.value)},onKeyDown:u?function(e){"Escape"===e.key?p():v(e)}:void 0,value:n})}),(0,a.tZ)(c.G,{css:eW.recordingRow,children:u?(0,a.BX)(a.HY,{children:[(0,a.tZ)(f.xv,{color:"dimmest",css:[{fontStyle:"italic"}],multiline:!1,children:"Recording..."}),(0,a.tZ)(y.hU,{alt:"Stop Recording",onClick:p,children:(0,a.tZ)(eK,{})})]}):(0,a.tZ)(y.hU,{alt:"Record Keys",onClick:m,children:(0,a.tZ)(eA.Z,{})})}),(0,a.tZ)(y.hU,{alt:"Clear Input",disabled:0===n.length,onClick:function(){var e;r(""),null==o||null===(e=o.current)||void 0===e||e.focus()},children:(0,a.tZ)(ed.Z,{})})]})}function eq(){var e=(0,b._)((0,l.useState)(""),2),t=e[0],n=e[1],r=(0,e_.xF)(),i=(0,eL.Z)(function(){return(0,d._)(r.values())},[r]),o=l.useMemo(function(){return eP.Z.filter(t,i,{extract:function(e){var t="".concat(e.name," ").concat(e.id);return e.description&&(t+=" ".concat(e.description)),e.shortcut&&(t+=" ".concat(eV([e.shortcut]))),t}})},[t,i]);return(0,a.BX)(c.G,{css:ez.root,children:[(0,a.tZ)(ej,{onSearch:n}),o.length>0?(0,a.tZ)(h.Tg,{css:ez.surface,children:o.map(function(e,n){return(0,a.BX)(l.Fragment,{children:[n>0?(0,a.tZ)(h.Tg,{elevated:!0,style:{height:1}}):null,(0,a.tZ)(eH,{command:e.original,filter:t})]},e.original.id)})}):null]})}function eY(e){var t="You have unsaved changes";(0,l.useEffect)(function(){var n=function(e){return e.preventDefault(),e.returnValue=t,t};if(e)return window.addEventListener("beforeunload",n),function(){window.removeEventListener("beforeunload",n)}},[e])}var e$=(0,eO.F4)("0%{transform:scale(1);}40%{transform:scale(1.3);}100%{transform:scale(1);}"),eJ=(0,eu.X)({background:[{animationName:e$,animation:"".concat(e$," 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"),boxShadow:"0 0 10px ".concat(s.TV.redStronger)},s.l0.height(11),s.l0.width(11),s.l0.borderRadius("full"),s.l0.position.absolute],container:[s.l0.position.relative,s.l0.align.center,s.l0.justify.center],icon:[{zIndex:1}]});function eK(){return(0,a.BX)(c.G,{css:eJ.container,children:[(0,a.tZ)(eT.Z,{css:eJ.icon,color:s.TV.redStronger}),(0,a.tZ)(c.G,{css:eJ.background})]})}function eQ(){var e=(0,eC.U)()("keyboard_shortcuts");return(0,a.BX)(h.Tg,{background:"default",css:[s.l0.px(16),s.l0.pb(16),s.l0.colWithGap(12)],children:[(0,a.tZ)(c.G,{tag:"label",htmlFor:e}),(0,a.tZ)(eq,{})]})}var e0=n(83447);function e1(e){var t=e.hideLayoutControl,n=e.resetLayout,r=(0,u.T3)();return(0,a.BX)(a.HY,{children:[(0,a.BX)(c.G,{css:[s.l0.flex.column,s.l0.justify.center,s.l0.px(16),s.l0.py(8)],children:[(0,a.tZ)(f.h4,{variant:"subheadBig",level:3,children:"User Settings"}),(0,a.tZ)(f.xv,{variant:"small",css:[{fontStyle:"italic"},s.l0.color.foregroundDimmer],children:"The following settings apply to your account and will be used across all your Repls."})]}),r?(0,a.tZ)(ex,{hideLayoutControl:t,resetLayout:n}):(0,a.tZ)(c.G,{children:(0,a.BX)(e0.mQ,{css:[{width:"100%"}],children:[(0,a.BX)(e0.td,{withDividers:!1,css:[{"[aria-selected=true]":[s.l0.fontWeight.medium]}],children:[(0,a.tZ)(e0.OK,{css:[s.l0.py(8),s.l0.px(16)],children:"Editor preferences"}),(0,a.tZ)(e0.OK,{css:[s.l0.py(8),s.l0.px(16)],children:"Keyboard shortcuts"})]}),(0,a.BX)(e0.nP,{children:[(0,a.tZ)(e0.x4,{children:(0,a.tZ)(ex,{resetLayout:n})}),(0,a.tZ)(e0.x4,{children:(0,a.tZ)(eQ,{})})]})]})})]})}},71241:function(e,t,n){n.d(t,{BZ:function(){return T},HX:function(){return S},WM:function(){return D},ap:function(){return L},gF:function(){return P},l9:function(){return G},pr:function(){return X},vi:function(){return N},zu:function(){return I}});var r=n(45903),i=n(93295),o=n(23982),a=n(78747),l=n(11707),c=n(83436),s=n(63204),u=n(51780),d=n(56353),f=n(66039),h=n(13440);function p(){var e=(0,i._)(["\n  fragment ReplPowerUpCosts on Repl {\n    id\n    powerUpCosts {\n      ... on PowerUpCostsType {\n        alwaysOn {\n          cycles\n          explanation\n        }\n      }\n    }\n  }\n"]);return p=function(){return e},e}function m(){var e=(0,i._)(["\n  fragment WorkspaceHeaderReplInfoRepl on Repl {\n    id\n    title\n    rawTemplateLabel: templateLabel(disableFallbackToTitle: true)\n    description\n    isPrivate\n    isRenamed\n    url\n    slug\n    workspaceCta\n    isAlwaysOn\n    lastPublishedAt\n    publishedAs\n    owner {\n      ... on Team {\n        id\n      }\n      ... on User {\n        id\n      }\n    }\n    currentUserPermissions {\n      containerAttach\n      changeIconUrl\n      changeTemplateLabel\n      changeTitle\n      changeDescription\n      changePrivacy\n      delete\n      changeAlwaysOn\n      publish\n      fork\n    }\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        currentBuild {\n          id\n        }\n      }\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    user {\n      id\n      image\n      ...UserLinkUser\n    }\n    ...WorkspaceHeaderReplMetadataRepl\n    ...ReplEnvironmentWebviewRepl\n    ...PublishReleaseFormRepl\n    ...ReplPowerUpCosts\n    ...BulkDeleteConfirmationModalRepl\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return m=function(){return e},e}function v(){var e=(0,i._)(["\n  query WorkspaceHeaderReplInfo($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n    currentUser {\n      id\n      canAlwaysOn\n    }\n  }\n  ","\n"]);return v=function(){return e},e}function g(){var e=(0,i._)(["\n  query CurrentUserStates {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n      }\n    }\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,i._)(["\n  query ReplPowerUpStatus {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n        userPowerUpsByType {\n          ... on UserPowerUpsTypes {\n            privateRepls {\n              active\n              cost {\n                cycles\n                explanation\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return y=function(){return e},e}function b(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoUnpublishTemplate(\n    $input: DeleteReplDeploymentInput!\n  ) {\n    deleteReplDeployment(input: $input) {\n      ... on Repl {\n        id\n        ...PublishReplData\n      }\n    }\n  }\n  ","\n"]);return b=function(){return e},e}function Z(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return Z=function(){return e},e}function w(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoDeleteRepl($id: String!) {\n    deleteRepl(id: $id) {\n      id\n    }\n  }\n"]);return w=function(){return e},e}function x(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoSetAlwaysOn(\n    $replId: ID!\n    $enabled: Boolean!\n  ) {\n    setAlwaysOn(replId: $replId, enabled: $enabled) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n        ...ReplPowerUpCosts\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return x=function(){return e},e}function C(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoSetGpu($replId: ID!, $enabled: Boolean!) {\n    setGpu(replId: $replId, enabled: $enabled) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n        ...ReplPowerUpCosts\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return C=function(){return e},e}var _={},k=(0,o.Ps)(p()),S=(0,o.Ps)(m(),a._,l.s,c.sY,s.wd,k,u.d),E=(0,o.Ps)(v(),S);function T(e){var t=(0,r._)({},_,e);return f.a(E,t)}var R=(0,o.Ps)(g());function I(e){var t=(0,r._)({},_,e);return f.a(R,t)}var D=(0,o.Ps)(y());function G(e){var t=(0,r._)({},_,e);return f.a(D,t)}var B=(0,o.Ps)(b(),d.FW);function P(e){var t=(0,r._)({},_,e);return h.D(B,t)}var A=(0,o.Ps)(Z(),S);function N(e){var t=(0,r._)({},_,e);return h.D(A,t)}var U=(0,o.Ps)(w());function L(e){var t=(0,r._)({},_,e);return h.D(U,t)}var O=(0,o.Ps)(x(),S,k);function X(e){var t=(0,r._)({},_,e);return h.D(O,t)}C()},32604:function(e,t,n){n.d(t,{Z:function(){return e6}});var r=n(45903),i=n(25e3),o=n(32477),a=n(8182),l=n(94450),c=n.n(l),s=n(48900),u=n(43429),d=n(14819),f=n(38889),h=n(46835),p=n(25210),m=n(60427),v=n(56337),g=n(68399),y=n(7444),b=n(55534),Z=n(50782),w=n(6189),x=n(22004),C=n(59868),_=n(73614),k=n(4895),S=n(34142),E=n(39698),T=n(87682),R=n(56596),I=n(74833),D=n(29287),G=n(18836),B=n(1498),P=n(37951),A=n(30983),N=n(60769),U=n(10981),L=n(75582),O=n(63204),X=n(72310),M=n(20573),F=n(81799),W=n(93295),H=n(23982),V=n(66039);function z(){var e=(0,W._)(["\n  query PendingChanges($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        deployment {\n          id\n          activeRelease {\n            id\n            pendingChanges {\n              fileName\n              changeType\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return z=function(){return e},e}var j={},q=(0,H.Ps)(z()),Y=n(66555),$=n(13440);function J(){var e=(0,W._)(["\n  mutation RevertTemplateRelease($input: RevertReplReleaseInput!) {\n    revertReplRelease(input: $input) {\n      ... on Repl {\n        id\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return J=function(){return e},e}var K={},Q=(0,H.Ps)(J()),ee=n(88936),et=n(57468),en=n(48459),er=n(29559),ei=n(83109),eo=n(73524),ea=R.K.form;function el(e){if(0===e.length)return{message:"You cannot leave this empty."}}function ec(e){var t,n,r=e.changeType;return r===L.J5.NewFile?(t=D.TV.accentPositiveStronger,n="Added"):r===L.J5.DeletedFile?(t=D.TV.accentNegativeStronger,n="Deleted"):(t=D.TV.foregroundDefault,n="Changed"),(0,a.tZ)(I.xv,{variant:"small",css:[{color:t}],multiline:!1,children:n})}function es(e){var t=e.pendingChangesState,n=e.isReplitTemplate;if(t.loading)return(0,a.tZ)(R.G,{css:[D.l0.center],children:(0,a.tZ)(ee.Z,{})});if(t.error)return(0,a.tZ)(P.E,{icon:(0,a.tZ)(M.Z,{}),text:t.error.message||"Could not load modified files - please try again.",colorway:"negative"});if(!t.pendingChanges||0===t.pendingChanges.length)return n?null:(0,a.tZ)(I.xv,{children:"No changes to publish. Come back when you have made changes to your Repl."});var r=t.pendingChanges,i=r.slice(0,15);return(0,a.BX)(R.G,{css:[{display:"grid",gridTemplateColumns:"1fr 1fr",gap:D.TV.space8}],children:[i.map(function(e){return(0,a.BX)(u.Fragment,{children:[(0,a.BX)(R.G,{css:[D.l0.rowWithGap(4),D.l0.align.center],children:[(0,a.tZ)(et.Z,{size:12,path:e.fileName}),(0,a.tZ)(I.xv,{multiline:!1,children:e.fileName})]},e.fileName),(0,a.tZ)(ec,{changeType:e.changeType})]},e.fileName)}),r.length>i.length&&(0,a.BX)(I.xv,{multiline:!1,children:["And ",r.length-i.length," other files..."]})]})}function eu(e){var t,n=e.repl,i=function(){var e,t=(0,o._)((e=(0,r._)({},K,{refetchQueries:["ReplEnvironmentHeader"]}),$.D(Q,e)),2),n=t[0];function i(){return(i=(0,S._)(function(e){var t;return(0,T.Jh)(this,function(r){switch(r.label){case 0:return[4,n({variables:{input:e.input}})];case 1:return[2,{data:(t=r.sent()).data,error:function(e){if(!e.data)return null;var t=e.data;if("revertReplRelease"in t){if("NotFoundError"===t.revertReplRelease.__typename||"UnauthorizedError"===t.revertReplRelease.__typename||"UserError"===t.revertReplRelease.__typename)return t.revertReplRelease.message;if("Repl"!==t.revertReplRelease.__typename)return"Something went wrong reverting your Template"}}(t)}]}})})).apply(this,arguments)}return{revertTemplateRelease:function(e){return i.apply(this,arguments)},state:t[1]}}(),l=(t=(0,S._)(function(e){return(0,T.Jh)(this,function(t){switch(t.label){case 0:return[4,i.revertTemplateRelease({input:{replId:n.id,releaseId:e}})];case 1:return t.sent(),[2]}})}),function(e){return t.apply(this,arguments)});return(0,a.BX)(R.G,{children:[(0,a.tZ)(I.h4,{level:1,variant:"subheadBig",css:[D.l0.mb(16)],children:"Existing Releases"}),(0,a.tZ)(R.G,{css:[{display:"grid",gridTemplateColumns:"2fr 3fr 1fr",gap:D.TV.space8}],children:n.releases.items.map(function(e){var t,r;return(0,a.BX)(u.Fragment,{children:[(0,a.tZ)("span",{children:(0,ei.Z)(new Date(e.timeCreated),"do MMM, hh:mm a")}),(0,a.tZ)("span",{children:e.description}),(0,a.tZ)("span",{style:{justifySelf:"end"},children:e.id===(null===(r=n.deployment)||void 0===r?void 0:null===(t=r.activeRelease)||void 0===t?void 0:t.id)?(0,a.tZ)("span",{css:[D.l0.p(4),{display:"flex"}],children:"(active)"}):(0,a.tZ)(B.zx,{text:"revert",colorway:"primary",size:"small",onClick:function(){l(e.id)}})})]},e.id)})})]})}function ed(e){var t=e.children;return(0,a.tZ)(R.G,{css:[D.l0.rowWithGap(8),D.l0.py(2)],children:t})}function ef(e){var t,n,l,c,s,d,f,h,p,m=e.repl,v=(0,U.U)(),g=(0,o._)(u.useState(!1),2),y=g[0],b=g[1],Z=(0,o._)(u.useState(!1),2),w=Z[0],x=Z[1],C=(t=function(e){var t,n,i,o,a=(i={variables:{replId:e.replId},fetchPolicy:"cache-and-network",ssr:!1},o=(0,r._)({},j,i),V.a(q,o)),l=a.data,c=a.loading,s=a.error;if(c)return{loading:c,pendingChanges:null,error:null};if(s)return{loading:!1,pendingChanges:null,error:s};var u=(null==l?void 0:l.repl.__typename)==="Repl"?l.repl:null;return u?{loading:!1,pendingChanges:(null===(n=u.deployment)||void 0===n?void 0:null===(t=n.activeRelease)||void 0===t?void 0:t.pendingChanges)||[],error:s}:{loading:!1,pendingChanges:null,error:Error("Repl not found")}}({replId:{replId:m.id}.replId}),n=u.useMemo(function(){return t.pendingChanges?t.pendingChanges.slice().sort(function(e,t){return e.fileName.localeCompare(t.fileName)}).map(function(e){return{file:e,pathDepth:(0,er.U$)(e.fileName)}}).sort(function(e,t){return e.pathDepth-t.pathDepth}).map(function(e){return e.file}):[]},[t.pendingChanges]),(0,i._)((0,r._)({},t),{pendingChanges:n})),_=(0,Y.r)(),k=(0,X.Y)("",el),N=(null===(c=C.pendingChanges)||void 0===c?void 0:c.length)!==0,L=(null===(s=m.user)||void 0===s?void 0:s.username)===eo.IU||(null===(d=m.user)||void 0===d?void 0:d.username)==="templates",O=(0,o._)((0,u.useState)({ran:!1,tested:!1}),2),W=O[0],H=O[1];u.useEffect(function(){H({ran:!1,tested:!1})},[H]);var z=!!(k.error||!L&&!N||_.loading||L&&(!W.ran||!W.tested)),$=L&&(null===(h=m.releases)||void 0===h?void 0:null===(f=h.items)||void 0===f?void 0:f.length)>1,J="";return(k.error?J="Please fill out the form":L||N||(J="No changes to publish in this release"),y)?(0,a.tZ)(en.q,{repl:m,isUpdate:!0}):w?(0,a.tZ)(R.G,{css:[D.l0.p(16),D.l0.colWithGap(16)],children:(0,a.tZ)(eu,{repl:m})}):(0,a.BX)(ea,{onSubmit:(l=(0,S._)(function(e){return(0,T.Jh)(this,function(t){switch(t.label){case 0:if(e.preventDefault(),z||k.validate())return[2];return[4,_.createRelease({input:{replId:m.id,description:k.value}})];case 1:if(t.sent().error)return[2];return b(!0),[2]}})}),function(e){return l.apply(this,arguments)}),css:[D.l0.colWithGap(24),D.l0.p(16)],children:[(0,a.tZ)(I.h4,{level:1,variant:"headerDefault",children:"Publish a new release"}),(0,a.BX)(R.G,{css:[D.l0.colWithGap(8)],children:[(0,a.tZ)(I.h4,{level:2,variant:"subheadDefault",children:"Modified files"}),(0,a.tZ)(es,{pendingChangesState:C,isReplitTemplate:L})]}),L||N?(0,a.BX)(R.G,{css:[D.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:v("description"),css:[D.l0.color.foregroundDimmer,{fontSize:D.TV.fontSizeSmall,lineHeight:D.TV.lineHeightSmall}],children:"Description"}),(0,a.tZ)(G.B,{id:v("description"),"aria-label":"Description",onChange:function(e){return k.setValue(e.target.value)},css:[D.l0.width("100%"),D.l0.minHeight(64),D.l0.maxHeight(128),{resize:"vertical"}],placeholder:"Explain what has changed about your template"}),k.error?(0,a.tZ)(P.E,{icon:(0,a.tZ)(M.Z,{}),text:null===(p=k.error)||void 0===p?void 0:p.message,colorway:"negative"}):null]}):null,L?(0,a.tZ)(eh,{repl:m,state:W,onChange:function(e,t){return H(function(n){return(0,i._)((0,r._)({},n),(0,E._)({},e,t))})}}):null,(0,a.tZ)(R.G,{children:_.error?(0,a.tZ)(P.E,{icon:(0,a.tZ)(M.Z,{}),text:_.error,colorway:"negative"}):null}),(0,a.BX)(R.G,{css:[D.l0.rowWithGap(12),D.l0.justify.end],children:[$?(0,a.tZ)(B.zx,{text:"Revert to older",colorway:"negative",onClick:function(){return x(!0)}}):null,(0,a.tZ)(A.u,{tooltip:J,placement:"bottom",isDisabled:!J,children:(0,a.tZ)(B.zx,{text:"Publish release",type:"submit",colorway:"primary",iconLeft:(0,a.tZ)(F.Z,{}),disabled:z})})]})]})}function eh(e){var t,n,r,i=e.repl,o=e.state,l=e.onChange,c=(0,U.U)(),s=(0,O.e9)(),u=s.data,d=s.loading,f=null==u?void 0:null===(t=u.currentUser)||void 0===t?void 0:t.username;return(0,a.BX)(R.G,{css:[D.l0.colWithGap(12)],children:[(0,a.tZ)(I.h4,{level:2,children:"Official Replit Template publishing checklist"}),(0,a.BX)(R.G,{children:[(0,a.BX)(ed,{children:[(0,a.tZ)(N.X,{id:c("ran"),checked:o.ran,onChange:function(e){return l("ran",e.target.checked)}}),(0,a.tZ)("label",{htmlFor:c("ran"),children:"Ran Repl:"}),(0,a.BX)("span",{children:["I ran the Repl to generate and cache package guesser result into"," ",(0,a.tZ)("code",{children:".upm"}),"."]})]}),(0,a.BX)(ed,{children:[(0,a.tZ)(N.X,{id:c("tested"),checked:o.tested,onChange:function(e){return l("tested",e.target.checked)}}),(0,a.tZ)("label",{htmlFor:c("tested"),children:"Ran tests:"}),(0,a.BX)("span",{children:['I ran "Test working copy" for @',null===(n=i.user)||void 0===n?void 0:n.username,"/",i.slug," in"," ",(0,a.tZ)("a",{href:"https://template-tester.replit.app/",target:"_blank",children:"template tester"}),". ",(0,a.tZ)("br",{}),"If there are no tests, consider adding one."]})]})]}),d||(null===(r=i.user)||void 0===r?void 0:r.username)!==f?null:(0,a.tZ)(P.E,{text:"You can't publish an update while impersonating. Add yourself as a member of the 'replit' team using CLUI tool 'add-remove-team-member', then open this Repl from your account.",colorway:"negative"})]})}var ep=n(25061),em=n(5693),ev=n(5315),eg=n(15053),ey=n(59639),eb=n(49344),eZ=n(38080),ew=n(29479),ex=n(7877),eC=n(39390),e_=n(97411),ek=n(90513),eS=n(94106),eE=n(40028),eT=n(71241),eR=n(78066),eI=n(52924),eD=n(85805),eG=n(35972),eB=n(6620),eP=n(43973),eA=n(88205);function eN(e){var t=u.useRef(null),n=(0,o._)(u.useState(e.value),2),r=n[0],i=n[1],l=(0,o._)(u.useState(null),2),s=l[0],d=l[1],f=(0,eD.Z)({onUpload:function(t){var n=t.url;e.onChange(n)},onUploadPreview:function(e){i(e.dataUrl)},onError:function(e){d(e.message)}});u.useEffect(function(){i(e.value)},[e.value]);var h=null==r?void 0:r.startsWith("data:");return(0,a.BX)(eG.gC,{spacing:"var(--space-4)",children:[(0,a.BX)("div",{onClick:function(){var e;null===(e=t.current)||void 0===e||e.click()},"aria-label":r?"Change icon":"Upload an icon","data-microtip-position":"right",role:"tooltip",className:c().dynamic([["649b73688aef77e0",[32,32]]])+" "+((r?"update-icon":"add-icon")||""),children:[r?(0,a.BX)(a.HY,{children:[(0,a.tZ)(eR.Z,{iconUrl:r,size:32,alt:"icon"}),h?(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" loading-state",children:(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" loading-icon",children:(0,a.tZ)(ee.Z,{})})}):(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" hover-state",children:(0,a.tZ)(eI.Z,{})})]}):(0,a.tZ)(eB.Z,{}),(0,a.tZ)("input",{ref:t,accept:eP.W9.join(","),type:"file",onChange:function(e){var t=e.target,n=t.validity,r=t.files;n.valid&&(null==r?void 0:r.length)&&(d(null),f.uploadImage(r[0],eA.N.TemplateIcon))},className:c().dynamic([["649b73688aef77e0",[32,32]]])})]}),s?(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" error",children:s}):null,(0,a.tZ)(c(),{id:"649b73688aef77e0",dynamic:[32,32],children:".add-icon.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;border:1px dashed var(--foreground-dimmest);background-color:var(--background-root);width:".concat(32,"px;height:").concat(32,"px}.add-icon.__jsx-style-dynamic-selector:hover{color:var(--accent-primary-default);border-color:var(--accent-primary-default)}.add-icon.__jsx-style-dynamic-selector,.update-icon.__jsx-style-dynamic-selector{position:relative;cursor:pointer;background-color:var(--background-higher);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);padding:2px}.update-icon.__jsx-style-dynamic-selector:hover .hover-state.__jsx-style-dynamic-selector{opacity:.8}.hover-state.__jsx-style-dynamic-selector{opacity:0}.loading-state.__jsx-style-dynamic-selector{opacity:.8}.loading-icon.__jsx-style-dynamic-selector{-webkit-animation:rotate 1s linear infinite;-moz-animation:rotate 1s linear infinite;-o-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes rotate{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes rotate{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.hover-state.__jsx-style-dynamic-selector,.loading-state.__jsx-style-dynamic-selector{color:var(--accent-primary-default);position:absolute;top:0;left:0;width:100%;height:100%;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);background-color:var(--background-root);overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}input.__jsx-style-dynamic-selector{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1}.error.__jsx-style-dynamic-selector{font-size:var(--font-size-default);color:var(--accent-negative-default)}")})]})}var eU=n(25770),eL=n(79378),eO=n(70002),eX=n(15146),eM=n(5542),eF=n(74883),eW=n(58719),eH=n(80339),eV=n(98859),ez=n(8271),ej=n(52682),eq=n(89106),eY=n(20399),e$=n(93918),eJ=n(8017),eK=n(13900),eQ=n(31811),e0=n(24635),e1=n(48528),e2=(0,e$.X)({destructiveMenuItem:[D.l0.color.accentNegativeStronger]});function e8(e){var t=e.repl,n=(0,v.Z)(),o=(0,u.useMemo)(function(){return t.user?{text:t.user.username,css:[{"&, & span":D.l0.flex.shrink(1)}],iconLeft:(0,a.tZ)(eL.q,{src:t.user.image,username:t.user.username})}:{text:""}},[t]);if(!t.user)return null;var l=(0,eM.Ru)(t.user);return n?(0,a.tZ)(B.zx,(0,i._)((0,r._)({},o),{onClick:function(){eq.X.openExternalUrl(l.as)}})):(0,a.tZ)(eO.Z,(0,i._)((0,r._)({},o,l),{prefetch:!1}))}function e4(e){var t=e.setActiveDialog,n=e.repl,o=e.isTemplate,l=e.updateIconUrl,c=e.showCloseButton,s=e.setIsEditing,u=e.updateReplInfo,d=(0,eQ.Z)(),h=!!n.publishedAs,p=n.currentUserPermissions.publish,m=(0,v.Z)(),g=!(null==n?void 0:n.publishedAs)&&!m,y=(null==n?void 0:n.publishedAs)===L.O2.RegularRepl,b=(0,f.g)().fork,Z=[];n.currentUserPermissions.fork&&Z.push({value:e0.$.Fork,label:"Fork",icon:(0,a.tZ)(ez.Z,{})}),n.publishedAs===L.O2.RegularRepl&&p&&!m&&Z.push({value:e0.$.Unpublish,label:"Unpublish",icon:(0,a.tZ)(eV.Z,{})}),o&&p&&!m&&Z.push({value:e0.$.UnpublishTemplate,label:"Unpublish template",icon:(0,a.tZ)(eV.Z,{})}),h&&p&&!m&&Z.push({value:e0.$.EditPublishSettings,label:"Edit Publish Settings",icon:(0,a.tZ)(eI.Z,{})}),n.currentUserPermissions.delete&&Z.push({isDestructive:!0,value:e0.$.Delete,label:"Delete",icon:(0,a.tZ)(ej.Z,{})});var w=(null==n?void 0:n.isPrivate)||!(null==n?void 0:n.isRenamed),x="";return(null==n?void 0:n.isPrivate)?x="This Repl is private. You need to make it public in order to publish it!":(null==n?void 0:n.isRenamed)||(x="You need to give this Repl a name before publishing it."),(0,a.BX)(R.G,{css:[D.l0.colWithGap(8),D.l0.p(8)],children:[(0,a.BX)(R.G,{css:[D.l0.rowWithGap(8),D.l0.align.center,D.l0.justify.spaceBetween,(0,E._)({},D.BC.max("mobileMax"),[D.l0.flex.columnReverse,D.l0.align.start,{gap:D.TV.space8}])],children:[(0,a.BX)(R.G,{css:[D.l0.rowWithGap(8),D.l0.center,D.l0.flex.shrink(1)],children:[(0,a.tZ)(e8,{repl:n}),n.currentUserPermissions.changeIconUrl&&o?(0,a.tZ)(eN,{value:n.iconUrl,onChange:l}):null]}),(0,a.BX)(R.G,{css:[D.l0.align.center,D.l0.rowWithGap(8),(0,E._)({},D.BC.max("mobileMax"),{width:"100%",">*:not(div)":{flex:1}})],children:[m?null:(0,a.tZ)(eO.Z,(0,i._)((0,r._)({prefetch:!1},(0,eU.j3)(n)),{iconLeft:(0,a.tZ)(eH.Z,{}),colorway:"primary",text:"Cover page",target:"_blank"})),p&&g&&!d?(0,a.tZ)(A.u,{tooltip:x,isDisabled:!w,children:(0,a.tZ)(B.zx,{type:"button",iconLeft:(0,a.tZ)(eB.Z,{}),onClick:function(){t(e0.x.Publish)},dataCy:"ws-publish-button",text:"Publish",disabled:w})}):null,o&&!m?(0,a.tZ)(B.zx,{type:"button",iconLeft:(0,a.tZ)(eB.Z,{}),onClick:function(){return t(e0.x.UpdatePublishedTemplate)},text:"Update"}):null,y&&!m?(0,a.tZ)(B.zx,{type:"button",iconLeft:(0,a.tZ)(eF.Z,{}),onClick:function(){return t(e0.x.UpdatePublishedRepl)},text:"Update"}):null,m?(0,a.tZ)(e1.j,{textToCopy:window.location.href,alt:"Copy Repl URL",tooltip:"Copied!",tooltipPlacement:"bottom-end",timeout:2e3,children:(0,a.tZ)(eJ.Z,{})}):null,Z.length>0&&(0,a.tZ)(eY.ZE,{icon:(0,a.tZ)(eK.Z,{size:16}),"aria-label":o?"Template Actions":"Repl Actions",cssProps:[D.l0.backgroundColor.backgroundDefault],placement:"bottom-end",onAction:function(e){switch(e){case e0.$.Fork:b();return;case e0.$.Unpublish:t(e0.x.Unpublish);return;case e0.$.UnpublishTemplate:t(e0.x.UnpublishTemplate);return;case e0.$.Delete:t(e0.x.DeleteRepl);return;case e0.$.EditPublishSettings:t(e0.x.EditPublishSettings)}},children:Z.map(function(e){return(0,a.tZ)(eY.ck,{children:(0,a.BX)(R.G,{css:[D.l0.rowWithGap(8),e.isDestructive&&e2.destructiveMenuItem],children:[e.icon,(0,a.tZ)(R.G,{children:e.label})]})},e.value)})}),c?(0,a.tZ)(eX.hU,{alt:"Close",tooltipHidden:!0,onClick:function(){u(),s(!1)},children:(0,a.tZ)(eW.Z,{})}):null]})]}),n.lastPublishedAt&&p?(0,a.BX)(I.xv,{variant:"small",color:"dimmest",multiline:!1,children:["Last published on"," ",new Date(n.lastPublishedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}):null]})}var e3={query:g.s8},e5={query:p.BW};function e6(e){var t=e.setIsEditing,n=e.showCloseButton,r=e.onDeployClick,i=(0,Z.Z)(),o=(0,eT.BZ)({variables:{replId:i}}),l=o.data,c=o.refetch,s=(null==l?void 0:l.repl.__typename)==="Repl"?l.repl:null;return s?(0,a.tZ)(e9,{setIsEditing:t,showCloseButton:n,repl:s,refetch:c,onDeployClick:r}):(0,a.tZ)(R.G,{css:[D.l0.center,D.l0.p(16)],children:(0,a.tZ)(ee.Z,{})})}function e9(e){var t,n,l,p=e.repl,g=e.showCloseButton,Z=e.setIsEditing,S=e.onDeployClick,E=(0,eS.useRouter)(),T=(0,v.Z)(),A=(0,o._)(u.useState(null),2),N=A[0],O=A[1],X=(0,o._)(u.useState(p.isRenamed?p.title:""),2),M=X[0],F=X[1],W=(0,o._)(u.useState(p.description||""),2),H=W[0],V=W[1],z=(0,o._)(u.useState(p.rawTemplateLabel),2),j=z[0],q=z[1],Y=(0,eT.zu)().data,$=(0,b.Z)().showError,J=p.publishedAs===L.O2.Template;u.useEffect(function(){V(p.description||"")},[p.description]);var K=(0,_.Z)(),Q=u.useRef(p),ee=(0,o._)((0,eT.ap)({variables:{id:p.id},onCompleted:function(){if(T){E.push("/desktopApp/home");return}E.push("/home","/~")},update:function(e,t){var n;(null===(n=t.data)||void 0===n?void 0:n.deleteRepl)&&(e.evict({id:e.identify(t.data.deleteRepl)}),e.gc())},onError:function(e){return $((0,w.Z)(e.message))}}),2),et=ee[0],en=ee[1].loading,er=(0,o._)((0,eT.vi)({onError:function(e){return $((0,w.Z)(e.message))},onCompleted:function(e){var t=e.updateRepl.repl,n=Q.current,r={};n.description!==t.description&&(r.description=t.description),n.title!==t.title&&(r.title=t.title),n.url!==t.url&&(r.url=t.url,E.push({pathname:K,query:{replUrl:t.url}},t.url+window.location.search+window.location.hash)),n.isRenamed!==t.isRenamed&&(r.isRenamed=!!t.isRenamed),Q.current=p,Object.keys(r).length>0&&Z(!1)}}),2),ei=er[0],eo=er[1].loading,ea=(0,o._)((0,eT.gF)({variables:{input:{replId:p.id}},onError:function(e){s.Tb(e),$((0,w.Z)(e.message))}}),2),el=ea[0],ec=ea[1],es=(0,eT.l9)({fetchPolicy:"cache-and-network",ssr:!1}),eu=es.data,ed=es.loading,eh=es.error,eR=u.useMemo(function(){return!!M&&M!==p.title||j!==p.rawTemplateLabel||(""!==H||!!p.description)&&H!==p.description},[p,M,H,j]),eI=(0,y.Z)(eR),eD=u.useCallback(function(){eR&&ei({variables:{input:{id:p.id,title:M.trim()||p.title,description:H,templateLabel:p.currentUserPermissions.changeTemplateLabel?j:void 0}}})},[eR,ei,p,M,H,j]),eG=(0,y.Z)(eD);u.useLayoutEffect(function(){return function(){eI.current&&eG.current()}},[eG,eI]);var eB=u.useCallback(function(e){switch(e){case"private":var t,n,r;return(null==eu?void 0:null===(t=eu.currentUser)||void 0===t?void 0:t.userPowerUpsByType.__typename)==="UserPowerUpsTypes"?null===(r=eu.currentUser.userPowerUpsByType)||void 0===r?void 0:null===(n=r.privateRepls.cost)||void 0===n?void 0:n.explanation:null;case"always-on":case"gpu":return null;default:(0,eE.Z)(e)}},[eu]),eP=function(){ei({variables:{input:{id:p.id,isPrivate:!p.isPrivate}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,i._)((0,r._)({},p),{isPrivate:!p.isPrivate})}},refetchQueries:[{query:eT.WM,variables:{replId:p.id}},e3,e5]}),(0,C.j)(C.U3.PRIVATE_TOGGLED,{enabled:!p.isPrivate,source:"workspace_info_modal"})},eA=p.isRenamed?"Name your Repl":"Default name: ".concat(p.title),eN=[L.Sy.Submit,L.Sy.PublishTemplate,L.Sy.EditTemplate].includes(p.workspaceCta),eU=(0,U.U)(),eL=(null===(t=p.owner)||void 0===t?void 0:t.__typename)==="Team",eO=p.hostingDeploymentPermissions.canDeploy&&"function"==typeof S,eX="/replEnvironmentDesktop"===K&&eO,eM=(0,m.gg)(),eF=eM.isDeployableRepl,eW=eM.reason,eH=(null===(n=p.hostingDeployment)||void 0===n?void 0:n.__typename)==="HostingDeployment"&&p.hostingDeployment.currentBuild;return(0,a.BX)("div",{css:{overflow:"auto",maxHeight:"80vh"},className:c().dynamic([["e8f7dc262f842124",[p.currentUserPermissions.changeDescription?"auto":"not-allowed",ew.j.mobileMax]]]),children:[(0,a.tZ)(f.b,{forkParams:{trackingData:{forkSource:"editReplPopoverMenuItem"}},repl:p,teamContext:null===(l=p.user)||void 0===l?void 0:l.username,children:(0,a.tZ)(e4,{repl:p,isTemplate:J,showCloseButton:g,setActiveDialog:O,setIsEditing:Z,updateIconUrl:function(e){return ei({variables:{input:{id:p.id,iconUrl:e}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,i._)((0,r._)({},p),{iconUrl:e})}}})},updateReplInfo:eD})}),(0,a.tZ)("form",{onSubmit:function(e){e.preventDefault(),eD()},className:c().dynamic([["e8f7dc262f842124",[p.currentUserPermissions.changeDescription?"auto":"not-allowed",ew.j.mobileMax]]]),children:(0,a.BX)(R.G,{css:[D.l0.align.stretch,D.l0.colWithGap(16)],children:[(0,a.BX)(eZ.Tg,{background:"default",css:[D.l0.colWithGap(16)],children:[(0,a.tZ)(R.G,{css:[D.l0.flex.column],children:(0,a.BX)(R.G,{css:[D.l0.colWithGap(4)],children:[(0,a.BX)(R.G,{css:[D.l0.flex.row,D.l0.justify.spaceBetween,D.l0.align.end],children:[(0,a.tZ)("label",{htmlFor:eU("name"),className:c().dynamic([["e8f7dc262f842124",[p.currentUserPermissions.changeDescription?"auto":"not-allowed",ew.j.mobileMax]]]),children:(0,a.tZ)(I.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Name"})}),(0,a.tZ)(h.Z,{maxLength:60,value:M,hideLabel:!0})]}),(0,a.tZ)(G.II,{style:{cursor:p.currentUserPermissions.changeTitle?"auto":"not-allowed"},disabled:!p.currentUserPermissions.changeTitle,maxLength:60,placeholder:eA,value:M,onChange:function(e){return F(e.target.value)},spellCheck:!1,id:eU("name"),dataCy:"ws-repl-info-title-input"})]})}),(0,a.tZ)(R.G,{css:[D.l0.flex.column],children:(0,a.BX)(R.G,{css:[D.l0.colWithGap(4)],children:[(0,a.BX)(R.G,{css:[D.l0.flex.row,D.l0.justify.spaceBetween,D.l0.align.end],children:[(0,a.tZ)("label",{htmlFor:eU("description"),className:c().dynamic([["e8f7dc262f842124",[p.currentUserPermissions.changeDescription?"auto":"not-allowed",ew.j.mobileMax]]]),children:(0,a.tZ)(I.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Description"})}),(0,a.tZ)(h.Z,{maxLength:ev.p,value:H,hideLabel:!0})]}),(0,a.tZ)(G.B,{onKeyDown:function(e){13===e.keyCode&&(e.ctrlKey||e.metaKey)},disabled:!p.currentUserPermissions.changeDescription,maxLength:ev.p,value:H,onChange:function(e){return V(e.target.value)},placeholder:"What does this Repl do?",css:[D.l0.minHeight(96),D.l0.maxHeight(256),{resize:"vertical"}],id:eU("description")})]})})]}),J&&p.currentUserPermissions.changeTemplateLabel?(0,a.tZ)(eZ.Tg,{background:"default",css:[D.l0.colWithGap(4)],children:(0,a.BX)(R.G,{css:[D.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:eU("template"),className:c().dynamic([["e8f7dc262f842124",[p.currentUserPermissions.changeDescription?"auto":"not-allowed",ew.j.mobileMax]]]),children:(0,a.tZ)(I.xv,{color:"dimmer",variant:"small",multiline:!1,children:"Template label"})}),(0,a.tZ)(G.II,{value:j,maxLength:60,placeholder:"Template label",spellCheck:!1,onChange:function(e){return q(e.target.value)},id:eU("template")})]})}):null]})}),eN?null:(0,a.BX)(R.G,{css:[D.l0.colWithGap(24),D.l0.p(8),D.l0.pt(0)],children:[p.currentUserPermissions.changePrivacy===L.HA.Allowed&&(0,a.BX)(R.G,{css:[D.l0.colWithGap(8)],children:[(0,a.BX)(ey.hE,{tag:"fieldset",name:eU("privacy"),value:p.isPrivate.toString(),onChange:function(){if(!eo){if(p.isPrivate||p.currentUserPermissions.changePrivacy===L.HA.Allowed&&(null===(e=p.user)||void 0===e?void 0:e.id)!=null&&(null==Y?void 0:null===(t=Y.currentUser)||void 0===t?void 0:t.id)!=null&&p.user.id!==Y.currentUser.id){eP();return}var e,t,n,r,i=(null==eu?void 0:null===(n=eu.currentUser)||void 0===n?void 0:n.userPowerUpsByType.__typename)==="UserPowerUpsTypes"&&(null===(r=eu.currentUser.userPowerUpsByType)||void 0===r?void 0:r.privateRepls.active),o=eB("private");if(null==o||ed){$("You're too fast for us! Please try again in a moment.");return}if(eh){$("This action is currently unavailable. Please refresh and try again.");return}if((0,C.j)(C.U3.POWER_UP_TOGGLE_REQUESTED,{powerUp:"private",setting:!p.isPrivate,source:"workspace_info_modal",costExplanation:o}),i){eP();return}O(e0.x.PowerUp)}},row:!0,primary:!0,stretch:!0,children:[(0,a.tZ)(ey.rK,{id:eU("false"),value:"false",text:"Public",icon:(0,a.tZ)(eC.Z,{})}),(0,a.tZ)(ey.rK,{id:eU("true"),value:"true",text:"Private",icon:(0,a.tZ)(e_.Z,{})})]}),(0,a.tZ)(I.xv,{variant:"small",color:"dimmest",children:(0,x.Z)(p.isPrivate,eL)})]}),eX?(0,a.BX)(R.G,{css:D.l0.colWithGap(8),children:[(0,a.tZ)(B.zx,{text:eH?"Redeploy your project":"Deploy your project",iconLeft:(0,a.tZ)(ex.Z,{}),colorway:eH?void 0:"primary",onClick:function(){S(),eH||(0,C.j)(C.U3.DEPLOY_PROJECT_SELECTED,{source:"workspace_info_modal"})},disabled:!eF}),eF?null:(0,a.tZ)(P.E,{text:eW})]}):null]}),(0,a.tZ)(eg.Z,{isOpen:N===e0.x.DeleteRepl,onClose:function(){return O(null)},selectedRepls:[p],onDelete:function(){et()},deleting:en}),(0,a.tZ)(ek.Z,{isOpen:N===e0.x.PowerUp,onClose:function(){return O(null)},type:"purchase",analyticsContext:{upgrade:{context:"workspace_info_modal"},trial:{context:L.$X.Workspace}}}),(0,a.tZ)(eb.u,{isOpen:N===e0.x.Unpublish,onRequestClose:function(){return O(null)},children:(0,a.tZ)(em.Z,{repl:p,source:"replEnvironment",onDone:function(){O(null)}})}),(0,a.tZ)(eb.u,{isOpen:N===e0.x.UnpublishTemplate,onRequestClose:function(){return O(null)},children:(0,a.tZ)(d.Z,{confirmLabel:"Yes, unpublish this Template",isDestructive:!0,title:"Unpublish Template",onCancel:function(){return O(null)},onConfirm:function(){ec.loading||(el(),O(null))},children:"Your Repl will no longer be discoverable on Templates. You can republish again at any time, and all of your comments or reactions will stick around."})}),(0,a.tZ)(eb.u,{isOpen:N===e0.x.EditPublishSettings,onRequestClose:function(){return O(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,a.tZ)(k.Z,{source:"replEnvironment",replId:p.id})}),(0,a.tZ)(eb.u,{isOpen:N===e0.x.Publish,onRequestClose:function(){return O(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,a.tZ)(k.Z,{source:"replEnvironment",replId:p.id})}),(0,a.tZ)(eb.u,{isOpen:N===e0.x.UpdatePublishedTemplate,onRequestClose:function(){return O(null)},noPadding:!0,children:(0,a.tZ)(ef,{repl:p})}),(0,a.tZ)(eb.u,{isOpen:N===e0.x.UpdatePublishedRepl,onRequestClose:function(){return O(null)},children:(0,a.tZ)(ep.Z,{repl:p,onDone:function(){return O(null)},source:"replEnvironment"})}),(0,a.tZ)(c(),{id:"e8f7dc262f842124",dynamic:[p.currentUserPermissions.changeDescription?"auto":"not-allowed",ew.j.mobileMax],children:"form.__jsx-style-dynamic-selector{padding:var(--space-8)}textarea.__jsx-style-dynamic-selector{min-height:42px;height:200px;resize:none;cursor:".concat(p.currentUserPermissions.changeDescription?"auto":"not-allowed",";font-size:var(--font-size-default);font-family:var(--font-family-default);padding:var(--space-8);display:block;width:100%;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);border:1px solid var(--outline-dimmest);-webkit-transition:.2s border-color;-moz-transition:.2s border-color;-o-transition:.2s border-color;transition:.2s border-color;background-color:transparent;color:var(--foreground-default)}textarea.__jsx-style-dynamic-selector:hover{border-color:var(--accent-primary-dimmer)}textarea.__jsx-style-dynamic-selector:active,textarea.__jsx-style-dynamic-selector:focus{border-color:var(--accent-primary-default)}textarea.__jsx-style-dynamic-selector:disabled{opacity:.5}textarea.__jsx-style-dynamic-selector:focus,textarea.__jsx-style-dynamic-selector:active{outline:none;border-color:var(--accent-primary-default)}.edit-repl-actions.__jsx-style-dynamic-selector{padding:0 var(--space-16)}.menu-item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:var(--foreground-default)}.delete-menu-item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:var(--accent-negative-default)}.icon-container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:0 var(--space-4)}.menu-text.__jsx-style-dynamic-selector{padding:0 var(--space-4)}@media screen and (max-width:").concat(ew.j.mobileMax,"px){.edit-repl.__jsx-style-dynamic-selector{width:80vw}}")})]})}},11707:function(e,t,n){n.d(t,{s:function(){return l}});var r=n(93295),i=n(23982),o=n(78747);function a(){var e=(0,r._)(["\n  fragment WorkspaceHeaderReplMetadataRepl on Repl {\n    id\n    title\n    iconUrl\n    user {\n      id\n      ...UserLinkUser\n    }\n  }\n  ","\n"]);return a=function(){return e},e}var l=(0,i.Ps)(a(),o._)},38168:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(39698),i=n(8182);n(43429);var o=n(93918),a=n(29287),l=n(74833),c=n(56596),s=n(2161),u=(0,o.X)({metadata:[a.l0.rowWithGap(6),a.l0.align.center,a.l0.flex.growAndShrink(1)],username:[a.l0.maxWidth(160),a.l0.truncate,a.l0.flex.shrink(1)],title:[a.l0.flex.shrink(1),a.l0.truncate]});function d(e){var t=e.repl;return(0,i.BX)(c.G,{css:u.metadata,children:[(0,i.tZ)(c.G,{css:[a.l0.display.none,(0,r._)({},a.BC.min("tabletMax"),[a.l0.display.flex])],children:(0,i.tZ)(s.ZP,{iconUrl:t.iconUrl,size:20,alt:""})}),(0,i.tZ)(l.xv,{multiline:!1,css:u.title,"data-cy":"header-repl-title",children:t.title})]})}},24635:function(e,t,n){var r,i,o,a;n.d(t,{$:function(){return i},x:function(){return r}}),(o=r||(r={})).DeleteRepl="DeleteRepl",o.PowerUp="PowerUp",o.BuyCycles="BuyCycles",o.Unpublish="Unpublish",o.UnpublishTemplate="UnpublishTemplate",o.EditPublishSettings="EditPublishSettings",o.Publish="Publish",o.UpdatePublishedTemplate="UpdatePublishedTemplate",o.UpdatePublishedRepl="UpdatePublishedRepl",(a=i||(i={})).Fork="Fork",a.Delete="Delete",a.Unpublish="Unpublish",a.UnpublishTemplate="UnpublishTemplate",a.EditPublishSettings="EditPublishSettings"},61673:function(e,t,n){n.d(t,{ZP:function(){return Q},L7:function(){return K}});var r,i,o,a=n(34142),l=n(39698),c=n(45903),s=n(25e3),u=n(32477),d=n(87682),f=n(8182),h=n(43429),p=n(93295),m=n(23982),v=n(66039);function g(){var e=(0,p._)(["\n  query WorkspaceRunButton($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        language\n        title\n        rootOriginReplUrl\n        source {\n          release {\n            id\n            repl {\n              id\n              title\n              owner {\n                ... on User {\n                  id\n                  username\n                }\n                ... on Team {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    currentUser {\n      id\n    }\n  }\n"]);return g=function(){return e},e}var y={},b=(0,m.Ps)(g()),Z=n(59868),w=n(50782),x=n(18107),C=n(29287),_=n(56596),k=n(88936),S=n(74833),E=n(30983),T=n(51384),R=n(29479),I=n(71999),D=n(15859);function G(){var e=(0,p._)(["\n  query CelebrateReplRunCurrentUser {\n    currentUser {\n      id\n      timeCreated\n    }\n  }\n"]);return G=function(){return e},e}var B={},P=(0,m.Ps)(G()),A=n(90351),N=n(48900),U=n(92920),L=new Date("2022-07-08"),O=(0,D.O4)("useCelebrateFirstReplPlay",!1),X=n(27187),M=n(25753),F=n(49996),W=n(55534),H=n(47507),V=n(93049),z=n(74652);function j(e){var t=e.runState,n=e.size,r=void 0===n?16:n;switch(t){case x.Ah.IDLE:return(0,f.tZ)(X.Z,{size:r});case x.Ah.RUNNING:return(0,f.tZ)(M.Z,{size:r});default:return(0,f.tZ)(k.Z,{size:r})}}var q=(r={},(0,l._)(r,x.Ah.IDLE,"Run"),(0,l._)(r,x.Ah.RUNNING,"Stop"),(0,l._)(r,x.Ah.STOPPING,"Stopping"),(0,l._)(r,x.Ah.OFFLINE,"Working"),(0,l._)(r,x.Ah.BEFORE_RUN,"Working"),r),Y=(i={small:48,large:100},(0,l._)(i,x.Ah.IDLE,68),(0,l._)(i,x.Ah.RUNNING,72),(0,l._)(i,x.Ah.STOPPING,92),(0,l._)(i,x.Ah.OFFLINE,86),(0,l._)(i,x.Ah.BEFORE_RUN,86),i),$=(0,T.iv)([C.l0.py(12),C.l0.width(Y.small),C.l0.flex.row,C.l0.center,C.l0.borderRadius(6),C.l0.backgroundColor.accentPositiveDimmest,C.l0.color.accentPositiveStrongest,C.l0.cursor.pointer,C.l0.focusRing,(o={transition:"color 0.2s ease 0s, background-color 0.2s ease 0s",border:"1px solid",borderColor:"transparent",lineHeight:1,outline:"0 none","&:hover":[{color:"white"},C.l0.backgroundColor.accentPositiveDefault],"&:active":[{borderColor:C.TV.accentPositiveStrongest}]},(0,l._)(o,(0,F.et)("tabletMax"),[C.l0.width(Y.large)]),(0,l._)(o,":focus-visible",{outlineColor:"".concat(C.TV.accentPositiveStrongest)}),o)]),J=(0,T.iv)([C.l0.color.foregroundDimmer,C.l0.backgroundColor.backgroundHigher,{borderColor:"transparent","&:hover":[{color:"white"},C.l0.backgroundColor.backgroundHighest],"&:active":[{borderColor:C.TV.accentPrimaryDefault}]}]);function K(e){var t=(0,u._)((0,h.useState)(e.getRunState()),2),n=t[0],r=t[1];return(0,h.useEffect)(function(){return r(e.getRunState()),e.onStateChanged(function(e){r(e)})},[e]),n}var Q=h.forwardRef(function(e,t){var n,r,i,o,p,m,g,k,T,D,G,X,M,Q=e.runner,ee=e.runConfig,et=e.onRunInitiated,en=e.style,er=void 0===en?"default":en,ei=e.disableTooltip,eo=e.shortcut,ea=(0,w.Z)(),el=K(Q),ec=(n=(0,c._)({},y,{variables:{id:ea}}),v.a(b,n)).data,es=(null==ec?void 0:ec.repl.__typename)==="Repl"?ec.repl:null,eu=(r=(0,c._)({},B,void 0),p=v.a(P,r),m=(0,U.Z)().preferences.extraDelight,g=(0,A.$0)().fireCircularBurstFrom,T=(k=(0,u._)((0,I.KO)(O),2))[0],D=k[1],G=null!==(o=null===(i=p.data)||void 0===i?void 0:i.currentUser)&&void 0!==o?o:null,X=!T&&G&&new Date(G.timeCreated)>=L,{hasCelebrated:T,celebrate:function(e){if(!e){N.Tb(Error("Cannot find element for celebrate Repl run confetti"));return}(m||X)&&g({element:e}),X&&D(!0)}}).celebrate,ed=el!==x.Ah.IDLE&&el!==x.Ah.RUNNING,ef=(0,W.Z)().showError,eh=(0,h.useRef)(null),ep=(M=(0,a._)(function(){var e,t,n,r,i,o,a,l;return(0,d.Jh)(this,function(c){switch(c.label){case 0:if(c.trys.push([0,3,,4]),el!==x.Ah.IDLE)return[3,2];return et&&et(),eh.current&&eu(eh.current),[4,Q.run(ee)];case 1:return c.sent(),es&&(0,Z.j)(Z.U3.PROJECT_RAN,{placement:"primary_btn",language:es.language,replId:es.id,replTitle:es.title,rootOriginReplUrl:es.rootOriginReplUrl,templateTitle:null===(n=es.source)||void 0===n?void 0:null===(t=n.release)||void 0===t?void 0:null===(e=t.repl)||void 0===e?void 0:e.title,templateOwner:null===(a=es.source)||void 0===a?void 0:null===(o=a.release)||void 0===o?void 0:null===(i=o.repl)||void 0===i?void 0:null===(r=i.owner)||void 0===r?void 0:r.username}),[2];case 2:if(el===x.Ah.RUNNING)return[2,Q.stopRun()];return[3,4];case 3:if(ef((l=c.sent()).toString()),H.kg.error("run button error",{errorMessage:l.message}),el===x.Ah.RUNNING)return[2,Q.stopRun()];return[3,4];case 4:return[2]}})}),function(){return M.apply(this,arguments)});if("floating"===er)return(0,f.tZ)(_.G,{tag:"button",disabled:ed,css:[{position:"fixed",right:24,bottom:72,zIndex:1},C.l0.center,{height:"50px",width:"50px",opacity:"0.5",cursor:"pointer",borderRadius:"100%",border:"solid 2px var(--accent-positive-dimmer)",backgroundColor:C.TV.accentPositiveDimmest}],onClick:ep,innerRef:eh,children:(0,f.tZ)(j,{runState:el})});var em=el===x.Ah.IDLE;return"inline-small"===er?(0,f.BX)("button",{"data-cy":"ws-run-btn",onClick:ep,ref:eh,disabled:ed,css:[C.l0.p(12),C.l0.flex.row,C.l0.center,C.l0.borderRadius(8),em?C.l0.backgroundColor.accentPositiveDimmest:C.l0.backgroundColor.backgroundHigher,em?C.l0.color.accentPositiveStronger:C.l0.color.foregroundDimmer,{border:"1px solid",borderColor:em?C.TV.accentPositiveDimmest:C.TV.backgroundHigher},C.l0.width("100%"),C.l0.height("100%")],children:[(0,f.tZ)(j,{runState:el}),(0,f.tZ)(S.xv,{variant:"subheadDefault",css:[C.l0.pl(8)],multiline:!1,children:q[el]})]}):(0,f.tZ)(E.u,{placement:"bottom",isDisabled:ei||!eo,tooltip:eo?(0,f.tZ)(_.G,{css:{margin:-4},children:(0,f.tZ)(z.bM,{keyCombo:eo,small:!0})}):null,children:function(e,n){return(0,f.BX)("button",(0,s._)((0,c._)({},e),{onClick:ep,ref:(0,V.l)(eh,n,t),css:[$,!em&&J,C.l0.height(32),(0,l._)({transition:"width 80ms ease-out"},(0,F.et)("tabletMax"),C.l0.width(Y[el]))],children:[(0,f.tZ)(j,{runState:el,size:12}),(0,f.tZ)(S.xv,{multiline:!1,css:[C.l0.pl(6),C.l0.display.none,C.l0.fontWeight.medium,(0,l._)({lineHeight:1,overflow:"visible"},"@media (min-width: ".concat(R.j.tabletMax,"px)"),[C.l0.display.block])],children:q[el]})]}))}})})},68681:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(45903),i=n(25e3),o=n(70322),a=n(8182),l=n(15146),c=n(29287),s=(0,n(93918).X)({checked:[c.l0.width(32),c.l0.height(32),c.l0.backgroundColor.backgroundHigher],unchecked:[c.l0.width(32),c.l0.height(32),c.l0.color.foregroundDimmest]});function u(e){var t=e.alt,n=e.icon,c=e.checked,u=e.onClick,d=(0,o._)(e,["alt","icon","checked","onClick"]);return(0,a.tZ)(l.hU,(0,i._)((0,r._)({},d),{css:c?s.checked:s.unchecked,alt:"".concat(c?"Disable":"Enable"," ").concat(t),onClick:u,children:n}))}},71984:function(e,t,n){n.d(t,{Z:function(){return u}});var r,i=n(39698),o=n(8182),a=n(29287),l=n(30983),c=n(52682),s=(0,n(51384).iv)([a.l0.focusRing,a.l0.display.flex,a.l0.center,a.l0.borderRadius(4),a.l0.backgroundColor.backgroundRoot,a.l0.color.foregroundDefault,a.l0.cursor.pointer,a.l0.p(4),(r={transition:"background-color 0.2s",border:"none"},(0,i._)(r,a.wl.hover,[a.l0.backgroundColor.backgroundHigher]),(0,i._)(r,":focus",{outline:"none"}),r)]),u=function(e){var t=e.onClick;return(0,o.tZ)(l.u,{tooltip:"Clear",placement:"bottom-start",children:(0,o.tZ)("button",{"aria-label":"Clear",onClick:t,css:s,children:(0,o.tZ)(c.Z,{size:16})})})}},24837:function(e,t,n){n.d(t,{Z:function(){return W}});var r=n(32477),i=n(8182),o=n(43429),a=n(37951),l=n(54254),c=n(56596),s=n(29287),u=n(23291),d=n(30983),f=n(74833),h=n(32377),p=n(80839),m=n(36010),v=n.n(m),g=n(45903),y=n(17108),b=n(68333),Z=n(46299),w=n(85768),x=n(92920),C=n(51384),_=n(8070),k=n(77550),S=n(33195),E=n(53326),T=["a","pre","code","em","strong","p","ul","ol","li","img","del","h1","h2","h3","h4","h5","h6","sup","sub","br","hr","blockquote","span","div"],R=(0,o.memo)(function(e){var t=e.content,n=(0,x.Z)().preferences.fontSize,r=o.useCallback(function(e){return(0,i.tZ)(E.Z,(0,g._)({},e))},[]);return(0,i.tZ)("div",{css:[{"& ol":{paddingInlineStart:"20px"},"& ul":{paddingInlineStart:"20px",listStyle:"initial"}}],children:(0,i.tZ)(y.D,{css:(0,C.iv)({wordBreak:"break-word",boxSizing:"border-box",whiteSpace:"normal",lineHeight:1.5,color:s.TV.foregroundDefault,fontFamily:"".concat(s.TV.fontFamilyDefault," !important"),fontSize:n,textSizeAdjust:"100%","h1, h2, h3, h4, h5, h6":{color:s.TV.foregroundDefault,fontWeight:s.TV.fontWeightMedium,marginBottom:s.TV.space16,lineHeight:1.25,wordWrap:"break-word"},"h1, h2":{paddingBottom:s.TV.space8,borderBottom:"1px solid ".concat(s.TV.backgroundHigher),marginTop:s.TV.space32},h1:{fontSize:"2em"},h2:{fontSize:"1.5em"},h3:{fontSize:"1.25em",marginTop:s.TV.space24},h4:{fontSize:"1em",marginTop:s.TV.space16},h5:{fontSize:"0.875em"},h6:{color:s.TV.foregroundDimmer,fontSize:"0.85em"},".anchor":{float:"left",lineHeight:1,marginLeft:"calc(-1 * ".concat(s.TV.space16,")"),paddingRight:s.TV.space4},".anchor:focus":{outline:"none"},p:{marginBottom:s.TV.space16,fontSize:n,fontFamily:"".concat(s.TV.fontFamilyDefault," !important")},"p:last-child":{marginBottom:0},table:{borderSpacing:0,borderCollapse:"collapse",display:"block",width:"100%",overflow:"auto",marginBottom:s.TV.space16,wordBreak:"normal",th:{fontWeight:s.TV.fontWeightMedium},"td, th":{padding:"".concat(s.TV.space8," ").concat(s.TV.space12),border:"1px solid ".concat(s.TV.backgroundHighest),minWidth:"16ch"},tr:{backgroundColor:s.TV.backgroundDefault,borderTop:"1px solid ".concat(s.TV.backgroundHighest)},"tr:nth-of-type(2n)":{backgroundColor:s.TV.backgroundRoot}},"hr:after":{clear:"both"},"li > p":{marginBottom:0},li:{marginTop:s.TV.space4},dd:{marginLeft:0},"ol, ul":{paddingLeft:s.TV.space16,marginTop:0,marginBottom:0},ul:{listStyle:"initial",listStyleType:"disc",marginBottom:s.TV.space16},ol:{listStyle:"decimal",marginBottom:s.TV.space16},"ol ol, ol ul, ul ol, ul ul":{paddingLeft:s.TV.space16,marginTop:0,marginBottom:0,paddingBottom:0},"ul ul":{listStyleType:"circle"},"ul ul ul":{listStyleType:"square"},"ol ol, ul ol":{listStyleType:"lower-roman"},"ol ol ol, ol ul ol, ul ol ol, ul ul ol":{listStyleType:"lower-alpha"},pre:{fontFamily:"".concat(s.TV.fontFamilyCode," !important"),margin:"".concat(s.TV.space16," 0"),borderRadius:4,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",color:s.TV.foregroundDefault},"pre:last-child":{marginBottom:"0 !important"},blockquote:{padding:"0 1em",marginBottom:s.TV.space16,borderLeft:"".concat(s.TV.space2," solid ").concat(s.TV.backgroundHighest),paddingLeft:s.TV.space16},"blockquote > *":{color:"".concat(s.TV.foregroundDimmer," !important")},"blockquote > :last-child":{marginBottom:"0 !important",borderBottom:"none !important"},"blockquote > :first-child":{marginTop:"0 !important"},kbd:{display:"inline-block",padding:"3px 5px",font:"11px ".concat(s.TV.fontFamilyCode),color:s.TV.foregroundDimmer,verticalAlign:"middle",backgroundColor:s.TV.backgroundHigher,border:"none",borderRadius:3,boxShadow:"inset 0 -1px 0 ".concat(s.TV.backgroundHighest)},a:{color:s.TV.accentPrimaryStronger,backgroundColor:"initial"},"> :first-child":{marginTop:"0 !important",paddingTop:"0 !important"},"> :last-child":{borderBottom:"none !important",marginBottom:"0 !important",paddingBottom:"0 !important"},'[type="checkbox"]':{boxSizing:"border-box",marginRight:s.TV.space8,padding:0},details:{marginBottom:s.TV.space16,display:"block",background:s.TV.backgroundHigher,borderRadius:s.TV.borderRadius4,padding:s.TV.space16},summary:{display:"list-item",userSelect:"none",cursor:"pointer",fontWeight:s.TV.fontWeightBold},"details[open] > summary":{borderBottom:"1px solid ".concat(s.TV.backgroundHighest),marginBottom:s.TV.space16,paddingBottom:s.TV.space16},hr:{height:1,backgroundColor:s.TV.backgroundHigher,margin:"".concat(s.TV.space24," 0"),border:0}}),allowedElements:T,remarkPlugins:[b.Ic,Z.Z,w.Z,_.Z],linkTarget:"_blank",rehypePlugins:[k.Z],components:{code:r,img:S.Z},children:t})})}),I=n(44680),D=n(31900),G=n(52682),B=n(93295),P=n(23982),A=n(55846),N=n(13440);function U(){var e=(0,B._)(["\n  mutation DeleteThreadMessage($id: String!) {\n    deleteThreadMessage(messageId: $id) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return U=function(){return e},e}var L={},O=(0,P.Ps)(U(),A.j7),X=n(15542),M=n(55534),F=n(25425),W=(0,o.memo)(function(e){var t,n=e.thread,m=e.message,y=(0,X.d)(),b=(0,M.Z)().showError,Z=(0,r._)((t=(0,g._)({},L,{onError:function(e){b(e.message)},onCompleted:function(e){var t;(null===(t=e.deleteThreadMessage)||void 0===t?void 0:t.__typename)==="UserError"&&b(e.deleteThreadMessage.message)}}),N.D(O,t)),2),w=Z[0],x=Z[1].loading,C=(0,F.P5)({controlName:"flag-threads-dropdown-menu",default:!1,type:"boolean",logFlagToAnalytics:!1}),_=!!(n&&n.indexStart===n.indexEnd),k={statusBanner:{resolved:"Thread resolved. Re-open it any time in the inbox.",unresolved:"Thread re-opened"},outdated:"Outdated",outdatedTooltip:"The code has changed since the comment was left"},S=o.useMemo(function(){return{diff:(0,p.Y)(m.timeCreated),full:(0,p.u)(m.timeCreated)}},[m]);if(!m.user)return null;var E=y===m.user.id?[{label:"Delete",icon:(0,i.tZ)(G.Z,{}),isDestructive:!0}]:[];return(0,i.BX)(c.G,{children:[(0,i.BX)(c.G,{css:[s.l0.flex.row,s.l0.justify.spaceBetween,s.l0.pb(4)],children:[(0,i.BX)(c.G,{css:[s.l0.flex.row,s.l0.align.center,s.l0.rowWithGap(8)],children:[(0,i.tZ)(v(),{legacyBehavior:!0,passHref:!0,href:"/@".concat(m.user.username),children:(0,i.tZ)("a",{children:(0,i.tZ)(l.n,{small:!0,src:m.user.image,username:m.user.username})})}),(0,i.tZ)("p",{children:(0,i.tZ)(d.u,{tooltip:S.full,placement:"top",children:(0,i.tZ)(f.xv,{variant:"small",color:"dimmer",multiline:!1,children:S.diff})})}),E.length>0&&C?(0,i.tZ)(D.Z,{items:E,onItemClick:function(e){"Delete"!==e.label||x||w({variables:{id:m.id}})},label:"More"}):null]}),_?(0,i.tZ)(d.u,{tooltip:k.outdatedTooltip,children:(0,i.tZ)(u.D,{colorway:"negative",text:k.outdated})}):null]}),"StatusMessageContentType"===m.content.__typename&&"resolved"===m.content.status?(0,i.tZ)(a.E,{colorway:"positive",icon:(0,i.tZ)(h.Z,{}),text:k.statusBanner.resolved}):null,"StatusMessageContentType"===m.content.__typename&&"unresolved"===m.content.status?(0,i.tZ)(a.E,{colorway:"primary",icon:(0,i.tZ)(I.Z,{}),text:k.statusBanner.unresolved}):null,"TextMessageContentType"===m.content.__typename&&(0,i.tZ)(R,{content:m.content.text})]})})},80839:function(e,t,n){n.d(t,{Y:function(){return o},u:function(){return a}});var r=n(57526),i=n(11486),o=function(e){var t=new Date(e),n=new Date;return 60>(0,i.Z)(n,t)?"just now":(0,r.F)(t,!0)+" ago"},a=function(e){return new Date(e).toLocaleString()}},14648:function(e,t,n){n.d(t,{Z:function(){return ey}});var r=n(32477),i=n(8182),o=n(43429),a=n(46689),l=n(9617),c=n(99656),s=n(50782),u=n(88936),d=n(45903),f=n(25e3),h=n(79962),p=n(58003),m=n(79217),v=n(49344),g=n(56596),y=n(29287),b=n(74833),Z=n(1498),w=n(70002),x=n(55534),C=n(92611),_=n(44680),k=n(94450),S=n.n(k),E=n(38265),T=n(84357),R=n(20142),I=n(81013),D=T.q6.define();function G(e){var t=e.editorRef,n=e.onChange,r=e.placeholder,a=e.skeleton,l=e.language,c=e.skeletonClosingBracket,s=e.indentSize,u=(0,I.Z)(),d=u.ref,f=u.view,h=o.useRef(a?"".concat(a,"\n"):""),p=c?"\n".concat(c):"",m=" ".repeat(void 0===s?2:s);return o.useEffect(function(){if(f&&f.state.doc.length){var e=h.current;h.current=a?"".concat(a,"\n"):"",f.dispatch({changes:{from:0,to:e.length-1,insert:a},annotations:[T.YW.addToHistory.of(!1),D.of(!0)]})}},[f,a]),o.useEffect(function(){if(f){var e=T.yy.changeFilter.of(function(e){return!!e.annotation(D)||[-1,h.current.length,e.startState.doc.length-p.length,e.startState.doc.length+1]}),i=E.tk.updateListener.of(function(e){var t=e.state.doc.slice(h.current.length,e.state.doc.toString().length-p.length).toString();if(t!=="".concat(m).concat(r,"\n").concat(m)?n(t):n(""),e.docChanged&&e.state.doc.length===h.current.length+p.length){var i="\n"+m;f.dispatch({changes:{from:h.current.length-1,insert:"\n"+m},selection:{anchor:h.current.length+i.length-1},annotations:[D.of(!0)]})}}),o="".concat(h.current).concat(m).concat(r,"\n").concat(p);f.dispatch({changes:{from:0,to:f.state.doc.length,insert:o},effects:T.Py.appendConfig.of([e,i]),selection:{anchor:o.length},annotations:T.YW.addToHistory.of(!1)}),t({setValue:function(e){if(e){var t=f.state.doc.toString().length;f.dispatch({changes:{from:h.current.length,to:t-p.length,insert:e},annotations:T.YW.addToHistory.of(!1)})}},focus:function(){return f.focus()}})}},[n,l,f,p,t,r,m]),(0,i.BX)("div",{className:"jsx-c0a72647b9c20ef editor",children:[(0,i.tZ)(R.ZP,{ref:d,language:l,indentSize:2,fontSize:14,indentIsSpaces:!0}),(0,i.tZ)(S(),{id:"c0a72647b9c20ef",children:".editor.jsx-c0a72647b9c20ef{overflow:auto;position:absolute;width:100%;height:100%}.loader.jsx-c0a72647b9c20ef{height:100%;width:100%;z-index:5}"})]})}var B=n(59868),P=n(32377);function A(e){var t,n,a,l,c=e.isOpen,u=e.meta,p=e.language,w=e.hasMetadata,_=e.onClose,k=(0,s.Z)(),S=(0,x.Z)().showConfirm,E=(0,r._)(o.useState(null),2),T=E[0],R=E[1],I=(0,r._)(o.useState(!0),2),D=I[0],G=I[1],A=(0,r._)(o.useState((null==u?void 0:u.initialization)||""),2),X=A[0],M=A[1],F=(0,r._)(o.useState((null==u?void 0:u.imports)||""),2),W=F[0],H=F[1],V=(0,r._)(o.useState((null==u?void 0:u.setup)||""),2),z=V[0],j=V[1],q=(0,r._)(o.useState((null==u?void 0:u.tearDown)||""),2),Y=q[0],$=q[1],J=(0,r._)((0,h.rU)({onError:function(e){return R(e.message)},update:function(e,t){var n,r=null===(n=t.data)||void 0===n?void 0:n.createReplUnitTestMeta;r&&("UserError"===r.__typename?R(r.message):"ReplUnitTestMeta"===r.__typename&&(e.modify({id:e.identify({__typename:"Repl",id:k}),fields:{unitTests:function(t){var n=e.writeFragment({data:r,fragment:h.aA});return t?(0,f._)((0,d._)({},t),{meta:(0,d._)({},n)}):{__typename:"ReplUnitTestsWithMeta",meta:n,tests:[]}}}}),S("Setup saved!"),_()))}}),2),K=J[0],Q=J[1],ee=(0,r._)((0,h.AF)({onError:function(e){return R(e.message)},onCompleted:function(e){var t=e.updateReplUnitTestMeta;t&&("UserError"===t.__typename?R(t.message):"ReplUnitTestMeta"===t.__typename&&(S("Imports updated!"),_()))}}),2),et=ee[0],en=ee[1],er=(0,C.x)(p),ei=W!==(null==u?void 0:u.imports)||X!==(null==u?void 0:u.initialization)||z!==(null==u?void 0:u.setup)||Y!==(null==u?void 0:u.tearDown),eo=Q.loading||en.loading;return(0,i.tZ)(v.u,{isOpen:c,onRequestClose:_,maxWidth:872,children:(0,i.BX)(g.G,{css:[y.l0.colWithGap(24)],children:[(0,i.tZ)(b.h4,{level:1,variant:"headerDefault",children:"Setup"}),(0,i.tZ)(N,{unitTestsLib:er,onChange:H,language:p,initialValue:null!==(t=null==u?void 0:u.imports)&&void 0!==t?t:""}),(0,i.tZ)(g.G,{onClick:function(){return G(!D)},css:{cursor:"pointer"},children:(0,i.BX)(g.G,{css:[y.l0.rowWithGap(8),y.l0.align.center],children:[(0,i.tZ)(b.h4,{level:2,variant:"headerDefault",children:"Advanced"}),(0,i.tZ)(m.Z,{color:"var(--foreground-default)",size:20,rotate:D?270:0})]})}),D?null:(0,i.BX)(g.G,{css:[y.l0.colWithGap(8)],children:[(0,i.tZ)(U,{unitTestsLib:er,onChange:M,language:p,initialValue:null!==(n=null==u?void 0:u.initialization)&&void 0!==n?n:""}),(0,i.tZ)(L,{unitTestsLib:er,onChange:j,language:p,initialValue:null!==(a=null==u?void 0:u.setup)&&void 0!==a?a:""}),(0,i.tZ)(O,{unitTestsLib:er,onChange:$,language:p,initialValue:null!==(l=null==u?void 0:u.tearDown)&&void 0!==l?l:""})]}),(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.justify.spaceBetween],children:[(0,i.tZ)(b.xv,{css:[y.l0.color.accentNegativeStronger],children:T}),(0,i.BX)(g.G,{css:[y.l0.rowWithGap(12)],children:[(0,i.tZ)(Z.zx,{disabled:eo,onClick:_,text:"Cancel"}),(0,i.tZ)(Z.zx,{colorway:"primary",disabled:!ei||eo,onClick:function(){(0,B.j)(B.U3.REPL_UNIT_TEST_USED,{action:"modifiedSetup"}),w?et({variables:{input:{initialization:X,imports:W,setup:z,tearDown:Y,replId:k}}}):K({variables:{input:{initialization:X,imports:W,setup:z,tearDown:Y,replId:k}}})},iconLeft:(0,i.tZ)(P.Z,{}),text:"".concat(eo?"Saving...":"Save")})]})]})]})})}function N(e){var t=e.unitTestsLib,n=e.onChange,a=e.language,l=e.initialValue,c=(0,r._)(o.useState(null),2),s=c[0],u=c[1];o.useEffect(function(){s&&(s.setValue(l),s.focus())},[s,l]);var d=t.defaultImports().trim();return(0,i.BX)(g.G,{css:[y.l0.colWithGap(8)],children:[(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.justify.spaceBetween,y.l0.align.center],children:[(0,i.tZ)(b.h4,{level:2,variant:"subheadDefault",children:"Imports"}),(0,i.tZ)(w.Z,{iconLeft:(0,i.tZ)(_.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(g.G,{css:[y.l0.backgroundColor.backgroundDefault,y.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(g.G,{css:[y.l0.borderRadius(8),y.l0.height(200),y.l0.position.relative],children:(0,i.tZ)(G,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add imports here"),editorRef:u,language:a,skeleton:d,skeletonClosingBracket:"",indentSize:0})})})]})}function U(e){var t=e.unitTestsLib,n=e.onChange,a=e.language,l=e.initialValue,c=(0,r._)(o.useState(null),2),s=c[0],u=c[1];o.useEffect(function(){s&&s.setValue(l)},[s,l]);var d=t.classConstructorName();return(0,i.BX)(g.G,{css:[y.l0.colWithGap(8)],children:[(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.justify.spaceBetween,y.l0.align.center],children:[(0,i.tZ)(b.h4,{level:2,variant:"subheadDefault",children:"Initialization"}),(0,i.tZ)(w.Z,{iconLeft:(0,i.tZ)(_.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),d?(0,i.BX)(b.xv,{children:["Hint: constructor name is ",(0,i.tZ)("code",{children:d}),"."]}):null,(0,i.tZ)(g.G,{css:[y.l0.backgroundColor.backgroundDefault,y.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(g.G,{css:[y.l0.borderRadius(8),y.l0.height(200),y.l0.position.relative],children:(0,i.tZ)(G,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add initialization code here"),editorRef:u,language:a,skeleton:"",skeletonClosingBracket:"",indentSize:0})})})]})}function L(e){var t=e.unitTestsLib,n=e.onChange,a=e.language,l=e.initialValue,c=(0,r._)(o.useState(null),2),s=c[0],u=c[1];o.useEffect(function(){s&&s.setValue(l)},[s,l]);var d=t.setupIntro().trim();return(0,i.BX)(g.G,{css:[y.l0.colWithGap(8)],children:[(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.justify.spaceBetween,y.l0.align.center],children:[(0,i.tZ)(b.h4,{level:2,variant:"subheadDefault",children:"Setup"}),(0,i.tZ)(w.Z,{iconLeft:(0,i.tZ)(_.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(g.G,{css:[y.l0.backgroundColor.backgroundDefault,y.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(g.G,{css:[y.l0.borderRadius(8),y.l0.height(200),y.l0.position.relative],children:(0,i.tZ)(G,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add setup code here"),editorRef:u,language:a,skeleton:d,skeletonClosingBracket:t.hasClosingBrackets()?t.getClosingBrackets():""})})})]})}function O(e){var t=e.unitTestsLib,n=e.onChange,a=e.language,l=e.initialValue,c=(0,r._)(o.useState(null),2),s=c[0],u=c[1];o.useEffect(function(){s&&s.setValue(l)},[s,l]);var d=t.tearDownIntro().trim();return(0,i.BX)(g.G,{css:[y.l0.colWithGap(8)],children:[(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.justify.spaceBetween,y.l0.align.center],children:[(0,i.tZ)(b.h4,{level:2,variant:"subheadDefault",children:"Teardown"}),(0,i.tZ)(w.Z,{iconLeft:(0,i.tZ)(_.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(g.G,{css:[y.l0.backgroundColor.backgroundDefault,y.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(g.G,{css:[y.l0.borderRadius(8),y.l0.height(200),y.l0.position.relative],children:(0,i.tZ)(G,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add teardown code here"),editorRef:u,language:a,skeleton:d,skeletonClosingBracket:t.hasClosingBrackets()?t.getClosingBrackets():""})})})]})}var X=function(e){var t=e.language,n=e.meta,a=(0,r._)(o.useState(!1),2),l=a[0],c=a[1];return(0,i.BX)(i.HY,{children:[(0,i.tZ)(Z.zx,{iconLeft:(0,i.tZ)(p.Z,{}),onClick:function(){return c(!0)},text:"Setup"}),(0,i.tZ)(A,{language:t,isOpen:l,onClose:function(){return c(!1)},hasMetadata:!!(null==n?void 0:n.id),meta:n})]})},M=n(21289),F=n(75582),W=n(2158),H=n(52924),V=n(52682),z=n(58719),j=n(85508),q=n(18836),Y=n(15146),$=n(26338),J=n(72310),K=n(34142),Q=n(87682),ee=n(48900),et=n(15250),en=n(54916),er=n(59109),ei=n(18107),eo="\x1b[0;31m",ea="\x1b[0m",el=["","","","","","","","","","","","","","","",""];function ec(e){var t=e.name,n=e.failureMessage,r=e.stack;return"	".concat(eo).concat(t).concat(ea,"\r").concat(n?"\nMessage: ".concat(n,"\r"):"","\nStack Trace:\r\n").concat(r.replace(/\n/g,"\r\n"),"\n\r\n\r\n")}var es=function(e){var t,n,a=e.language,l=e.unitTests,c=e.onResult,s=e.trackingContext,u=e.getRunnerOutput,f=(0,r._)(o.useState(!1),2),h=f[0],p=f[1],m=(0,en.Z)(),v=m.container,y=m.packager,b=m.fs,w=null,x=u(),_=x&&void 0!==x.startBlock&&void 0!==x.endBlock&&void 0!==x.writeOutputToBlock&&void 0!==x.writeErrorToBlock,k=function(){p(!1),(0,er.WT)(b),w&&(w.stopLogSpinner(),w.finish(),w=null)},S=(t=(0,K._)(function(){var e,t,n,r,i,o,u,f,m,g,Z,S,E,T,R,I,D,G,P,A,N,U,L,O;return(0,Q.Jh)(this,function(X){switch(X.label){case 0:if(h)return[2];if(t=null,w={startLogSpinner:function(e){if(t)throw Error("A spinner is already active! call stopSpinner first or use the update callback to update the active spinner's message.");var n=e,r=0;return t=setInterval(function(){var e=el[++r%el.length];if(!w)throw Error("Expected logger");w.clearLine(),w.logMessage(e+" "+n)},100),function(e){n=e}},stopLogSpinner:function(){t&&clearInterval(t),t=null},finish:function(){if(_&&e){var t;null==x||null===(t=x.endBlock)||void 0===t||t.call(x,e)}},logMessage:function(t){var n,r;if(_&&e){null==x||null===(r=x.writeOutputToBlock)||void 0===r||r.call(x,e,t);return}null==x||null===(n=x.write)||void 0===n||n.call(x,t)},logError:function(t){if(_&&e){var n;null==x||null===(n=x.writeErrorToBlock)||void 0===n||n.call(x,e,t)}},clearLogs:function(){var e;_||(null==x||null===(e=x.clear)||void 0===e||e.call(x),null==w||w.logMessage("\r\n"))},clearLine:function(){if(!w)throw Error("Expected logger");w.logMessage("\x1b[1K\r")}},!l)throw Error("Run button should not be active if there are no tests");return p(!0),(0,B.j)(B.U3.REPL_UNIT_TEST_USED,{trackingData:{context:s},action:"ranTests"}),w.clearLogs(),_&&(e=null==x?void 0:null===(n=x.startBlock)||void 0===n?void 0:n.call(x,ei.kH.UNIT_TEST).id),[4,(r=(0,C.x)(a)).buildAndRunTests((0,d._)({container:v,fs:b,packager:y,logger:w},l))];case 1:if(i=X.sent(),w.stopLogSpinner(),w.clearLine(),w.clearLogs(),null!==i.error)return w.logMessage("".concat(eo).concat(i.error).concat(ea,"\r\n")),k(),l.tests.map(function(e){return{testId:e.id,didPass:!1}}),[2];if(o=i.result.passed?[]:i.result.failures.map(function(e){return r.parseTestResultName(e.name)}),u=[],f=l.tests.map(function(e){return r.getProperTestName(e.name)}),(m=o.filter(function(e){return!f.includes(e)})).length)Z=m[0],S=i.result.failures[0].stack,w.logMessage(ec({name:Z,failureMessage:"The following error occurred but was not related to a single unit test",stack:S})),w.logError("Testing failed"),(g=u).push.apply(g,(0,M._)(l.tests.map(function(e){return{testId:e.id,didPass:!1}})));else{E=!0,T=!1,R=void 0;try{for(I=l.tests[Symbol.iterator]();!(E=(D=I.next()).done);E=!0){if(G=D.value,P=r.getProperTestName(G.name),A=o.indexOf(P),N=-1===A,u.push({testId:G.id,didPass:N}),N){w.logMessage("	".concat("\x1b[0;32m").concat(P).concat(ea,"\r\n\r\n"));continue}U=i.result.failures[A].stack,w.logMessage(ec({name:P,failureMessage:G.failureMessage,stack:U})),w.logError('Test "'.concat(P,'" failed'))}}catch(e){T=!0,R=e}finally{try{E||null==I.return||I.return()}finally{if(T)throw R}}}if(c(u),L=l.tests.length,i.result.passed)return w.logMessage("".concat("\x1b[48;5;22m","  All tests have passed ").concat(L,"/").concat(L,"  ").concat(ea,"\r\n")),k(),[2];return O=L-i.result.failures.length,w.logMessage("".concat("\x1b[48;5;88m","  ").concat(O,"/").concat(L," passed, see errors above  ").concat(ea)),k(),[2]}})}),function(){return t.apply(this,arguments)}),E=(n=(0,K._)(function(){return(0,Q.Jh)(this,function(e){try{S()}catch(e){ee.$e(function(t){t.setTag("unittestsrun","true"),ee.Tb(e)}),w&&(w.logMessage("\r\n".concat(eo," Sorry, we have failed to run your tests. Please try again or contact support. ").concat(ea,"\r\n")),w.logError("Running tests failed")),k()}return[2]})}),function(){return n.apply(this,arguments)});return l&&l.tests.length>0?(0,i.tZ)(g.G,{children:(0,i.tZ)(Z.zx,{disabled:h,colorway:"primary",iconLeft:(0,i.tZ)(et.Z,{}),onClick:E,text:h?"Running tests...":"Run tests"})}):null},eu=n(95891);function ed(e){var t=e.isOpen,n=e.test,a=e.language,l=e.onClose,u=e.trackingContext,p=(0,s.Z)(),m=(0,x.Z)().showConfirm,_=(0,r._)(o.useState(null),2),k=_[0],S=_[1],E=(0,r._)(o.useState(""),2),T=E[0],R=E[1],I=(0,r._)(o.useState(""),2),D=I[0],A=I[1],N=(0,r._)(o.useState(""),2),U=N[0],L=N[1],O=(0,r._)((0,h.Hd)({onError:function(e){return L(e.message)},update:function(e,t){var n,r=null===(n=t.data)||void 0===n?void 0:n.createReplUnitTest;r&&("UserError"===r.__typename?L(r.message):"ReplUnitTest"===r.__typename&&(e.modify({id:e.identify({__typename:"Repl",id:p}),fields:{unitTests:function(t){var n=e.writeFragment({data:r,fragment:h.Rb});return t?(0,f._)((0,d._)({},t),{tests:(0,M._)(t.tests).concat([n])}):{__typename:"ReplUnitTestsWithMeta",meta:null,tests:[n]}}}}),m("Test created!"),l()))}}),2),X=O[0],F=O[1],H=(0,r._)((0,h.kO)({onError:function(e){return L(e.message)},onCompleted:function(e){var t=e.updateReplUnitTest;t&&("UserError"===t.__typename?L(t.message):"ReplUnitTest"===t.__typename&&(m("Test updated!"),l()))}}),2),V=H[0],Y=H[1],K=(0,J.Y)("",function(e){return e.length<=0?{message:"Must include test name"}:e.trim().split(" ").length>1?{message:"Test name must only be one word"}:void 0});o.useEffect(function(){K.setValue((null==n?void 0:n.name)||"",{preventTouch:!0}),A((null==n?void 0:n.failureMessage)||""),R((null==n?void 0:n.code)||""),k&&k.setValue((null==n?void 0:n.code)||"")},[n,k]),o.useEffect(function(){L("")},[T,L]);var Q=(0,C.x)(a),ee="".concat(Q.getCommentChar()," Enter code here"),et=!n||n.name!==K.value||n.code!==T||n.failureMessage!==D,en=F.loading||Y.loading,er=Q.testIntro(K.value||""),ei=Q.hasClosingBrackets()?Q.getClosingBrackets():"",eo=(0,r._)(o.useState(!1),2),ea=eo[0],el=eo[1],ec=function(){k&&(k.setValue("  "+Q.exampleTest.code),k.focus()),R(Q.exampleTest.code)};return(0,i.tZ)(v.u,{isOpen:t,onRequestClose:l,maxWidth:872,children:(0,i.BX)(g.G,{css:[y.l0.colWithGap(24)],children:[(0,i.tZ)(b.h4,{level:1,variant:"headerDefault",children:"New unit test"}),(0,i.BX)(g.G,{css:[y.l0.colWithGap(8)],children:[(0,i.tZ)("label",{htmlFor:"name",children:(0,i.tZ)(b.h4,{level:2,variant:"subheadDefault",children:"Name"})}),(0,i.tZ)($.Z,{id:"name",label:"Test name",status:null,autoFocus:!0,required:!0,value:K.value,isValid:K.isValid,error:K.error,warning:K.warning,touched:K.touched,onChange:function(e){K.setValue(e.target.value)},placeholder:"Enter test name here"})]}),(0,i.BX)(g.G,{css:[y.l0.colWithGap(8)],children:[(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.align.center,y.l0.justify.spaceBetween],children:[(0,i.tZ)(b.h4,{level:2,variant:"subheadDefault",children:"Code"}),(0,i.BX)(g.G,{css:[y.l0.rowWithGap(4)],children:[(0,i.BX)(eu.Z,{isOpen:ea,onClickOutside:function(){return el(!1)},placement:"bottom-end",children:[(0,i.tZ)(Z.zx,{iconLeft:(0,i.tZ)(W.Z,{}),size:"small",variant:"outlined",text:"View an example",onClick:function(){if([ee,Q.exampleTest.code].includes(T.trim())){ec();return}el(!0)}}),(0,i.BX)(g.G,{children:["This will overwrite your current test. Are you sure?",(0,i.BX)(g.G,{css:[y.l0.rowWithGap(4),y.l0.pt(8)],children:[" ",(0,i.tZ)(Z.zx,{text:"No, go back",size:"small",iconLeft:(0,i.tZ)(z.Z,{}),onClick:function(){el(!1)}}),(0,i.tZ)(Z.zx,{text:"Yes, delete test",colorway:"negative",size:"small",iconLeft:(0,i.tZ)(P.Z,{}),onClick:function(){ec(),el(!1)}})]})]})]}),(0,i.tZ)(w.Z,{iconLeft:(0,i.tZ)(j.Z,{}),size:"small",variant:"outlined",text:"View docs",target:"_blank",href:"https://docs.replit.com/teams-edu/unit-testing"})]})]}),(0,i.tZ)(g.G,{css:[y.l0.backgroundColor.backgroundDefault,y.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(g.G,{css:[y.l0.borderRadius(8),y.l0.height(200),y.l0.position.relative],children:(0,i.tZ)(G,{skeleton:er,skeletonClosingBracket:ei,language:a,editorRef:S,onChange:R,placeholder:ee})})})]}),(0,i.BX)(g.G,{css:[y.l0.colWithGap(8)],children:[(0,i.tZ)(b.h4,{level:2,variant:"subheadDefault",children:"Failure message"}),(0,i.tZ)(q.II,{value:D,onChange:function(e){return A(e.target.value)},placeholder:"This will be displayed on test failure"})]}),(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.align.center,y.l0.justify.spaceBetween],children:[(0,i.tZ)(b.xv,{css:[y.l0.color.accentNegativeStronger],multiline:!1,children:U}),(0,i.BX)(g.G,{css:[y.l0.rowWithGap(12)],children:[(0,i.tZ)(Z.zx,{text:"Cancel",onClick:l}),(0,i.tZ)(Z.zx,{text:"".concat(en?"Creating test...":"Create test"),iconLeft:(0,i.tZ)(c.Z,{}),colorway:"primary",disabled:!et||en,onClick:function(){if(!K.validate()){if(T.length<=0){L("Test cannot be empty");return}n?(V({variables:{input:{name:K.value,code:T,failureMessage:D,testId:n.id}}}),(0,B.j)(B.U3.REPL_UNIT_TEST_USED,{trackingData:{context:u},action:"modifiedTest"})):(X({variables:{input:{name:K.value,code:T,failureMessage:D,replId:p}}}),(0,B.j)(B.U3.REPL_UNIT_TEST_USED,{trackingData:{context:u},action:"addedTest"}))}}})]})]})]})})}function ef(e){var t=e.testId,n=e.onClose,a=(0,x.Z)().showConfirm,l=(0,s.Z)(),c=(0,r._)((0,h.IV)({onError:function(e){return C(e.message)},update:function(e,r){var i,o=null===(i=r.data)||void 0===i?void 0:i.deleteReplUnitTest;o&&("UserError"===o.__typename?C(o.message):"ReplUnitTest"===o.__typename&&t&&(e.modify({id:e.identify({__typename:"Repl",id:l}),fields:{unitTests:function(e,n){var r=n.readField,i=e.tests.filter(function(e){return r("id",e)!==t});return(0,f._)((0,d._)({},e),{tests:(0,M._)(i)})}}}),(0,B.j)(B.U3.REPL_UNIT_TEST_USED,{action:"removedTest"}),a("Test deleted!"),n()))}}),2),u=c[0],p=c[1],m=(0,r._)(o.useState(""),2),w=m[0],C=m[1];return(0,i.tZ)(v.u,{isOpen:!!t,onRequestClose:n,children:(0,i.BX)(g.G,{css:[y.l0.colWithGap(24)],children:[(0,i.tZ)(b.h4,{level:1,variant:"headerDefault",children:"Delete test?"}),(0,i.tZ)(b.xv,{children:"Are you sure you want to delete this test? This cannot be undone."}),(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.justify.spaceBetween,y.l0.align.center],children:[(0,i.tZ)(b.xv,{css:[y.l0.color.accentNegativeStronger],children:w}),(0,i.BX)(g.G,{css:[y.l0.rowWithGap(12),y.l0.justify.end],children:[(0,i.tZ)(Z.zx,{text:"Cancel",disabled:p.loading,onClick:n}),(0,i.tZ)(Z.zx,{text:"Yes, delete this test",colorway:"negative",iconLeft:(0,i.tZ)(V.Z,{}),disabled:p.loading,onClick:function(){if(!t)throw Error("Expected a testId");u({variables:{testId:t}})}})]})]})]})})}var eh=function(e){var t=e.unitTests,n=e.isAddingTest,a=e.onClose,l=e.language,u=e.canWrite,d=e.trackingContext,f=void 0===d?"default":d,p=e.getRunnerOutput,m=(0,r._)(o.useState(n),2),v=m[0],w=m[1],x=(0,r._)(o.useState(null),2),C=x[0],_=x[1],k=(0,r._)(o.useState(null),2),E=k[0],T=k[1],R=(0,s.Z)(),I=(0,r._)((0,h.lQ)(),1)[0],D=(null==t?void 0:t.tests)||[];return(0,i.BX)(g.G,{css:[y.l0.colWithGap(16)],children:[(0,i.tZ)(es,{language:l,unitTests:t,onResult:function(e){I({variables:{input:{replId:R,results:e},replId:R}})},getRunnerOutput:p,trackingContext:f}),D.length>0?(0,i.tZ)(g.G,{css:[y.l0.colWithGap(8),y.l0.align.center],children:D.map(function(e){var t,n;return(null===(t=e.lastRun)||void 0===t?void 0:t.__typename)==="ReplUnitTestLastRun"&&(e.lastRun.status===F.$I.Passed?n="passed-test":e.lastRun.status===F.$I.Failed&&(n="failed-test")),(0,i.tZ)(g.G,{className:"test ".concat(n),css:{width:"100%"},children:(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.justify.spaceBetween,y.l0.align.center,y.l0.p(8),y.l0.borderRadius(8),{border:"1px solid var(--background-highest);"}],children:[(0,i.tZ)(b.xv,{multiline:!1,children:e.name}),u?(0,i.BX)(g.G,{css:[y.l0.rowWithGap(8)],children:[(0,i.tZ)(Y.hU,{onClick:function(){_(e)},alt:"Edit",children:(0,i.tZ)(H.Z,{})}),(0,i.tZ)(Y.hU,{onClick:function(){T(e.id)},alt:"Delete",children:(0,i.tZ)(V.Z,{})})]}):null]})},e.id)})}):(0,i.BX)(g.G,{css:[y.l0.colWithGap(8),y.l0.align.center],children:[(0,i.tZ)(b.xv,{css:[y.l0.textAlign.center],children:"Looks like you dont have any tests yet!"}),u?(0,i.tZ)(Z.zx,{text:"Add test",onClick:function(){return w(!0)},iconLeft:(0,i.tZ)(c.Z,{})}):null]}),(0,i.tZ)(ed,{isOpen:v||!!C||n,test:C,language:l,onClose:function(){_(null),w(!1),a&&a()},trackingContext:f}),(0,i.tZ)(ef,{testId:E,onClose:function(){return T(null)}}),(0,i.tZ)(S(),{id:"a2df1ed8108a6cad",children:".tests-wrapper.jsx-a2df1ed8108a6cad{-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);padding:var(--space-16)0;width:100%}.test.jsx-a2df1ed8108a6cad{padding:var(--space-8)var(--space-8);border:1px solid var(--outline-dimmest);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4)}.passed-test.jsx-a2df1ed8108a6cad{border-color:var(--accent-positive-default);background:var(--accent-positive-dimmer)}.failed-test.jsx-a2df1ed8108a6cad{border-color:var(--accent-negative-default);background:var(--accent-negative-dimmer)}"})]})},ep=n(83848),em=n(73722),ev=function(e){var t=e.onClick,n=e.hasTests,r=n?{"aria-label":"Delete all tests to switch test type","data-microtip-position":"bottom","data-microtip-size":"medium",role:"tooltip"}:{};return(0,i.BX)("div",(0,f._)((0,d._)({},r),{className:"jsx-44786ca38dd3aa42 "+(r&&null!=r.className&&r.className||"back-button"),children:[(0,i.tZ)(ep.Z,{filled:!1,border:!1,size:"small",Icon:em.Z,onClick:t,disabled:n,children:"Switch test type"}),(0,i.tZ)(S(),{id:"44786ca38dd3aa42",children:".back-button.jsx-44786ca38dd3aa42{width:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}"})]}))},eg=n(31593),ey=function(e){var t,n,d,f,h=e.onBack,p=e.getRunnerOutput,m=(0,s.Z)(),v=(0,r._)(o.useState(!1),2),Z=v[0],w=v[1],x=(0,eg.Z)(),C=x.language,_=x.isLoading,k=(0,a.CH)({variables:{replId:m}}),S=null===(t=k.data)||void 0===t?void 0:t.repl;if(k.loading||_)return(0,i.tZ)(g.G,{css:[y.l0.backgroundColor.backgroundDefault,y.l0.flex.row,y.l0.align.center,y.l0.justify.center,y.l0.p(16)],children:(0,i.tZ)(u.Z,{})});if(!S||"Repl"!==S.__typename)return(0,i.tZ)(g.G,{css:[y.l0.p(16)],children:(0,i.tZ)(b.xv,{css:{textAlign:"center"},children:"Unable to fetch tests, please try again."})});if(!C)return(0,i.tZ)(g.G,{css:[y.l0.p(16)],children:(0,i.tZ)(b.xv,{css:{textAlign:"center"},children:"Unit tests are currently only supported in Java, Python, and Node.js Repls."})});var E="default";(null==S?void 0:S.isProject)?E="project_repl":(null==S?void 0:S.isProjectFork)&&(E="submission_repl");var T=!!((null===(n=S.unitTests)||void 0===n?void 0:n.tests)&&S.unitTests.tests.length>0);return(null==S?void 0:null===(d=S.currentUserPermissions)||void 0===d?void 0:d.writeTests)?(0,i.BX)(g.G,{css:[y.l0.colWithGap(16),y.l0.align.center],children:[(0,i.BX)(g.G,{css:[y.l0.flex.row,y.l0.justify.spaceBetween,y.l0.align.center,{width:"100%"}],children:[(0,i.tZ)(l.Z,{truncate:!0,level:4,children:"Unit tests"}),(0,i.tZ)(Y.hU,{alt:"Add test",size:32,onClick:function(){return w(!0)},children:(0,i.tZ)(c.Z,{})})]}),(0,i.BX)(g.G,{css:[y.l0.colWithGap(8),y.l0.maxWidth(256),{width:"80%"}],children:[(0,i.tZ)(X,{language:C,meta:(null===(f=S.unitTests)||void 0===f?void 0:f.meta)||null}),(0,i.tZ)(eh,{isAddingTest:Z,unitTests:(null==S?void 0:S.unitTests)||null,onClose:function(){return w(!1)},language:C,canWrite:!0,trackingContext:E,getRunnerOutput:p}),h?(0,i.tZ)(ev,{hasTests:T,onClick:h}):null]})]}):(0,i.BX)(g.G,{css:[y.l0.colWithGap(16)],children:[(0,i.tZ)(b.h4,{level:1,variant:"headerDefault",children:"Unit tests"}),(0,i.tZ)(g.G,{css:{width:"100%",overflowY:"auto"},children:(0,i.tZ)(eh,{unitTests:(null==S?void 0:S.unitTests)||null,language:C,isAddingTest:!1,canWrite:!1,trackingContext:E,getRunnerOutput:p})})]})}},92611:function(e,t,n){n.d(t,{x:function(){return E},y:function(){return S}});var r=n(34142),i=n(21289),o=n(87682),a=n(48900),l=n(59868),c=n(23026),s=function(){"use strict";function e(t){(0,c._)(this,e),this.code="",this.currentIndent=0,this.lib=t}var t=e.prototype;return t.indent=function(){this.currentIndent+=1},t.dedent=function(){if(0===this.currentIndent)throw Error("indent at zero");this.currentIndent-=1},t.addIndents=function(){for(var e=0;e<this.currentIndent;e++)this.code+="  "},t.push=function(e){var t=e.split("\n"),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;this.addIndents(),this.code+=l,this.newLine()}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}},t.newLine=function(){this.code+="\n"},t.closeCurly=function(){this.addIndents(),this.code+=this.lib.getClosingBrackets()},t.toString=function(){return this.code},e}(),u=n(59109),d=n(10653),f={testRunnerName:function(){return"TestRunner"},testSuiteName:function(){return"TestSuite"},defaultImports:function(){return"import org.junit.Before;\nimport org.junit.After;\nimport org.junit.Test;\nimport static org.junit.Assert.*;"},classIntro:function(){return"public class ".concat((0,u.Og)(f.testSuiteName())," {")},classConstructorName:function(){return(0,u.Og)(f.testSuiteName())},setupIntro:function(){return"@Before\npublic void setUp() {"},tearDownIntro:function(){return"@After\npublic void tearDown() {"},testIntro:function(e){return"".concat(f.testIntroPreName()).concat(e).concat(f.testIntroPostName())},testIntroPreName:function(){return"@Test\npublic void "},testIntroPostName:function(){return"() {"},getProperTestName:function(e){return e},parseTestResultName:function(e){return e.replace("(".concat((0,u.Og)(f.testSuiteName()),")"),"")},buildSuite:function(e){var t=e.tests,n=e.meta,r=new s(f);r.push(f.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(f.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),n.setup&&(r.push(f.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()),n.tearDown&&(r.push(f.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;u.code&&(r.push(f.testIntro(u.name)),r.indent(),r.push(u.code),r.dedent(),r.closeCurly(),r.newLine(),r.newLine())}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.dedent(),r.closeCurly(),r.toString()},runSuite:function(e){return v.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=f.buildSuite({tests:o,meta:a});return f.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!0},getClosingBrackets:function(){return"}"},hasSemicolon:function(){return!0},getCommentChar:function(){return"//"},getHelpText:function(){return"no react in this bitch either"},captureSetupError:function(e){var t=e.tag,n=e.raw;a.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","java10"),a.Tb(t)})},exampleTest:{id:-1,failureMessage:"An Adder class should have an add method that adds two ints and returns the result",name:"add",code:"Adder adder = new Adder();\nint result = adder.add(1, 2);\nassertEquals(3, result);\n"}},h="__UNIT_TEST_RESULT_START__",p="__UNIT_TEST_RESULT_END__",m="import org.json.simple.JSONArray;\nimport org.json.simple.JSONObject;\nimport org.junit.runner.JUnitCore;\nimport org.junit.runner.Result;\nimport org.junit.runner.notification.Failure;\n\npublic class ".concat((0,u.Og)(f.testRunnerName())," {\n    public static void main(String[] args) {\n      Result result = JUnitCore.runClasses(").concat((0,u.Og)(f.testSuiteName()),'.class);\n      JSONArray failures = new JSONArray();\n\n        for (Failure failure : result.getFailures()) {\n            JSONObject obj = new JSONObject();\n            obj.put("name", failure.getTestHeader());\n            obj.put("stack", failure.getTrace());\n            failures.add(obj);\n        }\n        JSONObject out = new JSONObject();\n        out.put("passed", result.wasSuccessful());\n        out.put("failures", failures);\n        System.out.println();\n        System.out.println("').concat(h,'");\n        System.out.println(out);\n        System.out.println("').concat(p,'");\n    }\n}');function v(){return(v=(0,r._)(function(e){var t,n,r,a,c,s,v,g,y,b,Z,w,x,C,_,k,S,E,T,R,I;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,a=e.logger,c=e.suiteCode,v=a.startLogSpinner("Setting up the environment"),[4,(0,u.WT)(n)];case 1:return o.sent(),v("Creating your test files 1/2"),[4,(0,u.e3)({fs:n,code:c,filename:"".concat(f.testSuiteName(),".java")})];case 2:if(g=o.sent().error)return f.captureSetupError({tag:"Failed to create suite code file",raw:g}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return v("Creating your test files 2/2"),[4,(0,u.e3)({fs:n,code:m,filename:"".concat(f.testRunnerName(),".java")})];case 3:if(y=o.sent().error)return f.captureSetupError({tag:"Failed to create test runner file",raw:y}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return a.stopLogSpinner(),a.clearLine(),a.logMessage("Installing imported packages\r\n"),[4,r.addPackages([{name:"junit:junit",version:"4.12"},{name:"com.googlecode.json-simple:json-simple",version:"1.1.1"},{name:"org.hamcrest:hamcrest-core",version:"1.3"}])];case 4:return o.sent(),[4,r.installPackages(d.D.active())];case 5:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return a.clearLogs(),v=a.startLogSpinner("Compiling your files"),[4,t.exec("find",".","-type","f","-name","*.java","-print0")];case 6:if(Z=(b=o.sent()).output,w=b.error)return x="Failed to fetch working directory java files",f.captureSetupError({tag:x,raw:w}),[2,{error:"".concat(x,"\r\n\r\n")+(null==Z?void 0:Z.replace(/\n/g,"\n\r"))+"\r\n\r\n"+w}];if("string"!=typeof Z)throw Error("expected working directory files to be a string");return C=Z.slice(0,-1).split("\x00"),_=".:./target/dependency/*",[4,(s=t).exec.apply(s,["javac","-classpath",_,"-d","."].concat((0,i._)(C)))];case 7:if(S=(k=o.sent()).output,E=k.error)return[2,{error:"".concat("Failed to compile test runner file","\r\n\r\n")+(null==S?void 0:S.replace(/\n/g,"\n\r"))+"\r\n\r\n"+E}];return v("Running your tests"),[4,t.exec("java","-classpath",_,(0,u.Og)(f.testRunnerName()))];case 8:if(R=(T=o.sent()).output,I=T.error)return(0,l.j)(l.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==R?void 0:R.replace(/\n/g,"\n\r"))+"\r\n\r\n"+I}];if("string"!=typeof R)throw Error("expected runOutput to be a string");return[2,{result:JSON.parse(R.slice(R.indexOf(h)+h.length,R.lastIndexOf(p))),error:null}]}})})).apply(this,arguments)}var g=function(e){return!!e&&e.trim().length>0&&e.split("\n").some(function(e){return!(e.trim().startsWith("#")||""===e.trim())})},y={testRunnerName:function(){return"test_runner"},testSuiteName:function(){return"test_suite"},defaultImports:function(){return"import unittest\nfrom main import *\n"},classIntro:function(){return"class UnitTests(unittest.TestCase):"},classConstructorName:function(){return"__init__"},setupIntro:function(){return"def setUp(self):"},tearDownIntro:function(){return"def tearDown(self):"},testIntro:function(e){return y.testIntroPreName()+e+y.testIntroPostName()},testIntroPreName:function(){return"def test_"},testIntroPostName:function(){return"(self):"},getProperTestName:function(e){return"test_".concat(e)},parseTestResultName:function(e){return e},buildSuite:function(e){var t=e.tests,n=e.meta,r=new s(y);r.push(y.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(y.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),g(n.setup)&&(r.push(y.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.newLine()),g(n.tearDown)&&(r.push(y.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;r.push(y.testIntro(u.name)),r.indent(),r.push(u.code||"pass"),r.dedent(),r.newLine()}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.toString()},runSuite:function(e){return x.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=y.buildSuite({tests:o,meta:a});return y.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!1},getClosingBrackets:function(){throw Error("This language does not have closing brackets, check `hasClosingBrackets` first")},hasSemicolon:function(){return!1},getCommentChar:function(){return"#"},getHelpText:function(){return"no react in this bitch"},captureSetupError:function(e){var t=e.tag,n=e.raw;a.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","python3"),a.Tb(t)})},exampleTest:{id:-1,failureMessage:"In main.py you should have an add functions that adds two numbers and returns the result",name:"add",code:"self.assertEquals(add(1, 2), 3)"}},b="__UNIT_TEST_RESULT_START__",Z="__UNIT_TEST_RESULT_END__",w="import unittest\nimport ".concat((0,u.Og)(y.testSuiteName()),"\nimport os\nimport json\nfrom time import sleep\n\nsuite = unittest.TestLoader().loadTestsFromTestCase(\n  ").concat((0,u.Og)(y.testSuiteName()),'.UnitTests)\nf = open(os.devnull,"w")\ntest_res = unittest.TextTestRunner(stream=f).run(suite)\n\n# Merge errors and failures and normalize to {name, stack}\nfailures = [\n    {\n        "name": r[0]._testMethodName,\n        "stack": r[1],\n    } for r in test_res.errors + test_res.failures\n]\nprint()\nprint(\'').concat(b,'\')\nsleep(1)\nprint(json.dumps({\n    "passed": test_res.wasSuccessful(),\n    "failures": failures,\n}))\nprint()\nprint(\'').concat(Z,"');");function x(){return(x=(0,r._)(function(e){var t,n,r,i,a,c,s,f,h,p,m;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,i=e.logger,a=e.suiteCode,c=i.startLogSpinner("Setting up the environment"),[4,(0,u.WT)(n)];case 1:return o.sent(),c("Creating your test files 1/2"),[4,(0,u.e3)({fs:n,code:a,filename:"".concat(y.testSuiteName(),".py")})];case 2:if(s=o.sent().error)return y.captureSetupError({tag:"Failed to create suite code file",raw:s}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return c("Creating your test files 2/2"),[4,(0,u.e3)({fs:n,code:w,filename:"".concat(y.testRunnerName(),".py")})];case 3:if(f=o.sent().error)return y.captureSetupError({tag:"Failed to create test runner file",raw:f}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return i.stopLogSpinner(),i.clearLine(),i.logMessage("Installing imported packages\r\n"),[4,r.installPackages(d.D.active())];case 4:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return i.clearLogs(),i.startLogSpinner("Running your tests"),[4,t.exec("python","-B",(0,u.Og)("".concat(y.testRunnerName(),".py")))];case 5:if(p=(h=o.sent()).output,m=h.error)return(0,l.j)(l.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==p?void 0:p.replace(/\n/g,"\n\r"))+"\r\n"+m}];if("string"!=typeof p)throw Error("expected runoutput to be a string");return[2,{result:JSON.parse(p.slice(p.indexOf(b)+b.length,p.lastIndexOf(Z))),error:null}]}})})).apply(this,arguments)}var C={testRunnerName:function(){throw Error("Node test runner uses jest directly")},testSuiteName:function(){return"test_suite"},defaultImports:function(){return"const index = require('./index.js');"},classIntro:function(){return'describe("UnitTests", function() {'},classConstructorName:function(){return null},setupIntro:function(){return"beforeAll(async function() {"},tearDownIntro:function(){return"afterAll(async function() {"},testIntro:function(e){return C.testIntroPreName()+e+C.testIntroPostName()},testIntroPreName:function(){return'test("'},testIntroPostName:function(){return'", async function() {'},getProperTestName:function(e){return e},parseTestResultName:function(e){return e},buildSuite:function(e){var t=e.tests,n=e.meta,r=new s(C);r.push(C.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(C.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),n.setup&&(r.push(C.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()),n.tearDown&&(r.push(C.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;u.code&&(r.push(C.testIntro(u.name)),r.indent(),r.push(u.code),r.dedent(),r.closeCurly(),r.newLine(),r.newLine())}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.dedent(),r.closeCurly(),r.toString()},runSuite:function(e){return _.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=C.buildSuite({tests:o,meta:a});return C.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!0},getClosingBrackets:function(){return"});"},hasSemicolon:function(){return!0},getCommentChar:function(){return"//"},getHelpText:function(){return"no react yet"},captureSetupError:function(e){var t=e.tag,n=e.raw;a.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","nodejs"),a.Tb(t)})},exampleTest:{id:-1,failureMessage:"",name:"add",code:"expect(index.add(1, 2)).toBe(3);"}};function _(){return(_=(0,r._)(function(e){var t,n,r,i,a,c,s,f,h,p,m,v,g,y,b,Z,w,x,_;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,i=e.logger,a=e.suiteCode,c=i.startLogSpinner("Setting up the environment"),[4,(0,u.WT)(n)];case 1:return o.sent(),c("Creating your test files 1/2"),[4,(0,u.e3)({fs:n,code:a,filename:"".concat(C.testSuiteName(),".js")})];case 2:if(s=o.sent().error)return C.captureSetupError({tag:"Failed to create suite code file",raw:s}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return c("Creating your test files 2/2"),f=69,h="jest.config.json",p={testRegex:(0,u.Og)("".concat(C.testSuiteName(),".js")),testEnvironment:"node",testFailureExitCode:f},[4,(0,u.e3)({fs:n,code:JSON.stringify(p),filename:h})];case 3:if(m=o.sent().error)return C.captureSetupError({tag:"Failed to create config file",raw:m}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return i.stopLogSpinner(),i.clearLine(),i.logMessage("Installing imported packages\r\n"),[4,r.installPackages(d.D.active())];case 4:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return i.clearLogs(),c=i.startLogSpinner("Running your tests"),v=(0,u.Og)("output.json"),[4,t.exec("jest","--json","--outputFile",v,"--config",(0,u.Og)(h),"--forceExit","--passWithNoTests")];case 5:if(y=(g=o.sent()).output,(b=g.error)&&!b.endsWith(f.toString()))return(0,l.j)(l.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==y?void 0:y.replace(/\n/g,"\n\r"))+"\r\n"+b}];return c("Parsing your test results"),[4,n.readFile(v)];case 6:if((Z=o.sent()).error)return C.captureSetupError({tag:"Error reading test results",raw:Z.error}),[2,{error:"There was an error getting test results, if this happens please contact support."}];if((w=JSON.parse(Z.content.toString())).success)return[2,{error:null,result:{passed:!0,failures:[]}}];if(!(_=(x=w.testResults[0]).assertionResults.filter(function(e){return"passed"!==e.status}).map(function(e){return{name:e.title,stack:e.failureMessages[0]}})).length)return[2,{error:x.message.replace(/\n/g,"\r\n")}];return[2,{error:null,result:{passed:!1,failures:_}}]}})})).apply(this,arguments)}var k={java10:f,java10_beta:f,java:f,python3:y,python3_beta:y,python:y,nodejs:C,javascript:C,nodejs_beta:C};function S(e){return e in k}function E(e){if(!S(e))throw Error("".concat(e," is not a supported unit testing language, it has to be one of ").concat(Object.keys(k)));return k[e]}},59109:function(e,t,n){n.d(t,{Og:function(){return u},WT:function(){return h},e3:function(){return d}});var r=n(34142),i=n(87682),o=n(48900),a=n(41500),l=n(39756),c=n(30084),s="_test_runner";function u(e){return s+e}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,o;return(0,i.Jh)(this,function(i){return t=e.fs,n=e.code,r=s+e.filename,o=a.Z.from(n,"utf8"),[2,t.writeFile(r,o)]})})).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)(function(e){var t,n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,e.readDir(l.Ql)];case 1:if((t=r.sent()).error)return[2];return[4,Promise.all(t.children.map(function(t){return t.filename.startsWith(s)?t.type===c.Tv.File?e.deleteFile(t.filename):e.deleteDir(t.filename):Promise.resolve(null)}))];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),o.$e(function(e){e.setTag("unitTestLib","true"),o.Tb(n)}),[3,4];case 4:return[2]}})})).apply(this,arguments)}},79962:function(e,t,n){n.d(t,{AF:function(){return w},Hd:function(){return C},IV:function(){return E},Rb:function(){return g},aA:function(){return v},kO:function(){return k},lQ:function(){return R},rU:function(){return b}});var r=n(45903),i=n(93295),o=n(23982),a=n(13440);function l(){var e=(0,i._)(["\n  fragment UnitTestsReplUnitTestMeta on ReplUnitTestMeta {\n    id\n    imports\n    initialization\n    setup\n    tearDown\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,i._)(["\n  fragment UnitTestsReplUnitTest on ReplUnitTest {\n    id\n    name\n    code\n    failureMessage\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  mutation createUnitTestMeta($input: CreateReplUnitTestMetaInput!) {\n    createReplUnitTestMeta(input: $input) {\n      ... on ReplUnitTestMeta {\n        id\n        ...UnitTestsReplUnitTestMeta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  mutation updateUnitTestMeta($input: UpdateReplUnitTestMetaInput!) {\n    updateReplUnitTestMeta(input: $input) {\n      ... on ReplUnitTestMeta {\n        id\n        ...UnitTestsReplUnitTestMeta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation createUnitTest($input: CreateReplUnitTestInput!) {\n    createReplUnitTest(input: $input) {\n      ... on ReplUnitTest {\n        id\n        ...UnitTestsReplUnitTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation updateUnitTest($input: UpdateReplUnitTestInput!) {\n    updateReplUnitTest(input: $input) {\n      ... on ReplUnitTest {\n        id\n        ...UnitTestsReplUnitTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  mutation deleteUnitTest($testId: Int!) {\n    deleteReplUnitTest(testId: $testId) {\n      ... on ReplUnitTest {\n        id\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation updateReplUnitTestLastRun(\n    $input: UpdateReplUnitTestLastRunInput!\n    $replId: String!\n  ) {\n    updateReplUnitTestLastRun(input: $input) {\n      ... on UpdateReplUnitTestLastRunUpdatedTests {\n        __typename\n        updatedTests {\n          ... on ReplUnitTest {\n            id\n            __typename\n            lastRun(replId: $replId) {\n              ... on ReplUnitTestLastRun {\n                __typename\n                status\n              }\n              ... on UserError {\n                __typename\n                message\n              }\n            }\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n      ... on UserError {\n        __typename\n        message\n      }\n    }\n  }\n"]);return p=function(){return e},e}var m={},v=(0,o.Ps)(l()),g=(0,o.Ps)(c()),y=(0,o.Ps)(s(),v);function b(e){var t=(0,r._)({},m,e);return a.D(y,t)}var Z=(0,o.Ps)(u(),v);function w(e){var t=(0,r._)({},m,e);return a.D(Z,t)}var x=(0,o.Ps)(d(),g);function C(e){var t=(0,r._)({},m,e);return a.D(x,t)}var _=(0,o.Ps)(f(),g);function k(e){var t=(0,r._)({},m,e);return a.D(_,t)}var S=(0,o.Ps)(h());function E(e){var t=(0,r._)({},m,e);return a.D(S,t)}var T=(0,o.Ps)(p());function R(e){var t=(0,r._)({},m,e);return a.D(T,t)}},31593:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(32477),i=n(66349),o=n(59808),a=n(54916),l=n(43429),c=n(92611);function s(){var e=(0,i.Z)(),t=(0,a.Z)().dotReplit,n=null==e?void 0:e.language,s=(0,r._)((0,l.useState)(null),2),u=s[0],d=s[1],f=(0,r._)((0,l.useState)(!0),2),h=f[0],p=f[1];return(0,l.useEffect)(function(){if(n){if((0,c.y)(n)){d(n),p(!1);return}var e=!1,r=t.watch(function(t){if(e||(e=!0,p(!1)),t.error){t.error===o.Yt.NotFound&&d(null);return}var n,r,i=null===(r=t.config.unitTest)||void 0===r?void 0:null===(n=r.language)||void 0===n?void 0:n.toLowerCase();i&&(0,c.y)(i)?d(i):d(null)});return function(){r()}}},[n,t]),{language:u,isLoading:h}}},39783:function(e,t,n){n.d(t,{Q:function(){return o}});var r=n(8182),i=n(43429);function o(e){var t=e.uploadFiles,n=e.fileUploadInputRef,o=e.dirUploadInputRef,a=(0,i.useRef)(Math.random().toString(36));return(0,r.BX)(r.HY,{children:[(0,r.tZ)("input",{style:{display:"none"},ref:n,id:"file-upload-input-".concat(a.current),type:"file",onChange:function(e){var n=e.target.files;n&&t({files:Array.from(n)})},onClick:function(e){e.currentTarget.value=""},multiple:!0,accept:"*"}),(0,r.tZ)("input",{style:{display:"none"},ref:o,id:"dir-upload-input-".concat(a.current),type:"file",onChange:function(e){var n=e.target.files;n&&t({files:Array.from(n)})},onClick:function(e){e.currentTarget.value=""},webkitdirectory:"true",mozdirectory:"true",msdirectory:"true",odirectory:"true",directory:"true",accept:"*"})]})}},81810:function(e,t,n){n.d(t,{ZP:function(){return eT},wK:function(){return eC}});var r,i,o=n(23026),a=n(39698),l=n(45903),c=n(32477),s=n(8182),u=n(43429),d=n(57122),f=n(44620),h=n(56596),p=n(29287),m=n(67337),v=n(51384),g=n(56337),y=n(1498),b=n(70002),Z=n(38080),w=n(70322),x=n(94450),C=n.n(x),_=n(93295),k=n(23982),S=n(66039),E=n(13440);function T(){var e=(0,_._)(["\n  fragment EditDomainRepl on Repl {\n    id\n    hostedUrl\n    apexProxy\n    domains {\n      hosting_deployment_id\n      domain\n      state\n    }\n  }\n"]);return T=function(){return e},e}function R(){var e=(0,_._)(["\n  query EditDomain($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...EditDomainRepl\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n      ... on SubscriptionExpiredError {\n        replId\n      }\n    }\n  }\n  ","\n"]);return R=function(){return e},e}function I(){var e=(0,_._)(["\n  query EditDomainCheckDomain2($replId: String!, $domain: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        checkDomain2(domain: $domain) {\n          ... on DomainStatus2 {\n            verified\n            retry\n            status\n            records {\n              A\n              TXT\n              CNAME\n            }\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on ServiceUnavailable {\n            message\n          }\n        }\n      }\n    }\n  }\n"]);return I=function(){return e},e}function D(){var e=(0,_._)(["\n  mutation EditDomainLinkReplDomain2(\n    $replId: String!\n    $domain: String!\n    $deploymentId: String\n  ) {\n    linkReplDomain2(\n      replId: $replId\n      domain: $domain\n      deploymentId: $deploymentId\n    ) {\n      __typename\n      ... on Repl {\n        id\n        ...EditDomainRepl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on ServiceUnavailable {\n        message\n      }\n    }\n  }\n  ","\n"]);return D=function(){return e},e}function G(){var e=(0,_._)(["\n  mutation EditDomainUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...EditDomainRepl\n      }\n    }\n  }\n  ","\n"]);return G=function(){return e},e}var B={},P=(0,k.Ps)(T()),A=(0,k.Ps)(R(),P),N=(0,k.Ps)(I()),U=(0,k.Ps)(D(),P),L=(0,k.Ps)(G(),P),O=n(74833),X=n(18836),M=n(30983),F=n(10041),W=n(48900),H=n(61314),V=n.n(H),z=n(99656),j=n(10981),q=n(8017),Y=n(52682),$=n(88936),J=n(32377),K=n(58719);function Q(e){switch(e.status){case"verified":return(0,s.tZ)(J.Z,{color:p.TV.accentPositiveDefault});case"failed":return(0,s.tZ)(K.Z,{color:p.TV.accentNegativeDefault});case"verifying":return(0,s.tZ)($.Z,{color:p.TV.accentPrimaryDefault});default:return null}}function ee(e){var t,n=e.replId,r=e.hostedUrl,i=e.desiredARecord,o=e.existingDomain,a=e.onLink,d=e.onGoBack,f=e.onLinkStarted,m=e.onStateChanged,v=(0,c._)((0,u.useState)(o?"loading":null),2),g=v[0],b=v[1],Z=(0,c._)((0,u.useState)(!1),2),w=Z[0],x=Z[1],C=(0,c._)((0,u.useState)(null),2),_=C[0],k=C[1],S=(0,c._)((0,u.useState)(!1),2),T=S[0],R=S[1],I=(0,c._)((t=(0,l._)({},B,void 0),E.D(U,t)),2),D=I[0],G=I[1],P=(0,u.useRef)(null),A=(0,u.useRef)(null),N=(0,u.useRef)(null),L=function(e){(null==e?void 0:e.current)&&e.current.select()},M=function(e){var t;(null==e?void 0:null===(t=e.current)||void 0===t?void 0:t.value)&&(0,F.Z)(e.current.value).catch(function(e){W.$e(function(t){t.setTag("domain-link",!0),t.setExtra("type","copy"),W.Tb(e)})})},H=(0,c._)((0,u.useState)(o||""),2),z=H[0],Y=H[1];(0,u.useEffect)(function(){G.data&&"Repl"===G.data.linkReplDomain2.__typename&&a()},[G.data,a]);var $=function(){try{var e=new URL("/",z);Y(e.hostname)}catch(e){}},J=function(e){b(e),m()},K=V()(z,{require_valid_protocol:!1})&&z.split(".").length>=2,Q=K&&2===z.split(".").length,ee=r.replace(/^https:\/\//,""),en="replit-verify=".concat(n),er=(0,j.U)();return(0,s.BX)(h.G,{css:[p.l0.colWithGap(16)],children:[(0,s.BX)(h.G,{css:[p.l0.colWithGap(8)],children:[(0,s.tZ)(O.h4,{level:2,variant:"subheadDefault",children:"New Domain Link"}),(0,s.BX)(O.xv,{children:["Learn more"," ",(0,s.tZ)("a",{href:"https://docs.replit.com/hosting/hosting-web-pages#custom-domains",target:"_blank",children:"here"}),"."]})]}),(0,s.BX)(h.G,{css:[p.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:er("domain"),children:(0,s.tZ)(O.xv,{color:"dimmer",variant:"small",multiline:!1,children:"Step 1: Enter your domain"})}),(0,s.tZ)(X.II,{className:"cname-url",readOnly:"loading"===g,value:z,onChange:function(e){Y(e.target.value)},onBlur:function(){$()},placeholder:"example.com",id:er("domain")})]}),Q&&!T?(0,s.BX)(h.G,{css:[p.l0.colWithGap(8)],children:[(0,s.BX)(h.G,{css:[p.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:er("record"),children:(0,s.BX)(O.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Step 2: Add an ",(0,s.tZ)("code",{children:"A"})," Record"]})}),(0,s.BX)(h.G,{css:[p.l0.rowWithGap(8),p.l0.align.center],children:[(0,s.tZ)(O.xv,{multiline:!1,css:{fontFamily:p.TV.fontFamilyCode,maxWidth:"40%"},children:z}),(0,s.tZ)(O.xv,{multiline:!1,css:{fontFamily:p.TV.fontFamilyCode},children:"A"}),(0,s.tZ)(X.II,{readOnly:!0,ref:P,onChange:function(){return null},value:i,onFocus:function(){return L(P)},id:er("record")}),(0,s.tZ)(y.zx,{onClick:function(){return M(P)},text:"Copy"})]})]}),(0,s.tZ)(h.G,{css:[p.l0.flex.row,p.l0.align.stretch],children:(0,s.tZ)(y.zx,{variant:"outlined",onClick:function(){return R(!0)},text:"Use CNAME record instead."})})]}):null,K&&(T||!Q)?(0,s.BX)(h.G,{css:[p.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:er("CNAMERecord"),children:(0,s.BX)(O.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Step 2: Add a ",(0,s.tZ)("code",{children:"CNAME"})," Record"]})}),(0,s.BX)(h.G,{css:[p.l0.rowWithGap(8),p.l0.align.center],children:[(0,s.tZ)(O.xv,{multiline:!1,css:{fontFamily:p.TV.fontFamilyCode,maxWidth:"40%"},children:z}),(0,s.tZ)(O.xv,{multiline:!1,css:{fontFamily:p.TV.fontFamilyCode},children:"CNAME"}),(0,s.tZ)(X.II,{readOnly:!0,ref:N,onChange:function(){return null},value:ee,onFocus:function(){return L(N)},id:er("CNAMERecord")}),(0,s.tZ)(y.zx,{onClick:function(){return M(N)},text:"Copy"})]}),Q?(0,s.BX)(h.G,{css:[p.l0.colWithGap(8)],children:[(0,s.tZ)(O.xv,{variant:"small",children:'Note: this CNAME record requires that your DNS provider supports CNAMEs for apex domains - for example Cloudflare with "CNAME Flattening".'}),(0,s.tZ)(h.G,{css:[p.l0.flex.row,p.l0.align.stretch],children:(0,s.tZ)(y.zx,{onClick:function(){return R(!1)},text:"Use A record instead",variant:"outlined"})})]}):null]}):null,K?(0,s.BX)(h.G,{css:[p.l0.colWithGap(4)],children:[Q?(0,s.tZ)("label",{htmlFor:er("txtRecord"),children:(0,s.BX)(O.xv,{color:"dimmer",variant:"small",multiline:!1,children:["This domain also requires a ",(0,s.tZ)("code",{children:"TXT"})," Record"]})}):(0,s.BX)("label",{children:['If you are using a service like Cloudflare (with "orange cloud") that rewrites domain records, you can add a ',(0,s.tZ)("code",{children:"TXT"})," ","Record for verification purposes."]}),(0,s.BX)(h.G,{css:[p.l0.rowWithGap(8),p.l0.align.center],children:[(0,s.tZ)(O.xv,{multiline:!1,css:{fontFamily:p.TV.fontFamilyCode,maxWidth:"40%"},children:z}),(0,s.tZ)(O.xv,{multiline:!1,css:{fontFamily:p.TV.fontFamilyCode},children:"TXT"}),(0,s.tZ)(X.II,{readOnly:!0,ref:A,onChange:function(){return null},value:en,onClick:function(){return L(A)},id:er("txtRecord")}),(0,s.tZ)(y.zx,{onClick:function(){return M(A)},text:"Copy"})]})]}):null,"loading"===g?(0,s.tZ)(h.G,{css:[p.l0.colWithGap(12),p.l0.pt(16)],children:(0,s.tZ)(et,{replId:n,domain:z,onVerified:function(){return J("verified")},onError:function(){return J("error")}})}):null,"verified"===g?(0,s.tZ)(h.G,{css:[p.l0.colWithGap(12),p.l0.pt(16)],children:(0,s.tZ)(O.xv,{multiline:!1,children:"Your domain has been verified."})}):null,"error"===g||_?(0,s.tZ)(h.G,{css:[p.l0.colWithGap(12),p.l0.pt(16)],children:(0,s.BX)(O.xv,{multiline:!1,children:["Creating the domain link failed",_?": "+_:"","."]})}):null,(0,s.BX)(h.G,{css:[p.l0.rowWithGap(12),p.l0.justify.end],children:[(0,s.tZ)(y.zx,{onClick:d,text:"Close"}),K&&null===g?(0,s.tZ)(y.zx,{disabled:w,onClick:function(){x(!0),k(null),D({variables:{replId:n,domain:z}}).then(function(e){var t,n=(null===(t=e.data)||void 0===t?void 0:t.linkReplDomain2)||null;(null==n?void 0:n.__typename)==="Repl"?(k(null),J("loading")):(((null==n?void 0:n.__typename)==="ServiceUnavailable"||(null==n?void 0:n.__typename)==="NotFoundError"||(null==n?void 0:n.__typename)==="UnauthorizedError")&&k(null==n?void 0:n.message),J("error")),x(!1),f()}).catch(function(e){x(!1),k(e.message)})},text:"".concat(w?"Linking domain...":"Link domain"),iconLeft:(0,s.tZ)(q.Z,{}),colorway:"primary"}):null]})]})}function et(e){var t=e.domain,n=e.replId,r=e.onVerified,i=e.onError,o=(f=(0,l._)({},B,{variables:{replId:n,domain:t},pollInterval:1e3}),S.a(N,f)),a=o.data,d=o.stopPolling;if((0,u.useEffect)(function(){if(a&&"Repl"===a.repl.__typename){var e,t,n=a.repl;if((null===(e=n.checkDomain2)||void 0===e?void 0:e.__typename)==="NotFoundError"){i();return}if((null===(t=n.checkDomain2)||void 0===t?void 0:t.__typename)==="DomainStatus2"){var o=n.checkDomain2,l=o.retry,c=o.verified;if(!c&&!l){i();return}(c||!l)&&d(),c&&r()}}},[a,d,r,i]),(null==a?void 0:a.repl.__typename)==="Repl"&&a.repl.checkDomain2){var f,m,v,g,y,b,Z="DomainStatus2"===a.repl.checkDomain2.__typename?a.repl.checkDomain2:null,x=null;if(null==Z?void 0:Z.records){var _=Z.records;_.__typename,x=(0,w._)(_,["__typename"])}var k=null;return(null==Z?void 0:Z.status)||((null===(b=a.repl.checkDomain2)||void 0===b?void 0:b.__typename)==="ServiceUnavailable"&&(k=a.repl.checkDomain2.message),k||(k="DNS updates can take up to 48 hours to fully synchronize. Feel free to check back later.")),(0,s.BX)(h.G,{css:[p.l0.colWithGap(16),p.l0.justify.spaceBetween],children:[(0,s.BX)(h.G,{css:[p.l0.rowWithGap(16),p.l0.align.center],children:[(0,s.tZ)("div",{css:[p.l0.width("20px"),p.l0.height("20px"),{aspectRatio:"1 / 1"},{borderRadius:"100%"},{borderRadius:"100%"},{borderStyle:"solid"},{borderWidth:"3px"},{borderColor:p.TV.accentPrimaryDimmer},{borderTopColor:p.TV.accentPrimaryDefault},{transform:"rotate(0deg)"},{animation:"linear domain-loading 1s infinite"}],className:"jsx-4e6cc6caecb799c9"}),(0,s.tZ)("div",{className:"jsx-4e6cc6caecb799c9",children:k})]}),x||(null===(v=a.repl.checkDomain2)||void 0===v?void 0:v.__typename)==="DomainStatus2"&&(null===(g=a.repl.checkDomain2)||void 0===g?void 0:g.retry)||(null===(y=a.repl.checkDomain2)||void 0===y?void 0:y.__typename)==="ServiceUnavailable"?(0,s.BX)(h.G,{children:[(0,s.tZ)("br",{className:"jsx-4e6cc6caecb799c9"}),x?(0,s.BX)(h.G,{children:["Currently, your domains records show:",(0,s.tZ)("pre",{css:[p.l0.overflow("scroll")],className:"jsx-4e6cc6caecb799c9",children:Object.entries(x).map(function(e){var n=(0,c._)(e,2),r=n[0],i=n[1];return null==i?void 0:i.map(function(e){return(0,s.BX)("div",{className:"jsx-4e6cc6caecb799c9",children:[t," ",r," ",e]},"{domain}-{dnsType}")})})})]}):(0,s.tZ)(O.xv,{children:"Currently, your domain is either not returning any records, or something is getting in the way of our verification process."})]}):null,(0,s.tZ)(C(),{id:"4e6cc6caecb799c9",children:"@-webkit-keyframes domain-loading{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes domain-loading{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes domain-loading{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes domain-loading{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]})}return(null==a?void 0:a.repl.__typename)==="Repl"&&(null===(m=a.repl.checkDomain2)||void 0===m?void 0:m.__typename)==="NotFoundError"?(0,s.tZ)(s.HY,{children:"We ran into an internal error while checking the domain. Please try again later."}):null}function en(e){var t,n=e.replId,r=e.domain,i=e.onUnlink,o=e.onGoBack,a=(0,c._)((t=(0,l._)({},B,{variables:{input:{id:n,removeDomain:r}}}),E.D(L,t)),2),d=a[0],f=a[1];return(0,u.useEffect)(function(){f.data&&f.data.updateRepl.repl&&i()},[f.data,i]),(0,s.BX)(h.G,{css:[p.l0.colWithGap(16)],children:[(0,s.BX)(h.G,{css:[p.l0.colWithGap(8)],children:[(0,s.tZ)(O.h4,{level:3,variant:"subheadDefault",children:"Domain Unlinking"}),(0,s.BX)(O.xv,{children:["Are you sure you want to unlink"," ",(0,s.tZ)("a",{target:"_blank",rel:"noopener",href:"https://"+r,children:r}),"?"]})]}),(0,s.BX)(h.G,{css:[p.l0.rowWithGap(12),p.l0.justify.end],children:[(0,s.tZ)(y.zx,{onClick:o,text:"Cancel"}),(0,s.tZ)(y.zx,{onClick:function(){f.loading||d()},text:f.loading?"Unlinking domain...":"Yes, unlink this domain",colorway:"negative",iconLeft:(0,s.tZ)(Y.Z,{}),disabled:f.loading})]})]})}function er(e){var t=e.replId,n=e.hostedUrl,r=e.apexProxy,i=e.onUnlink,o=e.onLink,a=e.domains,l=e.refetch,d=(0,c._)((0,u.useState)("listing"),2),f=d[0],m=d[1],v=(0,c._)((0,u.useState)(null),2),g=v[0],b=v[1],Z=null;return"listing"===f?Z=(0,s.BX)(h.G,{css:[p.l0.colWithGap(16)],children:[(0,s.BX)(h.G,{children:[(0,s.tZ)(O.h4,{level:3,variant:"subheadDefault",children:"Currently Linked Domains"}),(0,s.tZ)(h.G,{css:[p.l0.colWithGap(16)],children:a.map(function(e){return e?(0,s.tZ)(h.G,{children:(0,s.BX)(h.G,{css:[p.l0.colWithGap(4),p.l0.justify.spaceBetween,p.l0.align.center],children:[(0,s.BX)(h.G,{css:[p.l0.rowWithGap(8),p.l0.align.center,p.l0.justify.spaceBetween,p.l0.width("100%")],children:[(0,s.tZ)(h.G,{css:[p.l0.flex.shrink(1)],children:(0,s.tZ)(M.u,{tooltip:e.domain,children:(0,s.tZ)(O.xv,{multiline:!1,children:e.domain})})}),(0,s.tZ)(h.G,{children:(0,s.tZ)(M.u,{tooltip:(0,s.tZ)(O.xv,{css:{textTransform:"capitalize"},multiline:!1,children:e.state}),children:(0,s.tZ)(Q,{status:e.state})})})]}),(0,s.BX)(h.G,{css:[p.l0.rowWithGap(12),p.l0.justify.end,p.l0.align.center,p.l0.width("100%"),"verified"!==e.state&&p.l0.pl(12)],children:[(0,s.tZ)(y.zx,{text:"Unlink",css:p.l0.width("verified"!==e.state?"50%":"100%"),onClick:function(){b(e.domain),m("unlinking")}}),"verified"!==e.state?(0,s.tZ)(y.zx,{text:"Check status",css:p.l0.width("50%"),onClick:function(){b(e.domain),m("linking")}}):null]})]})},e.domain):null})})]}),(0,s.tZ)(y.zx,{text:"Create domain link",onClick:function(){return m("linking")},iconLeft:(0,s.tZ)(z.Z,{})})]}):"linking"===f?Z=(0,s.tZ)(ee,{replId:t,desiredARecord:r,hostedUrl:n,existingDomain:g,onLink:o,onGoBack:function(){m("listing"),b(null)},onLinkStarted:l,onStateChanged:l}):"unlinking"===f&&null!==g&&(Z=(0,s.tZ)(en,{replId:t,domain:g,onUnlink:function(){l(),m("listing"),i()},onGoBack:function(){m("listing"),b(null)}})),(0,s.BX)(h.G,{css:[p.l0.colWithGap(16)],children:[(0,s.tZ)(O.h4,{level:1,variant:"subheadDefault",children:"Domain Linking"}),(0,s.BX)(O.xv,{css:{fontStyle:"italic"},children:["Domain linking to the development preview is deprecated, please consider switching to"," ",(0,s.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/about-deployments",target:"_blank",children:"deployments"})," ","as a more scalable solution."]}),Z]})}(r=i||(i={})).Verified="verified",r.Verifying="verifying",r.Failed="failed";var ei=n(93918),eo=n(52924),ea=n(49344),el=n(15146),ec=n(12874),es=n(74652),eu=n(40102),ed=n(50199),ef=n(52234),eh=n(20573),ep=n(7444),em=n(36010),ev=n.n(em),eg=n(5344),ey=n(58003),eb=n(25425),eZ=n(73157),ew=n(85195),ex=n(66985),eC="flag-ocean-easy",e_=(0,v.iv)([p.l0.borderRadius(6),p.l0.color.foregroundDimmer,p.l0.height(24),p.l0.m(4)]),ek=[p.l0.reset.button,X.u3,p.l0.colWithGap(0),p.l0.flex.grow(0),p.l0.color.accentPositiveStronger,p.l0.fontSize("small"),p.l0.focusRing,{"&:hover":[p.l0.cursor.pointer,p.l0.color.accentPositiveStrongest]},{borderTopRightRadius:0,borderBottomRightRadius:0,borderRight:0},p.l0.py(0),p.l0.px(4)],eS=(0,ei.X)({root:[p.l0.flex.row,p.l0.align.center,p.l0.justify.spaceBetween,p.l0.border({color:p.TV.outlineDimmest,direction:"bottom"}),p.l0.p(2),p.l0.container("root")],navControls:[p.l0.align.center,p.l0.rowWithGap(4),p.l0.flex.grow(1)],urlWrapper:[p.l0.position.relative,p.l0.flex.row,p.l0.flex.grow(1)],urlOptions:[p.l0.position.absolute,p.l0.width("100%"),p.l0.backgroundColor.backgroundHigher,p.l0.p(8),p.l0.colWithGap(6),p.l0.border(),p.l0.borderRadius(0,0,12,12),{top:"100%",borderTop:0}],urlOptionsSection:[p.l0.colWithGap(4),p.l0.pb(8),p.l0.border({direction:"bottom"}),{":last-child":{borderBottom:0}}],urlOptionsTitle:[p.l0.rowWithGap(0),p.l0.justify.spaceBetween,p.l0.flex.grow(1)],portRadioGroup:[p.l0.colWithGap(8)],portOption:[p.l0.rowWithGap(8),p.l0.color.foregroundDimmer],portOptionSelected:[p.l0.rowWithGap(8),p.l0.color.foregroundDefault],portOptionLabel:[{"&:hover":[p.l0.cursor.pointer,p.l0.color.foregroundDefault]}],temporaryDevLinkWrapper:[p.l0.rowWithGap(4)],temporaryDevLinkText:{flex:"0 1 auto"},temporaryDevLink:[p.l0.display.block,p.l0.color.accentPositiveStronger,p.l0.fontSize("small"),p.l0.focusRing,{wordBreak:"break-all","&:hover":[p.l0.cursor.pointer,p.l0.color.accentPositiveStrongest]}],url:ek,urlSelected:[ek,p.l0.backgroundColor.backgroundHighest,{borderBottomLeftRadius:0}],urlPath:[p.l0.py(0),p.l0.fontSize(12),p.l0.flex.grow(1)],urlPath2:[p.l0.py(0),p.l0.fontSize(12),p.l0.flex.grow(1),{borderTopLeftRadius:0,borderBottomLeftRadius:0}],goButton:[p.l0.position.absolute,p.l0.right(4),p.l0.top("50%"),{transform:"translateY(-50%)"}],text:[p.l0.ml(8),p.l0.mr(4),p.l0.color.foregroundDimmest],buttons:[p.l0.flex.row,p.l0.align.center,(0,a._)({},p.nC.max("mobileMax","root"),{span:{fontSize:0},svg:{marginRight:0}})],navButton:[p.l0.p(6),p.l0.borderRadius(4),p.l0.flex.shrink(0),{border:"none"}],fakeUrl:[p.l0.fontSize(12),p.l0.border(),{boxSizing:"content-box"},p.l0.borderRadius(6),p.l0.px(8),p.l0.py(2),p.l0.flex.grow(1),p.l0.rowWithGap(4),p.l0.align.center],devtoolsErrorsBadge:[p.l0.position.absolute,p.l0.center,p.l0.textAlign.center,p.l0.backgroundColor.accentNegativeStronger,p.l0.color.accentNegativeDimmest,p.l0.right(0),p.l0.top(-2),p.l0.p(2),p.l0.minWidth(14),p.l0.height(14),p.l0.borderRadius(16),p.l0.fontSize(10)]}),eE=function e(t,n,r,i){"use strict";var a=this;(0,o._)(this,e),this.history=[],this.historyIndex=-1,this.init=function(e,t){a.history.push({relativeUrl:e,port:t}),a.historyIndex=a.history.length-1,a.notifyChanges()},this.notifyChanges=function(){a.onChange(a.canGoBack(),a.canGoForward(),a.getCurrentRelativeUrl(),a.getCurrentPort())},this.canGoBack=function(){return a.historyIndex>0},this.canGoForward=function(){return a.historyIndex<a.history.length-1},this.getCurrentRelativeUrl=function(){return a.history[a.historyIndex].relativeUrl},this.getCurrentPort=function(){return a.history[a.historyIndex].port},this.push=function(e,t){(e!==a.getCurrentRelativeUrl()||t!==a.getCurrentPort())&&(a.history=a.history.slice(0,a.historyIndex+1),a.history.push({relativeUrl:e,port:t}),a.historyIndex=a.history.length-1),a.notifyChanges()},this.relativeUrlUpdate=function(e){if(a.pendingNavigations>0){a.pendingNavigations-=1;return}a.push(e,a.getCurrentPort())},this.back=function(){(0,ef.xn)(),a.canGoBack()&&(a.historyIndex-=1,a.navigate(a.getCurrentRelativeUrl(),a.getCurrentPort()))},this.forward=function(){(0,ef.Yl)(),a.canGoForward()&&(a.historyIndex+=1,a.navigate(a.getCurrentRelativeUrl(),a.getCurrentPort()))},this.navigate=function(e,t){var n=null!=t?t:a.getCurrentPort();a.requestIframeNavigateTo(e,n),a.push(e,n),a.pendingNavigations+=1},this.refresh=function(){var e,t;(0,ef.rJ)(),a.requestIframeNavigateTo(null!==(e=a.getCurrentRelativeUrl())&&void 0!==e?e:"/",null!==(t=a.getCurrentPort())&&void 0!==t?t:80)},this.setPort=function(e){var t=a.getCurrentRelativeUrl();a.navigate(t,e)},this.onChange=r,this.pendingNavigations=0,this.requestIframeNavigateTo=i,this.init(t,n)};function eT(e){var t,n,r,i,o,a,d,v,w,x,C,_,k,E,T,R,I,D,G,P,N,U,L=e.canEditDomain,X=e.onToggleDevtools,M=e.navigationState,F=e.replId,W=e.url,H=e.requestIframeNavigateTo,V=e.initialPort,z=e.initialPath,j=e.forwardedPorts,q=e.onOpenPortSettings,Y=e.devtoolsErrorCount,$=e.setRefreshCb,J=(0,g.Z)(),K=(n=(t={initialPort:V,initialPath:z,navigationState:M,requestIframeNavigateTo:H}).initialPort,r=t.initialPath,i=t.navigationState,o=t.requestIframeNavigateTo,d=(a=(0,c._)(u.useState(!1),2))[0],v=a[1],x=(w=(0,c._)(u.useState(!1),2))[0],C=w[1],k=(_=(0,c._)(u.useState("Loading..."),2))[0],E=_[1],R=(T=(0,c._)(u.useState(80),2))[0],I=T[1],D=u.useCallback(function(e,t,n,r){v(e),C(t),E(n),I(r)},[]),G=(0,ep.Z)(o),P=(0,ep.Z)(n),N=(0,ep.Z)(r),U=(0,ed.Z)(function(){return new eE(N.current,P.current,D,G.current)},[N,P,D,G]),u.useEffect(function(){"active"===i.state&&U.relativeUrlUpdate(i.relativeUrl)},[i.state,i.relativeUrl,U]),{canNavigateBack:d,canNavigateForward:x,navigateBack:U.back,navigateForward:U.forward,canNavigateToInputRelativeUrl:k!==i.relativeUrl,navigateToInputRelativeUrl:function(){(0,ef.Fq)(k),U.navigate(k)},inputRelativeUrl:k,setInputRelativeUrl:E,refresh:U.refresh,setPort:U.setPort,selectedPort:R}),Q=K.canNavigateForward,ee=K.navigateForward,et=K.canNavigateBack,en=K.navigateBack,ei=K.canNavigateToInputRelativeUrl,el=K.navigateToInputRelativeUrl,ec=K.inputRelativeUrl,es=K.setInputRelativeUrl,eu=K.refresh,eh=K.setPort,em=K.selectedPort;u.useEffect(function(){$(function(){return eu})},[eu,$]);var ev=function(e){var t,n,r,i=(t=(0,l._)({},B,{variables:{replId:e}}),S.a(A,t)),o=i.data,a=i.refetch,s=(0,c._)((0,u.useState)(!1),2),d=s[0],f=s[1],h=(0,u.useRef)(!1);if(!o||"Repl"!==o.repl.__typename)return{showEditReplcoDomainButton:!1};var p=null!==(r=null===(n=o.repl.domains)||void 0===n?void 0:n.filter(Boolean).filter(function(e){return!(null==e?void 0:e.hosting_deployment_id)}).map(function(e){return{domain:e.domain,state:e.state}}))&&void 0!==r?r:[];return p.length||h.current?(h.current=!0,{showEditReplcoDomainButton:!0,setIsEditingDomain:f,isEditingDomain:d,editDomainProps:{domains:p,refetch:a,replId:e,apexProxy:o.repl.apexProxy,hostedUrl:o.repl.hostedUrl,onUnlink:function(){a(),f(!1)},onLink:function(){a(),f(!1)}}}):{showEditReplcoDomainButton:!1}}(F),eg=(0,s.tZ)(eB,{});return"external-page"===M.state?eg=(0,s.tZ)(eG,{backToLocal:function(){return eu()}}):"active"===M.state&&(eg=(0,s.tZ)(eD,{canNavigateForward:Q,navigateForward:ee,canNavigateBack:et,navigateBack:en,canNavigateToInputRelativeUrl:ei,navigateToInputRelativeUrl:el,inputRelativeUrl:ec,setInputRelativeUrl:es,refresh:eu,forwardedPorts:j,setPort:eh,selectedPort:em,url:W,onOpenPortSettings:q})),(0,s.BX)(Z.Tg,{css:eS.root,children:[eg,(0,s.tZ)(h.G,{css:p.l0.flex.row,children:(0,s.BX)(h.G,{css:eS.buttons,children:[L&&ev.showEditReplcoDomainButton?(0,s.BX)(s.HY,{children:[(0,s.tZ)(y.zx,{variant:"outlined",size:"small",text:"Edit custom domain",onClick:function(){return ev.setIsEditingDomain(!ev.isEditingDomain)},iconLeft:(0,s.tZ)(eo.Z,{size:16})}),(0,s.tZ)(ea.u,{isOpen:ev.isEditingDomain,onRequestClose:function(){return ev.setIsEditingDomain(!1)},children:(0,s.tZ)(er,(0,l._)({},ev.editDomainProps))})]}):null,"active"===M.state?(0,s.BX)(h.G,{css:p.l0.position.relative,children:[(0,s.tZ)(y.zx,{size:"small",variant:"outlined",onClick:X,css:e_,text:"Devtools",iconLeft:(0,s.tZ)(m.Z,{})}),Y>0?(0,s.tZ)(h.G,{css:eS.devtoolsErrorsBadge,children:(0,s.tZ)(O.xv,{variant:"small",multiline:!1,children:Y>99?"99+":Y.toString()})}):null]}):null,(0,s.tZ)(b.Z,{size:"small",variant:"outlined",css:e_,href:W,target:"_blank",iconLeft:(0,s.tZ)(f.Z,{}),text:J?"Open in the browser":"New tab",onClick:function(){(0,ef.Ji)()}})]})})]})}function eR(e){var t=e.url,n=(0,c._)(u.useState(!1),2),r=n[0],i=n[1],o=u.useRef(null),a=function(){i(!0),o.current=setTimeout(function(){i(!1)},1500)};return u.useEffect(function(){return function(){o.current&&clearTimeout(o.current)}},[]),(0,s.tZ)(M.u,{isOpen:r,placement:"bottom",tooltip:r?"Copied!":"Copy link",delay:"none",children:(0,s.tZ)(el.hU,{alt:"Copy link",size:18,tooltipHidden:!1,onClick:function(){(0,F.Z)(t),a()},children:(0,s.tZ)(eg.Z,{})})})}function eI(e){var t=e.canNavigateToInputRelativeUrl,n=e.navigateToInputRelativeUrl,r=e.inputRelativeUrl,i=e.setInputRelativeUrl,o=e.forwardedPorts,a=e.setPort,l=e.selectedPort,d=e.url,f=e.onOpenPortSettings,p=(0,c._)(u.useState(!1),2),m=p[0],v=p[1],g=(0,j.U)(),y=g("radioGroup");return(0,s.BX)(s.HY,{children:[m?(0,s.BX)(Z.Tg,{css:eS.urlOptions,elevated:!0,children:[(0,s.BX)(h.G,{css:eS.urlOptionsSection,children:[(0,s.BX)(h.G,{css:eS.urlOptionsTitle,children:[(0,s.BX)(O.xv,{children:["Listening on ",(0,eZ.Z)("port",o.length),":"]}),(0,s.tZ)(el.hU,{alt:"Port settings",onClick:f,children:(0,s.tZ)(ey.Z,{})})]}),(0,s.tZ)(ew.E,{tag:"fieldset",css:eS.portRadioGroup,name:y,value:l.toString(),onChange:function(e){a(parseInt(e.target.value,10)),v(!1)},children:o.map(function(e,t){return(0,s.BX)(h.G,{css:l===e.configuration.externalPort?eS.portOptionSelected:eS.portOption,children:[(0,s.tZ)(ew.Y,{id:g(e.configuration.externalPort),value:e.configuration.externalPort.toString()}),(0,s.tZ)("label",{htmlFor:g(e.configuration.externalPort),css:eS.portOptionLabel,children:":".concat(e.configuration.localPort,"  :").concat(e.configuration.externalPort)})]},"".concat(t,"-").concat(e.configuration.externalPort,":").concat(e.configuration.localPort))})})]}),(0,s.BX)(h.G,{css:eS.urlOptionsSection,children:[(0,s.tZ)(O.xv,{children:"Dev URL:"}),(0,s.BX)(h.G,{css:eS.temporaryDevLinkWrapper,children:[(0,s.tZ)(O.xv,{css:eS.temporaryDevLinkText,maxLines:1,children:(0,s.tZ)(ev(),{legacyBehavior:!0,href:d,passHref:!0,children:(0,s.tZ)("a",{css:eS.temporaryDevLink,target:"_blank",children:d})})}),(0,s.tZ)(eR,{url:d})]})]})]}):null,(0,s.tZ)("button",{css:m?eS.urlSelected:eS.url,onClick:function(){return v(!m)},children:"{...}.".concat(d.includes("replit.dev")?"replit.dev":"repl.co").concat((0,ex.O2)(l)?"":":"+l)}),(0,s.tZ)(X.II,{css:eS.urlPath2,style:m?{borderBottomRightRadius:0}:{},value:r,onKeyDown:function(e){"Enter"===e.key&&t&&n()},onChange:function(e){if(""===e.currentTarget.value){i("/");return}i(e.target.value)}})]})}function eD(e){var t=e.canNavigateForward,n=e.navigateForward,r=e.canNavigateBack,i=e.navigateBack,o=e.canNavigateToInputRelativeUrl,a=e.navigateToInputRelativeUrl,l=e.inputRelativeUrl,c=e.setInputRelativeUrl,u=e.refresh,f=e.forwardedPorts,p=e.setPort,m=e.selectedPort,v=e.url,g=e.onOpenPortSettings,y=(0,eb.P5)({controlName:eC,logFlagToAnalytics:!0});return(0,s.BX)(h.G,{css:eS.navControls,children:[(0,s.tZ)(el.hU,{alt:"Back",tooltipDelay:"long",onClick:i,disabled:!r,css:eS.navButton,children:(0,s.tZ)(eu.Z,{})}),(0,s.tZ)(el.hU,{alt:"Forward",tooltipDelay:"long",onClick:n,disabled:!t,css:eS.navButton,children:(0,s.tZ)(ec.Z,{})}),(0,s.tZ)(el.hU,{alt:"Refresh",tooltipDelay:"long",onClick:u,css:eS.navButton,children:(0,s.tZ)(d.Z,{})}),(0,s.BX)(h.G,{css:eS.urlWrapper,children:[y?(0,s.tZ)(eI,{canNavigateToInputRelativeUrl:o,navigateToInputRelativeUrl:a,inputRelativeUrl:l,setInputRelativeUrl:c,forwardedPorts:f,setPort:p,selectedPort:m,url:v,onOpenPortSettings:g}):(0,s.tZ)(X.II,{css:eS.urlPath,value:l,onKeyDown:function(e){"Enter"===e.key&&o&&a()},onChange:function(e){if(""===e.currentTarget.value){c("/");return}c(e.target.value)}}),(0,s.tZ)(Z.Tg,{elevated:!0,css:eS.goButton,children:(0,s.tZ)(el.hU,{alt:"Go to URL",disabled:!o,onClick:a,size:18,tooltipContents:(0,s.tZ)(es.bM,{keyCombo:"Enter"}),children:(0,s.tZ)(ec.Z,{})})})]})]})}function eG(e){var t=e.backToLocal,n=(0,c._)(u.useState(!1),2),r=n[0],i=n[1];return(0,s.BX)(h.G,{css:eS.navControls,children:[(0,s.tZ)(y.zx,{size:"small",variant:"outlined",onClick:function(){t(),i(!0)},loading:r,css:e_,text:"Back to my page",iconLeft:r?(0,s.tZ)($.Z,{}):(0,s.tZ)(eu.Z,{})}),(0,s.BX)(Z.Tg,{elevated:!0,css:eS.fakeUrl,children:[(0,s.tZ)(M.u,{tooltip:"The URL bar is not supported when navigating to external pages. You can open in a new tab to use your browser instead.",delay:"none",placement:"auto",children:(0,s.tZ)(eh.Z,{})}),(0,s.tZ)(O.xv,{variant:"small",color:"dimmer",children:"External page"})]})]})}function eB(){return(0,s.tZ)(h.G,{css:eS.navControls,children:(0,s.BX)(Z.Tg,{elevated:!0,css:eS.fakeUrl,children:[(0,s.tZ)(M.u,{tooltip:"Page is loading, please wait.",delay:"none",placement:"auto",children:(0,s.tZ)($.Z,{})}),(0,s.tZ)(O.xv,{variant:"small",color:"dimmer",children:"Loading your page"})]})})}},83436:function(e,t,n){n.d(t,{I5:function(){return p},sY:function(){return f}});var r=n(45903),i=n(93295),o=n(23982),a=n(66039);function l(){var e=(0,i._)(["\n  fragment ReplEnvironmentWebviewDeployBanner on Repl {\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        currentBuild {\n          id\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    config {\n      isVnc\n    }\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,i._)(["\n  fragment ReplEnvironmentWebviewRepl on Repl {\n    id\n    prodUrl: hostedUrl(dotty: true)\n    devUrl: hostedUrl(dev: true)\n    currentUserPermissions {\n      linkDomain\n    }\n    lang {\n      id\n    }\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  query ReplEnvironmentWebview($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        ...ReplEnvironmentWebviewRepl\n        ...ReplEnvironmentWebviewDeployBanner\n      }\n    }\n  }\n  ","\n  ","\n"]);return s=function(){return e},e}var u={},d=(0,o.Ps)(l()),f=(0,o.Ps)(c()),h=(0,o.Ps)(s(),f,d);function p(e){var t=(0,r._)({},u,e);return a.a(h,t)}},51533:function(e,t,n){n.d(t,{Z:function(){return $},J:function(){return Y}});var r=n(45903),i=n(25e3),o=n(32477),a=n(8182),l=n(43429),c=n(48900),s=n(83436),u=n(50782),d=n(94450),f=n.n(d),h=n(63461),p=n(9617),m=n(35972),v=n(59868);function g(){return l.useEffect(function(){(0,v.j)(v.U3.WS_REPLCO_UNREACHABLE)},[]),(0,a.BX)("div",{className:"jsx-88c49dc4f1cb807b unreachable",children:[(0,a.BX)(m.gC,{align:"center",spacing:4,children:[(0,a.BX)(m.gC,{align:"center",children:[(0,a.tZ)(p.Z,{level:1,children:"\uD83D\uDE48"}),(0,a.tZ)(p.Z,{level:4,children:"This Repl link isnt broken!"}),(0,a.tZ)(p.Z,{level:4,foreground:2,children:"Its just blocked."})]}),(0,a.BX)(m.gC,{spacing:2,className:"why",children:[(0,a.tZ)(h.Z,{foreground:2,children:"Why this might be happening:"}),(0,a.tZ)(h.Z,{foreground:2,children:(0,a.BX)("ul",{className:"jsx-88c49dc4f1cb807b",children:[(0,a.BX)("li",{className:"jsx-88c49dc4f1cb807b",children:["repl.co URLs could be"," ",(0,a.tZ)(h.Z,{fontWeight:"medium",foreground:1,children:"blocked by a firewall,"})," ","so contact your IT administrator"]}),(0,a.BX)("li",{className:"jsx-88c49dc4f1cb807b",children:["repl.co URLs could be"," ",(0,a.tZ)(h.Z,{fontWeight:"medium",foreground:1,children:"blocked by your ISP,"})," ","so try getting in touch with them"]})]})})]}),(0,a.BX)(h.Z,{foreground:2,align:"center",children:["If you have any other questions, please check out"," ",(0,a.tZ)("a",{href:"https://docs.replit.com/teams-edu/it-administrators-toolkit",target:"_blank",rel:"noopener noreferrer",className:"jsx-88c49dc4f1cb807b",children:"our IT docs"})," ","or"," ",(0,a.tZ)("a",{href:"https://replit.com/support",target:"_blank",rel:"noopener noreferrer",className:"jsx-88c49dc4f1cb807b",children:"contact support"}),"."]})]}),(0,a.tZ)(f(),{id:"88c49dc4f1cb807b",children:".unreachable.jsx-88c49dc4f1cb807b{padding:var(--space-32)}.unreachable.jsx-88c49dc4f1cb807b ul.jsx-88c49dc4f1cb807b{list-style-position:inside}.unreachable.jsx-88c49dc4f1cb807b li.jsx-88c49dc4f1cb807b{padding-bottom:var(--space-16)}"})]})}var y=l.createContext(!1),b=n(56596),Z=n(29287),w=n(81810),x=n(30686),C=n(62582),_=n(74833);function k(){return(0,a.BX)(b.G,{css:[Z.l0.align.center,Z.l0.p(64)],children:[(0,a.BX)(b.G,{css:[Z.l0.align.center],children:[(0,a.tZ)(p.Z,{level:1,children:"\uD83D\uDE48"}),(0,a.tZ)(_.xv,{css:[Z.l0.textAlign.center,Z.l0.pb(8)],variant:"headerDefault",children:"We've detected a crash loop"}),(0,a.tZ)(_.xv,{css:[Z.l0.textAlign.center],variant:"subheadDefault",color:"dimmer",children:"Preview is disabled until you click the run button again."})]}),(0,a.tZ)(b.G,{css:[Z.l0.p(16)],children:(0,a.tZ)(_.xv,{css:[Z.l0.color.foregroundDimmer,Z.l0.textAlign.center,Z.l0.pb(16)],children:"There may be errors in the code that are causing your application to repeatedly crash."})})]})}var S=n(40664),E=n(42549),T=n(49932),R=n(1498),I=n(7877),D=n(60427);function G(e){var t=e.onCompleted,n=e.startTimeInSeconds,r=(0,o._)(l.useState(n),2),i=r[0],c=r[1];return l.useEffect(function(){var e=setInterval(function(){return c(function(t){return 0===t?(clearInterval(e),0):t-1})},1e3);return function(){return clearInterval(e)}},[]),l.useEffect(function(){i>0||t()},[i]),(0,a.tZ)(b.G,{css:{width:24,height:24},children:(0,a.BX)(b.G,{css:[Z.l0.flex.row,Z.l0.align.center,Z.l0.justify.center,{width:"100%",height:"100%",strokeDasharray:62.400000000000006,strokeDashoffset:62.400000000000006,strokeLinecap:"butt",strokeWidth:2,stroke:T.TV.accentPrimaryDefault,fill:"none"}],children:[(0,a.tZ)("svg",{width:"100%",height:"100%",className:f().dynamic([["1e155c6e775ef991",[62.400000000000006]]]),children:(0,a.tZ)("circle",{r:10,cx:12,cy:12,style:{animationName:"countdown-animation",animationDuration:"".concat(n,"s"),animationDelay:"0s",animationTimingFunction:"linear"},className:f().dynamic([["1e155c6e775ef991",[62.400000000000006]]])})}),(0,a.tZ)(f(),{id:"1e155c6e775ef991",dynamic:[62.400000000000006],children:"@-webkit-keyframes countdown-animation{from{stroke-dashoffset:0px}to{stroke-dashoffset:".concat(62.400000000000006,"px}}@-moz-keyframes countdown-animation{from{stroke-dashoffset:0px}to{stroke-dashoffset:").concat(62.400000000000006,"px}}@-o-keyframes countdown-animation{from{stroke-dashoffset:0px}to{stroke-dashoffset:").concat(62.400000000000006,"px}}@keyframes countdown-animation{from{stroke-dashoffset:0px}to{stroke-dashoffset:").concat(62.400000000000006,"px}}")}),(0,a.tZ)(_.xv,{css:[Z.l0.position.absolute],variant:"small",multiline:!1,children:i})]})})}function B(e){var t=e.onCompleted,n=[Z.l0.rowWithGap(4),Z.l0.align.center,Z.l0.justify.spaceBetween,Z.l0.p(6),Z.l0.pl(8),Z.l0.flex.growAndShrink(1),{borderWidth:1,borderStyle:"solid",background:T.TV.accentPrimaryDimmest,borderColor:T.TV.accentPrimaryDimmer,color:T.TV.accentPrimaryStrongest}];return(0,a.BX)(b.G,{css:n,children:[(0,a.BX)(b.G,{css:[Z.l0.rowWithGap(4),Z.l0.align.center],children:[(0,a.tZ)(_.xv,{variant:"small",children:"When you're ready, you can deploy from the"}),(0,a.tZ)(R.zx,{iconLeft:(0,a.tZ)(I.Z,{}),text:"Release",disabled:!0,size:"small"}),(0,a.tZ)(_.xv,{variant:"small",children:"menu!"})]}),(0,a.tZ)(G,{startTimeInSeconds:3,onCompleted:t})]})}function P(e){var t,n=e.repl,r=e.onClick,i=(0,o._)(l.useState(!1),2),c=i[0],s=i[1],u=(0,D.gg)().isDeployableRepl,d=(0,S.Z)("workspace","workspace-deployments-webview-banner"),f=d.shouldDisplay,h=d.register,p=d.dismiss;l.useEffect(function(){h()},[h]);var m=n.hostingDeploymentPermissions.canDeploy&&u,g=(null===(t=n.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"&&n.hostingDeployment.currentBuild;return m&&!g&&f?(0,a.tZ)(b.G,{children:c?(0,a.tZ)(B,{onCompleted:function(){p()}}):(0,a.tZ)(E.U,{onClick:function(){(0,v.j)(v.U3.DEPLOY_PROJECT_SELECTED,{source:"workspace_webview_deploy_banner"}),p(),r()},onDismiss:function(){s(!0)},rounded:!1})}):null}var A=n(86612),N=n(18107),U=n(76588),L=n(51384),O={container:(0,L.iv)(Z.l0.p(16),Z.l0.height("100%"),Z.l0.align.center),imageContainer:(0,L.iv)(Z.l0.height("100%"),Z.l0.colWithGap(16),Z.l0.align.center,Z.l0.justify.center,Z.l0.width(300)),image:(0,L.iv)(Z.l0.width(200))};function X(e){var t=e.hasForwardedPorts,n=e.showWebview;return(0,a.tZ)(b.G,{css:O.container,children:(0,a.BX)(b.G,{css:O.imageContainer,children:[(0,a.tZ)("div",{css:O.image,children:(0,a.tZ)(U.Z,{src:"/public/images/run_pointer.svg",alt:"A play button with a mouse pointer",height:250,width:400})}),t?(0,a.BX)(a.HY,{children:[(0,a.tZ)(_.h4,{level:3,variant:"subheadDefault",children:"Looks like you have a server running."}),(0,a.tZ)(R.zx,{text:"Show web content",colorway:"primary",onClick:n})]}):(0,a.tZ)(_.h4,{level:3,variant:"subheadDefault",children:"Start a server to see the hosted output."})]})})}var M=n(56337),F=n(37463),W=n(52234),H=n(66985),V=n(25425),z=n(23394),j=n(54916);function q(e){var t=new URL(e);return t.hostname.endsWith(".localhost")?e:(t.protocol="https:",t.toString())}function Y(e){var t,n,r=(0,V.P5)({controlName:"flag-dot-dev-url",logFlagToAnalytics:!1}),i=(0,M.Z)(),o=!(n=(0,F.bg)()).length||n.some(function(e){return 80===e.configuration.externalPort})?80:null!==(t=n[0].configuration.externalPort)&&void 0!==t?t:80,a=(0,j.Z)().container,l=(0,A.Z)(a),c=(0,s.I5)({variables:{id:e}}).data,u=(0,z.Z)();if(!o&&"html"!==u)return null;var d=(null==c?void 0:c.repl.__typename)==="Repl"?c.repl:null;if(!d)return null;if(r&&l){if(!l)return null;var f=(0,H.hw)(l,o).toString(),h=(0,H.hw)(l+"/__replco/devtools_wrapper.html",o).toString();return{iframeSrc:i?q(f):h,presentationUrl:f}}return{iframeSrc:i?q((0,H.hw)(d.prodUrl,o).toString()):(0,H.hw)(d.devUrl,o).toString(),presentationUrl:(0,H.hw)(d.prodUrl,o).toString()}}function $(e){var t,n,d,f,h,p,m,_,S,E,T,R,I,D,G,B,A,U=e.initialPort,L=void 0===U?80:U,O=e.initialPath,V=void 0===O?"/":O,z=e.openPane,q=e.containerRef,$=e.openDotReplit,J=e.setRefreshCb,K=(0,l.useId)(),Q=(0,u.Z)(),ee=(0,s.I5)({variables:{id:Q}}).data,et=(null==ee?void 0:ee.repl.__typename)==="Repl"?ee.repl:null,en=(0,l.useContext)(y),er=(0,x.S)().isCircuitBroken,ei=(0,l.useRef)(null),eo=(0,o._)((0,l.useState)(!1),2),ea=eo[0],el=eo[1],ec=(t=(0,j.Z)().runner,d=(n=(0,o._)((0,l.useState)(t.getRunState()),2))[0],f=n[1],p=(h=(0,o._)((0,l.useState)(!1),2))[0],m=h[1],(0,l.useEffect)(function(){return t.onStateChanged(f)},[t]),{shouldHide:(d===N.Ah.OFFLINE||d===N.Ah.STOPPING||d===N.Ah.IDLE&&"html"!==t.mode)&&!p,forceShow:function(){return m(!0)}}),es=ec.shouldHide,eu=ec.forceShow,ed=(0,o._)((0,l.useState)(0),2),ef=ed[0],eh=ed[1],ep=Y(Q),em=(0,F.bg)(),ev=(null==et?void 0:et.lang.id)==="html"||(null==et?void 0:et.lang.id)==="html_beta",eg=(0,M.Z)(),ey=!1,eb=null;ep?en?eb=(0,a.tZ)(g,{}):er?eb=(0,a.tZ)(k,{}):es?eb=(0,a.tZ)(X,{hasForwardedPorts:em.length>0,showWebview:eu}):eg?(ey=!0,eb=(0,a.tZ)("webview",(0,r._)({"data-cy":"ws-webview",ref:ei,src:(0,H.Gz)({url:ep.iframeSrc,port:L,path:V,id:K}).toString(),onLoad:function(){return el(!0)},css:[Z.l0.flex.growAndShrink(1),{border:"none",backgroundColor:Z.TV.white}]},C.Z))):(ey=!0,eb=(0,a.tZ)("iframe",(0,r._)({title:"webview","data-cy":"ws-webview",ref:ei,src:(0,H.Gz)({url:ep.iframeSrc,port:L,path:V,id:K}).toString(),onLoad:function(){return el(!0)},css:[Z.l0.flex.growAndShrink(1),{border:"none",display:"block",backgroundColor:Z.TV.white}]},C.Z))):eb=null;var eZ=(S=(_={webviewId:K,isWebviewVisible:ey,iframeOrWebviewRef:ei,iframeSrc:null==ep?void 0:ep.iframeSrc}).webviewId,E=_.isWebviewVisible,T=_.iframeOrWebviewRef,R=_.iframeSrc,D=(I=(0,o._)((0,l.useState)({state:"loading",relativeUrl:null}),2))[0],G=I[1],B=(0,M.Z)(),(0,l.useEffect)(function(){if(B&&E&&R){if(!T.current)throw Error("Expected iframe to be defined when isWebviewRendered");var e=T.current,t=new URL(R);return e.addEventListener("did-navigate",n),e.addEventListener("did-navigate-in-page",n),function(){e.removeEventListener("did-navigate",n),e.removeEventListener("did-navigate-in-page",n)}}function n(e){var n=new URL(e.url),r=n.pathname+n.search+n.hash;if(n.hostname!==t.hostname){G(function(e){return"external-page"===e.state?e:{state:"external-page",relativeUrl:null}});return}G(function(e){return"active"===e.state&&e.relativeUrl===r?e:{state:"active",relativeUrl:r}})}},[E,B,R,T]),(0,l.useEffect)(function(){if(!B&&R){var e=new URL(R);return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}}function t(t){if(t.origin&&"null"!==t.origin&&new URL(t.origin).hostname===e.hostname&&"object"==typeof t.data&&(null===(n=t.data)||void 0===n?void 0:n.type)){var n,r=T.current,i=t.data;if((null==i||!i.id||i.id===S)&&((null==i?void 0:i.id)===S&&t.source!==(null==r?void 0:r.contentWindow)&&c.Tb(Error("Expected event source to match iframe content window")),"page-navigation"===i.type)){if(i.payload.isExternal){G(function(e){return"external-page"===e.state?e:{state:"external-page",relativeUrl:null}});return}var o=i.payload.path;G(function(e){return"active"===e.state&&e.relativeUrl===o?e:{state:"active",relativeUrl:o}})}}}},[S,B,R,T]),D);return((0,l.useEffect)(function(){var e=function(e){if(e.origin&&"null"!==e.origin&&new URL(e.origin).hostname===t&&"object"==typeof e.data&&(null===(n=e.data)||void 0===n?void 0:n.type)){var n,o,a,l=e.data;if(null==l||!l.id||l.id===K)switch(l.type){case"event":var s=e.data,u=s.event,d=s.payload;"error"===u?c.Tb(d):(0,v.j)(u,(0,i._)((0,r._)({},d),{replId:Q,isHTML:ev}));return;case"show-badge":eh(e.data.count);return;case"ready":e.data.wasShown&&(null===(a=ei.current)||void 0===a||null===(o=a.contentWindow)||void 0===o||o.postMessage({type:"toggleDevtools",source:"automatic"},"*"));return}}};if(null==ep?void 0:ep.iframeSrc){var t=new URL(ep.iframeSrc).hostname;return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}},[K,Q,ev,null==ep?void 0:ep.iframeSrc]),et&&ep)?(A=ey?(0,a.tZ)(w.ZP,{navigationState:eZ,canEditDomain:et.currentUserPermissions.linkDomain,url:ep.presentationUrl,initialPort:L,initialPath:V,forwardedPorts:em,replId:Q,requestIframeNavigateTo:function(e,t){if(eh(0),ei.current){if(eg){var n,r=ei.current,i=new URL(e,ep.iframeSrc);t&&(i=(0,H.hw)(i.toString(),t)),r.loadURL(i.toString());return}if(null===(n=ei.current)||void 0===n?void 0:n.contentWindow){var o=(0,H.hw)(ep.iframeSrc,t);o.searchParams.set("initialPath",e),o.searchParams.set("id",K),ei.current.src=o.href}}},onToggleDevtools:function(){if((0,W.t1)(),eh(0),!eg){var e,t;null===(t=ei.current)||void 0===t||null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"toggleDevtools",source:"manual"},"*");return}var n=ei.current;n&&(n.isDevToolsOpened()?n.closeDevTools():n.openDevTools())},onOpenPortSettings:$,devtoolsErrorCount:ef,setRefreshCb:J}):null,(0,a.BX)(b.G,{css:[Z.l0.backgroundColor.backgroundDefault,Z.l0.height("100%"),Z.l0.borderRadius(4),{overflow:"hidden"}],innerRef:q,children:[A,ea?(0,a.tZ)(P,{repl:et,onClick:function(){return z({type:"deployments"})}}):null,eb]})):null}},52234:function(e,t,n){n.d(t,{Fq:function(){return u},Ji:function(){return f},Yl:function(){return c},rJ:function(){return l},t1:function(){return d},xn:function(){return s}});var r=n(45903),i=n(70322),o=n(59868);function a(e){var t=e.actionType,n=(0,i._)(e,["actionType"]);(0,o.j)(o.U3.WS_WEBVIEW_USED,(0,r._)({type:t},n))}function l(){a({actionType:"refresh"})}function c(){a({actionType:"history_forward"})}function s(){a({actionType:"history_back"})}function u(e){a({actionType:"navigated_to",path:e})}function d(){a({actionType:"devtools_opened"})}function f(){a({actionType:"open_new_window"})}},86793:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(43429),i=n(18107);function o(e){var t=e.container,n=e.runner,o=e.refreshWebView;(0,r.useEffect)(function(){var e,r=[];return"outputs"===n.mode&&r.push(n.onBlockChanged(function(t){t.type===i.kH.EXECUTION&&1===t.data.exitCode&&(e=Date.now())})),r.push(t.onPortOpened(function(t){var n=t.isVnc;if(t.isForwarded&&!n){var r=Date.now();void 0!==e&&r-e<1e3||o()}})),function(){return r.forEach(function(e){return e()})}},[t,o,n])}},45495:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(43429),i=n(18107);function o(e){var t=e.runner,n=e.refreshWebView;(0,r.useEffect)(function(){if("html"===t.mode)return t.onStateChanged(function(e){e===i.Ah.RUNNING&&n()})},[t,n])}},30686:function(e,t,n){n.d(t,{S:function(){return f},e:function(){return d}});var r=n(32477),i=n(18107),o=n(54916),a=n(47507),l=n(43429),c=n(90234),s=n(71999),u=(0,c.cn)(!1),d=function(){return(0,s.KO)(u)};function f(){var e=(0,o.Z)().runner,t=(0,r._)(d(),2),n=t[0],c=t[1];return l.useEffect(function(){if("outputs"===e.mode){var t,n=[],r=Date.now(),o=Array(6),l=0;return n.push(e.onLocalRun(function(){r=Date.now(),c(!1)})),n.push(e.onStateChanged(function(e){if(!(t===i.Ah.RUNNING&&e===i.Ah.IDLE)){t=e;return}var n=l%6,s=Date.now();o[n]=s;var u=o[n>0?n-1:5];void 0!==u&&s-u<6e4&&null!=r&&r<u&&(c(!0),a.kg.info("webview circuit broken",{lastRunnerStops:JSON.stringify(o),runnerStopCount:l,lastLocalRunTimestamp:r})),l++,t=e})),function(){c(!1),n.forEach(function(e){return e()})}}},[e,c]),{isCircuitBroken:n}}},67774:function(e,t,n){n.d(t,{C:function(){return function e(t,n){if(!["context","action"].includes(t.data.type))throw Error("Command type not supported: "+t.data.type);if("action"===t.data.type)return{match:l.pl,data:{label:t.data.label,description:t.data.description,icon:t.data.iconPath?(0,a.tZ)(c.Z,{src:(0,u.Vh)(t.extension.baseUrl,t.data.iconPath),layout:"fill",alt:""}):(0,a.tZ)(a.HY,{children:" "}),type:"action",run:(0,r._)(function(){var e;return(0,o.Jh)(this,function(n){switch(n.label){case 0:if(!(e=t.run))throw Error("Action command must have run");return[4,e()];case 1:return[2,n.sent()]}})})}};var s,d=t.commands;if(!d)throw Error("Context command must have commands");return{match:l.pl,data:{label:t.data.label,description:t.data.description,icon:t.data.iconPath?(0,a.tZ)(c.Z,{src:(0,u.Vh)(t.extension.baseUrl,t.data.iconPath),layout:"fill",alt:""}):(0,a.tZ)(a.HY,{}),type:t.data.type},commands:(s=(0,r._)(function(r){var a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,d({active:r.active,search:r.search,path:a=(0,i._)(n.path).concat([{data:t.data}])})];case 1:return[2,o.sent().map(function(t){return e(t,{path:a})})]}})}),function(e){return s.apply(this,arguments)})}}},V:function(){return p}});var r=n(34142),i=n(21289),o=n(87682),a=n(8182),l=n(80259),c=n(76588),s=n(19724),u=n(13090),d=n(92809),f=n(36617),h=d.Type.Object({id:d.Type.Optional(d.Type.String()),icon:d.Type.Optional(d.Type.String()),type:d.Type.Union([d.Type.Literal("action"),d.Type.Literal("context")]),label:d.Type.String(),description:d.Type.String(),contributions:d.Type.Optional(d.Type.Array(d.Type.Enum(s.Y)))});function p(e,t){return m.apply(this,arguments)}function m(){return(m=(0,r._)(function(e,t){var n,i,a;return(0,o.Jh)(this,function(l){switch(l.label){case 0:return[4,e.data];case 1:if(n=l.sent(),!f.B4.Check(h,n))throw Error("Invalid command");if(i=null,"string"==typeof n.icon){if(""===n.icon)throw Error("Command icon cannot be empty. Omit it if you do not want an icon.");i=n.icon}if(a={data:{label:n.label,description:n.description,type:n.type,iconPath:i,id:n.id?n.id:void 0},extension:t.extension},n.contributions&&(a.data.contributions=n.contributions,t.logger.warn("Command ".concat(n.label," uses deprecated contributions field"))),"context"===n.type){var c;a.commands=(c=(0,r._)(function(n){var r,i,a,l,c,s,u,d,f;return(0,o.Jh)(this,function(o){switch(o.label){case 0:r=n.active,i=n.search,a=n.path,l=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.commands({active:r,search:i,path:a})];case 2:return l=o.sent(),[3,4];case 3:return c=o.sent(),t.logger.error(c.message,{commandError:c,api:"command"}),[2,[]];case 4:return[4,l.length];case 5:s=o.sent(),u=[],d=0,o.label=6;case 6:if(!(d<s))return[3,9];return f=u.push,[4,p(l[d],t)];case 7:f.apply(u,[o.sent()]),o.label=8;case 8:return d++,[3,6];case 9:return[2,u]}})}),function(e){return c.apply(this,arguments)})}else a.run=(0,r._)(function(){var n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.run()];case 1:return r.sent(),[2,void 0];case 2:return n=r.sent(),t.logger.error(n.message,{runError:n,api:"command"}),[2,{type:"error",message:n.message}];case 3:return[2]}})});return[2,a]}})})).apply(this,arguments)}},60442:function(e,t,n){n.d(t,{oo:function(){return S},cR:function(){return x},nP:function(){return C},gI:function(){return _},Sp:function(){return k}});var r=n(32477),i=n(43429),o=n(54916),a=n(50782),l=n(45903),c=n(93295),s=n(23982),u=n(66039),d=n(13440);function f(){var e=(0,c._)(["\n  query ReplConfigIsExtension($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          isExtension\n        }\n      }\n    }\n  }\n"]);return f=function(){return e},e}function h(){var e=(0,c._)(["\n  mutation UpdateReplConfigIsExtension(\n    $replId: String!\n    $isExtension: Boolean!\n  ) {\n    updateRepl(input: { id: $replId, isExtension: $isExtension }) {\n      repl {\n        id\n        config {\n          isExtension\n        }\n      }\n    }\n  }\n"]);return h=function(){return e},e}function p(){var e=(0,c._)(["\n  query ReplExtensionHostedReplCoUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        title\n        hostedUrl\n        user {\n          username\n          id\n        }\n      }\n    }\n  }\n"]);return p=function(){return e},e}var m={},v=(0,s.Ps)(f()),g=(0,s.Ps)(h()),y=(0,s.Ps)(p()),b=n(22894),Z=n(46565),w=n(66349);function x(){var e,t=i.useContext(b.Z),n=(0,r._)(i.useState(null!==(e=null==t?void 0:t.replConfigIsExtension)&&void 0!==e&&e),2),a=n[0],l=n[1],c=(0,o.Z)().dotReplit;return i.useEffect(function(){return c.watch(function(e){var t,n,r;l(null!==(r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.isExtension)&&void 0!==r&&r)})},[c]),a}function C(){var e=(0,r._)(i.useState(null),2),t=e[0],n=e[1],a=(0,o.Z)().dotReplit;return i.useEffect(function(){return a.watch(function(e){var t,r,i=null===(r=e.config)||void 0===r?void 0:null===(t=r.extension)||void 0===t?void 0:t.extensionID;i?n((0,Z.T8)(i)):n(null)})},[a]),t}var _=function(){var e=(0,o.Z)().dotReplit,t=(0,r._)(i.useState(null),2),n=t[0],a=t[1];return i.useEffect(function(){return e.watch(function(e){var t,n,r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.staticDirectory;r?a({path:r,relativePath:r.replace(/^\.\//,"")}):a(null)})},[e]),n};function k(){var e,t,n,c,s=(0,a.Z)(),f=(e=(0,l._)({},m,{variables:{replId:s}}),u.a(v,e)),h=f.data,p=f.loading,y=f.error,b=(0,r._)((t=(0,l._)({},m,void 0),d.D(g,t)),1)[0],Z=!p&&!y&&!!(null==h?void 0:h.repl)&&"Repl"===h.repl.__typename&&null!==(c=null===(n=h.repl.config)||void 0===n?void 0:n.isExtension)&&void 0!==c&&c,w=(0,r._)(i.useState(!1),2),x=w[0],C=w[1],_=(0,o.Z)().dotReplit;i.useEffect(function(){return _.watch(function(e){var t,n,r;C(null!==(r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.isExtension)&&void 0!==r&&r)})},[_]),i.useEffect(function(){p||y||x===Z||b({variables:{replId:s,isExtension:x},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:{id:s,__typename:"Repl",config:{__typename:"ReplConfig",isExtension:x}}}}})},[p,y,s,Z,x,b])}var S=function(){var e,t,n,r,i,o=(0,w.Z)(),a=(e={variables:{replId:(null==o?void 0:o.id)||""},skip:!(null==o?void 0:o.id)},t=(0,l._)({},m,e),u.a(y,t)),c=a.data;if(a.error||!c||"Repl"!==c.repl.__typename)throw Error("Encountered an unknown error. Please contact support.");var s=null==c?void 0:null===(n=c.repl)||void 0===n?void 0:n.title,d=null==c?void 0:null===(i=c.repl)||void 0===i?void 0:null===(r=i.user)||void 0===r?void 0:r.username;if(!s||!d)throw Error("Encountered an unknown error. Please contact support.");return"https://".concat(s.replace(/[_\s]+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").toLowerCase(),".").concat(d,".repl.co")}},9149:function(e,t,n){n.d(t,{LM:function(){return r.LM},Mu:function(){return i.Mu},WF:function(){return r.WF},WG:function(){return i.WG},jx:function(){return i.jx},ot:function(){return r.ot},r9:function(){return i.r9}});var r=n(1831),i=n(18440)},1831:function(e,t,n){n.d(t,{EO:function(){return R},I1:function(){return G},Kf:function(){return D},LM:function(){return T},WF:function(){return E},bN:function(){return k},dI:function(){return I},ot:function(){return S},zm:function(){return B}});var r=n(34142),i=n(45903),o=n(25e3),a=n(32477),l=n(87682),c=n(50782),s=n(59868),u=n(70226),d=n(90234),f=n(88269),h=n.n(f),p=n(43429),m=n(13090),v=n(16385),g=n(30911),y=n.n(g),b=n(65169),Z=n(67887),w=n(18440),x=n(19418),C=n(34471),_=n(46565);function k(){var e,t=(0,x.E4)(w.We);return p.useCallback((e=(0,r._)(function(e){return(0,l.Jh)(this,function(n){return t({installationId:e}),[2]})}),function(t){return e.apply(this,arguments)}),[t])}function S(){var e,t=N(),n=t.throwSystemError,a=t.throwExtensionError,c=(0,x.E4)(w.nk),s=(0,x.ZC)(w.Ol),u=(0,x.Ld)();return p.useCallback((e=(0,r._)(function(e){var t,r,d,f,p,g,y,b,x,k,S,E,T,R,I,D,G,B,P,A;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=e.installationId,d=void 0===(r=e.forceRefetch)||r,[4,(0,Z.Al)()];case 1:if(!(f=l.sent())||f.error)return n({friendlyMessage:"Failed to load user context",error:f.error}),[2];if(p=f.result.userHasInternalApiEnabled,!(g=u.get(w.Lq).find(function(e){return e.installationId===t})))return[3,3];return[4,(0,Z.V9)(g.baseUrl)];case 2:if(y=l.sent(),b=s.createLogger({extensionId:g.extensionId,installationId:g.installationId,local:!0}),y.error)return x=(0,o._)((0,i._)({},g),{manifest:(0,m.fF)(),enableExperimentalApi:!1,enableInternalApi:!1,logger:b.createLogger({extensionName:"Unnamed Extension"}),isLocal:!0}),s.info("Adding extension: ".concat(x.manifest.name),{extensionArgs:h()(x,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:x.isLocal,error:!0}),c(x),k="Failed to load extension manifest",y.error instanceof C.Jg&&(k=y.error.message),a({extensionId:g.extensionId,installationId:g.installationId,extensionError:{error:y.error,friendlyMessage:k}}),[2];return S=(0,v.MU)(y.result,"experimental-api"),E=(0,o._)((0,i._)({},g),{manifest:y.result,enableExperimentalApi:S,enableInternalApi:p,logger:b.createLogger({extensionName:y.result.name}),isLocal:!0}),s.info("Adding extension: ".concat(E.manifest.name),{extensionArgs:h()(E,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!0}),c(E),[3,5];case 3:return[4,(0,Z.mr)(t,d)];case 4:if((T=l.sent()).error)return n({friendlyMessage:"Something went wrong while downloading an extension",error:T.error}),[2];if(!(R=T.result))return n({friendlyMessage:"Extension failed to install",error:Error("Expected installation to be defined")}),[2];if(!(I=R.extension))return n({friendlyMessage:"Extension failed to install",error:Error("Expected extension to be defined")}),[2];if(!I.manifest)return a({extensionId:(0,_.T8)(I.id),installationId:(0,_.Ad)(R.id),extensionError:{friendlyMessage:"Extension failed to install",error:Error("Expected extension manifest to be defined")}}),[2];if("ExtensionManifestError"===I.manifest.__typename)return a({extensionId:(0,_.T8)(I.id),installationId:(0,_.Ad)(R.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest: ".concat(I.manifest.message),error:Error(I.manifest.message)}}),[2];if(!I.manifest||"ExtensionManifest"!==I.manifest.__typename)return a({extensionId:(0,_.T8)(I.id),installationId:(0,_.Ad)(R.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest",error:Error("Expected extension manifest to be defined")}}),[2];return D=(0,m.tr)(I.manifest),G=(0,v.MU)(D,"experimental-api"),B=(0,_.T8)(I.id),P=I.enableInternalApi,A={extensionId:B,installationId:t,manifest:D,baseUrl:(0,m.BY)(I.url),enableExperimentalApi:G,enableInternalApi:p||P,logger:s.createLogger({extensionId:B,installationId:t,extensionName:D.name,local:!1}),isLocal:!1},s.info("Adding extension: ".concat(A.manifest.name),{extensionArgs:h()(A,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!1}),c(A),[2,R];case 5:return[2]}})}),function(t){return e.apply(this,arguments)}),[c,a,n,u,s])}function E(){var e,t=S(),n=N().throwSystemError;return p.useCallback((e=(0,r._)(function(e){var r,i,o,a,c;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return r=e.extensionId,i=e.replId,[4,(0,Z.Wc)({extensionId:r,replId:i})];case 1:if((c=l.sent()).error)return n({error:c.error,friendlyMessage:"Something went wrong while installing an extension"}),[2];return(0,s.j)(s.U3.EXTENSION_INSTALLED,{name:null===(a=c.result)||void 0===a?void 0:null===(o=a.extension)||void 0===o?void 0:o.name,extensionId:r}),[4,t({installationId:(0,_.Ad)(c.result.id)})];case 2:return l.sent(),[2,c.result]}})}),function(t){return e.apply(this,arguments)}),[t,n])}function T(){var e,t=k(),n=(0,x.Ld)(),i=N().throwSystemError;return p.useCallback((e=(0,r._)(function(e){var r,o,a;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(r=e.installationId,o=e.replId,!(a=n.get(w._t).find(function(e){return e.installationId===r})))return i({friendlyMessage:"Extension appears to be already uninstalled",error:Error("Expected extension to be defined")}),[2];if(!a.installationId||!a.extensionId)return i({friendlyMessage:"Failed to uninstall extension",error:Error("Expected installationId to be defined")}),[2];return(0,s.j)(s.U3.EXTENSION_UNINSTALLED,{name:a.manifest.name,extensionId:a.extensionId}),[4,(0,Z.Y4)({installationId:a.installationId,replId:o})];case 1:return l.sent(),[4,t(a.installationId)];case 2:return l.sent(),[2]}})}),function(t){return e.apply(this,arguments)}),[t,n,i])}function R(){var e,t=k(),n=S();return p.useCallback((e=(0,r._)(function(e){return(0,l.Jh)(this,function(r){switch(r.label){case 0:return[4,t(e)];case 1:return r.sent(),[4,n({installationId:e,forceRefetch:!0})];case 2:return r.sent(),[2]}})}),function(t){return e.apply(this,arguments)}),[t,n])}function I(){var e,t,n,i,o=(e=S(),t=(0,x.ZC)(w.Ol),n=N().throwSystemError,p.useCallback((i=(0,r._)(function(r){var i,o,a,c,s,u,d,f,h,p;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return[4,(0,Z.Zw)(r)];case 1:if((i=l.sent()).error)return n({friendlyMessage:"Failed to load installed extensions",error:i.error}),[2];o=!0,a=!1,c=void 0,l.label=2;case 2:l.trys.push([2,9,10,11]),s=i.result[Symbol.iterator](),l.label=3;case 3:if(o=(u=s.next()).done)return[3,8];if(null===(f=(d=u.value).extension)||void 0===f?void 0:f.isDisabled)return t.info("Skipping disabled extension: ".concat(d.extension.name),{extension:!0,extensionId:d.extension.id,installationId:d.id}),[3,7];l.label=4;case 4:return l.trys.push([4,6,,7]),[4,e({installationId:(0,_.Ad)(d.id),forceRefetch:!0})];case 5:return l.sent(),[3,7];case 6:return h=l.sent(),t.error("Extension Loading error: ".concat(h.message),{extension:!0,errors:h.message}),[3,7];case 7:return o=!0,[3,3];case 8:return[3,11];case 9:return p=l.sent(),a=!0,c=p,[3,11];case 10:try{o||null==s.return||s.return()}finally{if(a)throw c}return[7];case 11:return[2]}})}),function(e){return i.apply(this,arguments)}),[e,n,t])),c=(0,x.E4)(w.Ol),s=(0,x.E4)(w.zk),d=(0,a._)(p.useState(!1),2),f=d[0],h=d[1],m=(0,a._)(p.useState(null),2),v=m[0],g=m[1],y=(0,a._)(p.useState(null),2),b=y[0],C=y[1];return p.useEffect(function(){if(v&&b&&!f){var e=v.replId;h(!0),o(e)}},[v,b,o,f]),p.useCallback(function(e){var t=e.replId,n=e.userId;if(!f){g({replId:t,userId:n});var r=(0,u.Z)({extension:!0,isInitialized:!0,replId:t,userId:n},{onLog:function(e){s(e)}});C(r),c(r)}},[c,f,s])}function D(){var e,t=S(),n=(0,w.qr)(),i=(0,w.Mu)(),o=(0,x.E4)(w.ot);return p.useCallback((e=(0,r._)(function(e){var r,a;return(0,l.Jh)(this,function(l){return r=(0,m.BY)(e),(a=n.find(function(e){return e.baseUrl===r}))||o(a={extensionId:(0,_.T8)(y()()),installationId:(0,_.Ad)(y()()),baseUrl:r}),i.find(function(e){return e.extensionId===(null==a?void 0:a.extensionId)})||t({installationId:a.installationId}),[2]})}),function(t){return e.apply(this,arguments)}),[n,i,o,t])}function G(){var e=(0,c.Z)(),t=(0,b.q_)({variables:{replId:e}}).data,n=(0,x.E4)(w.M1),i=(0,x.Ld)(),o=S();return p.useCallback((0,r._)(function(){var e;return(0,l.Jh)(this,function(r){switch(r.label){case 0:if((null==t?void 0:t.repl.__typename)!=="Repl")return[2];return[4,o({installationId:(e=n(t.repl.hostedUrl)).installationId,forceRefetch:!0})];case 1:return r.sent(),[2,i.get(w._t).find(function(t){return t.installationId===e.installationId})]}})}),[t,n,o,i])}function B(){var e=(0,c.Z)(),t=(0,b.q_)({variables:{replId:e}}).data,n=(0,x.E4)(w.M1),r=(0,w.Mu)();return p.useMemo(function(){if((null==t?void 0:t.repl.__typename)==="Repl"){var e=n(t.repl.hostedUrl);return r.find(function(t){return e.installationId===t.installationId})}},[t,r,n])}var P=(0,d.cn)(null,function(e,t,n){var r=e(w.Ol);t(w.wQ,n),r.error("Extension System Error: ".concat(n.error.message),{extensionSystem:!0,originalError:n.error.message,friendlyMessage:n.friendlyMessage})}),A=(0,d.cn)(null,function(e,t,n){var r=e(w._t),i=e(w.Ol),o=r.find(function(e){return e.extensionId===n.extensionId});if(i.error("Extension Error: ".concat(n.extensionError.friendlyMessage),{extension:!0,extensionId:n.extensionId,originalError:n.extensionError.error.message,friendlyMessage:n.extensionError.friendlyMessage}),!o){t(w.nk,{extensionId:n.extensionId,installationId:n.installationId,manifest:(0,m.fF)({name:n.extensionId}),baseUrl:"",enableExperimentalApi:!1,enableInternalApi:!1,logger:i.createLogger({extensionId:n.extensionId,extensionName:n.extensionId,installationId:n.installationId,local:void 0}),isLocal:null}),t(w.f4,{extensionId:n.extensionId,extensionError:n.extensionError});return}t(w.f4,{extensionId:n.extensionId,extensionError:n.extensionError})});function N(){return{throwSystemError:(0,x.E4)(P),throwExtensionError:(0,x.E4)(A)}}},67887:function(e,t,n){n.d(t,{Al:function(){return b},V9:function(){return g},Wc:function(){return s},Y4:function(){return d},Zw:function(){return m},mr:function(){return h}});var r=n(34142),i=n(87682),o=n(24646),a=n(64540),l=n(13090),c=n(65169);function s(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e){var t,n,r,o,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=e.extensionId,n=e.replId,!a.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,a.l.mutate({mutation:c.aq,variables:{extensionId:t,replId:n}})];case 1:if((o=i.sent()).errors&&o.errors.length>0)return[2,{error:Error("Error when installing extension: "+o.errors.map(function(e){return e.message}).join(", ")),result:null}];if(!(l=null===(r=o.data)||void 0===r?void 0:r.installExtension))return[2,{error:Error("Error when installing extension: expected result"),result:null}];if((null==l?void 0:l.__typename)==="UnauthorizedError"||(null==l?void 0:l.__typename)==="UserError")return[2,{error:Error("Error when installing extension: "+l.message),result:null}];if(!l.extension)return[2,{error:Error("Error when installing extension: expected extension to be set"),result:null}];if(!l.extension.url)return[2,{error:Error("Error when installing extension: Extension does not have a URL and cannot be installed"),result:null}];return[2,{result:l,error:null}]}})})).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,o,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=e.installationId,n=e.replId,!a.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,a.l.mutate({mutation:c.jF,variables:{installationId:t,replId:n}})];case 1:if((o=i.sent()).errors&&o.errors.length>0)return[2,{error:Error("Error when uninstalling extension: "+o.errors.map(function(e){return e.message}).join(", ")),result:null}];if(!(l=null===(r=o.data)||void 0===r?void 0:r.uninstallExtension))return[2,{error:Error("Error when uninstalling extension: expected result"),result:null}];if((null==l?void 0:l.__typename)==="NotFoundError"||(null==l?void 0:l.__typename)==="UserError")return[2,{error:Error("Error when uninstalling extension: "+l.message),result:null}];return[2,{result:l,error:null}]}})})).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)(function(e){var t,n,r=arguments;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=r.length>1&&void 0!==r[1]&&r[1],!a.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,a.l.query({query:c.AR,variables:{installationId:e},fetchPolicy:t?"network-only":"cache-first"})];case 1:if("ExtensionInstallation"!==(n=i.sent().data.extensionInstallationById).__typename)return[2,{error:Error("Expected to find extension installation"),result:null}];if(!n.extension)return[2,{error:Error("Expected installation.extension"),result:null}];return[2,{result:n,error:null}]}})})).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=(0,r._)(function(e){var t;return(0,i.Jh)(this,function(n){switch(n.label){case 0:if(!a.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,a.l.query({query:c.Ve,variables:{replId:e}})];case 1:if("ExtensionInstallationList"!==(t=n.sent().data.extensionInstallations).__typename)return[2,{error:Error("Expected to find ExtensionInstallationList"),result:null}];return[2,{result:t.installations,error:null}]}})})).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(e){var t,n,r,a,c;return(0,i.Jh)(this,function(i){switch(i.label){case 0:t=(0,l.BP)(e),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(t)];case 2:return[4,i.sent().text()];case 3:if(n=i.sent(),r=o.ku(n),(a=(0,l.U4)(r)).error)return[2,{error:a.error,result:null}];return[2,{result:a.manifest,error:null}];case 4:if("SyntaxError"===(c=i.sent()).name)return[2,{error:Error("Error when fetching manifest: invalid JSON"),result:null}];return[2,{error:Error("Error when fetching manifest: "+c.message),result:null}];case 5:return[2]}})})).apply(this,arguments)}function b(){return Z.apply(this,arguments)}function Z(){return(Z=(0,r._)(function(){var e;return(0,i.Jh)(this,function(t){switch(t.label){case 0:if(!a.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,a.l.query({query:c.LF,fetchPolicy:"cache-first"})];case 1:if(!(e=t.sent().data.currentUser)||"CurrentUser"!==e.__typename)return[2,{error:Error("Expected to find CurrentUser"),result:null}];return[2,{result:{userHasInternalApiEnabled:e.isAdmin||e.isStaff},error:null}]}})})).apply(this,arguments)}},18440:function(e,t,n){n.d(t,{Lq:function(){return C},M1:function(){return B},Mu:function(){return X},Ol:function(){return k},UB:function(){return T},UT:function(){return R},WG:function(){return H},We:function(){return P},_K:function(){return N},_t:function(){return x},c_:function(){return W},ep:function(){return I},f4:function(){return A},jx:function(){return M},nk:function(){return D},ot:function(){return G},qr:function(){return z},r9:function(){return F},s6:function(){return V},wQ:function(){return _},zk:function(){return E}});var r,i,o,a=n(34142),l=n(45903),c=n(25e3),s=n(32477),u=n(21289),d=n(87682),f=n(90234),h=n(46565),p=n(92153),m=n(19418),v=n(30911),g=n.n(v),y=n(70226),b=n(36846),Z=n.n(b),w=n(50199),x=(0,f.cn)([]),C=(0,f.cn)([]),_=(0,f.cn)(null),k=(0,f.cn)((0,y.Z)({extension:!0,isInitialized:!1},{onLog:function(){throw Error("Logged before extension system was initialized.")}})),S=(0,f.cn)([]),E=(0,f.cn)(null,function(e,t,n){var r=e(S);t(S,(0,p.ZP)(r,function(e){e.push((0,p.ZP)(n,function(t){t.index=e.length})),e.length>1e3&&e.splice(0,e.length-1e3)}))}),T=(0,f.cn)(null,function(e,t){t(S,[])}),R=(0,f.cn)("local:true"),I=(0,f.cn)(function(e){var t=e(S),n=e(R);if(!n)return t;var r=n.split(" ").map(function(e){var t=(0,s._)(e.split(":"),2),n=t[0],r=t[1];return n&&void 0===r?function(e){return e.message.toLowerCase().includes(n.toLowerCase())}:n&&""===r?function(e){return void 0!==Z()(e,n)}:n&&r?function(e){try{return String(Z()(e,n))===r}catch(e){return!1}}:null}).filter(function(e){return null!==e});return t.filter(function(e){return r.every(function(t){return t(e)})})}),D=(0,f.cn)(null,(r=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(r){if(e(x).find(function(e){return e.extensionId===n.extensionId}))throw Error("Extension already loaded");return t(x,function(e){return(0,p.ZP)(e,function(e){var t,r,i,o,a,l,c,s,u=(r=n.baseUrl,i=n.extensionId,o=n.installationId,a=n.manifest,l=n.enableExperimentalApi,c=n.enableInternalApi,s=n.logger,{baseUrl:r,extensionId:i,installationId:o,manifest:a,isLocal:n.isLocal,stateAtom:(0,f.cn)({error:null,panes:[],scopes:new Set(null===(t=a.scopes)||void 0===t?void 0:t.map(function(e){return e.name})),enableExperimentalApi:l,enableInternalApi:c,commands:new Map}),logger:s});e.push(u)})}),[2]})}),function(e,t,n){return r.apply(this,arguments)})),G=(0,f.cn)(null,(i=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(r){if(e(C).find(function(e){return e.extensionId===n.extensionId||e.installationId===n.installationId||e.baseUrl===n.baseUrl}))throw Error("Extension already loaded");return t(C,function(e){return(0,p.ZP)(e,function(e){e.push(n)})}),[2]})}),function(e,t,n){return i.apply(this,arguments)})),B=(0,f.cn)(null,function(e,t,n){var r=e(C).find(function(e){return e.baseUrl===n});if(r)return r;var i={baseUrl:n,extensionId:(0,h.T8)(g()()),installationId:(0,h.Ad)(g()())};return t(C,function(e){return(0,p.ZP)(e,function(e){e.push(i)})}),i}),P=(0,f.cn)(null,(o=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(e){return t(x,function(e){return(0,p.ZP)(e,function(e){var t=e.findIndex(function(e){return"extensionId"in n?e.extensionId===n.extensionId:e.installationId===n.installationId});-1!==t&&e.splice(t,1)})}),[2]})}),function(e,t,n){return o.apply(this,arguments)})),A=(0,f.cn)(null,function(e,t,n){var r=e(x).find(function(e){return e.extensionId===n.extensionId});if(!r)throw Error("Extension not found");t(r.stateAtom,function(e){return(0,p.ZP)(e,function(e){e.error=n.extensionError})})}),N=(0,f.cn)(null,function(e,t,n){var r=n.createCommand.id;t(n.extensionStateAtom,function(e){return(0,p.ZP)(e,function(e){e.commands.set(r,n.createCommand)})})}),U=(0,f.cn)(function(e){return e(x).flatMap(function(t){return(0,u._)(e(t.stateAtom).commands.values())})}),L=(0,f.cn)(function(e){return e(x).map(function(e){var t;return null===(t=e.manifest.fileHandlers)||void 0===t?void 0:t.map(function(t){return(0,c._)((0,l._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})}),O=(0,f.cn)(function(e){return e(x).map(function(e){var t;return null===(t=e.manifest.tools)||void 0===t?void 0:t.map(function(t){return(0,c._)((0,l._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})});function X(){return(0,m.ZC)(x)}function M(e){return X().find(function(t){return t.installationId===e})}function F(e){var t=M(e);return t&&e?t.stateAtom:null}function W(){return(0,m.ZC)(L)}function H(){return(0,m.ZC)(O)}function V(e){var t=(0,m.ZC)(U);return(0,w.Z)(function(){return t.filter(function(t){return t.contributions.includes(e)})},[t,e])}function z(){return(0,m.ZC)(C)}},19418:function(e,t,n){n.d(t,{E4:function(){return f},Ld:function(){return s},OA:function(){return u},Wv:function(){return h},ZC:function(){return d}});var r=n(32477),i=n(8182),o=n(90234),a=n(71999),l=n(43429),c=(0,l.createContext)(null);function s(){return function(){var e=(0,l.useContext)(c);if(!e)throw Error("Expected extensions context");return e}().store}var u=function(e){var t=s();return(0,a.KO)(e,{store:t})};function d(e){var t=s();return(0,a.Dv)(e,{store:t})}var f=function(e){var t=s();return(0,a.b9)(e,{store:t})};function h(e){var t=e.children,n=(0,r._)(l.useState(function(){return(0,o.MT)()}),1)[0];return(0,i.tZ)(c.Provider,{value:{store:n},children:t})}},19724:function(e,t,n){var r,i;n.d(t,{Y:function(){return r}}),(i=r||(r={})).CommandBar="commandbar",i.FiletreeContextMenu="filetree-context-menu",i.SidebarSearch="sidebar-search",i.EditorContextMenu="editor-context-menu"},70226:function(e,t,n){n.d(t,{Z:function(){return function e(t,n){var r=function(e){var r,i,l,s,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{logLevel:"debug"},h=null!==(r=(i={},(0,o._)(i,"debug",c.kg.debug),(0,o._)(i,"warn",c.kg.warn),(0,o._)(i,"info",c.kg.info),(0,o._)(i,"error",c.kg.error),i)[f.logLevel])&&void 0!==r?r:c.kg.debug;(null!==(l=(s={},(0,o._)(s,"debug",d.debug),(0,o._)(s,"warn",d.warn),(0,o._)(s,"info",d.info),(0,o._)(s,"error",d.error),s)[f.logLevel])&&void 0!==l?l:d.debug)(e,f),h(e,u()((0,a._)({},f,t),["replId","logLevel"])),n.onLog((0,a._)({message:e},f,t))};return{context:t,info:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"info"}))},warn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"warn"}))},error:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"error"}))},createLogger:function(r){return e((0,a._)({},t,r),n)}}}},i:function(){return i}});var r,i,o=n(39698),a=n(45903),l=n(25e3),c=n(47507),s=n(61335),u=n.n(s),d=n(33212);(r=i||(i={})).debug="debug",r.info="info",r.warn="warn",r.error="error"},3574:function(e,t,n){n.d(t,{Cl:function(){return a},VD:function(){return d},uN:function(){return u}});var r=n(90234),i=n(71999),o=n(43429),a=(0,o.createContext)(null),l=(0,r.cn)(null),c=(0,r.cn)(null,function(e,t,n){t(l,n)});function s(){var e=(0,o.useContext)(a);if(!e)throw Error("Expected store in context");return e}function u(){return(0,i.Dv)(l,{store:s()})}function d(e){var t=(0,i.Dv)(l,{store:s()}),n=(0,i.b9)(c,{store:s()});(0,o.useEffect)(function(){t!==e&&n(e)},[e,t,n])}},88883:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(54916),i=n(43429),o=n(29559);function a(e){var t=(0,r.Z)().fs,n=(0,i.useCallback)(function(n,r){var i=n.code,a=n.insertAt,l=n.newLine,c=void 0===l||l;if(!e||(0,o.T3)(e)||(0,o.sL)(e)||(0,o.IQ)(e))throw Error("Invalid file, this should never happen");if(0!==i.length)var s=t.watchTextFile(e,{onReady:function(e){var n=e.initialContent,o=e.writeChange,l=n.toString(),u="end"===a?l.length:a,d=i;c&&(0!==u&&u!==l.length&&-1===(u=l.indexOf("\n",u))&&(u=l.length),0!==u&&"\n"!==l[u-1]&&(d="\n"+d),"\n"!==l[u]&&(d+="\n")),o({from:u,insert:d},r),t.flush().finally(function(){s()})}})},[e,t]);return!e||(0,o.T3)(e)||(0,o.sL)(e)?null:n}},51279:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(34142),i=n(32477),o=n(21289),a=n(87682),l=n(43429),c=n(58626),s=n(59868),u=n(30084),d=n(58091),f=n(54916),h=n(63009),p=n(29559),m=n(26851),v=n(86790),g=n(17789);function y(e){var t,n,y,b=e.moveOrDeleteFile,Z=(0,f.Z)().fs,w=(0,m.K)(),x=(0,l.useRef)(new Map),C=(0,d.ex)(),_=(0,i._)((0,l.useState)(!1),2),k=_[0],S=_[1],E=(0,i._)((0,l.useState)(!1),2),T=E[0],R=E[1],I=(0,i._)((0,l.useState)([]),2),D=I[0],G=I[1],B=(0,v.k)(),P=(0,h.uV)(),A=D.map(function(e){return e.path}).map(function(e){return{title:e,path:e}}),N=(0,i._)((0,l.useState)(),2),U=N[0],L=N[1],O=(0,d.Gg)();(0,l.useEffect)(function(){if(!(!C||x.current.has(C))&&C!==g.w){var e=function(e){var t=e.node.path;O(e.eventType===u.kS.Move?{path:t,type:"move",to:e.to}:{path:t,type:"delete"}),b&&b(e),x.current.delete(C),G(function(e){return e.filter(function(e){return e.path!==C})})};(0,p.Mb)(C)?Z.watchTextFile(C,{onMoveOrDelete:e,onError:function(e,t){e.code||(Z.flush(),Z.persist({skipDebounce:!0}),P({error:e,extras:t,tags:{ot:!0},origin:"useContentsDiverged: fs.watchTextFile"}))},onReconnectFail:function(e,t){G(function(n){return(0,o._)(n.filter(function(e){return e.path!==C})||[]).concat([{path:C,prompt:t,cb:e}])}),w("user:ot:diverged",{path:C,divergence:t}),S(!0),U||L(C)}}):Z.watchFile(C,{onChange:function(){},onMoveOrDelete:e}),x.current.set(C,!0)}},[C,Z,P,b,U,w,O]);var X=(t=(0,r._)(function(e){return(0,a.Jh)(this,function(t){switch(t.label){case 0:return(0,s.j)(s.U3.FILE_RECONNECT_FALLBACK_CHOSEN,{choice:e}),(0,s.j)(s.U3.CONTENTS_DIVERGED_ACTION,{action:"local"===e?"client":"server"}),R(!0),[4,Promise.all(D.map(function(t){return G(function(e){var n=e.filter(function(e){return e.path!==t.path});return 0===n.length?S(!1):L(n[0].path),n}),t.cb(e)}))];case 1:return t.sent(),R(!1),[2]}})}),function(e){return t.apply(this,arguments)}),M=U?D.find(function(e){return e.path===U}):null,F=null==M?void 0:M.prompt,W=(0,c.J)({left:{code:null!==(n=null==F?void 0:F.localContent)&&void 0!==n?n:"",filePath:U},right:{code:null!==(y=null==F?void 0:F.remoteContent)&&void 0!==y?y:"",filePath:U}});return{isConverging:T,didContentsDiverge:k,showMoreDetail:B,failedFiles:D,failedFilesOptions:A,selectedFile:U,setSelectedFile:L,reviewingPrompt:F,onChoice:X,local:W.left,remote:W.right}}},78392:function(e,t,n){n.d(t,{F:function(){return eo}});var r,i,o,a,l,c,s=n(34142),u=n(45903),d=n(25e3),f=n(32477),h=n(87682),p=n(59121),m=n(55534),v=n(50782),g=n(47507),y=n(24774),b=n.n(y),Z=function(e){var t=b()(e,{baseUrl:!1}).pathname.replace(/\.git$/,"");if(t){var n=(0,f._)(t.split("/").reverse(),2),r=n[0],i=n[1];if(i&&r)return{username:i,repository:r}}},w=n(81106),x=n(54916);(r=a||(a={}))[r.NONE=0]="NONE",r[r.PUSH=1]="PUSH",r[r.CLONE=2]="CLONE",r[r.FETCH=3]="FETCH",r[r.GITHUB_CREATE=4]="GITHUB_CREATE",r[r.GITHUB_GET_INFO=5]="GITHUB_GET_INFO",(i=l||(l={})).None="NONE",i.NoMergeBase="NO_MERGE_BASE",i.AuthFetchError="AUTH_FETCH_ERROR",i.IndexFilesCorrupted="INDEX_FILES_CORRUPTED",(o=c||(c={}))[o.UNTRACKED=0]="UNTRACKED",o[o.MODIFIED=1]="MODIFIED",o[o.MOVED=2]="MOVED",o[o.DELETED=3]="DELETED";var C="git log -0 2>/dev/null && ".concat("git symbolic-ref HEAD --short"," || echo 'HEAD'");function _(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return["bash","-c",t.join("&&")]}var k={format:function(e,t){return _('[ ! -d ".git" ]',"git init","git checkout -b main",'git config user.name "'.concat(t.username||"Replit user",'"'),'git config user.email "<>"',"touch .git/branches/.keep","touch .git/info/.keep","touch .git/objects/.keep","touch .git/refs/.keep")}},S={format:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=null!==(t=e.remote)&&void 0!==t?t:"";return n?_("git fetch ".concat(r," --progress --deepen=10")):_("git fetch ".concat(e.remote," +refs/heads/*:refs/remotes/origin/* --progress --depth=10"))},parse:function(e,t){return null!==new RegExp(/(^|\n)fatal: Authentication failed/g).exec(t)||null!==new RegExp(/(^|\n)fatal: unable to access/g).exec(t)||null!==new RegExp(/(^|\n)fatal: repository.*not found/g).exec(t)||null!==new RegExp(/(^|\n)fatal: could not read Username/g).exec(t)||null!==new RegExp(/(^|\n)fatal: Could not read from remote repository/g).exec(t)?(0,d._)((0,u._)({},e),{authError:a.FETCH}):e}},E={format:function(e){return["git","remote","get-url","origin"]},parse:function(e,t){return t.includes("No such remote")||t.startsWith("fatal")?(0,d._)((0,u._)({},e),{remote:""}):(0,d._)((0,u._)({},e),{remote:t.trim()})}},T={format:function(e,t){return e.remote?_("git remote remove origin; git remote add origin ".concat(t)):_("git remote add origin ".concat(t))}},R={format:function(e){var t;return _("git remote show ".concat(null!==(t=e.remote)&&void 0!==t?t:""," | grep 'HEAD branch'"))},parse:function(e,t){var n=(0,f._)(t.split(":"),2),r=(n[0],n[1]).trim();return(0,d._)((0,u._)({},e),{defaultBranch:r})}},I={format:function(e){return _("git checkout -f ".concat(e.defaultBranch))}},D={format:function(e){return _("if ! (( $(busybox ps -o comm | grep git) )) ; then rm -rf .git/index.lock; fi ; ".concat("git reset $(".concat(C,") --")))}},G=n(45123),B=n(42703),P=n.n(B),A=n(43429),N=n(93295),U=n(23982),L=n(43910);function O(){var e=(0,N._)(["\n  query WorkspacePatchDotReplitRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        rootOriginReplUrl\n      }\n    }\n  }\n"]);return O=function(){return e},e}var X={},M=(0,U.Ps)(O()),F=function(e,t){return{op:"add",path:e,value:JSON.stringify(t)}},W=new Map([["hintsList","hints"]]);function H(){return(H=(0,s._)(function(e){var t,n,r,i,o,a,l,c,d,p,m,v,g,y,b;function Z(){return w.apply(this,arguments)}function w(){return(w=(0,s._)(function(){var e,n,o;return(0,h.Jh)(this,function(a){switch(a.label){case 0:if(!(e="object"==typeof r.env?r.env:null)||0===Object.keys(e).length)return[2];return o=(n="object"==typeof i.env?i.env:null)?(0,u._)({},e,n):e,[4,t.updateDotReplit([F("env",o)])];case 1:return a.sent(),[2]}})})).apply(this,arguments)}function x(){return C.apply(this,arguments)}function C(){return(C=(0,s._)(function(){var e,o,a,l;return(0,h.Jh)(this,function(c){switch(c.label){case 0:if(null===(e=i.nix)||void 0===e?void 0:e.channel)return[2];if(null==r?void 0:null===(o=r.nix)||void 0===o?void 0:o.channel)return[3,2];return[4,n.getLatestStableChannel()];case 1:if(!(l=c.sent()).channel)return[2];return a=l.channel,[3,3];case 2:a=r.nix.channel,c.label=3;case 3:return[4,t.updateDotReplit([F("nix/channel",a)])];case 4:return c.sent(),[2]}})})).apply(this,arguments)}function _(){return(_=(0,s._)(function(e){var n,o,a,l,c;return(0,h.Jh)(this,function(s){switch(s.label){case 0:if(o=!!(n=i[e]),Array.isArray(n)?o=n.length>0:n&&"object"==typeof n&&(o=Object.keys(n).length>0),l=null!==(a=W.get(e))&&void 0!==a?a:e,o||!r[l])return[2];return c=F(l,r[l]),[4,t.updateDotReplit([c])];case 1:return s.sent(),[2]}})})).apply(this,arguments)}return(0,h.Jh)(this,function(s){switch(s.label){case 0:t=e.dotReplit,n=e.nixService,r=e.templateConfig,i=e.config,o=[],a={entrypoint:"entrypoint config",hidden:"hidden files config",audio:"audio config",run:"run command",refreshWebViewOnFileChange:"webview refresh config",language:"language config",onBoot:"onBoot command",languages:"languages config",compile:"compile command",debugger:"debugger config",packager:"packager config",interpreter:"interpreter config",unitTest:"unit test config",nix:x,env:Z,hosting:"hosting config",gitHubImport:"GitHub import config",auth:"Repl Auth config",hintsList:"Hints config",ports:"Ports config",deployment:"deployment config",orderedEnv:null,modules:"nix modules config",extension:"extension config",rules:"rules config",suggestions:"suggestions config"},l=[],c=!0,d=!1,p=void 0;try{for(m=Object.entries(a)[Symbol.iterator]();!(c=(v=m.next()).done);c=!0)y=(g=(0,f._)(v.value,2))[0],b=g[1],null!==b&&("function"==typeof b?l.push(b()):l.push(function(e){return _.apply(this,arguments)}(y)))}catch(e){d=!0,p=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw p}}return[4,Promise.all(l)];case 1:return s.sent(),[2,o]}})})).apply(this,arguments)}var V=n(71042),z=n(50682),j=n(24418),q=n(37229),Y=n(39756),$=n(30084),J=n(13440);function K(){var e=(0,N._)(["\n  query WorkspaceDoGitHubImportFlow($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          gitRemoteUrl\n          doClone\n        }\n      }\n    }\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n      }\n      username\n    }\n  }\n"]);return K=function(){return e},e}function Q(){var e=(0,N._)(["\n  mutation WorkspaceDoGitHubImportFlowFinishClone($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          doClone\n        }\n      }\n    }\n  }\n"]);return Q=function(){return e},e}function ee(){var e=(0,N._)(["\n  query GitHubImportRootOriginReplUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        rootOriginReplUrl\n      }\n    }\n  }\n"]);return ee=function(){return e},e}var et={},en=(0,U.Ps)(K()),er=(0,U.Ps)(Q());ee();var ei=n(88422).lW;function eo(e){var t,n,r,i,o,c,y,b,C,_,B,N,U,O,F,W,K,Q,ee,eo,ea,el,ec,es,eu,ed,ef,eh,ep=e.insertConfigPlugin,em=e.setConfigScreenLockIsOpen,ev=e.openFile,eg=(0,v.Z)(),ey=(0,f._)((t=(0,u._)({},et,void 0),J.D(er,t)),2),eb=ey[0],eZ=ey[1],ew=(0,f._)((0,A.useState)(null),2),ex=ew[0],eC=ew[1],e_=(0,x.Z)(),ek=e_.container,eS=e_.fs,eE=e_.runner,eT=e_.dotReplit,eR=(0,w.Z)(ek),eI=(0,m.Z)(),eD=eI.showError,eG=eI.showConfirm,eB=(r=(n=(0,x.Z)()).dotReplit,i=n.nixService,o=(0,v.Z)(),y=(0,f._)((c=(0,u._)({},X,void 0),L.t(M,c)),1)[0],C=(b=(0,m.Z)()).showWarning,_=b.showError,(0,A.useCallback)((B=(0,s._)(function(e){var t,n,a,l,c,s,u,d,f,p,m;return(0,h.Jh)(this,function(h){switch(h.label){case 0:return[4,r.getConfig()];case 1:if(!(t=h.sent().config))return[2];return[4,y({variables:{replId:o}})];case 2:if(!(null==(a=(null==(n=h.sent().data)?void 0:n.repl.__typename)==="Repl"?n.repl:null)?void 0:a.rootOriginReplUrl))return[2];try{l=P().parse(e.toString())}catch(e){return _("Failed to parse template .replit file"),g.kg.error("GitHub Import: Failed to parse template .replit file"),[2]}if(!l)return[2];return[4,function(e){return H.apply(this,arguments)}({nixService:i,dotReplit:r,config:t,templateConfig:l})];case 3:c=h.sent(),s=!0,u=!1,d=void 0;try{for(f=c[Symbol.iterator]();!(s=(p=f.next()).done);s=!0)m=p.value,C(m,1e3)}catch(e){u=!0,d=e}finally{try{s||null==f.return||f.return()}finally{if(u)throw d}}return[2]}})}),function(e){return B.apply(this,arguments)}),[o,C,_,r,i,y]));(0,A.useEffect)(function(){eZ.error&&eD("Failed to finish cloning Repl - "+eZ.error)},[eZ.error,eD]),(0,A.useEffect)(function(){ex&&eD("Failed to finish cloning Repl - "+ex)},[ex,eD]),(0,A.useEffect)(function(){eZ.data&&eG("Finished cloning Repl")},[eZ.data,eG]),(0,A.useEffect)(function(){eP()},[]);var eP=(0,f._)((U={variables:{replId:eg},fetchPolicy:"no-cache",onCompleted:(N=(0,s._)(function(e){var t,n,r,i,o,a;return(0,h.Jh)(this,function(l){switch(l.label){case 0:if(t=e.repl,n=e.currentUser,"Repl"!==t.__typename||!n||"CurrentUser"!==n.__typename||!t.config.gitRemoteUrl||!t.config.doClone)return[2];l.label=1;case 1:return l.trys.push([1,3,4,5]),em(!0),[4,e$({remote:null!==(i=t.config.gitRemoteUrl)&&void 0!==i?i:"",accessToken:null!==(o=null===(r=n.gitHubInfo)||void 0===r?void 0:r.accessToken)&&void 0!==o?o:null,username:n.username})];case 2:return l.sent(),[3,5];case 3:return a=l.sent(),g.kg.error("GitHub Import: Failed to do GitHub import flow",{originalError:String(a)}),eC(String(a)),[3,5];case 4:return em(!1),[7];case 5:return[2]}})}),function(e){return N.apply(this,arguments)})},O=(0,u._)({},et,U),L.t(en,O)),1)[0],eA={isInitialized:!1,hasConflictsWithFetchedRemote:!1,hasMergeBaseWithFetchedRemote:!0,authError:a.NONE,badState:l.None,remote:"",repoId:null,branch:"",defaultBranch:"main",branches:[],installations:[],changedFiles:[],commits:[],commitsAhead:null,commitsBehind:null,remoteToken:null,gitHubName:null,ownerId:null,gitHubAvatarUrl:null,gitHubEmail:null},eN=(F=(0,s._)(function(e){return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,eR({args:k.format(eA,null!=e?e:"")})];case 1:return t.sent(),[2]}})}),function(e){return F.apply(this,arguments)}),eU=(W=(0,s._)(function(e){return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,eR({args:T.format(eA,e)})];case 1:return t.sent(),[2]}})}),function(e){return W.apply(this,arguments)}),eL=(K=(0,s._)(function(){var e;return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,eR({args:E.format(eA)})];case 1:if(e=t.sent(),!E.parse)return[2];return[2,E.parse(eA,null===e.error?e.output:"").remote]}})}),function(){return K.apply(this,arguments)}),eO=(Q=(0,s._)(function(e){var t,n,r;return(0,h.Jh)(this,function(i){switch(i.label){case 0:return t=e.remote,n=e.remoteToken,[4,eR({args:R.format((0,d._)((0,u._)({},eA),{remote:t,remoteToken:n}))})];case 1:if(r=i.sent(),!R.parse)return[2];return[2,R.parse(eA,null===r.error?r.output:"HEAD branch: main").defaultBranch]}})}),function(e){return Q.apply(this,arguments)}),eX=(ee=(0,s._)(function(e){return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,eR({args:I.format((0,d._)((0,u._)({},eA),{defaultBranch:e}))})];case 1:return t.sent(),[2]}})}),function(e){return ee.apply(this,arguments)}),eM=(eo=(0,s._)(function(e){var t,n;return(0,h.Jh)(this,function(r){switch(r.label){case 0:return t=e.remote,n=e.remoteToken,[4,eF()];case 1:return r.sent(),[4,eL()];case 2:return r.sent(),[4,eW({deepen:!0,remote:t,remoteToken:n})];case 3:return r.sent(),[2]}})}),function(e){return eo.apply(this,arguments)}),eF=(ea=(0,s._)(function(){return(0,h.Jh)(this,function(e){switch(e.label){case 0:return[4,eR({args:D.format(eA)})];case 1:return e.sent(),[2]}})}),function(){return ea.apply(this,arguments)}),eW=(el=(0,s._)(function(e){var t,n,r,i;return(0,h.Jh)(this,function(o){switch(o.label){case 0:if(n=void 0!==(t=e.deepen)&&t,r=e.remote,i=e.remoteToken,!r.startsWith("https://api.glitch.com"))return[3,2];return[4,eR({args:["git","fetch",r,"+refs/heads/*:refs/remotes/origin/*"]})];case 1:case 3:return o.sent(),[2];case 2:return[4,eR({args:S.format((0,d._)((0,u._)({},eA),{remote:r,remoteToken:i}),n)})]}})}),function(e){return el.apply(this,arguments)}),eH=(ec=(0,s._)(function(){var e,t,n,r,i,o;return(0,h.Jh)(this,function(a){switch(a.label){case 0:return[4,eS.readDir(Y.Ql)];case 1:if((r=a.sent()).error)return[2];return[4,eT.getConfig()];case 2:if(!(null===(t=(i=a.sent()).config)||void 0===t?void 0:null===(e=t.gitHubImport)||void 0===e?void 0:e.requiredFiles))return[3,4];return o=i.config.gitHubImport.requiredFiles.map(function(e){return new RegExp(e)}),[4,Promise.all(r.children.filter(function(e){return!o.some(function(t){return null!=e.filename.match(t)})}).map(function(e){return e.type===$.Tv.Directory?eS.deleteDir(e.filename):eS.deleteFile(e.filename)}))];case 3:return a.sent(),[3,6];case 4:if(!(null===(n=i.config)||void 0===n?void 0:n.entrypoint))return[3,6];return[4,eS.deleteFile(i.config.entrypoint)];case 5:a.sent(),a.label=6;case 6:return[2]}})}),function(){return ec.apply(this,arguments)}),eV=(es=(0,s._)(function(e,t,n){var r;return(0,h.Jh)(this,function(i){switch(i.label){case 0:return[4,eN(n)];case 1:return i.sent(),[4,eU(e)];case 2:return i.sent(),[4,eL()];case 3:return i.sent(),[4,eW({deepen:!1,remote:e,remoteToken:t})];case 4:return i.sent(),[4,eO({remote:e,remoteToken:t})];case 5:return[4,eX(null!=(r=i.sent())?r:"")];case 6:return i.sent(),[4,eM({remote:e,remoteToken:t})];case 7:if(i.sent(),"html"!==eE.mode)return[3,10];return[4,(0,V.r)(ek,Y.Ql)];case 8:return i.sent(),[4,eE.run()];case 9:i.sent(),i.label=10;case 10:return[2]}})}),function(e,t,n){return es.apply(this,arguments)}),ez=(eu=(0,s._)(function(){var e,t,n;return(0,h.Jh)(this,function(r){switch(r.label){case 0:return[4,eS.readDir(Y.Ql)];case 1:if((e=r.sent()).error)return[2];return t=e.children.map(function(e){return e.filename}),(n=(0,G.T)(t))&&ev({path:n}),[2]}})}),function(){return eu.apply(this,arguments)}),ej=(ed=(0,s._)(function(e,t){var n;return(0,h.Jh)(this,function(r){switch(r.label){case 0:return[4,(0,z.J9)({repoNameWithOwner:e,accessToken:t})];case 1:if("error"in(n=r.sent()))return[2,{hasDotReplit:!1,hasProcfile:!1}];return[2,{hasDotReplit:n.some(function(e){return e.path===j.l}),hasProcfile:n.some(function(e){return e.path===p.E})}]}})}),function(e,t){return ed.apply(this,arguments)}),eq=(ef=(0,s._)(function(e,t){var n,r,i,o,a,l,c,s;return(0,h.Jh)(this,function(u){switch(u.label){case 0:return[4,(0,z.LK)({repoNameWithOwner:e,filePath:p.E,accessToken:t})];case 1:if("error"in(n=u.sent())||(r=ei.from(n.content,"base64").toString(),!(i=(0,p.c)(r))||!(a=null!==(o=i.web)&&void 0!==o?o:i.worker)))return[2,{showConfigPanel:!0}];return l=a.command+" "+a.options.join(" "),[4,eT.updateDotReplit([(0,q.KQ)(l),(0,q.xz)("interpreter")])];case 2:if(c=u.sent(),s=i.web&&!i.worker||!i.web&&i.worker,c.error||!s)return[2,{showConfigPanel:!0}];return[2,{showConfigPanel:!1}]}})}),function(e,t){return ef.apply(this,arguments)});function eY(){return eS.readFile(j.l)}var e$=(eh=(0,s._)(function(e){var t,n,r,i,o,a,l,c,s,u,d;return(0,h.Jh)(this,function(f){switch(f.label){case 0:return t=e.remote,n=e.accessToken,r=e.username,g.kg.info("GitHub Import: Starting client-side GitHub import flow"),[4,eY()];case 1:return i=f.sent(),[4,eH()];case 2:return f.sent(),g.kg.info("GitHub Import: Removed template boilerplate"),[4,eV(t,n,r)];case 3:if(f.sent(),g.kg.info("GitHub Import: Cloned repo into Repl"),"content"in i)return[3,4];return g.kg.error("GitHub Import: Skipping patching dotReplit because templateDotReplit was an error",{readError:String(i.error)}),[3,7];case 4:return[4,eY()];case 5:return"content"in(o=f.sent())&&o.content.toString()!==i.content.toString()&&g.kg.info("GitHub Import: Repo has .replit",{githubURL:t}),[4,eB(i.content)];case 6:f.sent(),f.label=7;case 7:return g.kg.info("GitHub Import: Patched dotreplit"),[4,eb({variables:{input:{id:eg,doClone:!1}}})];case 8:return f.sent(),g.kg.info("GitHub Import: Disabled doClone on Repl. Done."),[4,ez()];case 9:if(f.sent(),a=Z(t),l=!1,!a)return[3,13];return c=a.username,s=a.repository,[4,ej("".concat(c,"/").concat(s),n)];case 10:if(d=(u=f.sent()).hasDotReplit,!(u.hasProcfile&&!d))return[3,12];return[4,eq("".concat(c,"/").concat(s),n)];case 11:return l=!f.sent().showConfigPanel,[3,13];case 12:l=d,f.label=13;case 13:if("html"===eE.mode||l)return[2];return ep(),[2]}})}),function(e){return eh.apply(this,arguments)})}},5218:function(e,t,n){n.d(t,{T:function(){return d}});var r=n(50782),i=n(45903),o=n(93295),a=n(23982),l=n(66039);function c(){var e=(0,o._)(["\n  query WorkspaceEduPaneEnabled($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        isModelSolution\n        isProject\n        isProjectFork\n        owner {\n          __typename\n          ... on Team {\n            id\n            isAdmin\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},u=(0,a.Ps)(c());function d(){var e,t,n,o=(t={variables:{replId:(0,r.Z)()}},n=(0,i._)({},s,t),l.a(u,n)).data,a=(null==o?void 0:null===(e=o.repl)||void 0===e?void 0:e.__typename)==="Repl"?null==o?void 0:o.repl:null;if(!a)return!1;var c=a.owner;return!!c&&a.isProjectFork&&!a.isModelSolution&&"Team"===c.__typename&&c.isAdmin}},73858:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(32477),i=n(43429),o=n(17867),a=n(54916),l=n(30084),c=n(47001);function s(){var e=(0,a.Z)(),t=e.fs,n=e.container,s=(0,r._)((0,i.useState)(!1),2),u=s[0],d=s[1],f=(0,o.Z)(n),h=(0,r._)((0,i.useState)(!1),2),p=h[0],m=h[1];return((0,i.useEffect)(function(){f===c.em.CONNECTED&&m(!0)},[f]),(0,i.useEffect)(function(){return d(t.getStatus()===l.kO.Syncing),t.onStatusChange(function(e,t){var n=t.hasUserChanged;d(e===l.kO.Syncing&&n)})},[t]),p)?{isSaving:u,isOffline:f!==c.em.CONNECTED}:{isSaving:!1,isOffline:!1}}},13779:function(e,t,n){n.d(t,{O:function(){return c}});var r=n(34142),i=n(87682),o=n(25425),a=n(57369),l=n(19858);function c(){var e,t,n,c=(0,o.P5)({controlName:"flag-filetree-git-status",logFlagToAnalytics:!1}),s=(0,l.Z)((e=(0,r._)(function(e){var t,n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:if(!c)return[2,{status:null,error:null}];return[4,e.getRepositoryState()];case 1:if((t=r.sent()).error)return[2,t];if(t.type!==a.y5.NORMAL)return[2,{status:null,error:null}];return[4,e.status()];case 2:if((n=r.sent()).error)return[2,n];return[2,{status:n,error:null}]}})}),function(t){return e.apply(this,arguments)}),[c]);return s&&!s.error&&(null===(t=s.status)||void 0===t?void 0:t.changes)?function(e){var t=new Map,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;t.set(l.path,{index:l.type.index,worktree:l.type.worktree})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(null===(n=s.status)||void 0===n?void 0:n.changes):null}},71881:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(25425),i=n(50782),o=n(23394),a=n(11516),l=n(54916),c=n(43429),s=n(39756),u="persistmirrored";function d(){var e=(0,o.T)(),t=(0,i.Z)(),n=(0,r.P5)({controlName:"flag-persist-mirror-html",default:!0,logFlagToAnalytics:!1}),d=(0,l.Z)().container;(0,c.useEffect)(function(){if(!(!e||!n||(null!==(r=a.Z.get(u,"array"))&&void 0!==r?r:[]).includes(t))){var r,i=d.openChannel({service:"gcsfiles",skip:function(e){return!e.repl.currentUserPermissions.containerWrite}},function(e){return e.channel.request({persistMirror:{path:s.Ql}}).then(function(e){if(e.ok){var n,r;r=null!==(n=a.Z.get(u,"array"))&&void 0!==n?n:[],a.Z.set(u,r.concat(t)),i()}}),function(){}});return i}},[d,e,n,t])}},51359:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(54916),i=n(47001),o=n(43429);function a(){var e=(0,r.Z)().container;(0,o.useEffect)(function(){var t=function(){e.getConnectionState()===i.em.CONNECTED&&e.focus()};return window.addEventListener("focus",t),function(){window.removeEventListener("focus",t)}},[e])}},6309:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(8182),i=n(43429),o=n(54916),a=n(55534),l=n(20573),c=n(56596),s=n(74833),u=n(29287),d=n(93918),f=n(25425),h=n(81810),p=(0,d.X)({noticeContainer:[u.l0.rowWithGap(8),u.l0.align.center],noticeText:[u.l0.colWithGap(0)]}),m=new Set([3e3,3001,3002,3003,4200,5e3,5173,6e3,6800,8e3,8008,8080,8081,8888,9e3,1e4,25565,25577]);function v(){var e=(0,o.Z)().container,t=(0,a.Z)().showNotice,n=(0,f.P5)({controlName:h.wK,logFlagToAnalytics:!0});(0,i.useEffect)(function(){if(!n)return e.onPortOpened(function(e){var n=e.port,i=e.address;if(!e.isForwarded&&m.has(n)){var o="Port ".concat(n," opened on host ").concat(i,".");t((0,r.BX)(c.G,{css:p.noticeContainer,children:[(0,r.tZ)(l.Z,{}),(0,r.BX)(c.G,{css:p.noticeText,children:[(0,r.tZ)(s.xv,{multiline:!1,children:o}),(0,r.tZ)(s.xv,{variant:"small",multiline:!1,children:"Use the host 0.0.0.0 to open the port to web traffic."})]})]}),1e4)}})},[t,e,n])}},1904:function(e,t,n){n.d(t,{V:function(){return c},Z:function(){return s}});var r=n(32477),i=n(43429),o=n(54916),a=n(30084),l=n(39756),c=".tutorial";function s(){var e=(0,o.Z)().fs,t=(0,r._)((0,i.useState)({isLoading:!0,isTutorial:!1}),2),n=t[0],s=t[1];return(0,i.useEffect)(function(){e.watchDir(l.Ql,{onChange:function(e){s({isLoading:!1,isTutorial:e.some(function(e){return e.type===a.Tv.Directory&&e.filename===c})})},onMoveOrDelete:function(){s({isLoading:!1,isTutorial:!1})},onError:function(){s({isLoading:!1,isTutorial:!1})}})},[e]),n}},61364:function(e,t,n){n.d(t,{ZP:function(){return R},Ln:function(){return T}});var r=n(34142),i=n(87682),o=n(43429),a=n(90234),l=n(71999),c=n(54916),s=n(48900),u=n(50782),d=n(3042),f=n(47001),h=n(84800),p=n(97474),m=n(33829),v=n(45903),g=n(93295),y=n(23982),b=n(80428),Z=n(66039);function w(){var e=(0,g._)(["\n  query ReplEnvironmentDesktopLoadCurriculum($id: String!) {\n    currentUser {\n      id\n      isTeacher: hasRole(role: TEACHER)\n      ...CrosisContextCurrentUser\n    }\n    repl(id: $id) {\n      ... on Repl {\n        id\n        isProject\n        isProjectFork\n        isModelSolution\n        isModelSolutionFork\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n        language\n        origin {\n          id\n          ...CrosisContextRepl\n          origin {\n            id\n            ...CrosisContextRepl\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return w=function(){return e},e}var x={},C=(0,y.Ps)(w(),b.D,b.C),_=n(30173),k=n(30084),S=n(33212),E=(0,a.cn)(!1);function T(){return(0,l.Dv)(E)}function R(){var e,t,n,a=(0,u.Z)(),g=(0,c.Z)().fs,y=(e=(0,v._)({},x,{variables:{id:a}}),Z.a(C,e)).data,b=(0,l.b9)(E);o.useEffect(function(){return function(){b(!1)}},[b]);var w=(null==y?void 0:y.repl.__typename)==="Repl"?y.repl:null,T=(null==y?void 0:null===(t=y.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"?y.currentUser:null,R=(null==y?void 0:y.repl.__typename)==="Repl"&&y.repl.isModelSolutionFork,I=R?w&&(null===(n=w.origin)||void 0===n?void 0:n.origin):w&&w.origin||null,D=(0,h.b)((null==I?void 0:I.__typename)==="Repl"?{repl:I,currentUser:T||void 0}:null),G=(0,_.S)();o.useEffect(function(){w&&T&&w.isProject&&g.stat(".lesson").then(function(e){e.exists||g.createDir(".lesson")})},[g,T,w]),o.useEffect(function(){if(w&&(w.isProjectFork||R)&&I&&D){var e,t=(0,f.ZP)({onUnrecoverableError:function(e){S.error(e),s.$e(function(t){t.setTag("curriculum-authoring",!0),t.setExtra("originId",I.id),s.Tb(e)})}}),n=(0,m.Z)({container:t});t.connect({context:D,getMinimumRetryDelayMs:G,fetchConnectionMetadata:function(){return(0,d.Z)({url:"/data/repls/".concat(w.id,"/get_repl_origin_guest_connection_metadata")})}});var o=t.onConnectionStateChanged((e=(0,r._)(function(e){var r,a;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(e!==p.e.CONNECTED)return[3,8];o(),i.label=1;case 1:return i.trys.push([1,6,7,8]),[4,g.copyDirFromRemote(".lesson",".lesson",n)];case 2:if(!((r=i.sent()).error&&r.error!==k.Df.NotFound))return[3,3];return s.$e(function(e){e.setTag("curriculum-authoring",!0),e.setExtra("originId",I.id),s.Tb(Error("Error copying lesson: ".concat(r.error)))}),[3,5];case 3:return[4,g.stat(".lesson/instructions.md")];case 4:i.sent().exists&&b(!0),i.label=5;case 5:return[3,8];case 6:return a=i.sent(),s.$e(function(e){e.setTag("curriculum-authoring",!0),s.Tb(a)}),[3,8];case 7:return t.destroy(),[7];case 8:return[2]}})}),function(t){return e.apply(this,arguments)}));return function(){return t.destroy()}}},[g,D,w,I,R,b])}},86790:function(e,t,n){n.d(t,{k:function(){return d}});var r=n(94106),i=n(45903),o=n(93295),a=n(23982),l=n(66039);function c(){var e=(0,o._)(["\n  query WorkspaceShowAdmin {\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n  }\n"]);return c=function(){return e},e}var s={},u=(0,a.Ps)(c());function d(){var e,t,n=(e=(0,i._)({},s,void 0),l.a(u,e)).data,o=(0,r.useRouter)();return(null==n?void 0:null===(t=n.currentUser)||void 0===t?void 0:t.isAdmin)||!!o.query.debug}},92796:function(e,t,n){n.d(t,{B:function(){return I}});var r=n(32477),i=n(52902),o=n(1904),a=n(16278),l=n(31593),c=n(5218),s=n(50199),u=n(50782),d=n(45903),f=n(93295),h=n(23982),p=n(66039);function m(){var e=(0,f._)(["\n  fragment WorkspaceToolPanesRepl on Repl {\n    isProjectFork\n    isModelSolution\n    isProject\n    isProjectFork\n    workspaceCta\n    currentUserPermissions {\n      containerWrite\n      editMultiplayers\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    lang {\n      id\n      key\n      engine\n      supportsGit\n      hasLibSearch\n      supportsPackager3\n      hasDAP\n    }\n    config {\n      isServer\n      isVnc\n    }\n  }\n"]);return m=function(){return e},e}function v(){var e=(0,f._)(["\n  query WorkspaceToolPanes($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceToolPanesRepl\n      }\n    }\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n      isPrivacyLimitedAccess: hasRole(role: PRIVACY_LIMITED_ACCESS)\n      userPowerUpsByType {\n        __typename\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return v=function(){return e},e}var g={},y=(0,h.Ps)(m()),b=(0,h.Ps)(v(),y),Z=n(94106),w=n(25425),x=n(61364),C=n(2038),_=n(75582),k=n(9149),S=n(60442),E=n(81810),T=["shell","git","diff","packager","envEditor","deployments","database","neon","ghostwriterChat","unitTests","submitEduRepl","preferences","docs","multiplayer","adminPanel","sshConfigurator","webview","problems","systemDependencies"],R=["ghostwriterChat","deployments"];function I(){var e,t,n,f,h,m=(h=(null==(f=(t={variables:{replId:(0,u.Z)()}},n=(0,d._)({},g,t),p.a(b,n)).data)?void 0:null===(e=f.repl)||void 0===e?void 0:e.__typename)==="Repl"?null==f?void 0:f.repl:null)?{repl:h,currentUser:(null==f?void 0:f.currentUser)||null}:{repl:null,currentUser:null},v=m.repl,y=m.currentUser,I=(0,Z.useRouter)(),D=(0,C.T3)(),G=(0,C.rv)(),B=(0,w.P5)({controlName:"flag-neon-databases",logFlagToAnalytics:!1}),P=(0,w.P5)({controlName:"flag-postgres-db-god-mode",logFlagToAnalytics:!1}),A=!!((0,w.P5)({controlName:"flag-deployments",logFlagToAnalytics:!1})&&(null==v?void 0:v.hostingDeploymentPermissions.canDeploy)),N=(0,w.P5)({controlName:"flag-repl-auth-sidebar",logFlagToAnalytics:!1}),U=(0,w.P5)({controlName:"flag-nix-modules-tool",logFlagToAnalytics:!1}),L=(0,w.P5)({controlName:"flag-problems-pane",logFlagToAnalytics:!1}),O=(0,w.P5)({controlName:"flag-mb-ai4all",logFlagToAnalytics:!1}),X=(0,w.P5)({controlName:E.wK,logFlagToAnalytics:!1}),M=(0,S.cR)(),F=(0,l.Z)().language,W=(0,c.T)(),H=(0,x.Ln)(),V=(0,o.Z)().isTutorial,z=(0,a.I)().some(function(e){return"nix"!==e.id}),j=(0,k.WG)(),q=(null==y?void 0:y.isAdmin)||!!I.query.debug,Y=(0,i.Se)();return(0,s.Z)(function(){var e=D&&(null==v?void 0:v.currentUserPermissions.editMultiplayers),t=(null==y?void 0:null===(b=y.userPowerUpsByType)||void 0===b?void 0:b.__typename)==="UserPowerUpsTypes"&&(null==y?void 0:y.userPowerUpsByType.ghostwriter)&&(null==y?void 0:y.userPowerUpsByType.ghostwriter.active)||O,n=!G||t,i=e?[{type:"multiplayer"}]:[];if(!v||!y)return i;var o=!!v.config.isServer,a=!!v.config.isVnc,l=v.lang.supportsGit,c=v.lang.key.startsWith("html"),s="nix"===v.lang.key,u=v.isProject||v.isProjectFork,d=!u&&null!==F,f=[[{type:"shell"},!0],[{type:"instructions"},H],[{type:"threadInbox"},!0],[{type:"chat"},!0],[{type:"docs",data:{url:null}},!0],[{type:"webview"},o||c],[{type:"vnc"},a],[{type:"runnerOutput"},!c],[{type:"git"},l],[{type:"packager"},!0],[{type:"systemDependencies"},!0],[{type:"envEditor"},!c],[{type:"debugger"},!0],[{type:"tutorial"},V],[{type:"database"},!c],[{type:"neon"},P||s&&B],[{type:"replAuth"},!!(N&&z)],[{type:"autograder"},u],[{type:"unitTests"},d],[{type:"education"},!!W],[{type:"preferences"},!0],[{type:"adminPanel"},q],[{type:"deployments"},A],[{type:"sshConfigurator"},!0],[{type:"ghostwriterChat"},n],[{type:"searchReplace"},!0],[{type:"extensionStore",data:{page:"store"}},!0],[{type:"modules"},U],[{type:"extensionDevtools"},M],[{type:"problems"},L],[{type:"networking"},X]];if(D){var h=v.workspaceCta===_.Sy.Submit||v.workspaceCta===_.Sy.Resubmit;f.push([{type:"submitEduRepl"},h])}var p=!0,m=!1,g=void 0;try{for(var b,Z,w=j[Symbol.iterator]();!(p=(Z=w.next()).done);p=!0){var x=Z.value;f.push([{type:"extension",data:{extensionId:x.extension.extensionId,installationId:x.extension.installationId,name:x.name||x.extension.manifest.name,icon:x.icon||x.extension.manifest.icon,baseUrl:x.extension.baseUrl,path:x.handler}},!0])}}catch(e){m=!0,g=e}finally{try{p||null==w.return||w.return()}finally{if(m)throw g}}var C=!0,k=!1,S=void 0;try{for(var E,I=f[Symbol.iterator]();!(C=(E=I.next()).done);C=!0){var $=(0,r._)(E.value,2),J=$[0];$[1]&&(!D||T.includes(J.type))&&i.push(J)}}catch(e){k=!0,S=e}finally{try{C||null==I.return||I.return()}finally{if(k)throw S}}return i.map(function(e){return{title:Y.getTitle(e),pane:e}}).sort(function(e,t){return R.includes(e.pane.type)?-1:R.includes(t.pane.type)?1:e.title.localeCompare(t.title)}).map(function(e){return e.pane})},[D,v,y,N,z,F,P,B,H,V,W,q,A,U,M,L,j,Y,O,G,X])}},72875:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(47507),i=n(43429);function o(){(0,i.useEffect)(function(){var e=null;return!function t(){if(window.performance.memory){var n=window.performance.memory,i=n.jsHeapSizeLimit,o=n.totalJSHeapSize,a=n.usedJSHeapSize,l=window.performance.now();r.kg.info("perf:browser_memory",{jsHeapSizeLimit:i,totalJSHeapSize:o,usedJSHeapSize:a,timeElapsed:l}),e=setTimeout(t,-(3e5*Math.log(Math.random())))}}(),function(){e&&clearTimeout(e)}},[])}},87716:function(e,t,n){n.d(t,{L:function(){return c}});var r=n(45903),i=n(50782),o=n(43429),a=n(84707),l=n(87584);function c(){var e=(0,i.Z)(),t=(0,l.Z)("fileTree").trackTimeToLoadFileStart;return o.useCallback(function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(n);var o={action:"select",source:"filetree"};i.newTab?o={action:"newTab",source:"filetree"}:i.newPane&&(o={action:"newPane",source:"filetree"}),(0,a.Z)((0,r._)({replId:e},o))},[e,t])}},28470:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(43429),i=n(54916),o=n(59868),a=n(50782),l=n(92920),c=new Set([3e3,3001,3002,3003,3306,4e3,4200,5e3,5432,5173,6e3,6800,7e3,7001,8e3,8008,8080,8081,8888,9e3,9001,1e4,25565,25577,8887,27017,27018]);function s(){var e=(0,i.Z)().container,t=(0,l.Z)().preferences.webviewAutoOpenOnPortOpened,n=(0,a.Z)();(0,r.useEffect)(function(){return e.onPortOpened(function(e){var r=e.port,i=e.address,a=e.isForwarded,l=e.isVnc,s=e.externalPort;if(a){(0,o.j)(o.U3.WS_PORT_OPENED,{type:l?"vnc":"webview",replId:n,port:r,externalPort:s,address:i,webviewAutoOpenOnPortOpened:t});return}(0,o.j)(o.U3.WS_UNFORWARDED_PORT_OPENED,{port:r,isCommon:c.has(r),address:i,type:l?"vnc":"webview",replId:n,externalPort:s})})},[e,n,t])}},93702:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(47507),i=n(50782),o=n(43429),a=n(54916),l=n(95577),c=n(34523),s=n(59808),u=n(58130),d=n(25425),f=new Set;function h(e){var t=e.workspaceType,n=(0,i.Z)(),h=(0,a.Z)(),p=h.dotReplit,m=h.container,v=(0,d.P5)({controlName:"flag-channel-request-priority",logFlagToAnalytics:!1});(0,o.useEffect)(function(){if(!f.has(n)){f.add(n);var e=p.watch(function(n){if(!n.error||n.error!==s.Yt.Disconnected){try{var i=m.getConnectionMetadata();if(!i||!i.token)throw Error("Expected token in measure call.");!function(e){var t=e.workspaceType,n=e.parsedToken,i=e.flagChannelRequestPriority,o=!!window.performance.getEntriesByName(c.Iy.pageNavStart,"mark").length,a={ssr:!o,workspaceType:t,tokenCluster:n.cluster,flagChannelRequestPriority:i},s="time to code";window.performance.measure(s,o?c.Iy.pageNavStart:void 0);var u=window.performance.getEntriesByName(s,"measure")[0];if(!u){r.kg.info("Could not obtain measure for time to code",a);return}var d="page invisible fetch connection metadata",f=u.duration;window.performance.getEntriesByName(c.Iy.fetchConnectionMetadataPageInvisibleStart,"mark").length&&(window.performance.measure(d,c.Iy.fetchConnectionMetadataPageInvisibleStart,c.Iy.fetchConnectionMetadataPageInvisibleEnd),f-=window.performance.getEntriesByName(d,"measure")[0].duration,window.performance.clearMeasures(d),window.performance.clearMarks(c.Iy.fetchConnectionMetadataPageInvisibleStart),window.performance.clearMarks(c.Iy.fetchConnectionMetadataPageInvisibleEnd)),r.kg.time("time to code minus page invisible",f,a),r.kg.time("time to code with page invisible",u.duration,a),window.performance.clearMeasures(s),l.v.addTiming("time_to_code_minus_page_invisible",f),l.v.addTiming("time_to_code_with_page_invisible",u.duration)}({workspaceType:t,parsedToken:(0,u.he)(i.token),flagChannelRequestPriority:v})}catch(e){r.kg.info("Could not measure time to code",{workspaceType:t,e:e,dotReplitResult:n.error?n.error:"success"})}e()}});return e}},[n,t,p,m,v])}},87584:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(29559),i=n(47507),o=n(41792),a=new Map,l=function(e,t){if((0,r.Mb)(e)){var n=window.performance.now();a.set(e,{start:n,source:t})}},c=function(e){var t=a.get(e);if(void 0!==t){var n=t.start,r=t.source,l=window.performance.now(),c=(0,o.V)(e);i.kg.time("time to load file",l-n,{from:r,fileViewerType:c}),a.delete(e)}};function s(e){return{trackTimeToLoadFileStart:function(t){return l(t,e)},trackTimeToLoadFileEnd:c}}},75722:function(e,t,n){n.d(t,{_:function(){return y},O:function(){return g}});var r=n(34142),i=n(32477),o=n(87682),a=n(27308),l=n(45903),c=n(93295),s=n(23982),u=n(13440);function d(){var e=(0,c._)(["\n  mutation SetUserKeybindings($input: SetUserKeybindingsInput!) {\n    setUserKeybindings(input: $input) {\n      ... on Keybindings {\n        keybindings\n      }\n    }\n  }\n"]);return d=function(){return e},e}var f={},h=(0,s.Ps)(d()),p=n(50199),m=n(5805),v=n(47502);function g(){var e,t=(0,v.O)(),n=(0,i._)((e=(0,l._)({},f,void 0),u.D(h,e)),1)[0];return(0,p.Z)(function(){var e;return e=(0,r._)(function(e){var r,a,l,c,s,u,d,f,h;return(0,o.Jh)(this,function(o){switch(o.label){case 0:r=[],a=!0,l=!1,c=void 0;try{for(s=e[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)f=(d=(0,i._)(u.value,2))[0],h=d[1],r.push({commandId:f,keyCombo:h})}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}return[4,n({variables:{input:{environment:t,platform:(0,m.X)(),keybindings:r}}})];case 1:return o.sent(),[2]}})}),function(t){return e.apply(this,arguments)}},[t,n])}function y(e){var t=new Map;if(!Array.isArray(e))return t;var n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var c=o.value,s=function(e){if(e&&"object"==typeof e&&"commandId"in e&&"string"==typeof e.commandId&&"keyCombo"in e){if(Array.isArray(e.keyCombo)){var t=(0,a.uv)(e.keyCombo);return{commandId:e.commandId,keyCombo:t}}if("string"==typeof e.keyCombo){var n=(0,a.gD)(e.keyCombo);return{commandId:e.commandId,keyCombo:n}}return{commandId:e.commandId,keyCombo:null}}}(c);s&&t.set(s.commandId,s.keyCombo)}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return t}},5805:function(e,t,n){n.d(t,{X:function(){return o}});var r=n(21557),i=n(34396);function o(){return r.V5||r.gn?i.K5.Mac:r.ED?i.K5.Windows:i.K5.Linux}},46866:function(e,t,n){n.d(t,{R:function(){return s}});var r=n(34142),i=n(87682),o=n(64540),a=n(93295);function l(){var e=(0,a._)(["\n  query FiletreeDownloadZip($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        url\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c=(0,n(23982).Ps)(l());function s(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e){var t,n,r;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return[4,null===o.l||void 0===o.l?void 0:o.l.query({query:c,variables:{replId:e}})];case 1:return r=(null==(n=i.sent())?void 0:null===(t=n.data)||void 0===t?void 0:t.repl.__typename)==="Repl"?n.data.repl.url:window.location.pathname,window.open(r+".zip","_blank"),[2]}})})).apply(this,arguments)}},31232:function(e,t,n){n.d(t,{mn:function(){return u}});var r=n(32477),i=n(21289),o=n(30084),a=n(29559),l=["json","md","draw","txt"],c=[".gitignore",".replit"];function s(e,t){var n=new Map,o=!0,l=!1,c=void 0;try{for(var s,u=e[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var d,f=s.value,h=(0,a.r6)(f);if(h&&(!t||h.startsWith(t))){var p=null!==(d=n.get(h))&&void 0!==d?d:0;n.set(h,p+1)}}}catch(e){l=!0,c=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw c}}return(0,i._)(n.entries()).sort(function(e,t){var n=(0,r._)(e,2)[1];return(0,r._)(t,2)[1]-n}).map(function(e){return(0,r._)(e,1)[0]})}function u(e,t){if(e.fileType===o.Tv.Directory||!e.input)return[];if("."===e.input)return c.map(function(e){return{value:e,highlight:[{from:1,to:e.length}]}});if(e.input.startsWith("."))return c.filter(function(t){return t.startsWith(e.input)}).map(function(t){return{value:t,highlight:[{from:t.length-e.input.length,to:t.length}]}});var n=(0,a.r6)(e.input),r=s(e.siblings.map(function(e){return e.filename}),n);if(r.length<3&&r.push.apply(r,(0,i._)(s(t(),n))),r.length<3){var u=n?l.filter(function(e){return e.startsWith(n)}):l;r.push.apply(r,(0,i._)(u))}return(0,i._)(new Set(r)).slice(0,3).map(function(t){var r=e.input;r.endsWith(".")?r=r.slice(0,-1):n&&(r=r.slice(0,-(n.length+1)));var i=r+"."+t;return{value:i,highlight:[{from:e.input.length,to:i.length}]}})}},23090:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(30084),i=function(e){if(1===e.length)return e[0].type===r.Tv.File?"file":"folder";if(e.length>1){var t=e.filter(function(e){return e.type===r.Tv.File}).length,n=e.filter(function(e){return e.type===r.Tv.Directory}).length,i=t>1?"files":"file",o=n>1?"folders":"folder",a="file";return t>0&&n>0?a="".concat(i," and ").concat(o):t>0?a="".concat(i):n>0&&(a="".concat(o)),"".concat(a)}return""};function o(e){var t=i(e),n=1===e.length?t:"".concat(e.length," ").concat(t),r=e.slice(0,5).map(function(e){return e.path}).join(", ");return{name:n,description:e.length>5?"".concat(r," and ").concat(e.length-5," more ").concat(i(e.slice(5))):r,confirmDescription:n}}},71042:function(e,t,n){n.d(t,{r:function(){return r}});function r(e,t){return new Promise(function(n){var r=e.openChannel({service:"gcsfiles"},function(e){return e.channel.request({persistMirror:{path:t}}).then(function(e){e.ok,r(),n()}),function(e){e.willReconnect&&r()}})})}},19924:function(e,t,n){n.d(t,{e:function(){return _},Z:function(){return C}});var r=n(45903),i=n(32477),o=n(30911),a=n.n(o),l=n(52527),c=n(42371),s=n(70322),u=n(48900),d="exit status 1",f=n(69451),h=n.n(f),p=n(34142),m=n(21289),v=n(87682),g=n(14131);function y(){return(y=(0,p._)(function(e){var t,n,r,i,o,a,f;return(0,v.Jh)(this,function(h){switch(h.label){case 0:if(n=e.container,0===(r=(0,s._)(e,["container"])).query.trim().length)return[2,b(l.f.EMPTY_QUERY)];if(n.getConnectionState()===g.em.DISCONNECTED)return[2,b(l.f.CONTAINER_DISCONNECTED)];if(n.getConnectionState()===g.em.CONNECTING)return[2,b(l.f.CONTAINER_CONNECTING)];return[4,(t=n).exec.apply(t,(0,m._)((0,c.PR)(r)))];case 1:if(o=(i=h.sent()).output,a=i.error)switch(a){case d:return[2,b(l.f.EMPTY_RESULTS)];case"signal: broken pipe":return[2,b(l.f.PARTIAL_RESULTS)];case"Channel closed":return[2,b(l.f.CHANNEL_CLOSED)];default:return u.Tb(Error("Ripgrep search command failed with error: ".concat(a))),[2,{error:a,data:null}]}if(!(null==o?void 0:o.trim())||!(f=(0,c.Tq)()(o))||0===f.filesMap.size)return[2,b(l.f.EMPTY_RESULTS)];return[2,b(f.error,f.filesMap)]}})})).apply(this,arguments)}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{error:e,data:t}}var Z=n(1660),w=n(47507),x="File Search Used";function C(e){var t=e.container,n=e.onError,i=e.onUpdate,o=e.onLoadingStateChange,f=e.isStreaming,p=e.trackLatency,m=void 0!==p&&p,v=(0,Z.Z)({container:t}),g=[],y=a()(),b=Date.now(),C=function(e){i(g=e)};return h()(function(e){var t=a()();y=t,b=Date.now(),n(null),o(!0);var i=!0;if(""===e.query){C([]),o(!1);return}!function(e){var t=e.execer,n=e.onComplete,r=e.onError,i=e.onParse,o=(0,s._)(e,["execer","onComplete","onError","onParse"]);if(0===o.query.length){n("abort");return}var a=new TextEncoder,f=(0,c.Tq)(),h=0,p=0,m=function(){},v=function(e){r(e),n("error")},g=function(e){if(0===h&&"finished"===e){v(l.f.EMPTY_RESULTS);return}"finished"===e?n(e,{bytes:p}):n(e),m()},y=t.onOutput(function(e){var t=a.encode(e).length;p+=t;var n=f(e);if(n){var r=n.error,o=n.filesMap,l=n.filesMapChanges;r&&v(r),h=o.size,l.forEach(function(e){var t=o.get(e);t&&o.set(e,(0,c.Vd)(t))}),i(o,l)}}),b=t.onStderr(function(e){if(e.trim()===d)return v(l.f.EMPTY_RESULTS);v(l.f.INVALID_COMMAND)});m=function(){y(),b()};var Z=(0,c.PR)(o);t.request({args:Z}).then(function(e){if(e.error)return e.error.trim()===d?v(l.f.EMPTY_RESULTS):v(l.f.INVALID_COMMAND);g("finished")}).catch(function(e){return u.Tb(Error("Ripgrep search command failed with error: ".concat(e))),v(l.f.INVALID_COMMAND)})}((0,r._)({execer:v,onComplete:function(r,i){if(y===t){o(!1);var a,s,u,d,f="finished"===r&&i&&i.bytes===c.Ak;f&&n(l.f.PARTIAL_RESULTS),m&&w.kg.time("".concat(x," - complete"),Date.now()-b,{query:e.query,isRegex:e.isRegex,isCaseSensitive:e.isCaseSensitive,hasIncludes:(null!==(u=null==e?void 0:null===(a=e.includeGlobs)||void 0===a?void 0:a.length)&&void 0!==u?u:0)>0,hasExcludes:(null!==(d=null==e?void 0:null===(s=e.excludeGlobs)||void 0===s?void 0:s.length)&&void 0!==d?d:0)>0,latency:Date.now()-b,isPartialResults:f})}},onError:function(e){y===t&&n(e)},onParse:function(n,r){if(y===t){if(i){if(m){var a,l,s,u;w.kg.time("".concat(x," - first_chunk"),Date.now()-b,{query:e.query,isRegex:e.isRegex,isCaseSensitive:e.isCaseSensitive,hasIncludes:(null!==(s=null==e?void 0:null===(a=e.includeGlobs)||void 0===a?void 0:a.length)&&void 0!==s?s:0)>0,hasExcludes:(null!==(u=null==e?void 0:null===(l=e.excludeGlobs)||void 0===l?void 0:l.length)&&void 0!==u?u:0)>0})}C((0,c.Md)([],n,r)),i=!1}else C((0,c.Md)(g,n,r));f&&o(!1)}},mode:"json",context:0},e))},200)}function _(e){var t=e.container,n=h()(function(e,n,o){(function(e){return y.apply(this,arguments)})((0,r._)({container:t,mode:"json",context:1,isCaseSensitive:!1},e)).then(function(e){var t=e.data?function(e){var t={},n=!0,r=!1,o=void 0;try{for(var a,l=e.entries()[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=(0,i._)(a.value,2),s=c[0],u=c[1];t[s]=u.lines.map(function(e){return{content:e.content,lineNumber:e.lineNumber,matches:e.matches.map(function(e){return{column:e.start,length:e.length}})}}).filter(function(e){return e.matches.length>0})}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return t}(e.data):{},r=e.error===l.f.PARTIAL_RESULTS;if(r);else if(e.error)return n({error:e.error,results:null,isPartialResult:r});return n({error:null,results:t,isPartialResult:r})}).catch(o)},200);return function(e){return new Promise(function(t,r){return n(e,t,r)})}}},12763:function(e,t,n){n.d(t,{Eu:function(){return d},m6:function(){return l}});var r,i,o,a=n(21289);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],r=function(e){return e.forEach(function(e){return e&&n.push("-g",e)})},i=[],o=[],l=!0,u=!1,f=void 0;try{for(var h,p=e[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var m=h.value,v=s(m);v.startsWith("**")?i.push(v):o.push(v)}}catch(e){u=!0,f=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw f}}return o.length>0&&(r(["!*"]),new Set(o).forEach(function(e){r((function(e){var t=function(e){Array.isArray(r[e])||(r[e]=[]);var t,i=n[e],o=i.startsWith("{")&&i.endsWith("}")?d(i.substring(1,i.length-1),","):[i];(t=r[e]).push.apply(t,(0,a._)(o.map(function(t){var n=r[e-1];return n&&n.length>0?n.map(function(e){return"".concat(e,"/").concat(t)}):t}).flat(2)))},n=d(e,"/").filter(function(e){return e.length>0});"**"!==n[n.length-1]&&n.push("**");for(var r={},i=0;i<n.length;i++)t(i);return Object.values(r).flat(2)})(e).map(c))})),r(i),r(t.map(function(e){return"!".concat(c(s(e)))})),n}function c(e){return e.startsWith("**")||e.startsWith("/")?e:"/".concat(e)}function s(e){return e.replaceAll(/\*/g,function(e,t,n){return t>0&&("*"===n[t-1]||"\\"===n[t-1])||t<n.length-1&&"*"===n[t+1]?e:"**"})}var u=(r={},i={},(o=function(e,t){r[e]=t,i[t]=e})("{","}"),o("(",")"),o("[","]"),{hasKey:function(e){return e in r},getKey:function(e){return r[e]},hasValue:function(e){return e in i},getValue:function(e){return i[e]}});function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";if(0===e.length)return[];var n=[],r=[],i="",o=!0,a=!1,l=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var d=c.value;if(d===t){if(0===r.length){n.push(i),i="";continue}}else if(u.hasKey(d))r.push(d);else if(u.hasValue(d)&&r.pop()!==u.getValue(d))return[e];i+=d}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return 0!==r.length?[e]:(i.length>0&&n.push(i),n)}},42371:function(e,t,n){n.d(t,{Ak:function(){return d},Tq:function(){return f},PR:function(){return v},Vd:function(){return p},Md:function(){return m}});var r=n(45903),i=n(25e3),o=n(21289);function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e){return e.match(/["\s]/)&&!e.match(/'/)?"'".concat(e.replace(/(['\\])/g,"\\$1"),"'"):e.match(/["'\s]/)?'"'.concat(e.replace(/(["\\$`!])/g,"\\$1"),'"'):e.replace(/[#!"$&'()*,:;<=>?@[\\\]^`{|}]/g,"\\$&")}).join(" ")}var l=n(12763),c=n(52527),s=n(47507),u=n(88422).lW,d=524288;function f(){var e="",t=new Map;return function(n){var o=new Set,a=!1;if(n.trim().startsWith("error"))return{error:c.f.INVALID_COMMAND,filesMap:t,filesMapChanges:o};var l=n.indexOf("\n"),u=0,d=e+n;if(l>=0)l+=e.length;else{e=d;return}for(;l>=0;){var f=d.substring(u,l).trim();if(0!==f.length){var p=function(e){try{return JSON.parse(e)}catch(e){return null}}(f);p&&!function(e,t,n){switch(e.type){case"begin":var o=h(e.data.path);if(!o)return!1;t.set(o,{path:o,lines:[],dedentBy:0}),n.add(o);break;case"end":break;case"match":case"context":var a=h(e.data.path);if(!a)return!1;n.add(a);var l=t.get(a);if(!l)return!1;var c=function(e,t){var n,o,a=h(e.data.lines);if(!a)return null;var l=a.trimEnd().split(/\r?\n/),c=[];(null===(n=l[0])||void 0===n?void 0:n.trim())===""&&l.shift(),(null===(o=l[l.length-1])||void 0===o?void 0:o.trim())===""&&l.pop();var s=0,u=0,d=e.data.submatches;return l.forEach(function(t,n){var r=e.data.line_number+n,i=u;u+=t.length+1;for(var o=[];s<d.length;){var a=d[s];if(a.start>=u)break;var l=a.start-i,f=void 0;if(f=a.end<u?a.end-a.start:a.end===u?a.end-a.start-1:t.length-l,l<t.length&&o.push({start:l,length:f}),a.end>u){a.start=u;break}s++}c.push({lineNumber:r,content:t,matches:o})}),(0,i._)((0,r._)({},t),{lines:t.lines.concat(c)})}(e,l);c&&t.set(a,c);break;case"error":return s.kg.error("Invalid Search Line",{line:JSON.stringify(e)}),!1}return!0}(p,t,o)&&(a=!0)}u=l+1,l=d.indexOf("\n",u)}return e=d.substring(u),{error:a?c.f.INVALID_LINE:null,filesMap:t,filesMapChanges:o}}}function h(e){return e?"bytes"in e?u.from(e.bytes,"base64").toString():e.text:null}function p(e){var t,n=e.lines.length>0?(t=Math).min.apply(t,(0,o._)(e.lines.map(function(e){return e.content.match(/^[\t ]+/)}).flat().map(function(e){return(null==e?void 0:e.length)||0}))):0;return(0,i._)((0,r._)({},e),{dedentBy:n})}function m(e,t,n){for(var r=(0,o._)(e),i=new Set,a=0;a<r.length;a++){var l=r[a].path,c=t.get(l);n.has(l)&&c&&(r[a]=c,i.add(l))}var s=!0,u=!1,d=void 0;try{for(var f,h=n[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value,m=t.get(p);!i.has(p)&&m&&r.push(m)}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}return r}function v(e){var t=e.mode,n=e.query,r=e.context,i=e.isRegex,c=e.isCaseSensitive,s=e.isMatchingWholeWords,u=e.includeGlobs,f=e.excludeGlobs,h=["rg"];switch(t){case"json":h.push("--json");break;case"files":h.push("--files-with-matches")}return null!==r&&h.push("--context","".concat(r)),n.includes("\n")&&h.push("--multiline"),i||h.push("--fixed-strings"),h.push("--max-count","100"),h.push("--max-filesize","4M"),h.push("--max-depth","24"),h.push("--max-columns","512"),h.push("--max-columns-preview"),h.push(c?"--case-sensitive":"--ignore-case"),s&&h.push("--word-regexp"),h.push.apply(h,(0,o._)((0,l.m6)(u,f))),h.push("--",n),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;return["sh","-c","".concat(a.apply(void 0,(0,o._)(e))," | head -c ").concat(t)]}(h)}},52527:function(e,t,n){var r,i;n.d(t,{f:function(){return r}}),(i=r||(r={})).PARTIAL_RESULTS="Displaying partial results, try being more specific with your search.",i.EMPTY_RESULTS="Nothing came up searching your Repl's content.",i.EMPTY_QUERY="No search query was provided.",i.INVALID_LINE="We encountered an invalid line while parsing your search results.",i.INVALID_COMMAND="Ripgrep returned an invalid response.",i.CONTAINER_DISCONNECTED="Disconnected from the container.",i.CONTAINER_CONNECTING="Connecting to the container.",i.CHANNEL_CLOSED="Channel was closed."},84707:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(59868);function i(e){(0,r.j)(r.U3.FILETREE_USED,e)}},66959:function(e,t,n){n.d(t,{YI:function(){return A},kW:function(){return P}});var r,i,o=n(45903),a=n(25e3),l=n(8182),c=n(94450),s=n.n(c);n(43429);var u=n(63461);(r=i||(i={})).TEXT="TEXT",r.MENTION="MENTION",r.LINK="LINK",r.REPL_LINK="REPL_LINK",r.DEEP_LINK="DEEP_LINK",r.CODE="CODE",r.BOLD="BOLD",r.ITALICS="ITALICS",r.STRIKETHROUGH="STRIKETHROUGH",r.QUOTE="QUOTE";var d=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)(u.Z,{size:"small",onClick:n,children:t.content})},f=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)(u.Z,{size:"small",fontWeight:"medium",onClick:n,children:t.content})},h=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,rel:"noreferrer noopener nofollow",target:"_blank",children:t.content})},p=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,target:"_blank",children:t.content})},m=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,children:t.content})},v=function(e){var t=e.fragment,n=e.onClick,r=e.style;return(0,l.tZ)("code",{onClick:n,style:r,children:t.content})},g=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("b",{onClick:n,children:t.content})},y=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("i",{onClick:n,children:t.content})},b=function(e){var t=e.fragment,n=e.onClick;return(0,l.BX)("span",{onClick:n,className:"jsx-e2f6e2707e7599fa",children:[t.content,(0,l.tZ)(s(),{id:"e2f6e2707e7599fa",children:"span.jsx-e2f6e2707e7599fa{text-decoration:line-through}"})]})},Z=function(e){var t=e.fragment,n=e.onClick;return(0,l.BX)("blockquote",{onClick:n,className:"jsx-8741a91fadaf26be",children:[t.content,(0,l.tZ)(s(),{id:"8741a91fadaf26be",children:"blockquote.jsx-8741a91fadaf26be{border-left:2px solid var(--foreground-dimmest);padding-left:6px;color:var(--foreground-dimmest)}"})]})},w=/(@[0-9a-zA-Z_]+)/,x=/(#[-a-zA-Z0-9@:%._+~#=/]+)/,C=/(https?:\/\/[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{2,6}\b(?:[-a-zA-Z0-9()@:%_+.~#?&//=]*))/,_=/(`.+?`)/,k=/(\*\*.+?\*\*)/,S=/(_.+?_)/,E=/(\*.+?\*)/,T=/(~~.+?~~)/,R=/(^>.+?$\n?)/m,I=/\/@([0-9a-zA-Z_]+)\/(.+)/;function D(e){var t=e.url;return{type:"LINK",url:t,content:t}}function G(e){var t=e.hash;return{type:"DEEP_LINK",url:t,content:t}}var B=RegExp([_.source,k.source,S.source,E.source,T.source,C.source,w.source,x.source,R.source].join("|"),"m");function P(e,t){var n=e.split(B),r=[],i=[],o=!0,a=!1,l=void 0;try{for(var c,s=n[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;if(u){var d=function(e,t){if(C.test(e)){var n={};try{n=new window.URL(e)}catch(t){return{content:e,type:"TEXT"}}return["repl.it","replit.com","firewalledreplit.com",document.location.host].includes(n.host)?n.pathname===t.replUrl?G({hash:n.hash}):I.test(n.pathname)?function(e){var t=e.url,n=I.exec(t.pathname);if(!n)throw Error("Not a Repl URL");return{type:"REPL_LINK",url:t.href,content:"@".concat(n[1],"/").concat(n[2]).concat(t.hash)}}({url:n}):D({url:e}):D({url:e})}if(x.test(e))return G({hash:e});if(R.test(e))return{type:"QUOTE",content:({text:e.slice(1).trim()}).text};if(_.test(e))return{type:"CODE",content:({code:e.slice(1,-1)}).code};if(k.test(e))return{type:"BOLD",content:({text:e.slice(2,-2)}).text};if(S.test(e)||E.test(e))return{type:"ITALICS",content:({text:e.slice(1,-1)}).text};if(T.test(e))return{type:"STRIKETHROUGH",content:({text:e.slice(2,-2)}).text};if(w.test(e)){var r=e.slice(1);if(!t.users||t.users.includes(r))return{type:"MENTION",username:r,content:"@".concat(r)}}return{content:e,type:"TEXT"}}(u,t);if(d){if("MENTION"===d.type){if(!d.username)continue;r.push(d.username)}i.push(d)}}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return{tokens:i,mentions:r}}function A(e){var t=e.message,n=e.onMentionClick,r=void 0===n?function(){}:n,i=e.codeStyles,c=void 0===i?{}:i;return(0,l.tZ)(l.HY,{children:t.tokens.map(function(e,t){var n={fragment:e,key:t};return"MENTION"===e.type?(0,l.tZ)(f,(0,a._)((0,o._)({},n),{onClick:function(){return r(e)}})):"LINK"===e.type?(0,l.tZ)(h,(0,o._)({},n)):"REPL_LINK"===e.type?(0,l.tZ)(p,(0,o._)({},n)):"DEEP_LINK"===e.type?(0,l.tZ)(m,(0,o._)({},n)):"CODE"===e.type?(0,l.tZ)(v,(0,a._)((0,o._)({},n),{style:c})):"BOLD"===e.type?(0,l.tZ)(g,(0,o._)({},n)):"ITALICS"===e.type?(0,l.tZ)(y,(0,o._)({},n)):"STRIKETHROUGH"===e.type?(0,l.tZ)(b,(0,o._)({},n)):"QUOTE"===e.type?(0,l.tZ)(Z,(0,o._)({},n)):(0,l.tZ)(d,(0,o._)({},n))})})}},43001:function(e,t,n){n.d(t,{D:function(){return fa}});var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z,w,x,C=n(45903),_=n(25e3),k=n(32477),S=n(21289),E=n(8182),T=n(2038),R=n(57468),I=n(36577),D=n(98859),G=n(33914),B=n(3844),P=n(94106),A=n.n(P),N=n(90234),U=n(94450),L=n.n(U),O=n(43429),X=n(64457),M=n(56596),F=n(29287),W=n(39179),H=n(86262),V=n(89061),z=n(69451),j=n.n(z),q=n(21557),Y=n(3574),$=n(62340),J=function(e){var t=e.buttons,n=e.onClick,r=e.onUndo,i=e.onRedo;return(0,E.BX)("nav",{className:"jsx-43582faf24448cbd",children:[t.map(function(e){return(0,E.tZ)("button",{onClick:function(t){t.stopPropagation(),t.preventDefault(),n(e)},className:"jsx-43582faf24448cbd",children:void 0!==e.label?e.label:e.value},e.value)}),(0,E.tZ)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),r()},className:"jsx-43582faf24448cbd",children:(0,E.tZ)(W.Z,{})}),(0,E.tZ)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),i()},className:"jsx-43582faf24448cbd",children:(0,E.tZ)(H.Z,{})}),(0,E.tZ)(L(),{id:"43582faf24448cbd",children:'nav.jsx-43582faf24448cbd{font-family:Monaco,Menlo,"Ubuntu Mono",Consolas,source-code-pro,monospace;height:48px;background-color:var(--background-root);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:stretch;-webkit-align-items:stretch;-moz-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}button.jsx-43582faf24448cbd{color:var(--foreground-default);padding:10px;font-family:inherit;font-size:16px;background-color:transparent;border:0 none;-webkit-box-flex:1;-webkit-flex:1 1 auto;-moz-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}'})]})},K=[{value:"{}",cursorOffset:1},{value:"()",cursorOffset:1},{value:'""',cursorOffset:1}],Q=function(e){var t=e.path,n=(0,S._)(K).concat([{value:"= ",cursorOffset:2}]);return t.endsWith(".html")&&(n.unshift({value:"<>",cursorOffset:1}),n.unshift({label:"div",value:"<div></div>",cursorOffset:5})),n},ee="visualViewport"in window;function et(e){var t=e.filePath,n=e.isLoading,r=(0,Y.uN)(),i=(0,$.d)({tablet:!1}),o=(0,X.Z)();O.useEffect(function(){o&&r&&r.requestMeasure({read:function(){return{cursor:r.coordsAtPos(r.state.selection.main.head),scroller:r.scrollDOM.getBoundingClientRect()}},write:function(e){var t=e.cursor,n=e.scroller;if(t){var i=(t.top+t.bottom)/2,o=(n.top+n.bottom)/2;Math.abs(i-o)>5&&(r.scrollDOM.scrollTop+=i-o+(q.gn?50:0))}}})},[o,r]);var a=(0,k._)(O.useState(0),2),l=a[0],c=a[1];if(O.useEffect(function(){if(q.gn){var e=window.visualViewport;if(ee&&e){var t=j()(function(){c(window.innerHeight-e.height-e.offsetTop)},100);return e.addEventListener("scroll",t),e.addEventListener("resize",t),function(){e.removeEventListener("scroll",t),e.removeEventListener("resize",t)}}}},[]),!o||n||!i)return null;var s=(0,E.tZ)(J,{onUndo:function(){r&&((0,V.Yw)(r),r.focus())},onRedo:function(){r&&((0,V.KX)(r),r.focus())},onClick:function(e){if(r){var t,n=null!==(t=r.state.selection.ranges[0].from)&&void 0!==t?t:0;r.dispatch({changes:{from:n,insert:e.value},selection:{anchor:n+e.cursorOffset}}),r.focus()}},buttons:Q({path:t})});return!q.gn||ee?(0,E.tZ)(M.G,{css:[F.l0.position.fixed,F.l0.width("100%"),F.l0.zIndex(100),F.l0.bottom(l),F.l0.left(0)],children:s}):s}var en=n(24549),er=n(96606),ei=[{img:"/public/images/kaboomdraw/rect.png",code:"\ndrawRect({\n	pos: vec2(80, 80),\n	width: 120,\n	height: 80,\n	color: rgb(250, 242, 164),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/triangle.png",code:"\ndrawTriangle({\n	pos: vec2(100, 100),\n	p1: vec2(0, -48),\n	p2: vec2(-60, 48),\n	p3: vec2(60, 48),\n	color: rgb(164, 250, 204),\n})\n  ".trim()},{img:"/public/images/kaboomdraw/circle.png",code:"\ndrawCircle({\n	pos: vec2(100, 100),\n	radius: 48,\n	color: rgb(181, 164, 250),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/ellipse.png",code:"\ndrawEllipse({\n	pos: vec2(120, 100),\n	radiusX: 64,\n	radiusY: 40,\n	color: rgb(164, 209, 250),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/polygon.png",code:"\ndrawPolygon({\n	pos: vec2(100, 100),\n	pts: [\n		vec2(0, -48),\n		vec2(-64, 0),\n		vec2(-32, 64),\n		vec2(32, 64),\n		vec2(64, 0),\n	],\n	color: rgb(250, 164, 226),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/text.png",code:'\ndrawText({\n	text: "hi",\n	pos: vec2(60, 60),\n})\n    '.trim()}],eo=function(e){var t=e.img,n=e.code,r=(0,k._)((0,er.c)({item:{type:en.z.Code,code:n},type:en.z.Code}),2)[1];return(0,E.tZ)("img",{alt:"kaboom shape",ref:r,src:t,css:[F.l0.p(12),{userDrag:"none",height:"100%",cursor:"pointer",transition:"0.1s transform",":hover":{transform:"scale(1.2)"}}]})},ea=function(){return(0,E.tZ)(M.G,{css:[F.l0.flex.row,F.l0.justify.spaceEvenly,F.l0.backgroundColor.backgroundHigher,F.l0.borderRadius(8),F.l0.width("calc(100% - 32px)"),F.l0.height("64px"),F.l0.position.absolute,F.l0.overflowY("hidden"),{zIndex:5,left:16,bottom:16,border:"solid 1px var(--outline-dimmest)"}],children:ei.map(function(e){return(0,E.tZ)(eo,(0,C._)({},e),e.img)})})},el=n(62789),ec=n(16643),es=n(57111),eu=n(54916),ed=n(91039),ef=n(66349),eh=n(92994),ep=n(62299),em=n(12569),ev=n(69926);function eg(e){var t,n=e.getServerCapabilities();return{isAutoCompleteSupported:!!(null==n?void 0:n.completionProvider),isCompletionItemResolveSupported:!!(null==n?void 0:null===(t=n.completionProvider)||void 0===t?void 0:t.resolveProvider),isDocumentSymbolSupported:!!(null==n?void 0:n.documentSymbolProvider),isFindReferencesSupported:!!(null==n?void 0:n.referencesProvider),isFindDefinitionSupported:!!(null==n?void 0:n.definitionProvider),isFindTypeDefinitionSupported:!!(null==n?void 0:n.typeDefinitionProvider),isFindImplementationSupported:!!(null==n?void 0:n.implementationProvider),isFormatSupported:!!(null==n?void 0:n.documentFormattingProvider),isTextDocumentSyncSupported:!!(null==n?void 0:n.textDocumentSync),isHoverSupported:!!(null==n?void 0:n.hoverProvider),isRenameSupported:!!(null==n?void 0:n.renameProvider),isCodeActionsSupported:!!(null==n?void 0:n.codeActionProvider),isSignatureHelpSupported:!!(null==n?void 0:n.signatureHelpProvider)}}function ey(e){var t=(0,k._)(O.useState(null),2),n=t[0],r=t[1];return O.useEffect(function(){if(!e){r(null);return}return r(eg(e)),e.onServerCapabilitiesChange(function(){r(eg(e))})},[e]),n}var eb=n(92920),eZ=n(34142),ew=n(87682),ex=n(84357),eC=n(98188),e_=n(38265),ek=n(74106),eS=n(62609),eE=n(40497),eT=n(74833),eR=n(68333),eI=n(18672),eD=n(53326),eG={p:{padding:"".concat(F.TV.space2," ").concat(F.TV.space8),lineHeight:1.4,marginBottom:"".concat(F.TV.space8," !important")},"p:first-of-type":{marginTop:"".concat(F.TV.space4," !important")},"p:last-of-type":{marginBottom:"".concat(F.TV.space4," !important")},pre:{margin:"".concat(F.TV.space2," ").concat(F.TV.space8)},"pre + p":{borderTop:"1px solid ".concat(F.TV.outlineDimmest),paddingTop:F.TV.space4},"h1, h2, h3":{margin:"".concat(F.TV.space8," !important"),marginTop:"".concat(F.TV.space12," !important"),padding:"0 !important",paddingBottom:"".concat(F.TV.space4," !important"),fontSize:"100% !important",borderBottom:"1px solid ".concat(F.TV.backgroundHighest," !important"),lineHeight:1},"h1:first-of-type, h2:first-of-type, h3:first-of-type":{marginTop:"".concat(F.TV.space4," !important")},hr:{margin:"".concat(F.TV.space8," !important"),borderTop:"2px solid ".concat(F.TV.backgroundHighest," !important")},li:{margin:"".concat(F.TV.space2," ").concat(F.TV.space8)},".lsp-completion-detail":{borderBottom:"1px solid ".concat(F.TV.backgroundHighest),marginBottom:F.TV.space4},".cm-line":{paddingLeft:F.TV.space4,paddingRight:F.TV.space4},".cm-content":{paddingLeft:F.TV.space4,paddingRight:F.TV.space4}},eB=O.memo(function(e){var t=e.content,n=e.className;return(0,E.tZ)(M.G,{css:eG,children:(0,E.tZ)(eR.ZP,{className:n,components:{code:function(e){return(0,E.tZ)(eD.Z,(0,C._)({minimal:!0,disableCopy:!0},e))}},children:t})})});function eP(e){var t=e.content,n=e.className;return"string"==typeof t?(0,E.tZ)(eB,{css:[{p:{whiteSpace:"pre-wrap"}}],className:n,content:t}):t.kind===eI.MarkupKind.PlainText?(0,E.tZ)(M.G,{children:(0,E.tZ)(eT.xv,{className:n,children:t.value})}):(0,E.tZ)(eB,{className:n,content:t.value})}var eA=n(54472),eN=(0,eS.B)(),eU=ex.Py.define(),eL=ex.QQ.define({create:function(){return null},update:function(e,t){if(t.isUserEvent("select")||t.isUserEvent("undo")||t.isUserEvent("redo"))return null;if(!t.isUserEvent("input.type")||t.changes.empty)return e;var n="";return t.changes.iterChanges(function(e,t,r,i,o){n=o.sliceString(0,1)}),n||null}}),eO=new eA.Jf(function(e){var t,n,r=e.help,i=e.index,o="1px solid ".concat(F.TV.outlineDimmer),a="min(425px, 80vw)",l=r.signatures[i],c=r.signatures.length>1;if(!l)return null;var s=l.documentation,u=null!=r.activeParameter&&(null===(n=l.parameters)||void 0===n?void 0:null===(t=n[r.activeParameter])||void 0===t?void 0:t.documentation);return(0,E.BX)(M.G,{css:[F.l0.flex.row,F.l0.backgroundColor.backgroundHigher,{width:"max-content"}],children:[c?(0,E.tZ)(M.G,{css:[F.l0.flex.row,F.l0.pl(4),{borderRight:o,paddingBottom:5}],children:(0,E.BX)("span",{css:[{alignSelf:"flex-end"},F.l0.p(4)],children:[i+1,"/",r.signatures.length]})}):null,(0,E.BX)(M.G,{children:[(0,E.tZ)(M.G,{css:[F.l0.py(4),F.l0.pl(c?4:8),F.l0.pr(8),F.l0.maxHeight(100),F.l0.overflowY("scroll"),F.l0.font.code,{lineHeight:F.TV.lineHeightSmall,maxWidth:a}],children:(0,E.tZ)(eX,{signature:l,activeParameter:r.activeParameter})}),!!(s||u)&&(0,E.BX)(M.G,{css:[F.l0.px(c?4:8),F.l0.py(2),F.l0.maxHeight(200),F.l0.overflow("scroll"),{borderTop:o,maxWidth:a}],children:[u?(0,E.tZ)(eP,{content:u}):null,s?(0,E.tZ)(eP,{content:s}):null]})]})]})});function eX(e){var t,n=e.signature,r=n.label,i=n.parameters,o=e.activeParameter;if(null==o||!i)return(0,E.tZ)("span",{children:r});var a=null===(t=i[o])||void 0===t?void 0:t.label;if(!a)return(0,E.tZ)("span",{children:r});var l=(0,k._)("string"==typeof a?[r.indexOf(a),r.indexOf(a)+a.length]:a,2),c=l[0],s=l[1];return(0,E.BX)("div",{children:[(0,E.tZ)("span",{children:r.slice(0,c)}),(0,E.tZ)("strong",{children:a}),(0,E.tZ)("span",{children:r.slice(s)})]})}function eM(){return(eM=(0,eZ._)(function(e,t,n,r,i){var o,a;return(0,ew.Jh)(this,function(l){switch(l.label){case 0:return i.current&&n.notify.cancelRequest(i.current),o=n.generateId(),i.current=o,[4,n.request.signatureHelp(r,(0,ek.s)(e.doc,t),{id:o})];case 1:if(a=l.sent(),i.current=null,"error"in a)return[2,null];return[2,a.result]}})})).apply(this,arguments)}var eF=n(4755),eW=n(73926),eH=n.n(eW),eV=n(8701),ez=new Map,ej=n(49920),eq=n(39698),eY=n(78402),e$=n(43586),eJ=n(23026),eK=n(3194),eQ=n(70322),e0=n(2543),e1=n(74633),e2=n(57953),e8=n(32838),e4=n(81246);(o=h||(h={}))[o.Dollar=0]="Dollar",o[o.Colon=1]="Colon",o[o.Comma=2]="Comma",o[o.CurlyOpen=3]="CurlyOpen",o[o.CurlyClose=4]="CurlyClose",o[o.Backslash=5]="Backslash",o[o.Forwardslash=6]="Forwardslash",o[o.Pipe=7]="Pipe",o[o.Int=8]="Int",o[o.VariableName=9]="VariableName",o[o.Format=10]="Format",o[o.Plus=11]="Plus",o[o.Dash=12]="Dash",o[o.QuestionMark=13]="QuestionMark",o[o.EOF=14]="EOF";var e3=function(){"use strict";function e(){(0,eJ._)(this,e),this.value="",this.pos=0}var t=e.prototype;return t.text=function(e){this.value=e,this.pos=0},t.tokenText=function(e){return this.value.substr(e.pos,e.len)},t.next=function(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};var t,n=this.pos,r=0,i=this.value.charCodeAt(n);if("number"==typeof(t=e._table[i]))return this.pos+=1,{type:t,pos:n,len:1};if(e.isDigitCharacter(i)){t=8;do r+=1,i=this.value.charCodeAt(n+r);while(e.isDigitCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}}if(e.isVariableCharacter(i)){t=9;do i=this.value.charCodeAt(n+ ++r);while(e.isVariableCharacter(i)||e.isDigitCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}}t=10;do r+=1,i=this.value.charCodeAt(n+r);while(!isNaN(i)&&void 0===e._table[i]&&!e.isDigitCharacter(i)&&!e.isVariableCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}},e.isDigitCharacter=function(e){return e>=48&&e<=57},e.isVariableCharacter=function(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90},e}();e3._table=(p={},(0,eq._)(p,36,0),(0,eq._)(p,58,1),(0,eq._)(p,44,2),(0,eq._)(p,123,3),(0,eq._)(p,125,4),(0,eq._)(p,92,5),(0,eq._)(p,47,6),(0,eq._)(p,124,7),(0,eq._)(p,43,11),(0,eq._)(p,45,12),(0,eq._)(p,63,13),p);var e5=function(){"use strict";function e(){(0,eJ._)(this,e),this._children=[],function(e,t){t.forEach(function(t){Object.defineProperty(e,t,{enumerable:!1,writable:!0})})}(this,["parent"])}var t=e.prototype;return t.appendChild=function(e){return e instanceof e6&&this._children[this._children.length-1]instanceof e6?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this},t.replace=function(e,t){var n=e.parent,r=n.children.indexOf(e),i=n.children.slice(0);i.splice.apply(i,[r,1].concat((0,S._)(t))),n._children=i,function e(t,n){var r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;c.parent=n,e(c.children,c)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}}(t,n)},t.toString=function(){return this.children.reduce(function(e,t){return e+t.toString()},"")},t.len=function(){return 0},t.match=function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=Object.entries(tl)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=(0,k._)(i.value,2),l=a[0],c=a[1];if(this instanceof c&&l in e)return e[l](this)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},(0,e2._)(e,[{key:"children",get:function(){return this._children}},{key:"rightMostDescendant",get:function(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}},{key:"snippet",get:function(){for(var e=this;;){if(!e)return;if(e instanceof to)return e;e=e.parent}}}]),e}(),e6=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r;return(0,eJ._)(this,n),(r=t.call(this)).value=e,r}var r=n.prototype;return r.toString=function(){return this.value},r.toTextmateString=function(){return n.escape(this.value)},r.len=function(){return this.value.length},r.clone=function(){return new n(this.value)},n.escape=function(e){return e.replace(/\$|}|\\/g,"\\$&")},n}(e5),e9=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(){return(0,eJ._)(this,n),t.apply(this,arguments)}return n}(e5),e7=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r;return(0,eJ._)(this,n),(r=t.call(this)).index=e,r}var r=n.prototype;return r.toTextmateString=function(){var e="";return(this.transform&&(e=this.transform.toTextmateString()),0!==this.children.length||this.transform)?0===this.children.length?"${".concat(this.index).concat(e,"}"):this.choice?"${".concat(this.index,"|").concat(this.choice.toTextmateString(),"|").concat(e,"}"):"${".concat(this.index,":").concat(this.children.map(function(e){return e.toTextmateString()}).join("")).concat(e,"}"):"$".concat(this.index)},r.clone=function(){var e=new n(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(function(e){return e.clone()}),e},n.compareByIndex=function(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0},(0,e2._)(n,[{key:"isFinalTabstop",get:function(){return 0===this.index}},{key:"choice",get:function(){return 1===this._children.length&&this._children[0]instanceof te?this._children[0]:void 0}}]),n}(e9),te=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(){var e;return(0,eJ._)(this,n),e=t.apply(this,arguments),e.options=[],e}var r=n.prototype;return r.appendChild=function(e){return e instanceof e6&&(e.parent=this,this.options.push(e)),this},r.toString=function(){return this.options[0].value},r.toTextmateString=function(){return this.options.map(function(e){return e.value.replace(/\||,|\\/g,"\\$&")}).join(",")},r.len=function(){return this.options[0].len()},r.clone=function(){var e=new n;return this.options.forEach(e.appendChild,e),e},n}(e5),tt=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(){var e;return(0,eJ._)(this,n),e=t.apply(this,arguments),e.regexp=RegExp(""),e}var r=n.prototype;return r.resolve=function(e){var t=this,n=!1,r=e.replace(this.regexp,function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return n=!0,t._replace(r.slice(0,-2))});return!n&&this._children.some(function(e){return e instanceof tn&&!!e.elseValue})&&(r=this._replace([])),r},r._replace=function(e){var t="",n=!0,r=!1,i=void 0;try{for(var o,a=this._children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l instanceof tn){var c=e[l.index]||"";c=l.resolve(c),t+=c}else t+=l.toString()}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t},r.toString=function(){return""},r.toTextmateString=function(){return"/".concat(this.regexp.source,"/").concat(this.children.map(function(e){return e.toTextmateString()}),"/").concat((this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":""))},r.clone=function(){var e=new n;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(function(e){return e.clone()}),e},n}(e5),tn=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r,i,o){var a;return(0,eJ._)(this,n),(a=t.call(this)).index=e,a.shorthandName=r,a.ifValue=i,a.elseValue=o,a}var r=n.prototype;return r.resolve=function(e){if("upcase"===this.shorthandName)return e?e.toLocaleUpperCase():"";if("downcase"===this.shorthandName)return e?e.toLocaleLowerCase():"";if("capitalize"===this.shorthandName)return e?e[0].toLocaleUpperCase()+e.substr(1):"";if("pascalcase"===this.shorthandName)return e?this._toPascalCase(e):"";if("camelcase"===this.shorthandName)return e?this._toCamelCase(e):"";if(e&&"string"==typeof this.ifValue)return this.ifValue;if(!e&&"string"==typeof this.elseValue)return this.elseValue;else return e||""},r._toPascalCase=function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map(function(e){return e.charAt(0).toUpperCase()+e.substr(1)}).join(""):e},r._toCamelCase=function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map(function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.substr(1):e.charAt(0).toUpperCase()+e.substr(1)}).join(""):e},r.toTextmateString=function(){var e="${";return e+=this.index,this.shorthandName?e+=":/".concat(this.shorthandName):this.ifValue&&this.elseValue?e+=":?".concat(this.ifValue,":").concat(this.elseValue):this.ifValue?e+=":+".concat(this.ifValue):this.elseValue&&(e+=":-".concat(this.elseValue)),e+="}"},r.clone=function(){return new n(this.index,this.shorthandName,this.ifValue,this.elseValue)},n}(e5),tr=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r;return(0,eJ._)(this,n),(r=t.call(this)).name=e,r}var r=n.prototype;return r.resolve=function(e){var t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),void 0!==t&&(this._children=[new e6(t)],!0)},r.toTextmateString=function(){var e="";return(this.transform&&(e=this.transform.toTextmateString()),0===this.children.length)?"${".concat(this.name).concat(e,"}"):"${".concat(this.name,":").concat(this.children.map(function(e){return e.toTextmateString()}).join("")).concat(e,"}")},r.clone=function(){var e=new n(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(function(e){return e.clone()}),e},n}(e9);function ti(e,t){for(var n=(0,S._)(e);n.length>0;){var r=n.shift();if(!t(r))break;n.unshift.apply(n,(0,S._)(r.children))}}var to=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(){return(0,eJ._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.offset=function(e){var t=0,n=!1;return(this.walk(function(r){return r===e?(n=!0,!1):(t+=r.len(),!0)}),n)?t:-1},r.fullLen=function(e){var t=0;return ti([e],function(e){return t+=e.len(),!0}),t},r.enclosingPlaceholders=function(e){for(var t=[],n=e.parent;n;)n instanceof e7&&t.push(n),n=n.parent;return t},r.resolveVariables=function(e){var t=this;return this.walk(function(n){return n instanceof tr&&n.resolve(e)&&delete t._placeholders,!0}),this},r.appendChild=function(e){return delete this._placeholders,(0,e8._)((0,e4._)(n.prototype),"appendChild",this).call(this,e)},r.replace=function(e,t){return delete this._placeholders,(0,e8._)((0,e4._)(n.prototype),"replace",this).call(this,e,t)},r.toTextmateString=function(){return this.children.reduce(function(e,t){return e+t.toTextmateString()},"")},r.clone=function(){var e=new n;return this._children=this.children.map(function(e){return e.clone()}),e},r.walk=function(e){ti(this.children,e)},(0,e2._)(n,[{key:"placeholderInfo",get:function(){if(!this._placeholders){var e,t=[];this.walk(function(n){return n instanceof e7&&(t.push(n),e=!e||e.index<n.index?n:e),!0}),this._placeholders={all:t,last:e}}return this._placeholders}},{key:"placeholders",get:function(){return this.placeholderInfo.all}}]),n}(e5),ta=function(){"use strict";function e(){(0,eJ._)(this,e),this._scanner=new e3,this._token={type:14,pos:0,len:0}}var t=e.prototype;return t.text=function(e){return this.parse(e).toString()},t.parse=function(e,t,n){var r=new to;return this.parseFragment(e,r),this.ensureFinalTabstop(r,null!=n&&n,null!=t&&t),r},t.parseFragment=function(e,t){var n=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););var r=new Map,i=[];t.walk(function(e){return e instanceof e7&&(e.isFinalTabstop?r.set(0,void 0):!r.has(e.index)&&e.children.length>0?r.set(e.index,e.children):i.push(e)),!0});var o=function(e,n){var i=r.get(e.index);if(i){var a=new e7(e.index);a.transform=e.transform;var l=!0,c=!1,s=void 0;try{for(var u,d=i[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value.clone();a.appendChild(f),f instanceof e7&&r.has(f.index)&&!n.has(f.index)&&(n.add(f.index),o(f,n),n.delete(f.index))}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}t.replace(e,[a])}},a=new Set,l=!0,c=!1,s=void 0;try{for(var u,d=i[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;o(f,a)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return t.children.slice(n)},t.ensureFinalTabstop=function(e,t,n){(t||n&&e.placeholders.length>0)&&!e.placeholders.find(function(e){return 0===e.index})&&e.appendChild(new e7(0))},t._accept=function(e,t){if(void 0===e||this._token.type===e){var n=!t||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),n}return!1},t._backTo=function(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1},t._until=function(e){for(var t=this._token;this._token.type!==e;){if(14===this._token.type)return!1;if(5===this._token.type){var n=this._scanner.next();if(0!==n.type&&4!==n.type&&5!==n.type)return!1}this._token=this._scanner.next()}var r=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),r},t._parse=function(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)},t._parseEscaped=function(e){var t;return!!(t=this._accept(5,!0))&&(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new e6(t)),!0)},t._parseTabstopOrVariableName=function(e){var t,n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new e7(Number(t)):new tr(t)),!0):this._backTo(n)},t._parseComplexPlaceholder=function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);var r=new e7(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new e6("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(r.index>0&&this._accept(7))for(var i=new te;;){if(this._parseChoiceElement(i)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(i),this._accept(4)))return e.appendChild(r),!0}return this._backTo(n),!1}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)},t._parseChoiceElement=function(e){for(var t=this._token,n=[];2!==this._token.type&&7!==this._token.type;){var r=void 0;if(!(r=(r=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||r:this._accept(void 0,!0)))return this._backTo(t),!1;n.push(r)}return 0===n.length?(this._backTo(t),!1):(e.appendChild(new e6(n.join(""))),!0)},t._parseComplexVariable=function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);var r=new tr(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new e6("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)},t._parseTransform=function(e){for(var t=new tt,n="",r="";!this._accept(6);){var i=void 0;if(i=this._accept(5,!0)){n+=i=this._accept(6,!0)||i;continue}if(14!==this._token.type){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){var o=void 0;if(o=this._accept(5,!0)){o=this._accept(5,!0)||this._accept(6,!0)||o,t.appendChild(new e6(o));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(14!==this._token.type){r+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(n,r)}catch(e){return!1}return e.transform=t,!0},t._parseFormatString=function(e){var t=this._token;if(!this._accept(0))return!1;var n=!1;this._accept(3)&&(n=!0);var r=this._accept(8,!0);if(!r)return this._backTo(t),!1;if(!n||this._accept(4))return e.appendChild(new tn(Number(r))),!0;if(!this._accept(1))return this._backTo(t),!1;if(this._accept(6)){var i=this._accept(9,!0);return i&&this._accept(4)?(e.appendChild(new tn(Number(r),i)),!0):(this._backTo(t),!1)}if(this._accept(11)){var o=this._until(4);if(o)return e.appendChild(new tn(Number(r),void 0,o,void 0)),!0}else if(this._accept(12)){var a=this._until(4);if(a)return e.appendChild(new tn(Number(r),void 0,void 0,a)),!0}else if(this._accept(13)){var l=this._until(1);if(l){var c=this._until(4);if(c)return e.appendChild(new tn(Number(r),void 0,l,c)),!0}}else{var s=this._until(4);if(s)return e.appendChild(new tn(Number(r),void 0,void 0,s)),!0}return this._backTo(t),!1},t._parseAnything=function(e){return 14!==this._token.type&&(e.appendChild(new e6(this._scanner.tokenText(this._token))),this._accept(void 0),!0)},e.escape=function(e){return e.replace(/\$|}|\\/g,"\\$&")},e.asInsertText=function(t){return new e().parse(t).toString()},e.guessNeedsClipboard=function(e){return/\${?CLIPBOARD/.test(e)},e}(),tl={Text:e6,Placeholder:e7,Variable:tr,FormatString:tn,Choice:te},tc=function(){"use strict";function e(t){(0,eJ._)(this,e),this.lines=t.split(/\r\n?|\n/).map(function(e){return new ta().parse(e).children})}return e.prototype.apply=function(t){var n=t.view,r=t.from,i=t.to,o=e.instantiate(this.lines,t),a=o.text,l=o.ranges,c={from:r,to:i,insert:ex.xv.of(a)},s={changes:c,scrollIntoView:!0,annotations:eC.Jv.of(t.completion)};if(l.length&&(s.selection=tm(l,0)),l.length>1){var u=new td(l,0),d=s.effects=[tf.of(u)];void 0===n.state.field(tp,!1)&&d.push(ex.Py.appendConfig.of([tp,tg,ty]))}if(r===i&&!l.length){var f=ex.as.of(c,n.state.doc.length),h=n.state.selection.ranges.map(function(e){return e.map(f,0)});s.selection=ex.jT.create(h,n.state.selection.mainIndex)}return s},e.resolveVariable=function(e,t){var n=t.view,r=t.from,i=t.path;switch(e){case"TM_FILENAME":return(0,e$.basename)(i);case"TM_FILENAME_BASE":return(0,e$.basename)(i,(0,e$.extname)(i));case"TM_DIRECTORY":return(0,e$.dirname)(i);case"TM_FILEPATH":return i;case"TM_LINE_INDEX":return(n.state.doc.lineAt(r).number-1).toString();case"TM_LINE_NUMBER":return n.state.doc.lineAt(r).number.toString();default:return e}},e.instantiate=function(t,n){var r=n.view,i=n.from,o=r.state,a=[],l=[],c=o.doc.lineAt(i),s=/^\s*/.exec(c.text)[0],u=o.facet(e1.c),d=!0,f=!1,h=void 0;try{for(var p,m,v=t[Symbol.iterator]();!(d=(m=v.next()).done);d=!0)!function(){var t=m.value,r=0,o="",c=function(e){var t=0,n=r;if(0===r&&(t=/^\t*/.exec(e)[0].length)){var i=s+u.repeat(t);e=i+e.slice(t),n+=i.length}return o+=e,r+=e.length,{line:a.length,from:n,to:r}},d=function(t){var o=!0,s=!1,u=void 0;try{for(var f,h=t[Symbol.iterator]();!(o=(f=h.next()).done);o=!0)f.value.match({Text:function(e){c(e.value)},Variable:function(t){var r=t.name,i=t.transform,o=e.resolveVariable(r,n);i&&(o=o.replace(i.regexp,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.children.map(function(e){return e.match({Text:function(e){return e.value},FormatString:function(e){return e.resolve(t[e.index])}})}).filter(Boolean).join("")})),c(o)},Choice:function(e){c(e.options[0].value)},Placeholder:function(e){var t,n=a.length?i+a.map(function(e){return e.length}).reduce(function(e,t){return e+t}):i;if(null===(t=e.children)||void 0===t?void 0:t.length){var o={field:e.index,from:n+r,to:null};l.push(o),d(e.children),o.to=n+r}else{c("");var s=n+r;l.push({field:e.index,from:s,to:s})}}})}catch(e){s=!0,u=e}finally{try{o||null==h.return||h.return()}finally{if(s)throw u}}};d(t),a.push(o)}()}catch(e){f=!0,h=e}finally{try{d||null==v.return||v.return()}finally{if(f)throw h}}var g=(p=Math).max.apply(p,(0,S._)(l.map(function(e){return e.field})));return{text:a,ranges:l.map(function(e){var t=e.field,n=(0,eQ._)(e,["field"]);return(0,_._)((0,C._)({},n),{field:0===t?g:t-1})})}},e}(),ts=e_.p.widget({widget:new(function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(){return(0,eJ._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("span");return e.className="cm-snippetFieldPosition",e},r.ignoreEvent=function(){return!1},n}(e_.l9))}),tu=e_.p.mark({class:"cm-snippetField"}),td=function(){"use strict";function e(t,n){(0,eJ._)(this,e),this.ranges=t,this.active=n,this.deco=e_.p.set(t.map(function(e){return(e.from===e.to?ts:tu).range(e.from,e.to)}))}var t=e.prototype;return t.map=function(t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=this.ranges[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value,s=function(e,t){var n=t.mapPos(e.from,-1,ex.gc.TrackDel),r=t.mapPos(e.to,1,ex.gc.TrackDel);return null==n||null==r?null:{field:e.field,from:n,to:r}}(c,t);if(!s)return null;n.push(s)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return new e(n,this.active)},t.isSelectionInsideField=function(e){var t=this;return e.ranges.every(function(e){return t.ranges.some(function(n){return n.field===t.active&&n.from<=e.from&&n.to>=e.to})})},e}(),tf=ex.Py.define({map:function(e,t){return null==e?void 0:e.map(t)}}),th=ex.Py.define(),tp=ex.QQ.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(tf))return l.value;if(l.is(th)&&e)return new td(e.ranges,l.value)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.isSelectionInsideField(t.selection)&&(e=null),e},provide:function(e){return e_.tk.decorations.from(e,function(e){return e?e.deco:e_.p.none})}});function tm(e,t){var n=e.filter(function(e){return e.field===t}).map(function(e){return ex.jT.range(e.from,e.to)});if(0!==n.length)return ex.jT.create(n)}function tv(e){return function(t){var n,r=t.state,i=t.dispatch,o=r.field(tp,!1);if(!o||e<0&&0===o.active)return!1;var a=o.active+e,l=(n=Math).max.apply(n,(0,S._)(o.ranges.map(function(e){return e.field}))),c=e>0&&o.active>=l;return i(r.update({selection:tm(o.ranges,a),effects:tf.of(c?null:new td(o.ranges,a))})),!0}}var tg=ex.Wl.highest(e_.$f.of([{key:"Tab",run:tv(1),shift:tv(-1)},{key:"Escape",run:function(e){var t=e.state,n=e.dispatch;return!!t.field(tp,!1)&&(n(t.update({effects:tf.of(null)})),!0)}}])),ty=e_.tk.domEventHandlers({mousedown:function(e,t){var n,r=t.state.field(tp,!1);if(!r||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;var i=r.ranges.find(function(e){return e.from<=n&&e.to>=n});return!!i&&i.field!==r.active&&(t.dispatch({selection:tm(r.ranges,i.field),effects:tf.of(r.ranges.some(function(e){return e.field>i.field})?new td(r.ranges,i.field):null)}),!0)}}),tb=n(96132),tZ=n(85577),tw=n(59868),tx=n(11669),tC=n(47507),t_=n(34791),tk=n(73030),tS=n(93918),tE=n(89835),tT="cm-ghostwriter-hint-tooltip",tR=e_.tk.theme((0,eq._)({".cm-ghostwriter-hint":{display:"none",width:"100%",backgroundColor:F.TV.backgroundHigher,borderTop:"solid 1px ".concat(F.TV.outlineDefault)}},".cm-tooltip-autocomplete.".concat(tT," .cm-ghostwriter-hint"),{display:"block"})),tI=(0,tS.X)({hint:[F.l0.p(4),F.l0.rowWithGap(8),F.l0.align.center,F.l0.font.default,{opacity:.6}],prompt:[F.l0.rowWithGap(4),F.l0.align.center]});function tD(){return(0,E.BX)(M.G,{css:tI.hint,children:[(0,E.tZ)(tk.Z,{width:8,height:8}),(0,E.BX)(M.G,{css:tI.prompt,children:[(0,E.tZ)(tb.ZP,{size:"small",dimmed:!1,shortcut:{key:"tab"}}),(0,E.tZ)(eT.xv,{variant:"small",multiline:!1,children:"to use AI suggestion."})]})]})}var tG=e_.lg.define(function(e){var t=function(){var t,n,r;return(0,S._)(e.dom.children).concat((0,S._)(null!==(r=null===(n=tE.yb.get(e))||void 0===n?void 0:null===(t=n.children[0])||void 0===t?void 0:t.children)&&void 0!==r?r:[])).filter(function(e){return e.classList.contains("cm-tooltip-autocomplete")})},n=function(e){return Array.from(e.children).filter(function(e){return e.classList.contains("cm-ghostwriter-hint")})},r=!1;return{update:function(){null!==(0,eC.LR)(e.state)&&Promise.resolve().then(function(){if(!r){var e=!0,i=!1,o=void 0;try{for(var a,l=t()[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var c=a.value,s=n(c);if(0===s.length){var u=(0,eA.VV)((0,E.tZ)(tD,{}));u.className="cm-ghostwriter-hint",c.appendChild(u)}}}catch(e){i=!0,o=e}finally{try{e||null==l.return||l.return()}finally{if(i)throw o}}}})},destroy:function(){var e=!0,i=!1,o=void 0;try{for(var a,l=t()[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var c=a.value,s=!0,u=!1,d=void 0;try{for(var f,h=n(c)[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value;c.removeChild(p)}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}}}catch(e){i=!0,o=e}finally{try{e||null==l.return||l.return()}finally{if(i)throw o}}r=!0}}}),tB=ex.Py.define(),tP=ex.QQ.define({create:function(){return null},update:function(e,t){null!==(0,eC.LR)(t.state)?e&&(e=(0,_._)((0,C._)({},e),{missed:e.missed.compose(t.changes)})):e=null;var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.is(tB)&&(e={original:t.state.doc,missed:ex.as.empty(t.state.doc.length)})}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}});function tA(e,t){var n=e.field(tP,!1);if(n){var r=(0,ek.R)(n.original,t);return n.missed.mapPos(r)}return(0,ek.R)(e.doc,t)}var tN=n(29457),tU=n(89798);function tL(e){var t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),"[".concat(n?"\\w":"").concat(t.replace(".","").replace(/[^\w\s]/g,"\\$&"),"]")}var tO=Object.entries(eI.CompletionItemKind).reduce(function(e,t){var n=(0,k._)(t,2),r=n[0],i=n[1];return(0,C._)((0,eq._)({},i,r.toLowerCase()),e)},{});function tX(e,t){return{from:tA(e,t.start),to:tA(e,t.end)}}function tM(e,t){var n=tX(e.state,t.range),r=n.from,i=n.to;if(null!==r&&null!==i)return{from:r,to:i,insert:t.newText}}var tF=e_.tk.baseTheme({".lsp-completion-keyboard-shortcuts":{display:"none"},'[aria-selected="true"] .lsp-completion-keyboard-shortcuts':{float:"right",display:"inline-block"}}),tW=n(30609),tH=n(25425);function tV(e){var t=e.content,n=e.className,r=e.showHoveredVariable,i=(0,eb.Z)().preferences;if("string"!=typeof t&&"kind"in t)return(0,E.tZ)(eP,{content:t});var o=(Array.isArray(t)?t:[t]).map(function(e){return"string"==typeof e?e:"```"+e.language+"\n"+e.value+"\n```"}).join("\n");return(0,E.tZ)(eR.ZP,{css:[{p:{fontSize:i.fontSize}},r?[F.l0.maxHeight(tz),F.l0.overflowY("auto")]:void 0],className:n,components:{code:function(e){return(0,E.tZ)(eD.Z,(0,C._)({minimal:!0,disableCopy:!0},e))}},children:o})}var tz=100;function tj(e){var t=e.className,n=e.content,r=e.textHovered,i=(0,tH.P5)({controlName:"flag-debugger-hover-variable",logFlagToAnalytics:!1}),o=(0,eu.Z)().debuggest,a=(0,ec.Z)(o.mainClient),l=a&&("running"===a.state.current||"paused"===a.state.current),c=(0,k._)(O.useState(!1),2),s=c[0],u=c[1],d=(0,k._)(O.useState(void 0),2),f=d[0],h=d[1],p=i&&l&&f;return O.useEffect(function(){function e(){return(e=(0,eZ._)(function(){var e,t;return(0,ew.Jh)(this,function(n){switch(n.label){case 0:if(!(i&&l))return[3,4];u(!0),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,a.evaluate({expression:r,context:"hover"})];case 2:return(null===(e=(t=n.sent()).body)||void 0===e?void 0:e.result)&&h((0,C._)({name:r,value:t.body.result},t.body)),[3,4];case 3:return u(!1),[7];case 4:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[i,a,l,r]),(0,E.BX)(M.G,{css:[eG,p?F.l0.maxHeight(tz+190):F.l0.maxHeight(190),F.l0.minHeight(30),F.l0.overflowY("auto"),F.l0.borderRadius(4),F.l0.backgroundColor.backgroundHigher],children:[s?void 0:(0,E.tZ)(tV,{content:n,className:t,showHoveredVariable:!!p}),p?(0,E.tZ)(M.G,{css:[F.l0.maxHeight(190),F.l0.overflowY("auto")],children:(0,E.tZ)(tW._,{depth:0,client:a,variable:f})}):void 0]})}var tq=n(92631),tY=n(95032),t$=n(81031),tJ=n(22487),tK=n(83848),tQ=n(58719),t0=n(88936);function t1(e){var t=e.matchesMap,n=e.fileToContents,r=e.type,i=e.onClose,o=e.jumpToPosition,a=Object.keys(t);return 0===a.length?(0,E.tZ)(eT.xv,{color:"dimmer",css:[F.l0.pl(8),F.l0.py(8)],multiline:!1,children:"REFERENCES"===r?"No references found":"No definitions found"}):(0,E.tZ)(M.G,{children:a.map(function(e){var r=t[e],l=n[e],c=(0,tY.Z)(r,l);return(0,E.tZ)(M.G,{css:[F.l0.p(4)],children:(0,E.tZ)(t$.V,{path:e,extensions:[c],doc:l,numMatches:r.length,initiallyExpanded:1===a.length,onNavigateToCode:function(t){if(null!==t)o({path:e,line:t.line+1,col:t.character});else{var n=(0,k._)(r,1)[0],a=l.lineAt(n.from),c=n.from-a.from;o({path:e,line:a.number,col:c})}i()}})},e)})})}function t2(e){var t=e.files,n=e.onClose,r=e.references,i=e.definitions,o=e.currentFile,a=e.currentFileContents,l=e.jumpToPosition,c=(0,eu.Z)().fs,s=(0,ev.Z)(o),u=(0,tJ.Z)(n,[]),d=(0,k._)(O.useState((0,eq._)({},o,ex.xv.of(a.split("\n")))),2),f=d[0],h=d[1];O.useEffect(function(){if(t.length){var e=!1;return!function(){n.apply(this,arguments)}(),function(){e=!0}}function n(){return(n=(0,eZ._)(function(){var n;return(0,ew.Jh)(this,function(r){switch(r.label){case 0:var i;return n={},[4,Promise.all(t.map((i=(0,eZ._)(function(e){var t;return(0,ew.Jh)(this,function(r){switch(r.label){case 0:return[4,c.readFile(e)];case 1:if((t=r.sent()).error)throw Error("Something went wrong reading file with path ".concat(e,". Received error: ").concat(t.error));return n[e]=ex.xv.of(t.content.toString().split("\n")),[2]}})}),function(e){return i.apply(this,arguments)})))];case 1:if(r.sent(),e)return[2];return h(function(e){return(0,C._)({},e,n)}),[2]}})})).apply(this,arguments)}},[c,t]);var p=(0,S._)(r).concat((0,S._)(i));if(!s||p.some(function(e){return!(s.documentUriToPath(e.uri) in f)}))return(0,E.tZ)(M.G,{style:{width:F.TV.space128,height:F.TV.space128,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,E.tZ)(t0.Z,{size:32})});var m={},v={};function g(e,t){if(!s)throw Error("Expected LSP Client");var n=s.documentUriToPath(e.uri),r=e.range,i=r.start,o=r.end;n in t||(t[n]=[]);var a=f[n],l=a.line(i.line+1),c=a.line(o.line+1);t[n].push({from:l.from+i.character,to:c.from+o.character})}return r.forEach(function(e){g(e,m)}),i.forEach(function(e){g(e,v)}),(0,E.BX)(M.G,{innerRef:u,css:[F.l0.minWidth("375px"),F.l0.maxWidth("500px"),F.l0.pt(4),F.l0.maxHeight("100%"),{overflowY:"scroll"}],children:[(0,E.tZ)(M.G,{css:{borderBottom:"1px solid var(--background-highest)"},children:(0,E.BX)(M.G,{css:[F.l0.p(4)],children:[(0,E.BX)(M.G,{css:[F.l0.flex.row,F.l0.justify.spaceBetween,F.l0.align.center,F.l0.pr(4)],children:[(0,E.tZ)(eT.h4,{level:2,variant:"subheadDefault",css:[F.l0.p(4),F.l0.pl(8)],children:"Definitions"}),(0,E.tZ)(tK.Z,{filled:!1,border:!1,onClick:n,children:(0,E.tZ)(tQ.Z,{})})]}),(0,E.tZ)(t1,{matchesMap:v,fileToContents:f,type:"DEFINITION",onClose:n,currentFile:o,jumpToPosition:l})]})}),(0,E.tZ)(M.G,{children:(0,E.BX)(M.G,{css:[F.l0.p(4)],children:[(0,E.tZ)(eT.h4,{level:2,variant:"subheadDefault",css:[F.l0.p(4),F.l0.pl(8)],children:"References"}),(0,E.tZ)(t1,{matchesMap:m,fileToContents:f,type:"REFERENCES",onClose:n,currentFile:o,jumpToPosition:l})]})})]})}(a=m||(m={})).DEFINITION="DEFINITION",a.REFERENCES="REFERENCES";var t8=n(23758),t4=n(82200),t3=n(59620),t5=n(22421),t6=n(72310),t9=n(1498),t7=n(15146),ne=n(32377),nt=n(29358),nn=n(64975),nr=(0,tS.X)({headerContainer:[F.l0.flex.row,F.l0.align.center,F.l0.pr(4)],bodyContainer:[F.l0.justify.center,F.l0.align.center,F.l0.p(8),F.l0.pt(4)],input:[F.l0.p(4),F.l0.borderRadius(4)],wrapper:[F.l0.flex.column,F.l0.justify.center,F.l0.borderRadius(4),F.l0.shadow(2),F.l0.width(200)]});function ni(e){var t=(0,tJ.Z)(e.onClose,[e.onClose]),n=(0,O.useRef)(null),r=(0,t6.Y)(e.currentValue,function(t){return t?t===e.currentValue?{message:"Must pick a new name"}:void 0:{message:"New name can't be empty"}});return(0,E.tZ)(nn.ZP,{children:(0,E.tZ)(M.G,{"data-testid":"RenameInput",innerRef:t,css:nr.wrapper,onKeyDown:function(t){"Escape"===t.key&&e.onClose(),t.stopPropagation()},children:(0,E.BX)("form",{onSubmit:function(t){t.preventDefault(),r.error||e.onRename(r.value)},children:[(0,E.BX)(M.G,{css:nr.headerContainer,children:[(0,E.tZ)(eT.h4,{level:2,variant:"subheadDefault",css:[F.l0.p(4),F.l0.pl(8)],children:"Rename"}),(0,E.tZ)(eT.h4,{level:2,variant:"subheadDefault",color:"dimmer",css:[F.l0.maxWidth(100),F.l0.overflow("hidden"),{whiteSpace:"nowrap",textOverflow:"ellipsis"}],children:e.currentValue}),(0,E.tZ)(t7.hU,{alt:"Close rename input",tooltipHidden:!0,onClick:e.onClose,css:[F.l0.position.absolute,F.l0.top(4),F.l0.right(4)],children:(0,E.tZ)(tQ.Z,{})})]}),(0,E.tZ)(M.G,{css:nr.bodyContainer,children:(0,E.tZ)(nt.ZP,{css:nr.input,name:"rename",ref:n,onBlur:r.handleBlur,onChange:function(e){r.setValue(e.target.value)},value:r.value,placeholder:"New name",autoFocus:!0,autoCorrect:"off",autoCapitalize:"off",autoComplete:"off",validationResults:r.error?[{message:r.error.message,state:"error"}]:void 0})}),(0,E.tZ)(M.G,{css:[F.l0.flex.rowReverse,F.l0.p(8),F.l0.pt(0)],children:(0,E.tZ)(t9.zx,{type:"submit",text:"Rename",colorway:"primary",iconLeft:(0,E.tZ)(ne.Z,{}),disabled:!!r.error||!r.value})})]})})})}var no=n(72526),na=ex.Py.define(),nl=ex.Py.define();function nc(e){var t,n;return null!==(n=null===(t=e.facet(tq.N))||void 0===t?void 0:t.isRenameSupported)&&void 0!==n&&n}var ns=function(e){if(!nc(e.state))return!1;var t=e.state.selection.main.head;return e.state.wordAt(t)?(e.dispatch({effects:na.of(t)}),!0):((0,t8.J)(e,{message:"You cannot rename this element",offset:t}),!1)},nu=ex.QQ.define({create:function(){return null},update:function(e,t){return(null!==e&&(e=t.changes.mapPos(e,-1,ex.gc.TrackDel)),(0,eE.j)(t,na,function(t){e=t.value}),e&&(e>t.state.doc.length||!t.state.wordAt(e)||!nc(t.state)))?null:e},provide:function(e){var t=new eA.Jf(ni),n=function(t){var n=t.field(e);if(null==n)throw Error("Expected non-null offset");var r=t.wordAt(n);if(!r)throw Error("Expected non-null range");return t.sliceDoc(r.from,r.to)},r=function(r){var i=r.state.field(e);if(null==i)throw Error("Expected non-null offset");if(!r.state.wordAt(i))throw Error("Expected non-null range");var o=t.create({currentValue:n(r.state),onClose:function(){r.dispatch({effects:na.of(null)}),r.focus()},onRename:function(e){r.dispatch({effects:nl.of(e)})}});return o.classList.add("replit-tooltip"),o.style.padding="0",{dom:o,update:function(e){t.update(o,function(t){var r=n(e.state);return r!==t.currentValue?(0,_._)((0,C._)({},t),{currentValue:r}):t})}}};return e_.hJ.from(e,function(e){return null===e?null:{pos:e,create:r}})}}),nd=n(32781),nf=n(50199),nh=new Map,np="undefined"==typeof WeakRef?function(e){return{deref:function(){return e}}}:WeakRef,nm=n(12834),nv=n(59173),ng=n(48900),ny=n(82723),nb=n(27308),nZ=n(10041),nw=n(80259);function nx(e){var t=[],n=[],r=!1,i=!0,o=!1,a=void 0;try{for(var l,c=e.selection.ranges[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.empty||(t.push(e.sliceDoc(s.from,s.to)),n.push(s))}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}if(!t.length){var u=-1,d=!0,f=!1,h=void 0;try{for(var p,m=e.selection.ranges[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value.from,g=e.doc.lineAt(v);g.number>u&&(t.push(g.text),n.push({from:g.from,to:Math.min(e.doc.length,g.to+1)})),u=g.number}}catch(e){f=!0,h=e}finally{try{d||null==m.return||m.return()}finally{if(f)throw h}}r=!0}return{text:t.join(e.lineBreak),ranges:n,linewise:r}}var nC=n(5344),n_=n(64595),nk=n(44620),nS=n(44680),nE=n(48282),nT=n(52924),nR=n(48728),nI=n(89446),nD=n(61314),nG=n.n(nD),nB=n(29559),nP=n(39756),nA=RegExp("_(?<num>\\d+)$");function nN(){return(nN=(0,eZ._)(function(e,t){var n,r,i,o;return(0,ew.Jh)(this,function(a){switch(a.label){case 0:return n=(0,nB.Il)(t),[4,e.readDir(n||nP.Ql)];case 1:if((r=a.sent()).error)return[2,t];return o=(i=function(e){if(r.children.find(function(t){return"FILE"===t.type&&t.filename===e})){var t,n=(0,nB.eb)(e),o=(0,nB.r6)(e),a=n.match(nA);if(null==a?void 0:null===(t=a.groups)||void 0===t?void 0:t.num){var l=Number(a.groups.num);return i("".concat(n.replace(nA,""),"_").concat(l+1,".").concat(o))}return i("".concat(n,"_2.").concat(o))}return e})((0,nB.UO)(t)),[2,n?n+"/"+o:o]}})})).apply(this,arguments)}var nU=n(41500),nL=(l=(0,eZ._)(function(e,t,n){var r,i,o,a,l,c;return(0,ew.Jh)(this,function(s){switch(s.label){case 0:return r=encodeURI(e.name),[4,function(e,t){return nN.apply(this,arguments)}(t,(i=(0,nB.Il)(n))?i+"/"+r:r)];case 1:return o=s.sent(),[4,(0,nI.pV)(e)];case 2:return a=s.sent(),[4,t.writeFile(o,nU.Z.from(a))];case 3:return s.sent(),l=(0,nB.eb)(e.name),c=(0,nB.UO)(o),[2,"![".concat(l,"](").concat(c,")")]}})}),function(e,t,n){return l.apply(this,arguments)});function nO(e){var t=e.cta,n=e.version;(0,tw.j)(tw.U3.EDITOR_EMPTY_STATE_CLICKED,{cta:t,version:n})}var nX=n(75023);function nM(e){var t=e.view,n=e.event,r=e.clipboardText,i=e.filePath,o=t.state.selection;if(!i||!(0,nB.gK)(i)||o.ranges.length>1||o.main.from===o.main.to||!r||!nG()(r)){!function(){if(!n){var e=r||"";if(o.main.empty){var i=o.main.from+e.length;t.dispatch({changes:[{from:o.main.from,insert:e}],selection:ex.jT.range(i,i)})}else t.dispatch(t.state.replaceSelection(e))}}();return}n&&n.preventDefault();var a=t.state.sliceDoc(o.main.from,o.main.to),l="[".concat(a,"](").concat(r,")"),c=o.main.from+l.length;t.dispatch({changes:{from:o.main.from,to:o.main.to,insert:l},selection:ex.jT.range(c,c)})}var nF=e_.tk.domEventHandlers({paste:function(e,t){var n;nM({filePath:t.state.facet(tU.Yp),view:t,event:e,clipboardText:null===(n=e.clipboardData)||void 0===n?void 0:n.getData("Text")})}}),nW=new nX.j(function(e,t){return e_.tk.domEventHandlers({paste:function(n,r){var i=r.state.facet(tU.Yp),o=null==n?void 0:null===(u=n.clipboardData)||void 0===u?void 0:u.files,a=function(e){var t=r.state.selection.main.head;r.dispatch({changes:{from:t,insert:e},selection:{anchor:t,head:t+e.length}})};if(o){var l=!0,c=!1,s=void 0;try{for(var u,d,f=o[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var h=d.value;e?(0,nI.L0)(h).then(function(e){return a('"'+e+'"')}):i&&(0,nB.gK)(i)&&nL(h,t,i).then(a)}}catch(e){c=!0,s=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw s}}}}})}),nH=n(8017),nV=n(38806),nz=n(87279),nj=n(74883),nq=n(51944),nY=n(83898),n$=n(14917),nJ=n(99952),nK=n(78786),nQ=n(2454);function n0(e,t,n){if(eI.Command.is(e)){t.request.executeCommand(e.command,e.arguments);return}var r=e.edit,i=e.command;if(r&&(0,no.w)({edit:r,fs:n,client:t}),i&&"java.apply.workspaceEdit"===i.command&&i.arguments){var o=!0,a=!1,l=void 0;try{for(var c,s=i.arguments[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;eI.WorkspaceEdit.is(u)&&(0,no.w)({edit:u,fs:n,client:t})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}}i&&t.request.executeCommand(i.command,i.arguments)}var n1=n(25934),n2=n(19408),n8=n(12880),n4=n(7444),n3=n(4832),n5=n(19724),n6=n(18440),n9=n(67774),n7=n(74652),re=n(50586),rt=n(50978),rn=n(22031);function rr(e){var t=e.selection,n=e.doc,r=t.ranges.map(function(e){return e.extend(n.lineAt(e.from).from,n.lineAt(e.to).to)});return ex.jT.create(r)}var ri=n(83215);function ro(e,t,n){var r=e.selection.main,i=e.sliceDoc(r.from,r.to),o=(0,nB.r6)(t);return{code:i,filePath:t,fileVersion:n,fileContent:e.doc.toString(),range:{indexFrom:r.from,indexTo:r.to,lineFrom:e.doc.lineAt(r.from).number,lineTo:e.doc.lineAt(r.to).number},language:o}}var ra=(0,tS.X)({ghostwriterIcon:[F.l0.color.blurpleStronger]});function rl(e){var t=e.label,n=e.icon,r=e.run,i=e.keyboardShortcut,o=e.dataCy;return{match:nw.pl,data:{type:"action",label:t,icon:n,run:r,keyboardShortcut:i,dataCy:o}}}function rc(e){var t=e.view,n=e.mainSelection,r=e.codeReference;t.dispatch({selection:{anchor:n.to},effects:[nq.Q.of({codeReference:r,type:"ghostwriterKillswitch"}),e_.tk.scrollIntoView(n.to,{y:"center"})]})}function rs(e){var t=e.path,n=(0,eu.Z)().fs,r=(0,n$.eD)(),i=(0,tH.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,O.useCallback)(function(e){r(t);var o=e.state,a=o.doc,l=o.selection,c=o.lineBreak,s=a.lineAt(l.main.head);s.length&&e.dispatch({changes:{from:s.to,insert:c},selection:ex.jT.cursor(s.to+1)});var u=n.getOTVersion(t),d=ro(e.state,t,u);if((0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"GENERATE"}),i){rc({view:e,mainSelection:e.state.selection.main,codeReference:d});return}var f=e.state.selection.main.to;e.dispatch({selection:{anchor:f},effects:[nq.Q.of({codeReference:d,type:"generateCode"}),e_.tk.scrollIntoView(f,{y:"center"})]})},[t,n,r,i])}function ru(e){var t=e.path,n=(0,eu.Z)().fs,r=(0,nJ.Ef)(),i=(0,tH.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,O.useCallback)(function(e){r(t),e.dispatch({selection:rr(e.state)});var o=n.getOTVersion(t),a=ro(e.state,t,o);if(i){rc({view:e,mainSelection:e.state.selection.main,codeReference:a});return}(0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"TRANSFORM"});var l=e.state.selection.main.to;e.dispatch({selection:{anchor:l},effects:[nq.Q.of({type:"transformCode",codeReference:a}),e_.tk.scrollIntoView(l,{y:"center"})]})},[t,n,r,i])}function rd(e){var t=e.fs,n=e.path,r=(0,nY.ql)(),i=(0,tH.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,O.useCallback)(function(e){e.dispatch({selection:rr(e.state)});var o=t.getOTVersion(n),a=ro(e.state,n,o);if((0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"EXPLAIN"}),i){rc({view:e,mainSelection:e.state.selection.main,codeReference:a});return}r({chatMessage:{type:"explainCode",codeReference:a}});var l=e.state.selection.main.to;e.dispatch({selection:{anchor:l},effects:[nq.Q.of({codeReference:a,type:"explainCode"}),e_.tk.scrollIntoView(l,{y:"center"})]})},[t,n,i,r])}var rf="Rename all occurrences",rh=new nX.j(function(e,t){return e?null:e_.tk.domEventHandlers({contextmenu:function(e,n){var r=e.clientX,i=e.clientY,o=n.state.selection.main,a=n.posAtCoords({x:r,y:i}),l=n.state.doc.length,c=null===a?l:a;if(c<o.from||c>o.to){var s=ex.jT.cursor(c);n.dispatch({selection:s})}return t(e),!0}})}),rp=ex.r$.define({combine:function(e){return e[0]}}),rm=new nX.j(function(e){return rp.of(e)}),rv=function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z,w,x=e.view,C=e.path,_=e.lspClient,T=e.visible,R=(0,eu.Z)().fs,I=(0,k._)((l=(a={path:C,lspClient:_,range:(n=(t=x.state).doc,i=(r=t.selection.main).from,o=r.to,{start:(0,ek.s)(n,i),end:(0,ek.s)(n,o)})}).path,c=a.range,s=a.lspClient,c=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify,r=n(e),i=null===(t=nh.get(r))||void 0===t?void 0:t.deref();return null!=i?i:(nh.set(r,new np(e)),e)}(c),u=(0,nm.Z)(),d=O.useRef(null),v=(m=(0,k._)((h=O.useCallback((f=(0,eZ._)(function(e,t){return(0,ew.Jh)(this,function(n){return s.isOpen(e)?(d.current={requestPath:e,requestRange:t},[2,s.request.codeActions(e,t)]):[2,{result:null}]})}),function(e,t){return f.apply(this,arguments)}),[s]),p=O.useRef(),[(0,nf.Z)(function(){return j()(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];h.apply(void 0,(0,S._)(t)).then(function(e){var t;null===(t=p.current)||void 0===t||t.call(p,e)})},1e3)},[h,1e3]),O.useCallback(function(e){p.current=e},[])]),2))[0],g=m[1],b=(y=(0,k._)(O.useState([]),2))[0],Z=y[1],w=O.useCallback((0,eZ._)(function(){return(0,ew.Jh)(this,function(e){return s&&l&&(g(function(e){u.current&&("error"in e||null===e.result||0===e.result.length?Z([]):Z(e.result))}),v(l,c)),[2]})}),[s,l,v,c,g,u]),O.useEffect(function(){return w(),function(){v.cancel()}},[w,v]),[b,w]),1)[0],D=(0,ec.Z)(T),G=O.useCallback(function(){T.current=!1,x.focus()},[x,T]);if(O.useEffect(function(){var e=function(e){"Escape"===e.key&&G()};if(D)return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[G,D]),!I.length)return null;var B=I.some(function(e){return"kind"in e&&"quickfix"===e.kind})?"#75bdff":"#ffcc00";return(0,E.tZ)("div",{role:"presentation",onMouseDown:function(e){D||(e.stopPropagation(),e.preventDefault(),function(e,t){var n=e.state.facet(rp);if(n){var r=e.coordsAtPos(e.state.selection.main.from);r&&n({x:r.left,y:r.top},t)}}(x,{match:nw.pl,data:{type:"context",label:"More actions",icon:(0,E.tZ)(nd.Z,{})},commands:function(){return I.map(function(e){var t,n,r,i,o,a;return n=(t={icon:(0,E.tZ)(nQ.Z,{}),label:e.title,run:function(){n0(e,_,R)}}).label,r=t.icon,i=t.run,o=t.keyboardShortcut,a=t.dataCy,{match:nw.pl,data:{type:"action",label:n,icon:r,run:i,keyboardShortcut:o,dataCy:a}}})}}),T.current=!D)},children:(0,E.tZ)(nd.Z,{css:{fill:B,color:B,cursor:"pointer"},className:"lightbulb"})})},rg=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r){var i;return(0,eJ._)(this,n),(i=t.call(this)).lspClient=e,i.path=r,i.visible=(0,nv.u)(!1),i.coords=(0,nv.u)(null),i.container=O.createRef(),i}var r=n.prototype;return r.toDOM=function(e){this.visible.current=!1;var t=(0,eA.VV)((0,E.tZ)("div",{children:(0,E.tZ)("span",{ref:this.container,children:(0,E.tZ)(rv,{lspClient:this.lspClient,path:this.path,view:e,visible:this.visible})})}));return t.setAttribute("aria-hidden","true"),t.className="cm-code-action",t},r.contains=function(e){var t;return(null===(t=this.container.current)||void 0===t?void 0:t.contains(e))||!1},r.updateDOM=function(){return!0},n}(e_.l9),ry=e_.tk.baseTheme({".cm-code-action":{position:"absolute",zIndex:101,top:"calc(50% - 8px)",left:"0",height:"16px",width:"16px",background:"transparent",fontFamily:F.TV.fontFamilyDefault,"& svg":{display:"block"}}}),rb=n(88626),rZ=n(7612),rw=n(7730),rx=n.n(rw),rC=n(25202),r_=ex.Py.define(),rk=ex.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,eE.j)(t,r_,function(e){n=e.value}),n}});function rS(){return(rS=(0,eZ._)(function(e,t,n){var r,i,o,a,l,c,s,u,d;return(0,ew.Jh)(this,function(f){switch(f.label){case 0:return[4,e.request.documentSymbol(t,{signal:n})];case 1:if(!(r=f.sent())||r.cancelled||!(i="result"in r&&!r.cancelled?r.result:null))return[2,null];o=[],a=!0,l=!1,c=void 0;try{for(s=i[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)(d=u.value)&&"range"in d&&o.push(d)}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}return[2,o.length?o:null]}})})).apply(this,arguments)}function rE(e){if("Debounced function cancelled"!==e.message)throw e}var rT=ex.QQ.define({create:function(){return[]},update:function(e,t){if(!(0,rZ.a)(t,rk,"selection"))return e;var n=t.state.field(rk);return n?function e(t,n,r){var i=r.find(function(e){var r=e.range;return(0,ek.R)(t,r.end)>=n&&(0,ek.R)(t,r.start)<=n});return null==i?[]:i.children?[i].concat(e(t,n,i.children)):[i]}(t.state.doc,t.state.selection.main.head,n):[]},compare:rx()}),rR=new nX.j(function(e,t,n,r,i,o){if(!t||!r)return[];var a,l,c,s,u,d,f,h=[(s=(c={lspClient:t,path:n}).lspClient,u=c.path,e_.lg.define(function(e){var t,n,r,i,o,a,l,c;return n=(t={lspClient:s,path:u,view:e}).lspClient,r=t.path,i=t.view,o=eH().v4(),a=function(){var e;return(null!==(e=ez.get(r))&&void 0!==e?e:[])[0]===o},c=null!==(l=ez.get(r))&&void 0!==l?l:[],ez.set(r,(0,S._)(c).concat([o])),n.notify.didOpen(r,i.state.doc.toString()),{id:o,destroy:function(){var e,t=(null!==(e=ez.get(r))&&void 0!==e?e:[]).filter(function(e){return e!==o});n.getServerState()===eV.a.INITIALIZED&&n.isOpen(r)&&n.notify.didClose(r),0===t.length?ez.delete(r):ez.set(r,t)},update:function(e){if(a()&&e.docChanged){var t,i=null===(t=n.getServerCapabilities())||void 0===t?void 0:t.textDocumentSync;if(i!==eF.TextDocumentSyncKind.None&&n.isOpen(r)){if(i===eF.TextDocumentSyncKind.Full){var o,l,c,s,u=e.view.state.doc.toString();n.notify.didChange(r,[{text:u}]);return}n.notify.didChange(r,(o=e.changes,l=e.startState.doc,c=[],s=l,o.iterChanges(function(e,t,n,r,i){var o=i.sliceString(0),a=t-e,l=a+n;c.push({range:{start:(0,ek.s)(s,n),end:(0,ek.s)(s,l)},rangeLength:a,text:o}),s=s.replace(n,l,i)}),c))}}}}})),(0,ej.Fq)({lspClient:t,path:n,askGhostwriter:o}),eg(t).isTextDocumentSyncSupported?e_.lg.fromClass(function(){"use strict";function n(e){(0,eJ._)(this,n),this.dispose=this.listen(e.state.facet(tU.Yp))}var r=n.prototype;return r.update=function(e){(0,rZ.a)(e,tU.Yp)&&(this.dispose=this.listen(e.state.facet(tU.Yp)))},r.destroy=function(){this.dispose&&this.dispose()},r.listen=function(n){if(this.dispose&&this.dispose(),n)return e.watchTextFile(n,{onFlush:function(){t.isOpen(n)&&t.notify.didSave(n)}})},n}()):[]],p=t&&eg(t).isDocumentSymbolSupported?[rk,rT,e_.lg.fromClass(function(){"use strict";function e(n){(0,eJ._)(this,e),this.abortController=null;var r=this;this.getSymbolMap=(0,rC.Z)((0,eZ._)(function(){var e,i;return(0,ew.Jh)(this,function(o){switch(o.label){case 0:if(!(e=n.state.facet(tU.Yp)))return[2];return r.abortController=new AbortController,[4,function(e,t,n){return rS.apply(this,arguments)}(t,e,r.abortController.signal)];case 1:return i=o.sent(),n.dispatch({effects:r_.of(i)}),[2]}})}),{wait:200}),this.getSymbolMap().catch(rE)}var n=e.prototype;return n.update=function(e){var t;e.docChanged&&(null===(t=this.abortController)||void 0===t||t.abort(),this.getSymbolMap().catch(rE))},n.destroy=function(){var e;null===(e=this.abortController)||void 0===e||e.abort(),this.getSymbolMap.isScheduled()&&this.getSymbolMap.cancel()},e}())]:null;return p&&h.push(p),(0,rb.isMobile)()||h.push(eg(t).isAutoCompleteSupported?new tN.R(function(e){return function(e){var t=e.lspClient,n=e.view,r=n.state.facet(tU.Yp),i=.01>Math.random(),o=0,a=function(e,n){if(i&&r){var o=t.getLanguageId(r);return tC.kg.info("lsp:autocomplete:".concat(e),(0,C._)({languageId:o},n)),(0,tw.j)(tw.U3.LSP_COMPLETION_USED,(0,C._)({type:e,sampleRate:.01},n))}};function l(){return(l=(0,eZ._)(function(e){var i,l,c,s,u;return(0,ew.Jh)(this,function(d){switch(d.label){case 0:if(!(l=t.getServerCapabilities())||!(c=function(e,t){var n=e.state,r=e.pos;if(e.explicit)return{triggerKind:eF.CompletionTriggerKind.Invoked};var i=n.doc.lineAt(r),o=i.text[r-i.from-1],a=i.text.substring(0,r-i.from);return(null==t?void 0:t.includes(o))?{triggerKind:eF.CompletionTriggerKind.TriggerCharacter,triggerCharacter:o}:a.match(/\w$/)?{triggerKind:eF.CompletionTriggerKind.Invoked}:null}(e,(null==l?void 0:null===(i=l.completionProvider)||void 0===i?void 0:i.triggerCharacters)||[])))return[2,null];if(o&&t.notify.cancelRequest(o),!r)throw Error("path not found");return o=t.generateId(),n.dispatch({effects:[tB.of(null)]}),[4,t.request.completion(r,(0,ek.s)(e.state.doc,e.pos),c,{id:o})];case 1:if("error"in(s=d.sent())||(u=s.result,e.aborted||!u))return[2,null];return[2,function(e){for(var t=e.context,n=e.items,r=e.client,i=e.path,o=e.trackCompletion,a=0,l=null!==(B=(0,tx.Z)(t.state))&&void 0!==B?B:"unknown",c=(T=n.filter(function(e){return!!e.label}),R=["label","kind"],I=new Set,T.filter(function(e){var t=R.map(function(t){return e[t]}).join("");return!I.has(t)&&(I.add(t),!0)})).map(function(e){var t=e.additionalTextEdits,n={label:e.label,detail:e.detail,apply:function(n,r,a,c){if(e.insertTextFormat===eI.InsertTextFormat.Snippet){var s=[];t&&s.push({changes:t.map(function(e){return tM(n,e)})});var u=new tc(null!==(h=null!==(f=null===(d=e.textEdit)||void 0===d?void 0:d.newText)&&void 0!==f?f:e.insertText)&&void 0!==h?h:e.label);if(e.textEdit&&("range"in e.textEdit)){var d,f,h,p,m=c;a=(p=tX(n.state,e.textEdit.range)).from,c=Math.max(c=p.to,m)}var v=u.apply({view:n,from:a,to:c,path:i,completion:r});n.dispatch.apply(n,(0,S._)(s).concat([v])),o("completion-accepted",{language:l,completionKind:e.kind,insertTextFormat:e.insertTextFormat});return}var g=function(e){var t,n=e.view,r=e.item,i=e.from,o=e.to,a=n.state,l=a.doc,c=a.selection,s=[];if(r.textEdit){if(!("range"in r.textEdit))return;var u=tM(n,r.textEdit);if(!u)return;u.to=Math.max(u.to,c.main.to),s.push(u)}else{var d=r.insertText||r.label,f=n.state.wordAt(o);f&&f.to>o&&d.includes(n.state.doc.sliceString(o,f.to))&&(o=f.to),s.push({from:i,to:o,insert:d})}var h=(0,k._)(s,1)[0],p="";null===(t=r.additionalTextEdits)||void 0===t||t.forEach(function(e){var t=tM(n,e);t&&(("from"in h)&&t.from===h.from&&(p=t.insert),s.push(t))});var m=o-i;c.ranges.forEach(function(e){if(e!==c.main){if(!("insert"in h)||!h.insert)throw Error("Expected insert in mainChange");var t=e.from-m,n=p+h.insert;s.push({from:t,to:e.to,insert:n})}});var v=s.map(function(e){return("from"in e)&&void 0!==e.to?(0,_._)((0,C._)({},e),{from:Math.min(e.from,e.to),to:Math.max(e.from,e.to)}):e}),g=ex.as.of(v,l.length),y=c.ranges.map(function(e){return e.map(g,0)});return{changes:g,selection:ex.jT.create(y,c.mainIndex)}}({view:n,item:(0,_._)((0,C._)({},e),{additionalTextEdits:t}),to:c,from:a});g&&(o("completion-accepted",{language:l,completionKind:e.kind,insertTextFormat:e.insertTextFormat}),n.dispatch({changes:g.changes,selection:g.selection,annotations:eC.Jv.of(r)}))},type:e.kind&&tO[e.kind],filterText:(e.filterText||e.label).toLowerCase(),sortText:(e.sortText||e.label).toLowerCase()},c=eg(r).isCompletionItemResolveSupported;return r&&c?n.info=(0,eZ._)(function(){var n,c,s,u,d;return(0,ew.Jh)(this,function(f){switch(f.label){case 0:return[4,r.request.resolveCompletionItem(e)];case 1:if(c=("cancelled"in(n=f.sent()))&&n.cancelled,s=("result"in n)?n.result:null,c||!s||(s.additionalTextEdits&&(t=s.additionalTextEdits),a++,u=[],s.detail&&s.detail!==e.detail&&s.detail!==e.label&&(d=["```"+(0,e$.extname)(i).slice(1),s.detail,"```"].join("\n"),u.push((0,E.tZ)(eP,{className:"lsp-completion-detail",content:{value:d,kind:"markdown"}},"".concat(a,"-detail")))),s.documentation&&u.push((0,E.tZ)(eP,{content:s.documentation},"".concat(a,"-documentation"))),0===u.length))return[2,null];return o("resolution-presented",{language:l,resolutionSource:"request",completionKind:e.kind}),[2,(0,eA.VV)((0,E.tZ)("div",{children:u}))]}})}):e.documentation&&(n.info=function(){return e.documentation?(o("resolution-presented",{language:l,resolutionSource:"documentation",completionKind:e.kind}),(0,eA.VV)((0,E.tZ)("div",{children:(0,E.tZ)(eP,{content:e.documentation})}))):null}),n}),s=((c=c.sort(function(e,t){return e.sortText<t.sortText?-1:e.sortText>t.sortText?1:0})).length%2?c.length-1:c.length)/2,u=0;u<=s;u++){if(0===u&&c[s]){c[s].boost=0;continue}var d=c[s-u];if(d){var f=c[s-u+1],h=f.sortText,p=f.boost,m=void 0===p?0:p;d.boost=d.sortText===h?m:m+1}var v=c[s+u];if(v){var g=c[s+u-1],y=g.sortText,b=g.boost,Z=void 0===b?0:b;v.boost=v.sortText===y?Z:Z-1}}var w=null!==(P=null===(D=c[0])||void 0===D?void 0:D.boost)&&void 0!==P?P:0,x=null!==(A=null===(G=c[c.length-1])||void 0===G?void 0:G.boost)&&void 0!==A?A:0;if(w>99||x<-99)for(var T,R,I,D,G,B,P,A,N,U=99/Math.max(Math.abs(w),Math.abs(x)),L=0;L<c.length;L++)c[L].boost=(null!==(N=c[L].boost)&&void 0!==N?N:0)*U;var O=(0,k._)(function(e){var t=Object.create(null),n=Object.create(null),r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value.filterText;t[c[0]]=!0;for(var s=1;s<c.length;s++)n[c[s]]=!0}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}var u=tL(t)+tL(n)+"*$";return[RegExp("^"+u),new RegExp(u)]}(c),2),X=O[0],M=O[1],F=t.matchBefore(M),W=t.pos;return F&&(W=F.from),c.length&&o("completion-options-presented",{language:l}),{from:W,options:c,validFor:X}}({context:e,items:Array.isArray(u)?u:u.items,client:t,path:r,trackCompletion:a})]}})})).apply(this,arguments)}return[tR,tG,tP,(0,eC.ys)({defaultKeymap:!1,closeOnBlur:!1,tooltipClass:function(e){return(0,tZ.Z)(e)?tT:""},addToOptions:[{render:function(e,t){if(!(0,tZ.Z)(t))return null;var n=document.createElement("div");return n.className="lsp-completion-keyboard-shortcuts",(0,eY.createRoot)(n).render((0,E.tZ)(t_.C,{children:(0,E.tZ)(tb.ZP,{size:"inherit",shortcut:{key:""}})})),n},position:200}],override:[(0,eC.eC)(["LineComment","BlockComment"],function(e){return l.apply(this,arguments)})]}),tF]}({lspClient:t,view:e})}):[],function(e){var t=e.lspClient,n=e.path;if(!eg(t).isSignatureHelpSupported)return[];var r={current:null};function i(){return(i=(0,eZ._)(function(e,i){var a,l,c,s,u,d,f;return(0,ew.Jh)(this,function(h){switch(h.label){case 0:if(s=(null===(l=t.getServerCapabilities())||void 0===l?void 0:null===(a=l.signatureHelpProvider)||void 0===a?void 0:a.triggerCharacters)||[],u=e.field(o,!1),d=e.field(eL,!1),!u&&(null==d||!s.includes(d)))return[2,null];return[4,function(e,t,n,r,i){return eM.apply(this,arguments)}(e,i,t,n,r)];case 1:if(!(null==(f=h.sent())?void 0:null===(c=f.signatures)||void 0===c?void 0:c.length))return[2,null];return[2,f]}})})).apply(this,arguments)}var o=ex.QQ.define({create:function(){return null},update:function(e,t){return t.isUserEvent("select.pointer")?null:(e&&t.newSelection.main.from!==e.pos&&(e=(0,_._)((0,C._)({},e),{pos:t.newSelection.main.from})),(0,eE.j)(t,eN.effect,function(n){var r=n.value;e=r?{pos:t.newSelection.main.from,help:r,index:0}:null}),(0,eE.j)(t,eU,function(t){var n=t.value;if(e){var r=e.help.signatures.length,i=(r+e.index+n)%r;e=i>=e.help.signatures.length||i<0?null:(0,_._)((0,C._)({},e),{index:i})}}),e)},provide:function(e){var t=function(t){var n=t.state.field(e);if(!n)throw Error("expected nonnull field");var r=eO.create({help:n.help,index:n.index});return{dom:r,update:function(t){eO.update(r,function(r){var i=t.state.field(e);return i&&i!==n?{help:i.help,index:i.index}:r})}}};return e_.hJ.compute([e],function(n){var r=n.field(e);return r?{pos:r.pos,create:t,above:!0}:null})}}),a=e_.lg.define(function(){var e,t=j()((e=(0,eZ._)(function(e){var t,n,r;return(0,ew.Jh)(this,function(o){switch(o.label){case 0:if(!(t=e.state.selection.main).empty)return[3,2];return n=e.state.field(eN.state,!1),[4,function(e,t){return i.apply(this,arguments)}(e.state,t.from)];case 1:(r=o.sent())&&!n&&(0,eC._B)(e),e.dispatch({effects:eN.effect.of(r)}),o.label=2;case 2:return[2]}})}),function(t){return e.apply(this,arguments)}),0);return{update:function(e){e.transactions.some(function(e){return e.selection})&&e.state.selection.main.empty&&t(e.view)}}});function l(e,t){var n=e.state.field(eN.state,!1);return"active"!==(0,eC.LR)(e.state)&&null!=n&&("navigate"!==t||n.signatures.length>1)}var c=function(e){return function(t){return!!l(t,"navigate")&&(t.dispatch({effects:eU.of(e)}),!0)}},s=[{key:"ArrowDown",run:c(1)},{key:"ArrowUp",run:c(-1)},{key:"Escape",run:function(e){return!!l(e,"dismiss")&&(e.dispatch({effects:eN.effect.of(null)}),!0)}}];return[o,eN.state,eL,a,ex.Wl.high(e_.$f.of(s))]}({lspClient:t,path:n}),(d=null,[(0,e_.bF)((f=(0,eZ._)(function(e,n){var r,i,o,a,l,c;return(0,ew.Jh)(this,function(s){switch(s.label){case 0:var u,f;if(!(null!==(f=null===(u=e.state.facet(tq.N))||void 0===u?void 0:u.isHoverSupported)&&void 0!==f&&f)||!(r=e.state.facet(tU.Yp)))return[2,null];i=(0,ek.s)(e.state.doc,n);try{o=e.state.wordAt(n)}catch(e){return[2,null]}if(d){if(d.from===(null==o?void 0:o.from)&&d.to===(null==o?void 0:o.to))return[2,null];t.notify.cancelRequest(d.id)}return d={id:a=t.generateId(),from:null==o?void 0:o.from,to:null==o?void 0:o.to},[4,t.request.hover(r,i,{id:a})];case 1:if(l=s.sent(),d=null,"error"in l||null===(c=l.result))return[2,null];return[2,function(e){var t,n,r=e.hover,i=e.state,o=e.offset;if((Array.isArray(r.contents)||"string"==typeof r.contents)&&0===r.contents.length)return null;var a="",l=i.doc;if(r.range)t=(0,ek.R)(l,r.range.start),n=(0,ek.R)(l,r.range.end),a=l.sliceString(t,n);else if(n=void 0,(t=o)<=i.doc.length){var c=i.wordAt(t);c?(a=l.sliceString(c.from,c.to),t=Math.min(t,c.from),n=c.to):a=l.sliceString(t,t+1)}return{pos:t,end:n,create:function(e){var t=(0,eA.VV)((0,E.tZ)(tj,{content:r.contents,textHovered:a})),n=function(){e.dispatch({effects:e_.E8})};return t.classList.add("hover-tooltip"),t.style.padding="0",t.addEventListener("mouseleave",n),{dom:t,mount:function(){!function(e,t){t.forEach(function(t){return setTimeout(e,t)})}(function(){(0,e_.E2)(e)},[0,50,200,1e3])},destroy:function(){t.removeEventListener("mouseleave",n)}}},above:!0}}({hover:c,offset:n,state:e.state})]}})}),function(e,t){return f.apply(this,arguments)}),{hideOn:function(e){return!e.annotation(ex.YW.remote)&&!!(e.isUserEvent("input")||e.isUserEvent("delete")||e.isUserEvent("select"))},hoverTime:0}),e_.tk.domEventObservers({mousedown:function(e,t){!(e.target instanceof HTMLElement&&e.target.matches(".cm-tooltip *"))&&(0,e_.Dm)(t.state)&&t.dispatch({effects:e_.E8})},scroll:function(e,t){(0,e_.Dm)(t.state)&&t.dispatch({effects:e_.E8})}})]),(a=t,l=n,eg(a).isCodeActionsSupported?[ry,e_.lg.fromClass(function(){"use strict";function e(t){(0,eJ._)(this,e),this.widget=new rg(a,l),this.decoration=e_.p.widget({widget:this.widget,side:0}),this.updateDecorations(t)}var t=e.prototype;return t.update=function(e){(e.docChanged||e.selectionSet)&&this.updateDecorations(e.view)},t.updateDecorations=function(e){var t,n,r=e.state,i=r.doc,o=r.selection,a=i.lineAt(o.main.from);if(!this.widget.visible.current&&0===i.length){this.decorations=e_.p.none;return}t=a.text,n=/^( {2}|\u3000|\t)/.test(t)||1===a.number&&1===i.lines?a.from:1===a.number?Math.min(i.length,a.to+1):i.lineAt(a.from-1).from,this.decorations=e_.p.set([this.decoration.range(n)])},e}(),{decorations:function(e){return e.decorations}})]:[]),(0,rn.jd)({lspClient:t,openFile:i}),function(e){var t,n=e.lspClient,r=e.path,i=e.openFile;if(!i)return[];var o=eg(n);if(!o.isFindDefinitionSupported&&!o.isFindReferencesSupported)return[];var a=ex.Py.define(),l=ex.Py.define();return[e_.tk.updateListener.of((t=(0,eZ._)(function(e){var t,i,c,s,u,d,f,h,p,m,v,g,y,b,Z,w,x,C,_,E,T,R,I,D,G,B,P,A,N,U,L;return(0,ew.Jh)(this,function(O){switch(O.label){case 0:t=null,i=!0,c=!1,s=void 0;try{for(u=e.transactions[Symbol.iterator]();!(i=(d=u.next()).done);i=!0){f=d.value,h=!0,p=!1,m=void 0;try{for(v=f.effects[Symbol.iterator]();!(h=(g=v.next()).done);h=!0)(y=g.value).is(t5.h)&&(t=y.value)}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}}}catch(e){c=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(c)throw s}}if(!t)return[2];return o=eg(n),b=e.state.doc,Z=(0,ek.s)(b,t),w=Promise.all([o.isFindReferencesSupported?n.request.findReferences(r,Z,{includeDeclaration:!1}):{result:null},o.isFindDefinitionSupported?n.request.findDefinitions(r,Z):{result:null}]),(0,t4.SC)(e.view,w),[4,w];case 1:if(C=(x=k._.apply(void 0,[O.sent(),2]))[0],_=x[1],"error"in C)throw Error("Something went wrong fetching references: ".concat(C.error.message));if("error"in _)throw Error("Something went wrong fetching definition: ".concat(_.error.message));if(E=C.result,T=_.result,R=(0,t3.g)(T),I=E&&E.length>0,D=R&&R.length>0,!I&&!D)return(0,t8.J)(e.view,{message:"No references found",offset:t}),e.view.dispatch({effects:l.of(null)}),[2];return G=[],B=[],E&&E.length>0&&(P=G).push.apply(P,(0,S._)(E)),R&&R.length>0&&(A=B).push.apply(A,(0,S._)(R)),N=(0,S._)(G).concat((0,S._)(B)).map(function(e){return n.documentUriToPath(e.uri)}).filter(function(e){return e!==r}),U=(0,S._)(new Set(N)),L=b.toJSON().join("\n"),e.view.dispatch({effects:a.of({references:G,definitions:B,currentFile:r,currentFileContents:L,files:U})}),[2]}})}),function(e){return t.apply(this,arguments)})),ex.QQ.define({create:function(){return null},update:function(e,t){var n=e,r=!0,i=!1,o=void 0;try{for(var c,s=t.effects[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value;u.is(a)&&(n=u.value),u.is(l)&&(n=null)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n},provide:function(e){return e_.hJ.compute([e],function(t){var n=t.field(e);if(!n)return null;var o=t.selection.asSingle().main;return{pos:o.from,end:o.to,create:function(e){var t=(0,eA.VV)((0,E.tZ)("div",{children:(0,E.tZ)(t2,(0,_._)((0,C._)({},n),{onClose:function(){e.dispatch({effects:l.of(null)})},jumpToPosition:function(t){if(i){if(t.path!==r){i(t);return}var n=t.line,o=t.col;(0,em.S)({view:e,line:n,col:o}),e.focus()}}}))}));return t.classList.add("cm-lsp-tooltip"),t.classList.add("replit-tooltip"),t.style.padding="0",{dom:t}}}})}})]}({lspClient:t,path:n,openFile:i}),[nu,e_.lg.define(function(n){var r=null;return{onRename:function(i){return(0,eZ._)(function(){var o,a,l,c;return(0,ew.Jh)(this,function(s){switch(s.label){case 0:if(!nc(n.state))return[2,this.cancelInflightRequest()];if(this.cancelInflightRequest(),!(o=n.state.facet(tU.Yp)))throw Error("Expected non-null file path");if(!(a=n.state.field(nu)))return[2];return r=t.generateId(),[4,t.request.rename(o,(0,ek.s)(n.state.doc,a),i,{id:r,tap:function(e){return(0,t4.SC)(n,e)}})];case 1:if((l=s.sent()).cancelled)return[2];if("error"in l)throw Error("Something went wrong renaming ".concat(l.error.message));if(!(c=l.result))return[2];return(0,no.w)({edit:c,fs:e,client:t}),n.dispatch({effects:na.of(null)}),[2]}})}).apply(this)},cancelInflightRequest:function(){r&&(t.notify.cancelRequest(r),r=null)},update:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=!0,c=!1,s=void 0;try{for(var u,d=a.effects[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;f.is(nl)&&this.onRename(f.value)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},destroy:function(){this.cancelInflightRequest()}}})]),h}),rI=n(17542),rD="cm-multiplayer-selection-green",rG="cm-multiplayer-selection-red",rB="cm-multiplayer-selection-blue",rP="cm-multiplayer-selection-gold",rA="cm-multiplayer-selection-purple",rN="cm-multiplayer-selection-teal",rU="cm-multiplayer-selection-pink",rL=e_.tk.theme((v={},(0,eq._)(v,".".concat(rD),{background:"rgba(27, 196, 125, 0.2)"}),(0,eq._)(v,".".concat(rG),{background:"rgba(239, 85, 51, 0.2)"}),(0,eq._)(v,".".concat(rB),{background:"rgba(24, 160, 251, 0.2)"}),(0,eq._)(v,".".concat(rP),{background:"rgba(255, 199, 0, 1)"}),(0,eq._)(v,".".concat(rA),{background:"rgba(144, 124, 255, 0.2)"}),(0,eq._)(v,".".concat(rN),{background:"rgba(0, 181, 206, 0.2)"}),(0,eq._)(v,".".concat(rU),{background:"rgba(238, 70, 211, 0.2)"}),v)),rO={"#1BC47D":rD,"#EF5533":rG,"#18A0FB":rB,"#FFC700":rP,"#907CFF":rA,"#00B5CE":rN,"#EE46D3":rU},rX=ex.Py.define(),rM=ex.Py.define(),rF=ex.Py.define(),rW=ex.QQ.define({create:function(){return{}},update:function(e,t){if(!t.changes.empty){var n=function(e){return t.changes.mapPos(Math.min(t.changes.length,e))},r={},i=!0,o=!1,a=void 0;try{for(var l,c=Object.values(e)[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;r[s.id]=(0,_._)((0,C._)({},s),{position:n(s.position),selectionStart:n(s.selectionStart),selectionEnd:n(s.selectionEnd)})}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}e=r}var u=!0,d=!1,f=void 0;try{for(var h,p=t.effects[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value;if(m.is(rI.R)&&(e=(0,C._)({},e)),m.is(rX)&&m.value.position<=t.newDoc.length&&((e=(0,C._)({},e))[m.value.id]=(0,C._)({},m.value)),m.is(rM)&&(e=(0,C._)({},e),m.is(rM)&&delete e[m.value]),m.is(rF)){e=(0,C._)({},e);var v=!0,g=!1,y=void 0;try{for(var b,Z=Object.entries(e)[Symbol.iterator]();!(v=(b=Z.next()).done);v=!0){var w=(0,k._)(b.value,2),x=w[0];w[1].username===m.value&&delete e[x]}}catch(e){g=!0,y=e}finally{try{v||null==Z.return||Z.return()}finally{if(g)throw y}}}}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}return e},provide:function(e){return[rL,ex.Wl.high((0,e_.EY)({above:!1,class:"cm-multiplayer-cursor-layer",update:function(t){return(0,rZ.a)(t,e)},markers:function(t){var n=t.state.field(e,!1);if(!n)return[];var r=[],i=!0,o=!1,a=void 0;try{for(var l,c=Object.values(n)[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value,u=s.selectionStart,d=s.selectionEnd,f=s.color.selection;if(u!==d){var h=ex.jT.range(u,d);r.push.apply(r,(0,S._)(e_.dc.forRange(t,f,h)))}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r}}))]}}),rH=e_.tk.theme({".multiplayer-cursor":{width:"2px",left:"0",top:"0"},".multiplayer-cursor .multiplayer-label":{boxShadow:F.TV.shadow1,borderRadius:F.TV.borderRadius4,padding:"1px",position:"absolute",left:"0px",animation:"fadeOut 2s ease-in forwards",color:"white",display:"inline-block",whiteSpace:"nowrap"},".multiplayer-cursor:hover .multiplayer-label":{animation:"auto"}});function rV(e){e.style.transform="translate(-10000px, -10000px)"}function rz(e){var t=document.createElement("div");t.textContent=e.username,t.style.backgroundColor=e.color.cursor,t.classList.add("multiplayer-label");var n=document.createElement("div");return n.classList.add("multiplayer-cursor"),n.style.backgroundColor=e.color.cursor,n.style.position=q.gn?"absolute":"fixed",n.appendChild(t),{dom:n,label:t}}var rj=new Map,rq=[rH,e_.lg.define(function(e){var t=e.state.field(rW,!1),n=new Map((t?Object.values(t):[]).map(function(e){return[e.id,{view:rz(e),cursor:e}]})),r=!0,i=0,o="function"==typeof IntersectionObserver?new IntersectionObserver(function(e){Date.now()>i-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&s()},{threshold:[1]}):null;function a(){o&&(o.disconnect(),n.forEach(function(e){o.observe(e.view.dom)}))}function l(){t&&0!==Object.values(t).length&&(e.inView&&e.requestMeasure(u),r!==e.inView)&&!(r=e.inView)&&n.forEach(function(e){rV(e.view.dom)})}a();var c=null;function s(){null===c&&(c=setTimeout(function(){c=null,l()},50))}window.addEventListener("resize",s);var u={read:function(){return{editorRect:e.scrollDOM.getBoundingClientRect(),dimensions:new Map((t?Object.values(t):[]).map(function(t){var r=n.get(t.id),i=r?function(e,t){var n=rj.get(e);if(n)return n;var r=t.getBoundingClientRect().width;return rj.set(e,r),r}(t.username,r.view.label):null;return[t.id,{position:e.coordsAtPos(t.position),labelWidth:i}]}))}},write:function(e){n.forEach(function(t,n){var r=e.dimensions.get(n);!function(e){var t=e.cursorView,n=e.position,r=e.labelWidth,i=e.editorRect,o=t.dom,a=t.label;if(!n||!r){rV(o);return}var l=n.bottom-n.top;if(n.bottom<=i.top+l||n.top+l>=i.bottom||n.right<i.left-.1||n.left>i.right+.1){rV(o);return}var c=n.left+r-i.right,s="0px";c>0?(s="-".concat(c,"px"),a.style.borderBottomLeftRadius="4px"):a.style.borderBottomLeftRadius="0px",a.style.pointerEvents="none",a.style.transform="translate(".concat(s,", -100%)");var u=q.gn?{x:n.left-i.left+"px",y:n.top-i.top+"px"}:{x:"calc(".concat(n.left,"px + var(--fixed-position-offset-x))"),y:"calc(".concat(n.top,"px + var(--fixed-position-offset-y))")},d=u.x,f=u.y;o.style.transform="translate(".concat(d,", ").concat(f,")"),o.style.height=l+"px"}({cursorView:t.view,position:(null==r?void 0:r.position)||null,labelWidth:(null==r?void 0:r.labelWidth)||null,editorRect:e.editorRect})})},key:Math.random().toString()};return{update:function(r){r.transactions.length&&(i=Date.now());var o=r.state.field(rW,!1);if(!(o!==r.startState.field(rW,!1))){r.geometryChanged&&l();return}var c=new Map,s=new Set;if(o){var u=new Map((0,S._)(n.values()).map(function(e){return[e.cursor.id,e.view]}));Object.values(o).forEach(function(t){var n=u.get(t.id);if(n)s.add(n),c.set(t.id,{view:n,cursor:t});else{var r=rz(t);c.set(t.id,{view:r,cursor:t}),e.dom.appendChild(r.dom)}})}n.forEach(function(e){s.has(e.view)||e.view.dom.remove()}),n=c,t=o,a(),l()},destroy:function(){window.removeEventListener("resize",s),n.forEach(function(e){e.view.dom.remove()}),t=void 0,n=new Map,null==o||o.disconnect(),c&&clearTimeout(c)},maybeMeasure:l}},{eventHandlers:{scroll:function(){this.maybeMeasure()}}})],rY=function(){"use strict";function e(t,n,r,i){var o=this;(0,eJ._)(this,e),this.view=t,this.destroyed=!1,this.colors=this.getColorMapFromUsers(i.getActiveUsers()),this.disposes=[],this.updateSelections=null,this.disposes.push(i.onUserLeave(function(e){o.destroyed||o.view.dispatch({effects:rF.of(e.username)})}),i.onActiveUsersChange(function(e){o.destroyed||(o.colors=o.getColorMapFromUsers(e))}),r.watchTextFile(n,{onReady:function(e){var t=e.updateSelections;o.destroyed||(o.updateSelections=t)},onCursor:function(e){if(!o.destroyed){var t=function(e){var t,n=e.cursor,r=e.usernameColorsMap,i=null===(t=n.user)||void 0===t?void 0:t.name;if(i){var o=n.id,a=n.position,l=n.selectionStart,c=n.selectionEnd,s=r[i];if(s&&o&&"number"==typeof a&&"number"==typeof l&&"number"==typeof c)return rX.of({id:o,username:i,position:a,color:{cursor:s,selection:rO[s]||""},selectionStart:l,selectionEnd:c})}}({cursor:e,usernameColorsMap:o.colors});t&&o.view.dispatch({effects:t})}},onRemoveCursor:function(e){o.destroyed||o.view.dispatch({effects:rM.of(e)})},onError:function(){o.updateSelections=null},onMoveOrDelete:function(){o.updateSelections=null}}))}var t=e.prototype;return t.getColorMapFromUsers=function(e){return e.reduce(function(e,t){return t.username&&t.color?(0,_._)((0,C._)({},e),(0,eq._)({},t.username,t.color)):e},{})},t.postUpdate=function(e){if(!(!e.selectionSet||e.transactions.every(function(e){return e.annotation(ex.YW.remote)}))&&this.updateSelections){var t=e.state.selection.ranges.map(function(e){return{position:e.head,selectionStart:e.from,selectionEnd:e.to}});this.updateSelections(t)}},t.destroy=function(){this.destroyed=!0,this.disposes.forEach(function(e){return e()})},e}(),r$=new nX.j(function(e,t,n){return[rq,rW,e_.lg.define(function(r){return new rY(r,e,t,n)},{provide:function(e){return e_.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})}})]}),rJ=function(){"use strict";function e(t,n){var r=this;(0,eJ._)(this,e),this.view=t,this.presence=n,this.destroyed=!1,this.followed=null,this.dispose=n.onFollowedUserChanged(function(e){return r.onFollowedUserChanged(e)}),Promise.resolve().then(function(){r.onFollowedUserChanged(n.getFollowedUser())})}var t=e.prototype;return t.onFollowedUserChanged=function(e){var t=this;if(!this.destroyed&&(this.followed=e,this.followed)){var n=this.view.state.field(rW,!1);if(n){var r=Object.values(n).find(function(e){var n;return e.username===(null===(n=t.followed)||void 0===n?void 0:n.username)});r&&this.jumpToPosition(r.position)}}},t.jumpToPosition=function(e){this.view.dispatch({effects:[e_.tk.scrollIntoView(ex.jT.cursor(e),{x:"center",y:"center"})]})},t.unfollow=function(){this.presence.getFollowedUser()&&this.presence.unfollowUser()},t.postUpdate=function(e){if(this.followed){var t=void 0,n=!0,r=!1,i=void 0;try{for(var o,a=e.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=!0,s=!1,u=void 0;try{for(var d,f=l.effects[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value;h.is(rX)&&h.value.username===this.followed.username&&(t=h)}}catch(e){s=!0,u=e}finally{try{c||null==f.return||f.return()}finally{if(s)throw u}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t&&this.jumpToPosition(t.value.position)}},t.destroy=function(){this.destroyed=!0,this.dispose()},e}(),rK=new nX.j(function(e){return e_.lg.define(function(t){return new rJ(t,e)},{provide:function(e){return e_.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})},eventHandlers:{click:function(){this.unfollow()},wheel:function(){this.unfollow()},keydown:function(e){"Control"!==e.key&&"Meta"!==e.key&&this.unfollow()}}})}),rQ=n(87584),r0=n(30084),r1=n(63009),r2=n(54450),r8=n(13474),r4=n(48652),r3=ex.q6.define(),r5=ex.Py.define(),r6=ex.QQ.define({create:function(){return!0},update:function(e,t){return!(0,rZ.a)(t,r5)&&e},provide:function(e){return r4.o.from(e)}}),r9=function(){"use strict";function e(t,n,r,i){var o=this;(0,eJ._)(this,e),this.view=t,this.path=n,this.fs=r,this.writeChange=null,this.destroyed=!1,this.debug=(0,_._)((0,C._)({},i),{latestReceivedVersion:0,openVersion:0,initiatedChanges:0,previousInitiatedChanges:null}),this.dispose=r.watchTextFile(n,{onReady:function(e){var n=e.initialContent,r=e.writeChange,i=e.version;o.destroyed||(o.debug.latestReceivedVersion=i,o.debug.openVersion=i,o.debug.setBsodFilePathVersion({filePath:o.path,version:i}),o.debug.trackTimeToLoadFileEnd(o.path),o.writeChange=r,t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n},effects:r5.of(null),annotations:[ex.YW.addToHistory.of(!1),ex.YW.remote.of(!0),r3.of(!0)]}))},onChange:function(e){var n=e.changes,r=e.changeSource,i=e.version;if(!o.destroyed){o.debug.latestReceivedVersion=i,o.debug.setBsodFilePathVersion({filePath:o.path,version:i});try{t.dispatch({changes:n,annotations:[ex.YW.remote.of(r===r0.Fl.Container),ex.YW.addToHistory.of(r===r0.Fl.Local),r3.of(!0)]})}catch(e){o.debugThrowSyncRemoteOpError(n,r,e)}}},onError:function(){o.destroyed||(o.dispose=null,o.writeChange=null)},onMoveOrDelete:function(){o.destroyed||(o.dispose=null,o.writeChange=null)}})}var t=e.prototype;return t.postUpdate=function(e){if(e.docChanged&&this.writeChange){var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(!(a.annotation(ex.YW.remote)||a.annotation(r3))){this.debug.initiatedChanges++;var l=a.annotation(r2.Z)?{author:"ghostwriter"}:{};try{this.writeChange(a.changes,l),this.debug.previousInitiatedChanges=a.changes}catch(t){this.debugThrowWriteChangeError(e,a,t);break}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},t.destroy=function(){var e;this.destroyed=!0,null===(e=this.dispose)||void 0===e||e.call(this),this.dispose=null,this.writeChange=null,this.debug.deleteBsodFilePathVersion({filePath:this.path})},t.debugThrowSyncRemoteOpError=function(e,t,n){var r=this;this.fs.readFile(this.path,{fromDisk:!1}).then(function(i){var o="replitReadError: "+i.error;i.error||(o=i.content.toString());var a=r.view.contentDOM.innerText;r.debug.throwBsod({origin:"Codemirror: ot/syncRemoteOp",error:n,tags:{ot:!0},extras:{filePath:r.path,previousChanges:JSON.stringify(r.debug.previousInitiatedChanges),changes:JSON.stringify(e),changeSource:t,otClientDoc:o,domText:a,cmDoc:r.view.state.doc.sliceString(0),openVersion:r.debug.openVersion,version:r.debug.latestReceivedVersion,initiatedChanges:r.debug.initiatedChanges}}),(0,e_.OO)(r.view.state,n)})},t.debugThrowWriteChangeError=function(e,t,n){var r=this;this.fs.readFile(this.path,{fromDisk:!1}).then(function(i){var o="replitReadError: "+i.error;i.error||(o=i.content.toString());var a=e.view.contentDOM.innerText,l=e.view.plugin(r8.k),c=null==l?void 0:l.logs();null==l||l.flush(),r.debug.throwBsod({origin:"Codemirror: ot/writeChange",error:n,tags:{ot:!0},extras:{filePath:r.path,previousChanges:JSON.stringify(r.debug.previousInitiatedChanges),transactionChanges:JSON.stringify(t.changes),otherTransactionChanges:JSON.stringify(e.transactions.filter(function(e){return e!==t}).map(function(e){return e.changes})),transactionDoc:t.newDoc.sliceString(0),updateDoc:e.state.doc.sliceString(0),otClientDoc:o,domText:a,openVersion:r.debug.openVersion,latestReceivedVersion:r.debug.latestReceivedVersion,keystrokes:JSON.stringify(c)}})}),(0,e_.OO)(e.state,n)},e}(),r7=new nX.j(function(e,t,n){return e_.lg.define(function(r){return new r9(r,e,t,n)},{provide:function(e){return[r6,e_.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})]}})}),ie=n(45086),it=n(11570),ir=n(11516),ii=n(50782),io=n(8482),ia=n(17491),il=n(55534);function ic(e,t,n,r){var i=(0,il.Z)().showError,o=(0,ii.Z)(),a=(0,ia.eR)({variables:{replId:o,path:e},onError:function(e){i(e.message)},skip:!r||t});return O.useMemo(function(){var r;return t||a.loading||a.error||!a.data||(null===(r=a.data.threadsByFile)||void 0===r?void 0:r.__typename)!=="ThreadsByFileResult"?{}:a.data.threadsByFile.threads.filter(function(t){return t.path===e&&(!n||!t.isResolved)}).reduce(function(e,t){return(0,_._)((0,C._)({},e),(0,eq._)({},t.id,t))},{})},[a.loading,a.data,a.error,e,t,n])}var is=n(50220),iu=n(39327);function id(e,t,n){var r=t.clientWidth,i=n.clientWidth;e.style.maxWidth="".concat(r,"px"),e.style.position="sticky",e.style.zIndex="201",e.style.marginLeft="-".concat(i,"px")}var ih=n(49932),ip=n(6634),im=n(70671),iv=n(11134),ig=n(10028),iy=function(e){var t=e.isOpen,n=e.threadId,r=(0,k._)((0,O.useState)(!1),2),i=r[0],o=r[1],a=(0,ig.GD)({variables:{id:n},skip:"initial-spacer"===n});(0,O.useEffect)(function(){if(a&&!a.error){var e,t=null===(e=a.data)||void 0===e?void 0:e.thread;t&&o((null==t?void 0:t.__typename)==="AnnotationAnchor"&&(null==t?void 0:t.messages.some(function(e){return!e.seen})))}},[a]);var l={button:{alt:{default:"View threads",close:"Dismiss thread"}}};return(0,E.tZ)(t7.hU,{alt:t?l.button.alt.close:l.button.alt.default,size:24,className:"thread-indicator",css:[F.l0.width(20),F.l0.height(20),F.l0.transition.snappy,F.l0.cursor.pointer,F.l0.display.flex,F.l0.borderRadius(8),F.l0.position.relative,F.l0.overflow("visible"),t?F.l0.color.accentPrimaryStrongest:F.l0.color.foregroundDimmest,{borderWidth:F.TV.borderWidthDefault,borderStyle:"solid",borderColor:t?F.TV.accentPrimaryDefault:"transparent",backgroundColor:t?F.TV.accentPrimaryDimmer:F.TV.backgroundHigher,outline:0},{":hover":{borderColor:t?F.TV.accentPrimaryStronger:F.TV.outlineDimmer,color:t?F.TV.accentPrimaryStrongest:F.TV.foregroundDimmer,background:t?F.TV.accentPrimaryDefault+" !important":F.TV.backgroundHighest},svg:{width:12,height:12}}],children:(0,E.BX)(E.HY,{children:[i?(0,E.tZ)("div",{css:[F.l0.width(8),F.l0.height(8),F.l0.backgroundColor.redStronger,F.l0.position.absolute,F.l0.top(-1),F.l0.left(-1),F.l0.borderRadius("full")]}):null,(0,E.tZ)(iv.Z,{})]})})},ib=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(){return(0,eJ._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.compare=function(e){return this==e||this.constructor==e.constructor&&this.eq(e)},r.eq=function(e){return!1},r.destroy=function(e){},n}(ex.uU);ib.prototype.elementClass="",ib.prototype.toDOM=void 0,ib.prototype.mapMode=ex.gc.TrackBefore,ib.prototype.startSide=ib.prototype.endSide=-1,ib.prototype.point=!0;var iZ=ex.r$.define(),iw=ex.r$.define(),ix=ex.r$.define({combine:function(e){return e.some(function(e){return e})}}),iC=e_.lg.fromClass(function(){"use strict";function e(t){(0,eJ._)(this,e),this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-right-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.width="0px",this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(iw).map(function(e){return new iE(t,e)});var n=!0,r=!1,i=void 0;try{for(var o,a=this.gutters[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;this.dom.appendChild(l.dom)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this.fixed=!t.state.facet(ix),this.fixed&&(this.dom.style.position="sticky",this.dom.style.right="0"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM.nextSibling)}var t=e.prototype;return t.update=function(e){if(e.viewportChanged){var t=this.view.contentDOM.nextElementSibling;t&&t!==this.dom&&t.classList.contains("cm-minimap-gutter")&&e.view.scrollDOM.insertBefore(this.dom,e.view.contentDOM.nextSibling)}if(this.updateGutters(e)){var n=this.prevViewport,r=e.view.viewport,i=Math.min(n.to,r.to)-Math.max(n.from,r.from);this.syncGutters(i<(r.to-r.from)*.8)}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(ix)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport},t.syncGutters=function(e){var t=this,n=this.dom.nextSibling;e&&this.dom.remove();var r=ex.Xs.iter(this.view.state.facet(iZ),this.view.viewport.from),i=[],o=this.gutters.map(function(e){return new iS(e,t.view.viewport,-t.view.documentPadding.top)}),a=!0,l=!1,c=void 0;try{for(var s,u=this.view.viewportLineBlocks[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value,f=void 0;if(Array.isArray(d.type)){var h=!0,p=!1,m=void 0;try{for(var v,g=d.type[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value;if(y.type==e_.kH.Text){f=y;break}}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}}else f=d.type==e_.kH.Text?d:void 0;if(f){i.length&&(i=[]),ik(r,i,d.from);var b=!0,Z=!1,w=void 0;try{for(var x,C=o[Symbol.iterator]();!(b=(x=C.next()).done);b=!0)x.value.line(this.view,f,i)}catch(e){Z=!0,w=e}finally{try{b||null==C.return||C.return()}finally{if(Z)throw w}}}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}var _=!0,k=!1,S=void 0;try{for(var E,T=o[Symbol.iterator]();!(_=(E=T.next()).done);_=!0)E.value.finish()}catch(e){k=!0,S=e}finally{try{_||null==T.return||T.return()}finally{if(k)throw S}}e&&this.view.scrollDOM.insertBefore(this.dom,n)},t.updateGutters=function(e){var t=e.startState.facet(iw),n=e.state.facet(iw),r=e.docChanged||e.heightChanged||e.viewportChanged||!ex.Xs.eq(e.startState.facet(iZ),e.state.facet(iZ),e.view.viewport.from,e.view.viewport.to);if(t==n){var i=!0,o=!1,a=void 0;try{for(var l,c=this.gutters[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)l.value.update(e)&&(r=!0)}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}else{r=!0;var s=[],u=!0,d=!1,f=void 0;try{for(var h,p=n[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value,v=t.indexOf(m);v<0?s.push(new iE(this.view,m)):(this.gutters[v].update(e),s.push(this.gutters[v]))}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}var g=!0,y=!1,b=void 0;try{for(var Z,w=this.gutters[Symbol.iterator]();!(g=(Z=w.next()).done);g=!0){var x=Z.value;x.dom.remove(),0>s.indexOf(x)&&x.destroy()}}catch(e){y=!0,b=e}finally{try{g||null==w.return||w.return()}finally{if(y)throw b}}var C=!0,_=!1,k=void 0;try{for(var S,E=s[Symbol.iterator]();!(C=(S=E.next()).done);C=!0){var T=S.value;this.dom.appendChild(T.dom)}}catch(e){_=!0,k=e}finally{try{C||null==E.return||E.return()}finally{if(_)throw k}}this.gutters=s}return r},t.destroy=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.gutters[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.destroy()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.dom.remove()},e}(),{provide:function(e){return e_.tk.scrollMargins.of(function(t){var n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==e_.Nm.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth}:null})}});function i_(e){return Array.isArray(e)?e:[e]}function ik(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}var iS=function(){"use strict";function e(t,n,r){(0,eJ._)(this,e),this.gutter=t,this.height=r,this.localMarkers=[],this.i=0,this.cursor=ex.Xs.iter(t.markers,n.from)}var t=e.prototype;return t.line=function(e,t,n){this.localMarkers.length&&(this.localMarkers=[]),ik(this.cursor,this.localMarkers,t.from);var r=n.length?this.localMarkers.concat(n):this.localMarkers,i=this.gutter.config.lineMarker(e,t,r);i&&r.unshift(i);var o=this.gutter;if(0!=r.length||o.config.renderEmptyElements){var a=t.top-this.height;if(this.i==o.elements.length){var l=new iT(e,t.height,a,r);o.elements.push(l),o.dom.appendChild(l.dom)}else o.elements[this.i].update(e,t.height,a,r);this.height=t.bottom,this.i++}},t.finish=function(){for(var e=this.gutter;e.elements.length>this.i;){var t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}},e}(),iE=function(){"use strict";function e(t,n){var r=this,i=function(e){r.dom.addEventListener(e,function(r){var i=t.lineBlockAtHeight(r.clientY-t.documentTop);n.domEventHandlers[e](t,i,r)&&r.preventDefault()})};for(var o in(0,eJ._)(this,e),this.view=t,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),n.domEventHandlers)i(o);this.markers=i_(n.markers(t)),n.initialSpacer&&(this.spacer=new iT(t,0,0,[n.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}var t=e.prototype;return t.update=function(e){var t=this.markers;if(this.markers=i_(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){var n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n])}var r=e.view.viewport;return!ex.Xs.eq(this.markers,t,r.from,r.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)},t.destroy=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.elements[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.destroy()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},e}(),iT=function(){"use strict";function e(t,n,r,i){(0,eJ._)(this,e),this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,n,r,i)}var t=e.prototype;return t.update=function(e,t,n,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),!function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}(this.markers,r)&&this.setMarkers(e,r)},t.setMarkers=function(e,t){for(var n="cm-gutterElement",r=this.dom.firstChild,i=0,o=0;;){var a=o,l=i<t.length?t[i++]:null,c=!1;if(l){var s=l.elementClass;s&&(n+=" "+s);for(var u=o;u<this.markers.length;u++)if(this.markers[u].compare(l)){a=u,c=!0;break}}else a=this.markers.length;for(;o<a;){var d=this.markers[o++];if(d.toDOM){d.destroy(r);var f=r.nextSibling;r.remove(),r=f}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),c&&o++}this.dom.className=n,this.markers=t},t.destroy=function(){this.setMarkers(null,[])},e}(),iR=ex.r$.define(),iI=ex.r$.define({combine:function(e){return(0,ex.BO)(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function(e,t){var n=Object.assign({},e);for(var r in t)!function(e){var r=n[e],i=t[e];n[e]=r?function(e,t,n){return r(e,t,n)||i(e,t,n)}:i}(r);return n}})}}),iD=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r;return(0,eJ._)(this,n),(r=t.call(this)).number=e,r}var r=n.prototype;return r.eq=function(e){return this.number==e.number},r.toDOM=function(){return document.createTextNode(this.number)},n}(ib);function iG(e,t){return e.state.facet(iI).formatNumber(t,e.state)}function iB(e){for(var t=9;t<e;)t=10*t+9;return t}iw.compute([iI],function(e){return{class:"cm-lineNumbers",renderEmptyElements:!1,markers:function(e){return e.state.facet(iR)},lineMarker:function(e,t,n){return n.some(function(e){return e.toDOM})?null:new iD(iG(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:function(e){return e.startState.facet(iI)!=e.state.facet(iI)},initialSpacer:function(e){return new iD(iG(e,iB(e.state.doc.lines)))},updateSpacer:function(e,t){var n=iG(t.view,iB(t.view.state.doc.lines));return n==e.number?e:new iD(n)},domEventHandlers:e.facet(iI).domEventHandlers}});var iP=new(function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(){var e;return(0,eJ._)(this,n),e=t.apply(this,arguments),e.elementClass="cm-activeLineGutter",e}return n}(ib));iZ.compute(["selection"],function(e){var t=[],n=-1,r=!0,i=!1,o=void 0;try{for(var a,l=e.selection.ranges[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;if(c.empty){var s=e.doc.lineAt(c.head).from;s>n&&(n=s,t.push(iP.range(s)))}}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return ex.Xs.of(t)});var iA=n(51384),iN=n(18836),iU=n(23291),iL=n(38080),iO=n(77615),iX=n(41831),iM=n(39511),iF=n(24837),iW=function(e){var t=e.caretSize,n=void 0===t?[8,12]:t,r=(0,eQ._)(e,["caretSize"]);return(0,E.BX)("svg",(0,_._)((0,C._)({width:n[0],height:n[1],viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r),{children:[(0,E.tZ)("mask",{id:"outline",fill:"white",children:(0,E.tZ)("path",{d:"M0 8L5.2 1.06667C5.6 0.533333 6.40033 0.533776 6.80033 1.06711C8.67223 3.56297 9.93719 5.24959 12 8H0Z"})}),(0,E.tZ)("path",{d:"M0 8L5.2 1.06667C5.6 0.533333 6.40033 0.533776 6.80033 1.06711C8.67223 3.56297 9.93719 5.24959 12 8H0Z",fill:"url(#gradient-fill)"}),(0,E.tZ)("path",{d:"M0 8L-0.8 7.4L-2 9H0V8ZM12 8V9H14L12.8 7.4L12 8ZM5.2 1.06667L4.4 0.466667L5.2 1.06667ZM6.80033 1.06711L6.00033 1.66711L6.80033 1.06711ZM12 7H0V9H12V7ZM0.8 8.6L6 1.66667L4.4 0.466667L-0.8 7.4L0.8 8.6ZM6.00033 1.66711C7.87223 4.16297 9.13719 5.84959 11.2 8.6L12.8 7.4C10.7372 4.64959 9.47223 2.96297 7.60033 0.467109L6.00033 1.66711ZM6 1.66667L6.00033 1.66711L7.60033 0.467109C6.80082 -0.598902 5.20049 -0.600655 4.4 0.466667L6 1.66667Z",fill:"#0079F2",mask:"url(#outline)"}),(0,E.tZ)("defs",{children:(0,E.BX)("linearGradient",{id:"gradient-fill",x1:"5.07692",y1:"0",x2:"5.07692",y2:"21.3333",gradientUnits:"userSpaceOnUse",children:[(0,E.tZ)("stop",{stopColor:"#57ABFF"}),(0,E.tZ)("stop",{offset:"1",stopColor:"#0079F2"})]})})]}))},iH=n(66610),iV=n(96179),iz=n(87599),ij=n(43704),iq=n(82104),iY=n(67795),i$=n(46056),iJ=n(12435),iK=n(63130),iQ=n(30456),i0=n(35972),i1=n(26508),i2=n(93049),i8=n(59725),i4=n(15542),i3=function(e){var t,n,r=e.isCreating,i=e.threadId,o=e.filePath,a=e.isResolved,l=e.isLoading,c=e.isPlaceholder,s=e.caretPosition,u=e.onRequestClose,d=e.onResolveThread,f=e.openThreadsInbox,h={viewAll:"Inbox",next:"Next thread",previous:"Previous thread",dismiss:"Collapse"},p=ic(null===o?"":o,l,!0,!0),m=(0,eb.Z)().preferences.fontSize,v=[12,8];switch(m){case 10:v=[8,6];break;case 14:v=[10,6];break;case 18:v=[12,8];break;case 24:v=[14,10]}var g=O.useMemo(function(){return Object.values(p).sort(function(e,t){return e.indexStart-t.indexStart})},[p]),y=O.useMemo(function(){return g.findIndex(function(e){return e.id===i})},[g,i]),b=(0,iu.a9)(),Z=(t=(0,eZ._)(function(){return(0,ew.Jh)(this,function(e){return b(y===g.length-1?g[0].id:g[y+1].id),[2]})}),function(){return t.apply(this,arguments)}),w=(n=(0,eZ._)(function(){return(0,ew.Jh)(this,function(e){return b(0===y?g[g.length-1].id:g[y-1].id),[2]})}),function(){return n.apply(this,arguments)});return(0,E.BX)(iL.Tg,{background:"root",css:[F.l0.flex.row,F.l0.align.center,F.l0.justify.spaceBetween,F.l0.position.relative,F.l0.px(12),F.l0.py(8),{borderBottomWidth:F.TV.borderWidthDefault,borderBottomStyle:"solid",borderBottomColor:F.TV.outlineDimmest}],children:[null!==s&&(0,E.tZ)("span",{css:[F.l0.position.absolute,F.l0.top(-v[1]),F.l0.left(s),F.l0.height("fit-content"),F.l0.display.flex,F.l0.flex.row,F.l0.align.center],children:(0,E.tZ)(iW,{caretSize:v})}),(0,E.tZ)(t9.zx,{iconLeft:(0,E.tZ)(iq.Z,{}),onClick:function(){f()},text:h.viewAll,size:"small"}),g.length>1?(0,E.BX)(M.G,{css:[F.l0.flex.row,F.l0.align.center,F.l0.rowWithGap(4)],children:[(0,E.tZ)(t7.hU,{alt:h.previous,onClick:w,children:(0,E.tZ)(iX.Z,{})}),(0,E.BX)(eT.xv,{color:"dimmest",variant:"small",multiline:!1,children:[y+1,"/",g.length]}),(0,E.tZ)(t7.hU,{alt:h.next,onClick:Z,children:(0,E.tZ)(iO.Z,{})})]}):null,(0,E.BX)(M.G,{css:[F.l0.flex.row,F.l0.align.center,F.l0.rowWithGap(4)],children:[r||a||c?null:(0,E.tZ)(t9.zx,{onClick:void 0===d?function(){}:d,text:"Resolve",size:"small",iconLeft:(0,E.tZ)(ne.Z,{})}),!r&&a?(0,E.tZ)(iU.D,{text:"Resolved",colorway:"positive"}):null,(0,E.tZ)(t9.zx,{onClick:void 0===u?function(){}:u,text:h.dismiss,size:"small",iconLeft:(0,E.tZ)(iz.Z,{})})]})]})},i5=function(e){var t,n,r=e.threadId,i=e.isResolved,o=e.onMessageChange,a=e.onMessageSubmit,l=e.isPlaceholder,c=e.onRequestClose,s=void 0===c?function(){}:c,u=(0,k._)(O.useState(""),2),d=u[0],f=u[1],h=(0,k._)(O.useState(eH().v4()),2),p=h[0],m=h[1],v=(0,ij.Z)(),g=v.ref,y=v.update,b=O.useRef(null),Z={input:{placeholder:function(){return l?"Start a new thread (Markdown is supported)":i?"Reply to re-open thread":"Reply (Markdown is supported)"}},submit:"Post reply",cancel:"Cancel"},w=function(){var e=d.trim();0!==e.length&&(a({message:e,messageId:p}),f(""),m(eH().v4()))},x=(0,i4.d)(),S=(0,iQ.Z)(),T=(0,k._)((0,iJ.Z)({"@":(t=(0,eZ._)(function(e){var t,n;return(0,ew.Jh)(this,function(r){return t=S.filter(function(e){return e.id!==x}),e&&(n=e.toLowerCase(),t=t.filter(function(e){return e.username.toLowerCase().startsWith(n)})),[2,t.slice(0,5).map(function(e){return{icon:(0,E.tZ)(i$.Z,{username:e.username,fullName:e.fullName,url:e.image,style:{height:"24px",width:"24px",minWidth:"24px",minHeight:"24px"}}),value:e.username}})]})}),function(e){return t.apply(this,arguments)})}),2),R=T[0].suggestions,I=T[1],D=(0,iK.Kb)({items:(null==R?void 0:R.results)||[],defaultHighlightedIndex:0,isOpen:(null!==(n=null==R?void 0:R.results.length)&&void 0!==n?n:0)>0,onSelectedItemChange:function(e){var t=e.selectedItem;if(R&&t){var n=R.applySuggestion({targetValue:d,suggestionValue:t.value}),r=n.fullValue,i=n.cursorIndex;f(r),setTimeout(function(){b.current&&(b.current.setSelectionRange(i,i),b.current.focus(),y())})}}}),G=D.isOpen,B=D.getInputProps,P=D.getMenuProps,A=D.getItemProps,N=D.highlightedIndex,U=D.getComboboxProps;return O.useEffect(function(){var e="threads/drafts/".concat(r),t=ir.Z.get(e,"string");t&&f(t);var n=b.current;return function(){if(n){var t=n.value;if(0===t.length){ir.Z.remove(e);return}ir.Z.set(e,t)}}},[r]),(0,E.BX)(iL.Tg,{background:"root",css:[F.l0.px(12),F.l0.pb(8),F.l0.pt(8),{borderTop:"1px solid ".concat(F.TV.outlineDimmest)}],className:"inline-thread-input",children:[(0,E.BX)("div",(0,_._)((0,C._)({css:[F.l0.flex.row,F.l0.align.start,F.l0.rowWithGap(8),F.l0.width("full")]},U()),{className:"jsx-45ff32690e481e34",children:[l?(0,E.tZ)(t9.zx,{text:Z.cancel,onClick:s}):null,(0,E.BX)("div",{css:[{width:"100%"}],className:"jsx-45ff32690e481e34",children:[(0,E.tZ)(iN.B,(0,C._)({},B({ref:function(e){b.current=e,g(e),I(e)},value:d,onChange:function(e){var t=e.target.value;f(t),o({message:t,messageId:p})},onKeyDown:function(e){!G&&(e.preventDownshiftDefault=!0,"Enter"!==e.key||e.shiftKey||(e.stopPropagation(),e.preventDefault(),w(),requestAnimationFrame(function(){y()})))},onKeyUp:function(e){"Escape"===e.key&&(e.stopPropagation(),e.preventDefault(),s())},placeholder:Z.input.placeholder(),css:[F.l0.height(32),F.l0.align.start,{resize:"vertical",width:"100%",flexGrow:1}],autoFocus:!0}))),(0,E.tZ)("div",{css:{position:"relative"},className:"jsx-45ff32690e481e34",children:(0,E.tZ)("div",(0,_._)((0,C._)({},P({css:[{position:"absolute",top:F.TV.space2,overflow:"hidden"},F.l0.borderRadius(16),F.l0.shadow(1),F.l0.backgroundColor.backgroundDefault]})),{className:"jsx-45ff32690e481e34",children:null==R?void 0:R.results.map(function(e,t){return(0,iA.az)("div",(0,_._)((0,C._)({},A({item:e,index:t})),{key:e.value,className:"jsx-45ff32690e481e34"}),(0,E.BX)(i0.Ug,{spacing:2,css:[N===t?F.l0.backgroundColor.backgroundHighest:null,F.l0.p(8)],children:[e.icon,(0,E.tZ)("div",{className:"jsx-45ff32690e481e34",children:e.value})]}))})}))})]}),(0,E.tZ)(M.G,{css:[F.l0.pt(4)],children:(0,E.tZ)(t7.hU,{alt:Z.submit,tooltipDelay:"long",onClick:w,children:(0,E.tZ)(iM.Z,{})})})]})),(0,E.tZ)(L(),{id:"45ff32690e481e34",children:".inline-thread-input .popover-control-container{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1}"})]})},i6=function(e){var t,n,r=e.threadId,i=e.isCreating,o=e.isResolved,a=void 0!==o&&o,l=e.view,c=e.filePath,s=e.openThreadsInbox,u=(0,iH.Z)(r,l,c),d=u.thread,f=u.loading,h=u.isPlaceholder,p=u.getLatestAnchor,m=u.updateThread,v=u.changeThreadMessage,g=u.finalizeThreadMessage,y=function(){null==l||l.dispatch({effects:[is.YM.of(null)]})},b=(0,eb.Z)().preferences.fontSize,Z=(0,O.useRef)(null);(0,i8.Z)(d);var w=p(),x=l&&!f&&"number"==typeof(null==w?void 0:w.indexEnd)&&w.indexEnd<=l.state.doc.length?null===(n=l.coordsAtPos(w.indexEnd))||void 0===n?void 0:n.left:null,C=(null==l?void 0:l.dom.getBoundingClientRect().left)||null,_=b;switch(b){case 10:_=13;break;case 14:_=19;break;case 18:_=25;break;case 24:_=34}var k=(0,il.Z)().showConfirm,T=(0,ii.Z)(),R=(0,O.useRef)(null),I=function(){R.current&&(R.current.scrollTop=R.current.scrollHeight)};O.useEffect(function(){setTimeout(function(){I()},0)},[null==d?void 0:d.messages]);var D=O.useMemo(function(){return(null==d?void 0:d.messages)?(0,S._)(d.messages).sort(function(e,t){return Date.parse(e.timeCreated)-Date.parse(t.timeCreated)}):[]},[null==d?void 0:d.messages]),G=(t=(0,O.useRef)(0),(0,i1.Z)(function(e){var n=e.height;n!==t.current&&(null==l||l.requestMeasure()),t.current=n}));return(0,E.tZ)("div",{css:[F.l0.width("100%"),F.l0.backgroundColor.backgroundRoot],children:(0,E.BX)(M.G,{innerRef:(0,i2.l)(Z,G),css:[F.l0.font.default,{borderTopWidth:F.TV.borderWidthDefault,borderBottomWidth:F.TV.borderWidthDefault,borderStyle:"solid",borderColor:F.TV.accentPrimaryDefault}],children:[h||f?null:(0,E.tZ)(i3,{isCreating:i,isResolved:a,isLoading:f,threadId:r,filePath:c,caretPosition:x&&C?x-C-6:null,isPlaceholder:h,onRequestClose:y,onResolveThread:function(){m({changes:{isResolved:!0}}),k("Thread resolved. You can reopen it from the inbox.")},openThreadsInbox:s}),f&&!h?(0,E.tZ)(M.G,{css:[F.l0.height(_)],children:(0,E.tZ)(iV.Z,{viewBox:"0 0 400 21",backgroundColor:F.TV.accentPrimaryDimmest,backgroundOpacity:0,foregroundColor:F.TV.accentPrimaryDimmest,foregroundOpacity:.2,speed:1,children:(0,E.tZ)("rect",{x:"0",y:"0",width:"100%",height:"100%"})})}):(0,E.BX)(E.HY,{children:[!i&&D.length>0?(0,E.tZ)("div",{css:[F.l0.px(12),F.l0.py(12),F.l0.maxHeight(300),F.l0.overflowY("auto"),F.l0.colWithGap(16),F.l0.fontSize(b)],ref:R,children:D.map(function(e){return(0,E.tZ)(iF.Z,{thread:d,message:e},e.id)})}):null,(0,E.tZ)(i5,{threadId:r,isPlaceholder:h,isResolved:a,onRequestClose:y,onMessageChange:v,onMessageSubmit:function(e){g(e),(0,tw.j)(iY.U3.MESSAGE_SENT,{replId:T,source:"threads",newThread:h})}})]})]})})},i9=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r,i){var o;return(0,eJ._)(this,n),(o=t.call(this)).id=e,o.filePath=r,o.openThreadsInbox=i,o}var r=n.prototype;return r.eq=function(e){return e.id===this.id},r.toDOM=function(e){var t=(0,eA.VV)((0,E.tZ)(i6,{threadId:this.id,view:e,filePath:this.filePath,openThreadsInbox:this.openThreadsInbox}));t.className="cm-thread-portal-widget";var n=e.dom.querySelector(".cm-scroller"),r=e.dom.querySelector(".cm-gutters");return n&&r&&id(t,n,r),t},r.ignoreEvent=function(){return!0},n}(e_.l9),i7=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r){var i;return(0,eJ._)(this,n),(i=t.call(this)).id=e,i.active=r,i}var r=n.prototype;return r.toDOM=function(e){var t=this,n=(0,eA.VV)((0,E.tZ)(iy,{isOpen:this.active,threadId:this.id}));return n.className="cm-thread-indicator",n.style.display="inline",n.style.cursor="pointer",n.setAttribute("aria-hidden","true"),n.onclick=function(n){n.stopPropagation(),n.preventDefault(),e.dispatch({effects:[is.YM.of(e.state.field(is.PQ)===t.id?null:t.id)]})},n},r.eq=function(e){return e.id===this.id&&e.active===this.active},n}(ib),oe=[(i=[iC],r&&!1===r.fixed&&i.push(ix.of(!0)),i),iw.of((0,C._)({},{class:"",renderEmptyElements:!1,elementStyle:"",markers:function(){return ex.Xs.empty},lineMarker:function(){return null},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},{class:"cm-thread-indicator-gutter",markers:function(e){var t=e.state.field(is.OQ),n=e.state.field(is.PQ);return ex.Xs.of(Object.values(t).filter(function(e){return e.indexEnd!==e.indexStart}).map(function(t){var r=e.state.doc.lineAt(Math.min(t.indexStart,t.indexEnd)).from;return new i7(t.id,t.id===n).range(r)}),!0)},initialSpacer:function(){return new i7("initial-spacer",!1)}}))],ot=function(e,t,n,r,i){if(t===n)return null;var o=(0,k._)(r,2),a=o[0],l=o[1];return e_.p.mark({class:"replit-thread-highlight cm-thread-".concat(e),attributes:{style:"background-color: ".concat(i?l:a)},id:e}).range(t,n)},on=new nX.j(function(e,t,n){return e&&n?[ex.Wl.highest(oe),is.cR,is.OQ,is.ZS,is.PQ,e_.tk.decorations.compute([is.OQ,is.ZS,is.PQ],function(e){var n=e.field(is.OQ),r=e.field(is.ZS),i=e.field(is.PQ),o=r||Object.values(n).find(function(e){return e.id===i});return e_.p.set((0,S._)(Object.values(n)).map(function(e){var n=o&&e.id===o.id;return ot(e.id,e.indexStart,e.indexEnd,t,n)}).filter(function(t){return null!==t&&t.from!==t.to&&t.from<=e.doc.length&&t.to<=e.doc.length}),!0)}),e_.tk.decorations.compute([is.OQ,is.ZS,is.PQ,tU.Yp],function(e){var t=e.field(is.OQ),r=e.field(is.ZS),i=e.field(is.PQ),o=e.facet(tU.Yp);if(void 0===o)return e_.p.none;var a=(0,S._)(Object.values(t)).concat((0,S._)(r?[r]:[])).filter(Boolean).find(function(e){return e.id===i});return a?e_.p.set([e_.p.widget({widget:new i9(a.id,o,n),block:!0,side:1}).range(a.indexEnd)],!0):e_.p.none}),e_.tk.updateListener.of(function(e){(0,eE.j)(e,rI.R,function(){var t=(0,S._)(e.view.dom.querySelectorAll(".cm-thread-portal-widget")),n=e.view.dom.querySelector(".cm-scroller"),r=e.view.dom.querySelector(".cm-gutters");if(t.length&&n&&r){var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;id(s,n,r)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}})}),e_.tk.updateListener.of(function(e){(0,eE.j)(e,is.eR,function(t){var n=t.value,r=e.state.field(is.OQ)[n];r&&e.view.dispatch({selection:{anchor:r.indexStart,head:r.indexStart},effects:[e_.tk.scrollIntoView(r.indexStart,{x:"center",y:"center"})]})})})]:null}),or=n(1323),oi=n(62808),oo=n(77510),oa=n(83311),ol=n(30911),oc=n.n(ol),os=n(9669),ou=n(57783),od=n(77589),of=n(95683),oh=n(85255),op=n(77858);function om(e){return{filePath:e,text:"",selections:[],hasFocus:!1}}function ov(e,t){var n;return null==t?om(e):{filePath:e,text:null!==(n=t.state.doc.toString())&&void 0!==n?n:"",selections:t.state.selection.ranges.map(function(e){var t=e.from;return{location:t,length:e.to-t}}),hasFocus:t.hasFocus}}function og(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:oc()(),i=ov(e,t),o={messageType:os.cF.TEXT_EDITOR_STATE,filePath:e,text:i.text,selections:i.selections,hasFocus:i.hasFocus,hasGhostwriterSuggestion:n.hasGhostwriterSuggestion,revisionId:n.revisionId};(0,od.bG)(o,r)}function oy(e,t,n,r,i){return r===e&&r===n.textEditorState.filePath&&t===n.textEditorState.filePath&&i===n.revisionId}function ob(e){var t=e.map(function(e){return ex.jT.range(e.location,e.location+e.length)});return ex.jT.create(t)}function oZ(e,t,n,r,i,o){var a=i.payload;if((0,os.Se)(a))return function(e,t,n,r,i){if(!oy(e,t,r,i.filePath,i.revisionId))return!1;var o=ob(i.selections);return n.dispatch({selection:o,scrollIntoView:!0}),!0}(e,t,n,r,a);if((0,os.m7)(a))return function(e,t,n,r,i){if(!oy(e,t,r,i.filePath,i.revisionId))return!1;var o=ov(e,n),a=ob(i.selections);return n.dispatch({changes:{from:0,to:o.text.length,insert:i.text},selection:a,scrollIntoView:!0}),!0}(e,t,n,r,a);if((0,os.ac)(a))return function(e,t,n,r,i){if(!oy(e,t,r,i.filePath,i.revisionId))return!1;var o=i.insertionRange,a=ob(i.selections);return n.dispatch({changes:{from:o.location,to:o.location+o.length,insert:i.text},selection:a,scrollIntoView:!0}),!0}(e,t,n,r,a);if((0,os.fz)(a))return!!oy(e,t,r,a.filePath,a.revisionId)&&(n.dispatch(n.state.replaceSelection(a.text)),!0);if((0,os.T$)(a))oy(e,t,r,a.filePath,a.revisionId)&&nM({filePath:e,view:n,clipboardText:a.text});else if((0,os.aB)(a))switch(a.action){case os.b9.REQUEST_BLUR:return function(e,t,n,r,i,o){if(!oy(e,t,r,i,o))return!1;n.contentDOM.blur()}(e,t,n,r,a.filePath,a.revisionId);case os.b9.REQUEST_UNDO:return!!oy(e,t,r,a.filePath,a.revisionId)&&((0,V.Yw)(n),!0);case os.b9.REQUEST_REDO:return!!oy(e,t,r,a.filePath,a.revisionId)&&((0,V.KX)(n),!0);case os.b9.REQUEST_INDENT_SELECTION:return!!oy(e,t,r,a.filePath,a.revisionId)&&(V.at(n),!0);case os.b9.REQUEST_DEDENT_SELECTION:return!!oy(e,t,r,a.filePath,a.revisionId)&&(V.xi(n),!0);case os.b9.REQUEST_TOGGLE_COMMENT:return!!oy(e,t,r,a.filePath,a.revisionId)&&(V.O8(n),!0);case os.b9.REQUEST_ACCEPT_GHOSTWRITER_SUGGESTION:return!!oy(e,t,r,a.filePath,a.revisionId)&&(void 0===n.state.field(oh.WF,!1)?!!(0,ou.$o)(n)&&((0,tw.j)(tw.U3.CODE_SUGGESTION_USED,{type:"suggestionAccepted",language:(0,of.S)(e),engine:o}),ng.n_({category:"ghostwriter",message:"Suggestion accepted",level:"info"}),(0,eC._B)(n),!0):!!(0,op.o)(n)&&void 0);case os.b9.REQUEST_FOCUS:return n.focus(),!0;default:throw Error("Unknown BridgeTextEditorAction.")}else throw Error("Invalid payload.")}var ow=n(20916),ox=n(40028),oC=n(26851),o_=new nX.j(function(e){var t=e_.tk.domEventHandlers({scroll:j()(function(t,n){var r=0,i=0,o=!0,a=!1,l=void 0;try{for(var c,s=n.visibleRanges[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;r=Math.min(r,u.from),i=Math.max(r,u.to)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}e("user:scroll",{visibleLines:{from:n.state.doc.lineAt(r).number,to:n.state.doc.lineAt(i).number}})},250)}),n=j()(function(t,n,r){e("user:selection",{inputMethod:r,from:t,to:n})},250);return[t,e_.tk.updateListener.of(function(t){var r=t.transactions,i=!0,o=!1,a=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.isUserEvent("input.paste")&&e("user:paste",{}),s.isUserEvent("input.drop")&&e("user:new-drop",{}),s.isUserEvent("move.drop")&&e("user:move-drop",{}),s.isUserEvent("delete.cut")&&e("user:cut",{}),s.isUserEvent("input.complete")&&e("user:complete",{}),s.isUserEvent("select")&&n(s.newSelection.main.from,s.newSelection.main.to,s.isUserEvent("select.pointer")?"pointer":"keyboard"),s.isUserEvent("undo")&&e("user:undo",{}),s.isUserEvent("redo")&&e("user:redo",{})}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}})]}),ok=n(11398),oS=n(67696);function oE(e){var t=e.selection.main.head,n=e.doc.lineAt(t);return{offset:t,line:n.number,column:t-n.from+1}}var oT=new nX.j(function(e){return e_.tk.focusChangeEffect.of(function(t,n){var r=t.facet(tU.Yp);return r&&e(r,n?{type:"focus",position:oE(t)}:{type:"blur"}),null})}),oR=new nX.j(function(e){return e_.tk.updateListener.of(function(t){if(t.selectionSet){var n=t.state.facet(tU.Yp);n&&e(n,{type:"update",hasFocus:t.view.hasFocus,position:oE(t.state)})}})}),oI=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r;return(0,eJ._)(this,n),(r=t.call(this)).type=e,r}return n.from=function(e){switch(e){case"yours":return this.yours;case"base":return this.base;case"middle":return this.middle;case"theirs":return this.theirs}},n.range=function(e,t,n){return this.from(e).range(t,n)},n}(ex.uU);function oD(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,i=[],o=n;o<=r;){var a=e.lineAt(o),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;if(e.text.length<t)return null;var n=e.text[0],r=function(e){switch(e){case"<":return"yours";case"|":return"base";case"=":return"middle";case">":return"theirs";default:return null}}(n);if(!r)return null;var i=n.repeat(t);return e.text.slice(0,t)!==i||e.text.length>t&&" "!==e.text[t]?null:r}(a,t);l&&i.push(oI.range(l,a.from,a.to)),o=a.to+1}return i}oI.yours=new oI("yours"),oI.base=new oI("base"),oI.middle=new oI("middle"),oI.theirs=new oI("theirs");var oG=["yours","base","middle","theirs"];function oB(e){Array.isArray(e)&&(e=ex.Xs.of(e));var t=[],n=[];if(0===e.size)return{hunks:t,hanging:n};for(var r=e.iter();null!==r.value;){var i,o,a,l={},c={},s=[],u=!0,d=!1,f=void 0;try{for(var h,p=oG[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value,v=r.value,g=r.from,y=r.to;if("base"!==m||v.type===m){if(v.type===m)l[m]={from:g,to:y},s.push({from:g,to:y,type:v.type});else if("yours"!==v.type)s.push({from:g,to:y,type:v.type});else break;if(r.next(),null===r.value)break}}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}if(!l.yours||!l.middle||!l.theirs){n.push.apply(n,(0,S._)(s));continue}null!==(i=l.base)&&void 0!==i||(l.base=null),null!==(o=c.base)&&void 0!==o||(c.base=null);var b=null!==(a=l.base)&&void 0!==a?a:l.middle,Z=l.yours.to+1,w=b.from-1;if(c.yours=Z<w?{from:Z,to:w}:null,l.base){var x=l.base.to+1,C=l.middle.from-1;c.base=x<C?{from:x,to:C}:null}var _=l.middle.to+1,k=l.theirs.from-1;c.theirs=_<k?{from:_,to:k}:null;var E={from:l.yours.from,to:l.theirs.to,markers:l,content:c};t.push(E)}return{hunks:t,hanging:n}}var oP=ex.r$.define({combine:function(e){return e.length?e[0]:7}}),oA=ex.QQ.define({create:function(e){var t=e.doc,n=e.facet(oP),r=ex.Xs.of(oD(t,n)),i=oB(r);return{markers:r,hunks:i.hunks,hanging:i.hanging}},update:function(e,t){var n=t.newDoc,r=t.startState.facet(oP),i=t.state.facet(oP);if(r!==i){var o=ex.Xs.of(oD(n,i)),a=oB(o);return{markers:o,hunks:a.hunks,hanging:a.hanging}}if(!t.docChanged)return e;var l=null,c=null,s=null,u=null;t.changes.iterChangedRanges(function(e,t,n,r){l=null===l?e:Math.min(l,e),c=null===c?t:Math.max(c,t),s=null===s?n:Math.min(s,n),u=null===u?r:Math.max(u,r)});var d=e.markers;if(null!==l&&null!==c){var f=t.startState.doc.lineAt(l).from,h=t.startState.doc.lineAt(c).to;d=d.update({filter:function(){return!1},filterFrom:f,filterTo:h})}d=d.map(t.changes),null!==s&&null!==u&&(d=d.update({add:oD(n,i,s,u)}));var p=oB(d);return{markers:d,hunks:p.hunks,hanging:p.hanging}}}),oN=e_.tk.atomicRanges.from(oA,function(e){return function(){return e.markers}}),oU=ex.yy.changeFilter.of(function(e){var t=e.startState.field(oA);if(!e.docChanged||0===t.markers.size)return!0;var n=e.startState.doc,r=[];return e.changes.iterChanges(function(e,i,o,a,l){var c=l.length,s=Math.max(n.lineAt(e).from-1,0),u=Math.min(n.lineAt(i).to+1,n.length);t.markers.between(s,u,function(t,s){e<=t&&i>=s||0!==c&&(e===s&&"\n"===l.sliceString(0,1)||i===t&&"\n"===l.sliceString(c-1,c))||o===a&&(i===s+1&&0===n.lineAt(i).length||e===t-1&&0===n.lineAt(e).length)||r.push(t-1,s+1)})}),!(r.length>0)||r}),oL=ex.yy.transactionFilter.of(function(e){var t=e.docChanged?e.state.field(oA):e.startState.field(oA);if(0===t.markers.size)return e;var n=e.newSelection,r=!1,i=!1;do{i=!1;for(var o=0;o<n.ranges.length&&"break"!==function(e){var o=n.ranges[e],a=o.from,l=o.to,c=a,s=l;if(t.markers.between(a,l,function(e,t){var n=(e+t)/2;a>e&&a<t&&(c=a<n?e:t),l>e&&l<t&&(s=l<n?e:t)}),c!==a||s!==l){var u,d=o.anchor<o.head?c:s,f=o.anchor<o.head?s:c,h=o.goalColumn,p=null!==(u=o.bidiLevel)&&void 0!==u?u:void 0,m=ex.jT.range(d,f,h,p);return n=n.replaceRange(m,e),i=!0,r=!0,"break"}}(o);o++);}while(i);return r?[e,{selection:n,sequential:!0}]:e}),oO="cm-git-conflict-marker-yours",oX="cm-git-conflict-marker-base",oM="cm-git-conflict-marker-middle",oF="cm-git-conflict-marker-theirs",oW="cm-git-conflict-marker-hanging",oH="cm-git-conflict-content-yours",oV="cm-git-conflict-content-base",oz="cm-git-conflict-content-theirs";function oj(e){var t=e.background,n=e.color,r=e.noBorder,i={color:n,backgroundColor:t,backgroundClip:"padding-box",paddingTop:F.TV.space4,paddingBottom:F.TV.space4,fontWeight:F.TV.fontWeightBold};return void 0!==r&&r||(i.borderLeft="4px solid rgba(0, 150, 255, 0.1)",i.paddingLeft="2px"),i}function oq(e){return{backgroundColor:e.background,backgroundClip:"padding-box",borderLeft:"4px solid rgba(0, 150, 255, 0.1)",paddingLeft:"2px"}}var oY=e_.tk.theme((g={},(0,eq._)(g,".".concat(oO),oj({background:"rgba(0, 150, 255, 0.1)",color:F.TV.blueStrongest,noBorder:!0})),(0,eq._)(g,".".concat(oM),oj({background:"rgba(255, 0, 0, 0.1)",color:F.TV.redStrongest})),(0,eq._)(g,".".concat(oX),oj({background:"rgba(255, 165, 0, 0.1)",color:F.TV.orangeStrongest})),(0,eq._)(g,".".concat(oF),oj({background:"rgba(0, 150, 255, 0.1)",color:F.TV.blueStrongest,noBorder:!0})),(0,eq._)(g,".".concat(oW),oj({background:"rgba(100, 150, 255, 0.1)",color:F.TV.blueStrongest,noBorder:!0})),(0,eq._)(g,".".concat(oH),oq({background:"rgba(0, 255, 0, 0.1)"})),(0,eq._)(g,".".concat(oz),oq({background:"rgba(255, 0, 0, 0.1)"})),(0,eq._)(g,".".concat(oV),oq({background:"rgba(255, 165, 0, 0.1)"})),g)),o$={yours:{marker:e_.p.line({class:oO}),content:e_.p.line({class:oH})},base:{marker:e_.p.line({class:oX}),content:e_.p.line({class:oV})},middle:{marker:e_.p.line({class:oM})},theirs:{marker:e_.p.line({class:oF}),content:e_.p.line({class:oz})},hanging:{marker:e_.p.line({class:oW})}},oJ=function(){"use strict";function e(t){(0,eJ._)(this,e),this.builder=new ex.f_,this.doc=t}var t=e.prototype;return t.add=function(e,t){var n=this.doc.lineAt(e.from);if(n.to>=e.to){this.builder.add(n.from,n.from,t);return}for(var r=n.from;r<=e.to;)this.builder.add(r,r,t),r=this.doc.lineAt(r).to+1},t.finish=function(){return this.builder.finish()},e}(),oK=e_.tk.decorations.from(oA,function(e){return function(t){var n=new oJ(t.state.doc),r=!0,i=!1,o=void 0;try{for(var a,l=e.hunks[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;t.viewport.from>c.to||t.viewport.to<c.from||(n.add(c.markers.yours,o$.yours.marker),c.content.yours&&n.add(c.content.yours,o$.yours.content),c.markers.base&&n.add(c.markers.base,o$.base.marker),c.content.base&&n.add(c.content.base,o$.base.content),n.add(c.markers.middle,o$.middle.marker),c.content.theirs&&n.add(c.content.theirs,o$.theirs.content),n.add(c.markers.theirs,o$.theirs.marker))}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n.finish()}}),oQ=e_.tk.decorations.from(oA,function(e){return function(){var t=new ex.f_,n=!0,r=!1,i=void 0;try{for(var o,a=e.hanging[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;t.add(l.from,l.from,o$.hanging.marker)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.finish()}}),o0=[oA,[oN,oU,oL],[ex.Wl.lowest(oY),oK,oQ]],o1=n(31157),o2=function(){"use strict";function e(t,n,r,i,o,a){(0,eJ._)(this,e),this.original=t,this.current=n,this.chunks=r,this.desc=i,this.pending=o,this.ranges=a}var t=e.prototype;return t.hasChanges=function(){return this.ranges.length>0},t.update=function(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.original,a=this.chunks,l=this.desc,c=this.pending,s=this.ranges;if(Math.abs((this.pending?this.pending.length:this.current.length)-t.length)>=250||i){var u=(0,o1.Gj)(l,c,n).pending;a=(0,o1.U_)(o,t,{chunks:a,changesB:u}),l=(0,o1.fu)(a,o.length),c=null,s=(0,o1.Hu)(l)}else c=(r=(0,o1.Gj)(l,c,n)).pending,l=r.desc,s=(0,o1.Hu)(l);return c&&t.eq(o)&&(a=[],l=ex.as.empty(o.length),c=null,s=[]),new e(o,t,a,l,c,s)},t.isAccurate=function(){return null===this.pending},t.getLineChangeType=function(e){var t=this.current.line(e);return 0===this.original.length&&this.current.length>0?o1.dQ.COVERED:(0,o1.dx)(t,o1.MF.B,this.ranges)},t.iterRanges=function(){return(0,ew.Jh)(this,function(e){switch(e.label){case 0:return[5,(0,ew.XA)(this.ranges)];case 1:return e.sent(),[2]}})},e.create=function(t,n){var r=(0,o1.U_)(t,n),i=(0,o1.fu)(r,t.length),o=(0,o1.Hu)(i);return new e(t,n,r,i,null,o)},e}(),o8=ex.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),o4=ex.QQ.define({create:function(){return null},update:function(e,t){var n=t.state.facet(o8);return n?(e&&e.original.eq(n)?t.docChanged&&(e=e.update(t.newDoc,t.changes,!(t.isUserEvent("input.type")||t.isUserEvent("delete.forward")||t.isUserEvent("delete.backward")))):e=o2.create(n,t.newDoc),e):null}}),o3=n(92708),o5=(0,e_.v5)({class:o3.Tr,renderEmptyElements:!0,lineMarker:function(e,t){var n=e.state.field(o4,!1);if(!n||!n.hasChanges())return null;if(0===n.original.length)return o3.Vt;var r=e.state.doc.lineAt(t.from);switch(n.getLineChangeType(r.number)){case o1.dQ.COVERED:return o3.vP;case o1.dQ.MODIFIED:return o3.wp;default:return null}},initialSpacer:function(e){return e.state.field(o4,!1)?o3.Vt:o3.Do},updateSpacer:function(e,t){var n=t.state.field(o4,!1)?o3.Vt:o3.Do;return e===n?e:n}}),o6=ex.r$.define({enables:function(e){return[o8.computeN([e],function(t){return t.facet(e)}),o3.Lw,o4,ex.Wl.highest(o5)]}}),o9=n(10814);(c=y||(y={})).GUTTER_DIFF="GUTTER_DIFF",c.INLINE_DIFF="INLINE_DIFF";var o7=ex.Py.define(),ae=ex.Py.define(),at=ex.QQ.define({create:function(){return{head:null,mode:"GUTTER_DIFF"}},update:function(e,t){var n=e.head,r=e.mode,i=!0,o=!1,a=void 0;try{for(var l,c=t.effects[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.is(o7)?n=s.value:s.is(ae)&&(r=s.value)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n!==e.head||r!==e.mode?{head:n,mode:r}:e},provide:function(e){return[o6.from(e,function(e){return"GUTTER_DIFF"===e.mode?e.head:null}),o9.p.from(e,function(e){return"INLINE_DIFF"===e.mode?e.head:null})]}}),an=function(){"use strict";function e(t,n,r){var i=this;(0,eJ._)(this,e),this.view=t,this.git=n,this.path=r,this.disposed=!1,this.dispose=n.onRefresh(function(){return i.fetchThenUpdateState()}),this.fetchThenUpdateState()}var t=e.prototype;return t.fetchThenUpdateState=function(){var e=this;return(0,eZ._)(function(){var t,n,r,i,o;return(0,ew.Jh)(this,function(a){switch(a.label){case 0:return[4,e.git.getFileContents({path:e.path,revision:"HEAD"})];case 1:if(t=a.sent(),e.disposed||!(n=e.view.state.field(at,!1)))return[2];return(!(o=null===(i=t.error?null:null!==(r=t.content)&&void 0!==r?r:"")?null:e.view.state.toText(i))!=!n.head||o&&n.head&&!o.eq(n.head))&&e.view.dispatch({effects:o7.of(o)}),[2]}})})()},t.destroy=function(){this.dispose(),this.disposed=!0},e}(),ar=new nX.j(function(e,t,n,r){var i=[];return n||i.push(t?[at,e_.lg.define(function(n){return new an(n,e,t)})]:[]),(r||i.push(o0),0===i.length)?null:i}),ai=n(68956),ao=n(58091),aa=n(20142),al=n(81013),ac=n(60417),as="cm-transform-diff-line-deletion-base",au="cm-transform-diff-line-deletion",ad="cm-transform-diff-text-deletion",af="cm-transform-diff-line-insertion-base",ah="cm-transform-diff-line-insertion",ap="cm-transform-diff-text-insertion",am="cm-transform-diff-number-marker",av="rgba(180, 0, 0, 0.1)",ag="rgba(180, 0, 0, 0.125)",ay="rgba(0, 180, 0, 0.1)",ab="rgba(0, 180, 0, 0.125)";function aZ(e,t){var n="linear-gradient(to right, ".concat(e,", ").concat(e,")");return t&&(n+=", linear-gradient(to right, ".concat(t,", ").concat(t,")")),n}var aw=e_.tk.theme((b={},(0,eq._)(b,".".concat(af,", .").concat(ah),{cursor:"text","&.cm-line ::selection":{backgroundColor:"".concat(F.TV.accentPrimaryDimmest," !important")}}),(0,eq._)(b,".".concat(as),{background:aZ(av),backgroundClip:"content-box"}),(0,eq._)(b,".".concat(au),{background:aZ(av,ag),backgroundClip:"content-box"}),(0,eq._)(b,".".concat(af),{background:aZ(ay),backgroundClip:"content-box"}),(0,eq._)(b,".".concat(ah),{background:aZ(ay,ab),backgroundClip:"content-box"}),(0,eq._)(b,".".concat(ap),{display:"inline-block",background:ab}),(0,eq._)(b,".".concat(ad),{display:"inline-block",background:ag}),(0,eq._)(b,".".concat(am),{opacity:.5}),b)),ax=n(81232),aC=n(30804),a_=n(67075),ak=ex.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),aS=ex.QQ.define({create:function(){return{diff:null,tree:ax.mp.empty}},update:function(e,t){var n,r,i=t.state.facet(ak),o=null===(n=t.state.facet(e1.dK))||void 0===n?void 0:n.parser;if(!i)return null===e.diff&&e.tree===ax.mp.empty?e:{diff:null,tree:ax.mp.empty};var a=e.diff,l=e.tree;return(a&&a.b.eq(i)?t.docChanged&&(a=a.updateA(t.newDoc,t.changes)):(a=aC.z.create(t.newDoc,i),l=ax.mp.empty),(null===(r=t.startState.facet(e1.dK))||void 0===r?void 0:r.parser)!==o&&(l=ax.mp.empty),o&&l.length!==a.b.length)?(l=(0,a_.p)({parser:o,text:a.b,maxTime:16,base:l}),{diff:a,tree:l}):e.diff===a&&e.tree===l?e:{diff:a,tree:l}}}),aE=n(15658),aT=n(3756),aR=n.n(aT),aI=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r,i){var o;return(0,eJ._)(this,n),(o=t.call(this)).line=e,o.index=r,o.changed=i,o}var r=n.prototype;return r.toDOM=function(){var e=this,t=document.createElement("div");if(t.className=this.changed?"cm-line ".concat(af):"cm-line ".concat(ah),!this.changed||!this.changed.length){var n=!0,r=!1,i=void 0;try{for(var o,a=this.line[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=l.text,s=l.tags,u=document.createElement("span");u.textContent=c||"\xa0",u.className=null!=s?s:"",t.appendChild(u)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}for(var d=0,f=0,h=null,p=null,m=function(t,n){if(!h)throw Error("range is null");var r=e.line[f],i=r.text,o=r.tags,a=i.slice(d-h.from,n-h.from),l=document.createElement("span");l.textContent=a||"\xa0",l.className=null!=o?o:"",t.appendChild(l),d+=a.length};f<this.line.length;){if(!h){var v=this.line[f].text;h={from:d,to:d+v.length}}if(!p){var g=!0,y=!1,b=void 0;try{for(var Z,w=this.changed[Symbol.iterator]();!(g=(Z=w.next()).done);g=!0){var x=Z.value;if(!(x.from>=h.to)&&!(x.to<=d)){var C=document.createElement("span");C.className=ap,p={from:x.from,to:x.to,dom:C},d<p.from&&m(t,p.from),t.appendChild(C);break}}}catch(e){y=!0,b=e}finally{try{g||null==w.return||w.return()}finally{if(y)throw b}}}p?(d<p.to&&m(p.dom,p.to),d>=p.to&&(p=null)):m(t,h.to),d>=h.to&&(h=null,f++)}return t},r.eq=function(e){var t,r;return e instanceof n&&this.index===e.index&&this.line.length===e.line.length&&(null===(t=this.changed)||void 0===t?void 0:t.length)===(null===(r=e.changed)||void 0===r?void 0:r.length)&&aR()(this.line,e.line)&&aR()(this.changed,e.changed)},r.ignoreEvent=function(e){return e.stopImmediatePropagation(),!0},(0,e2._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(e_.l9),aD=e_.p.line({class:as}),aG=e_.p.line({class:au}),aB=e_.p.mark({class:ad}),aP=e_.tk.decorations.compute([aS],function(e){var t=function(e,t){if(r.getLineChangeType(e.number,o1.MF.A)===o1.dQ.COVERED)o.push(aG.range(e.from));else{o.push(aD.range(e.from));var n=!0,i=!1,a=void 0;try{for(var l,c=(0,o1.Po)(e,t,o1.MF.A,!1)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=l.value;o.push(aB.range(s.from,s.to))}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}}},n=e.field(aS,!1);if(!n||!n.diff)return e_.p.none;var r=n.diff,i=n.tree,o=[],a=!0,l=!1,c=void 0;try{for(var s,u=r.chunks[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value;if(d.fromA!==d.endA)for(var f=r.a.lineAt(d.fromA),h=r.a.lineAt(d.endA),p=f.number;p<=h.number;p++)t(r.a.line(p),d);else d.fromB===d.endB&&t(r.a.lineAt(d.fromA),d);if(d.fromB!==d.toB)for(var m=r.b.lineAt(d.fromB),v=(0,aE.CT)(i,r.b,e,d.fromB,d.endB),g=0;g<v.length;g++){var y=v[g],b=r.b.line(m.number+g),Z=r.getLineChangeType(b.number,o1.MF.B)===o1.dQ.COVERED?null:(0,o1.Po)(b,d,o1.MF.B,!0),w=e_.p.widget({widget:new aI(y,b.number,Z),block:!0,side:g+1}),x=Math.min(d.endA,r.a.length);o.push(w.range(x))}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}return e_.p.set(o,!0)}),aA=n(3917),aN=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r;return(0,eJ._)(this,n),(r=t.call(this)).index=e,r}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("span");return e.className=am,e.textContent=String(this.index),e},r.eq=function(e){return this.index===e.index},n}(e_.SJ),aU=aA.X4.of(function(e,t){if(t instanceof aI)return new aN(t.index)}),aL=ex.r$.define({enables:function(e){return[ak.computeN([e],function(t){return t.facet(e)}),aS,aw,aP,aU]}}),aO=n(53466);(s=Z||(Z={}))[s.Compare=0]="Compare",s[s.Original=1]="Original",s[s.Suggestion=2]="Suggestion";var aX=ex.Py.define(),aM=ex.QQ.define({create:function(){return Z.Suggestion},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(aX))e=l.value;else if(l.is(nq.Q))e=null;else if(l.is(nq.h)){var c=t.state.field(aO.$);if((null==c?void 0:c.type)==="transformCode"&&l.value){var s=t.startState.field(aO.u),u=l.value;!s&&u&&(e=Z.Suggestion)}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}}),aF=ex.QQ.define({create:function(){return null},update:function(e,t){if(!(0,rZ.a)(t,"doc",aO.$,tU.Yp,aM,aO.u))return e;var n,r=t.state.field(aO.$),i=t.state.facet(tU.Yp),o=t.state.field(aM);if(!r||!i||r.codeReference.filePath!==i||o!==Z.Suggestion)return null;var a=r.codeReference.range.indexFrom,l=r.codeReference.range.indexTo,c=t.state.doc.slice(a,l),s=null!==(n=t.state.field(aO.u))&&void 0!==n?n:"",u=c.lines,d=s.split(t.state.lineBreak).length-u;return e&&e.after===a&&e.offset===d?e:{after:a,offset:d}}}),aW=aA.gy.of(function(e,t){var n=e.state.doc.lineAt(t.from),r=e.state.field(aF);if(r&&!(n.from<=r.after))return new aA.un(n.number+r.offset)}),aH=aA.X4.of(function(e,t){if(t instanceof aV)return new aA.un(t.index)}),aV=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r,i){var o;return(0,eJ._)(this,n),(o=t.call(this)).line=e,o.block=r,o.index=i,o}var r=n.prototype;return r.toDOM=function(){var e=document.createElement(this.block?"div":"span");e.className=this.block?"cm-line":"";var t=!0,n=!1,r=void 0;try{for(var i,o=this.line[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=a.text,c=a.tags,s=document.createElement("span");s.textContent=l||"\xa0",c&&(s.className=c),e.appendChild(s)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e},r.eq=function(e){return this.index===e.index&&(0,aE.gj)(this.line,e.line)},r.ignoreEvent=function(){return!1},(0,e2._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(e_.l9),az=[aF,aW,aH,e_.tk.decorations.compute([e1.dK,aO.$,aO.u,aM,aS,tU.Yp,ex.yy.lineSeparator],function(e){var t=e.field(aO.$),n=e.facet(tU.Yp),r=e.field(aM);if(!t||"transformCode"!==t.type||!n||t.codeReference.filePath!==n||r!==Z.Suggestion)return e_.p.none;var i=t.codeReference.range.indexFrom,o=t.codeReference.range.indexTo,a=e.doc.lineAt(i),l=e.doc.lineAt(o),c=e.toText(null!==(y=e.field(aO.u))&&void 0!==y?y:""),s=e.changes({from:i,to:o,insert:c}),u=s.apply(e.doc),d=i+c.length,f=null===(g=e.facet(e1.dK))||void 0===g?void 0:g.parser,h=null;if(f)h=(0,a_.p)({parser:f,text:u,changes:s,base:e,upTo:d}),b=(0,aE.CT)(h,u,e,i,d);else{b=[];var p=!0,m=!1,v=void 0;try{for(var g,y,b,w,x=c.iterLines()[Symbol.iterator]();!(p=(w=x.next()).done);p=!0){var C=w.value;b.push([{text:C}])}}catch(e){m=!0,v=e}finally{try{p||null==x.return||x.return()}finally{if(m)throw v}}}var _=[];b.length>1&&i!==o&&0!==l.length&&o===l.to&&o<e.doc.length?_.push(e_.p.replace({inclusive:!1,block:!0}).range(i,o)):_.push(e_.p.replace({inclusiveStart:!1,block:!0}).range(i,o));for(var k=0;k<b.length;k++){var S=b[k],E=a.number+k,T=e_.p.widget({widget:new aV(S,k>0,E),inlineOrder:!0,side:k+1,block:k>0});_.push(T.range(i))}return e_.p.set(_,!0)})],aj=n(1643),aq=n(25961),aY=(0,tS.X)({container:[F.l0.rowWithGap(2),F.l0.flex.row,F.l0.align.center,F.l0.textAlign.center,F.l0.cursor.pointer,F.l0.pr(4),{opacity:.6},F.l0.height("100%")],text:[F.l0.rowWithGap(4),F.l0.color.foregroundDimmest,{textTransform:"capitalize"}],shortcut:[F.l0.ml(4),{"& > div > div":{fontSize:"0.8em",paddingLeft:(0,aj.fP)(4),paddingRight:(0,aj.fP)(4),paddingTop:(0,aj.fP)(2),paddingBottom:(0,aj.fP)(2)}}]}),a$=new eA.Jf(function(e){var t=e.onGenerateCode,n=e.onEditCode,r=e.hasSelection,i=(0,T.T3)(),o=r?"edit":"generate",a=(0,n7.gf)(re.x.id);return(0,E.BX)(M.G,{css:aY.container,onClick:function(){(0,tw.j)(iY.U3.GHOSTWRITER_CHAT_INLINE_HINT_CLICKED,{action:o}),r?n():t()},children:[(0,E.tZ)("div",{css:aY.text,children:(0,E.tZ)(eT.xv,{variant:"small",children:o})}),(0,E.tZ)("div",{css:aY.shortcut,children:!i&&a?(0,E.tZ)(aq.bM,{keyCombo:a,small:!0}):null})]})}),aJ=e_.tk.theme({".cm-ghostwriter-hint-layer":{width:"100%"}}),aK=function(e){var t=e.selection.main.head;return e.doc.lineAt(t)},aQ=new nX.j(function(e,t){return ex.QQ.define({create:function(e){return aK(e)},compare:rx(),update:function(e,t){return aK(t.state)},provide:function(n){return[aJ,ex.Wl.high((0,e_.EY)({above:!0,class:"cm-ghostwriter-hint-layer",update:function(e){return(0,rZ.a)(e,n,aO.$,ou.yn,oh.WF)},markers:function(r){var i=r.state.field(n,!1);if(!i)return[];var o=!r.state.selection.main.empty;if(o)return[];var a=r.state.field(aO.$,!1),l=0===r.state.doc.length,c=(0,tZ.Z)(r.state);if(i.length>0||a||c||l)return[];var s=r.dom.querySelector(".cm-minimap-gutter"),u=(null==s?void 0:s.clientWidth)||0,d=i.to,f=r.lineBlockAt(d),h=f.top,p=f.height;return[new a0({top:h+r.documentPadding.top,height:p,right:u,pocketOpen:null!==a,hasSelection:o,activeEditor:r.hasFocus,onGenerateCode:e,onEditCode:t})]}}))]}})}),a0=function(){"use strict";function e(t){(0,eJ._)(this,e),this.options=t}var t=e.prototype;return t.position=function(e){e.style.top=this.options.top+"px",e.style.height=this.options.height+"px",e.style.right=this.options.right+"px",e.style.paddingRight="8px"},t.draw=function(){var e=a$.create({onEditCode:this.options.onEditCode,onGenerateCode:this.options.onGenerateCode,hasSelection:this.options.hasSelection});return e.className="cm-ghostwriter-hint-marker",this.options.activeEditor||(e.style.visibility="hidden"),this.position(e),e},t.eq=function(e){return this.options.top===e.options.top&&this.options.hasSelection===e.options.hasSelection&&this.options.pocketOpen===e.options.pocketOpen&&this.options.activeEditor===e.options.activeEditor},e}(),a1=ex.Py.define(),a2=ex.Py.define(),a8=function(e){var t=e.view,n=e.insert,r=e.scrollIntoView;if(e.overwrite)t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n},effects:a1.of(null),scrollIntoView:r,annotations:r2.Z.of(!0)});else{var i=t.state.selection.main.head;t.dispatch({changes:{from:t.state.selection.main.from,insert:n},selection:{anchor:i+n.length},effects:a1.of(null),scrollIntoView:r,annotations:r2.Z.of(!0)})}},a4=function(e){var t=e.state.field(a3,!1);if(!t){ng.Tb(Error("RevetGhostwriterCodeInsertState not found when trying to revert"));return}e.dispatch({changes:t,effects:a2.of(null)})},a3=ex.QQ.define({create:function(){return null},update:function(e,t){e&&(e=e.map(t.changes));var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;l.is(a1)&&(e=t.changes.invert(t.startState.doc)),l.is(a2)&&(e=null)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}}),a5=n(92153),a6=n(73722),a9=RegExp(".*?```(\\w+)\\n(.*?)(?:$|\\n$|\\n`$|\\n``$|\\n```)","gs"),a7=function(e,t){for(var n,r=[];null!==(n=a9.exec(e));){var i=n[1],o=n[2];if(!1===t){var a=o.substring(0,o.lastIndexOf("\n"));r.push({language:i,code:a})}else r.push({language:i,code:o})}return r};function le(e){return(0,O.useMemo)(function(){if(!(null==e?void 0:e.text))return null;var t=a7((null==e?void 0:e.text)||"");return t.length>0?t[0].code:null},[null==e?void 0:e.text])}var lt=n(66820),ln=n(87659),lr=n(30376),li=n(93496),lo=n(25753),la=n(30983),ll=[F.l0.p(4),F.l0.center,F.l0.borderRadius(4)],lc=(0,tS.X)({root:(0,S._)(ll).concat([F.l0.cursor.pointer,(0,ln.ec)("blurple")]),disabled:(0,S._)(ll).concat([(0,ln.ec)("grey")])});function ls(e){return e.disabled?(0,E.tZ)(M.G,{css:lc.disabled,tag:"button","data-cy":"ghostwriter-inline-submit",children:(0,E.tZ)(iM.Z,{size:12})}):(0,E.tZ)(M.G,{"data-cy":"ghostwriter-inline-submit",css:lc.root,tag:"button",onClick:e.onClick,children:e.loading?(0,E.tZ)(lo.Z,{size:12}):(0,E.tZ)(iM.Z,{size:12})})}var lu=(0,tS.X)({root:[F.l0.py(8),F.l0.pr(8),F.l0.maxWidth(800),{fontFamily:F.TV.fontFamilyDefault}],container:[F.l0.position.relative],input:[li.gU.outlined,F.l0.borderRadius(4),{paddingBottom:36,"@media (hover: hover)":{":not([disabled]):hover":{backgroundColor:"transparent"}}}],textarea:[F.l0.p(8),F.l0.pb(0),{caretColor:"initial",fontFamily:F.TV.fontFamilyDefault,border:"0 none",resize:"none",height:"1em",backgroundColor:"transparent","@media (hover: hover)":{":not([disabled]):focus":{outline:"0 none"}},"::placeholder":{color:F.TV.foregroundDimmest}}],footer:[F.l0.px(8),F.l0.pr(6),F.l0.rowWithGap(8),F.l0.align.center,F.l0.position.absolute,F.l0.bottom(0),F.l0.left(0),F.l0.width("100%"),{height:36}],footerLeft:[F.l0.rowWithGap(8),F.l0.flex.growAndShrink(1),F.l0.align.center],iconText:[F.l0.rowWithGap(4),F.l0.align.center],footerRight:[F.l0.rowWithGap(4),F.l0.align.center,{"& button":[F.l0.height(22),F.l0.py(6),F.l0.py(4),F.l0.borderRadius(4)]}],error:[F.l0.color.accentNegativeStronger]}),ld=function(e){var t=e.requestMeasure,n=e.type,r=e.children,i=(0,i1.Z)(t);return(0,E.tZ)(lr.Z,{bsod:!0,tags:{ai:!0},extras:{type:n},origin:"ErrorBoundary: InlineAiWidget",children:(0,E.tZ)(M.G,{css:lu.root,innerRef:i,className:"cm-pocket-widget",children:r})})},lf=function(e){var t=e.requestMeasure,n=e.type,r=e.children;return(0,E.tZ)(ld,{type:n,requestMeasure:t,children:(0,E.tZ)(M.G,{css:lu.container,children:r})})};function lh(e){var t=(0,ij.Z)();return(0,E.tZ)(M.G,{css:lu.input,children:(0,E.tZ)("textarea",{value:e.value,onChange:e.onChange,placeholder:e.placeholder,css:lu.textarea,ref:t.ref,onKeyDown:e.onKeyDown,autoFocus:e.autoFocus,"data-cy":"ghostwriter-inline-input"})})}var lp={generateCode:"Generate new code based on this file.",transformCode:"Modify selected code based on the context of this file."};function lm(e){var t=e.type;return(0,E.tZ)(la.u,{tooltip:lp[t],children:(0,E.BX)(M.G,{css:lu.iconText,children:[(0,E.tZ)(n8.Z,{size:12,color:F.TV.foregroundDimmest}),(0,E.tZ)(eT.xv,{variant:"small",color:"dimmest",children:"transformCode"===t?"Modify":"Generate"})]})})}function lv(e){var t=e.loading,n=e.disabled,r=e.onClick;return(0,E.BX)(E.HY,{children:[t?(0,E.BX)(M.G,{css:lu.iconText,children:[(0,E.tZ)(t0.Z,{size:12,color:F.TV.blurpleDefault}),(0,E.tZ)(eT.xv,{variant:"small",color:"dimmest",children:"AI is writing"})]}):(0,E.tZ)(eT.xv,{variant:"small",color:"dimmest",children:"Esc to close, Enter to submit"}),(0,E.tZ)(ls,{loading:t,disabled:n,onClick:r})]})}function lg(e){var t=e.onClose,n=e.loading,r=e.onSubmit,i=(0,k._)((0,O.useState)(""),2),o=i[0],a=i[1];return{value:o,setValue:a,onKeyDown:function(e){switch(e.key){case"Escape":e.preventDefault(),t();break;case"Enter":if(e.preventDefault(),n)break;e.shiftKey?a(function(e){return e+"\n"}):e.metaKey||r()}}}}var ly=function(e){var t=(0,k._)(e.children,2),n=t[0],r=t[1];return(0,E.BX)(M.G,{css:lu.footer,children:[(0,E.tZ)(M.G,{css:lu.footerLeft,children:n}),(0,E.tZ)(M.G,{css:lu.footerRight,children:r})]})},lb=function(e){var t=e.error;return(0,E.tZ)(eT.xv,{css:lu.error,children:t})},lZ=n(29217),lw=new eA.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.updateCodeBlock,i=e.acceptSuggestion,o=e.onClose,a=e.autoFocus,l=function(){d?(i(d),(null==u?void 0:u.id)&&(p(u.id),m(n.filePath)),(0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_ACCEPTED,{action:"GENERATE"})):g()},c=function(){w.current=C,s({chatMessage:{type:"generateCode",text:C,codeReference:n}})},s=(0,nY.ql)(),u=(0,n$.oQ)(n.filePath),d=le(u),f=(0,lt.tz)(),h=(0,lt.WS)(u),p=(0,lZ.$0)(),m=(0,lZ.PM)();(0,O.useEffect)(function(){return r(d)},[d,r]);var v=(0,O.useCallback)(function(){h&&u&&f({messageId:u.id})},[f,u,h]),g=(0,O.useCallback)(function(){v(),o()},[v,o]),y=!!((null==u?void 0:u.loading)||(null==u?void 0:u.streaming)),b=!!((null==u?void 0:u.stopReason)||(null==u?void 0:u.aborted)),Z=(0,O.useCallback)(function(){(0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"GENERATE"}),g()},[g]),w=(0,O.useRef)(null),x=lg({loading:y,onSubmit:function(){S?l():c()},onClose:Z}),C=x.value,_=x.setValue,k=x.onKeyDown,S=b&&w.current===C;return(0,E.BX)(lf,{requestMeasure:t,type:"generateCode",children:[(0,E.tZ)(lh,{value:C,onChange:function(e){return _(e.currentTarget.value)},placeholder:"Enter a prompt to generate new code",onKeyDown:k,autoFocus:a}),(0,E.BX)(ly,{children:[(0,E.BX)(E.HY,{children:[(0,E.tZ)(lm,{type:"generateCode"}),b?(0,E.tZ)(t7.hU,{alt:"Rerun the same prompt",onClick:function(){return c()},size:12,colorway:"grey",children:(0,E.tZ)(a6.Z,{})}):null]}),S?(0,E.BX)(E.HY,{children:[(0,E.tZ)(t9.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_DISCARDED,{action:"GENERATE"}),Z()}}),(0,E.tZ)(t9.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:l,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,E.tZ)(lv,{loading:y,disabled:!C,onClick:function(){y?v():c()}})]})]})}),lx=new eA.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.updateCodeBlock,i=e.acceptSuggestion,o=e.onClose,a=e.autoFocus,l=e.updateDiffSelection,c=function(){f?((0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_ACCEPTED,{action:"TRANSFORM"}),i(f)):g()},s=function(){x.current=_,u({chatMessage:{type:"transformCode",text:_,codeReference:n}})},u=(0,nY.ql)(),d=(0,nJ.iH)(n.filePath),f=le(d),h=(0,lt.tz)(),p=(0,lt.WS)(d);(0,O.useEffect)(function(){return r(f)},[f,r]);var m=(0,n4.Z)(l);(0,O.useEffect)(function(){if(d){var e=d.loading||d.streaming?Z.Suggestion:Z.Compare;m.current(e)}},[d,m]);var v=(0,O.useCallback)(function(){p&&d&&h({messageId:d.id})},[h,d,p]),g=(0,O.useCallback)(function(){v(),o()},[v,o]),y=!!((null==d?void 0:d.loading)||(null==d?void 0:d.streaming)),b=!!((null==d?void 0:d.stopReason)||(null==d?void 0:d.aborted)),w=(0,O.useCallback)(function(){(0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"TRANSFORM"}),g()},[g]),x=(0,O.useRef)(null),C=lg({loading:y,onSubmit:function(){T?c():s()},onClose:w}),_=C.value,k=C.setValue,S=C.onKeyDown,T=b&&x.current===_;return(0,E.BX)(lf,{requestMeasure:t,type:"generateCode",children:[(0,E.tZ)(lh,{value:_,onChange:function(e){return k(e.currentTarget.value)},placeholder:"Enter a prompt to modify selection",onKeyDown:S,autoFocus:a}),(0,E.BX)(ly,{children:[(0,E.BX)(E.HY,{children:[(0,E.tZ)(lm,{type:"transformCode"}),b?(0,E.tZ)(t7.hU,{alt:"Rerun the same prompt",onClick:function(){return s()},size:12,colorway:"grey",children:(0,E.tZ)(a6.Z,{})}):null]}),T?(0,E.BX)(E.HY,{children:[(0,E.tZ)(t9.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_DISCARDED,{action:"TRANSFORM"}),w()}}),(0,E.tZ)(t9.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:c,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,E.tZ)(lv,{loading:y,disabled:!_,onClick:function(){y?v():s()}})]})]})}),lC=n(74997),l_=n(92101),lk=n(22580),lS=n(39469),lE=n(475),lT=n(43409),lR=n(44124),lI=n(19615),lD=ex.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:function(){}}}),lG=new nX.j(function(e){return lD.of(e)}),lB=(0,tS.X)({root:[F.l0.colWithGap(8),F.l0.border({color:F.TV.outlineDimmest}),F.l0.p(8),F.l0.borderRadius(4)],header:[F.l0.rowWithGap(8),F.l0.align.center,F.l0.justify.spaceBetween,F.l0.minHeight(28)],headerLeft:[F.l0.flex.growAndShrink(1),F.l0.rowWithGap(8),F.l0.align.center],footer:[F.l0.rowWithGap(8),F.l0.align.center,F.l0.justify.end]}),lP=new eA.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.onReplyInChat,i=e.onClose,o=function(){c&&((0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_REGENERATED,{action:"EXPLAIN"}),a({responseId:c.id,action:"EXPLAIN"}))},a=(0,nY.Gd)(),l=(0,k._)((0,lR.Ni)(),1)[0],c=(0,lC.j)(n.filePath),s=(0,lt.tz)(),u=(0,lt.WS)(c),d=(0,O.useCallback)(function(){u&&c&&s({messageId:c.id})},[s,c,u]),f=(null==c?void 0:c.attribution)==="Assistant",h=!!((null==c?void 0:c.loading)||(null==c?void 0:c.streaming)),p=!!((null==c?void 0:c.stopReason)||(null==c?void 0:c.aborted)),m=null==c?void 0:c.error,v=(0,nf.Z)(function(){return(0,l_.BW)(null==c?void 0:c.id)},[null==c?void 0:c.id]);return(0,E.tZ)(ld,{requestMeasure:t,type:"explainCode",children:(0,E.BX)(M.G,{css:lB.root,dataCy:"ghostwriter-inline-explain-content",children:[(0,E.BX)(M.G,{css:lB.header,children:[(0,E.BX)(M.G,{css:lB.headerLeft,children:[(0,E.tZ)(lI.R,{advanced:"advanced"===l}),(0,E.tZ)(lT.As,{intent:"EXPLAIN"})]}),p?(0,E.tZ)(t7.hU,{alt:"Close",dataCy:"ghostwriter-inline-close",children:(0,E.tZ)(tQ.Z,{onClick:function(){return i()}})}):(0,E.tZ)(t9.zx,{iconLeft:(0,E.tZ)(lE.Z,{}),size:"small",text:"Stop",onClick:function(){return d()}})]}),h&&!h?(0,E.tZ)(t0.Z,{}):null,c?(0,E.tZ)(lk.J,{text:c.text,codeComponent:v}):null,f&&"string"==typeof m?(0,E.tZ)(lb,{error:m}):null,(0,E.tZ)(M.G,{css:lB.footer,children:p?(0,E.BX)(E.HY,{children:[(0,E.tZ)(eT.xv,{variant:"small",color:"dimmer",children:"Esc to close"}),(0,E.tZ)(t9.zx,{iconLeft:(0,E.tZ)(lS.Z,{}),variant:"outlined",size:"small",text:"Retry",onClick:function(){o()}}),(0,E.tZ)(t9.zx,{dataCy:"ghostwriter-inline-reply-in-chat",iconLeft:(0,E.tZ)(nj.Z,{}),size:"small",text:"Reply in Chat",colorway:"blurple",onClick:function(){(0,tw.j)(tw.U3.GHOSTWRITER_CHAT_INLINE_REPLY_IN_CHAT),r()}})]}):null})]})})});function lA(e,t){e.dispatch({effects:nq.Q.of(null),selection:{anchor:t.range.indexTo,head:t.range.indexTo}}),e.hasFocus||e.focus()}function lN(e,t){a8({view:e,insert:t,scrollIntoView:!0}),e.dispatch({effects:nq.Q.of(null)}),e.hasFocus||e.focus()}function lU(e,t){e.dispatch({effects:nq.h.of(t)})}function lL(e,t,n){e.dispatch({changes:{from:n.range.indexFrom,to:n.range.indexTo,insert:t},scrollIntoView:!0,effects:nq.Q.of(null),annotations:[r2.Z.of(!0),V.Iv.of("full")]}),e.hasFocus||e.focus()}function lO(e,t){return e.range.indexFrom===t.range.indexFrom&&e.range.indexTo===t.range.indexTo&&e.filePath===t.filePath&&e.fileVersion===t.fileVersion}var lX=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r,i=e.codeReference;return(0,eJ._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return lw.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return lA(e,t)},acceptSuggestion:function(t){return lN(e,t)},updateCodeBlock:function(t){return lU(e,t)},autoFocus:!0})},r.updateDOM=function(e,t){var n=this.codeReference;return lw.update(e,function(e){return(0,a5.ZP)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return lA(t,n)},e.acceptSuggestion=function(e){return lN(t,e)},e.updateCodeBlock=function(e){return lU(t,e)},e.autoFocus=!1})}),!0},r.eq=function(e){return lO(this.codeReference,e.codeReference)},n}(e_.l9),lM=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r,i=e.codeReference;return(0,eJ._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return lx.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return lA(e,t)},acceptSuggestion:function(n){return lL(e,n,t)},updateCodeBlock:function(t){lU(e,t)},updateDiffSelection:function(t){e.dispatch({effects:aX.of(t)})},autoFocus:!0})},r.updateDOM=function(e,t){var n=this.codeReference;return lx.update(e,function(e){return(0,a5.ZP)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return lA(t,n)},e.acceptSuggestion=function(e){return lL(t,e,n)},e.updateCodeBlock=function(e){return lU(t,e)},e.updateDiffSelection=function(e){t.dispatch({effects:aX.of(e)})},e.autoFocus=!1})}),!0},r.eq=function(e){return lO(this.codeReference,e.codeReference)},n}(e_.l9),lF=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r,i=e.codeReference;return(0,eJ._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return lP.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return lA(e,t)},onReplyInChat:function(){return e.state.facet(lD)()}})},r.updateDOM=function(e,t){var n=this.codeReference;return lP.update(e,function(e){return(0,a5.ZP)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return lA(t,n)}})}),!0},r.eq=function(e){return lO(this.codeReference,e.codeReference)},n}(e_.l9),lW=ex.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t&&t}}),lH=n(57678),lV=(0,tS.X)({root:[F.l0.rowWithGap(8),F.l0.border({color:F.TV.outlineDimmest}),F.l0.p(8),F.l0.borderRadius(4)],text:[F.l0.flex.growAndShrink(1)]}),lz=new eA.Jf(function(e){var t=e.onClose,n=e.requestMeasure;return(0,E.tZ)(ld,{requestMeasure:n,type:"ghostwriterKillswitch",children:(0,E.BX)(M.G,{css:lV.root,children:[(0,E.tZ)(M.G,{css:lV.text,children:(0,E.tZ)(lH.r,{textVariant:"text"})}),(0,E.tZ)(t7.hU,{alt:"Close",onClick:t,type:"button",children:(0,E.tZ)(tQ.Z,{})})]})})}),lj=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e){var r,i=e.codeReference;return(0,eJ._)(this,n),(r=t.call(this)).codeReference=i,r}return n.prototype.toDOM=function(e){var t=this;return lz.create({onClose:function(){return lA(e,t.codeReference)},requestMeasure:function(){return e.requestMeasure()}})},n}(e_.l9),lq=ih.TV.blurpleDimmest,lY=ih.TV.accentPrimaryDimmest,l$=e_.tk.theme({".cm-pocket-highlight":{backgroundColor:"rgba(120, 95, 255, 0.2)"},"@keyframes moveGradient":{"0%":{backgroundPositionX:"100%"},"100%":{backgroundPositionX:"0%"}},".cm-pocket-highlight-loading":{background:"linear-gradient(90deg, ".concat(ih.TV.blurpleDimmest,", ").concat(lY,", ").concat(lq,", ").concat(lY,")"),backgroundSize:"300% 100%",backgroundPositionX:"0%",animation:"moveGradient 2s linear infinite"}}),lJ=e_.tk.decorations.compute([aO.$,aM,tU.Yp],function(e){var t=e.field(aO.$),n=e.facet(tU.Yp);if(!t||!n||t.codeReference.filePath!==n)return e_.p.none;var r=e.doc.lineAt(t.codeReference.range.indexFrom).from,i={generateCode:lX,transformCode:lM,explainCode:lF,ghostwriterKillswitch:lj}[t.type],o=e_.p.widget({widget:new i({codeReference:t.codeReference}),block:!0,side:0}).range(r);return e_.p.set(o)}),lK=(0,e_.EY)({above:!1,update:function(e){return(0,rZ.a)(e,aO.$)},markers:function(e){var t=e.state.field(aO.$),n=e.state.facet(tU.Yp);if(!t||!n||t.codeReference.filePath!==n)return[];var r=t.codeReference.range.indexFrom,i=t.codeReference.range.indexTo,o=e.state.doc.lineAt(i);o.from>=r&&o.to===i&&i<e.state.doc.length&&(i+=1);var a=ex.jT.range(r,i),l=t.loading&&t.codeReference.range.indexFrom<t.codeReference.range.indexTo?"cm-pocket-highlight-loading":"cm-pocket-highlight";return e_.dc.forRange(e,l,a)}}),lQ=aL.compute([aO.$,aO.u,tU.Yp,aM],function(e){var t=e.field(aO.$),n=e.field(aO.u),r=e.facet(tU.Yp),i=e.field(aM);return t&&n&&r&&t.codeReference.filePath===r&&"transformCode"===t.type&&i===Z.Compare?ex.as.of({from:t.codeReference.range.indexFrom,to:t.codeReference.range.indexTo,insert:n},e.doc.length).apply(e.doc):null}),l0=ac.V.compute([aO.$,aO.u,tU.Yp],function(e){var t=e.field(aO.$),n=e.field(aO.u),r=e.facet(tU.Yp);return t&&n&&r&&t.codeReference.filePath===r&&"generateCode"===t.type?ex.as.of({from:t.codeReference.range.indexTo,to:t.codeReference.range.indexTo,insert:n},e.doc.length):null}),l1=new nX.j(function(e){return lW.of(e)}),l2=n(65662),l8=n(56981),l4=[l8.Gj,l8._j,l8.yK,l8.gm,l8.ZF],l3=[l8.ZF],l5=new nX.j(function(e,t){return t?null:(0,l2.ZP)({key:"mod",rules:e?l4:l3})}),l6=n(18059);function l9(e,t){var n=performance.now();tC.kg.time(e,n-t)}var l7=new nX.j(function(e){var t=e?.01:.001;return ex.Wl.highest(e_.tk.domEventHandlers({keydown:function(e){if(Math.random()<t){var n=e.timeStamp;requestAnimationFrame(function(){l9("editor input latency",n),"undefined"!=typeof requestIdleCallback?requestIdleCallback(function(){l9("editor input latency after layout",n)}):setTimeout(function(){l9("editor input latency after layout",n)})})}}}))}),ce=n(35895),ct=n(10122),cn=n(28009),cr=n(75595),ci=n(79530),co=n(49344),ca=n(80339),cl=(0,tS.X)({buttons:[F.l0.display.flex,F.l0.rowWithGap(4),F.l0.justify.end],input:[F.l0.colWithGap(4),F.l0.flex.grow(1)],gap:[F.l0.colWithGap(16)],label:[F.l0.color.foregroundDimmer,F.l0.fontSize(12),F.l0.height(24),F.l0.justify.center],flexRow:[F.l0.display.flex,F.l0.rowWithGap(8),F.l0.align.center]}),cc={fontFamily:"text-security-disc"},cs=M.K.label;function cu(e){var t=(0,eu.Z)().secrets,n=(0,O.useId)(),r=(0,O.useId)(),i=(0,k._)((0,O.useState)(""),2),o=i[0],a=i[1],l=(0,k._)((0,O.useState)(e.initialValue),2),c=l[0],s=l[1],u=(0,k._)((0,O.useState)(!1),2),d=u[0],f=u[1],h=(0,O.useRef)(null);return(0,O.useEffect)(function(){if(e.isOpen){var t;null===(t=h.current)||void 0===t||t.focus(),(0,tw.j)(tw.U3.PASTE_SCANNER_USED,{action:"modal_opened",provider:null==e?void 0:e.provider})}},[e.isOpen,null==e?void 0:e.provider]),(0,E.tZ)(ci.MT,{contain:!0,children:(0,E.tZ)(co.u,{isOpen:e.isOpen,onRequestClose:e.onCancel,children:(0,E.BX)(M.G,{css:cl.gap,children:[(0,E.tZ)(eT.xv,{variant:"subheadBig",multiline:!1,children:"Add a key name for your secret value"}),(0,E.BX)(M.G,{css:cl.flexRow,children:[(0,E.BX)(M.G,{css:cl.input,children:[(0,E.tZ)(cs,{css:cl.label,htmlFor:n,children:"Key"}),(0,E.tZ)(iN.II,{id:n,ref:h,value:o,onChange:function(e){return a(e.target.value)}})]}),(0,E.BX)(M.G,{css:cl.input,children:[(0,E.BX)(M.G,{css:cl.flexRow,children:[(0,E.tZ)(cs,{css:cl.label,htmlFor:r,children:"Value"}),(0,E.tZ)(t7.hU,{alt:"Toggle Secret",onClick:function(){return f(function(e){return!e})},tooltipPlacement:"top",children:d?(0,E.tZ)(D.Z,{}):(0,E.tZ)(ca.Z,{})})]}),(0,E.tZ)(iN.II,{id:r,value:c,onChange:function(e){return s(e.target.value)},style:d?void 0:cc})]})]}),(0,E.BX)(M.G,{css:cl.buttons,children:[(0,E.tZ)(t9.zx,{text:"Cancel",onClick:e.onCancel}),(0,E.tZ)(t9.zx,{colorway:"primary",text:"Save Secret",disabled:0===o.length||0===c.length,onClick:(0,eZ._)(function(){return(0,ew.Jh)(this,function(n){switch(n.label){case 0:return[4,t.writeSecret({key:o,value:c})];case 1:return n.sent(),e.onSaveSecret(o,c),(0,tw.j)(tw.U3.PASTE_SCANNER_USED,{action:"secret_created",provider:null==e?void 0:e.provider}),[2]}})})})]})]})})})}var cd=n(97411),cf=n(20573),ch=(0,tS.X)({hint:[F.l0.align.center,F.l0.border({color:F.TV.outlineDimmer,direction:"top"}),F.l0.color.foregroundDimmest,F.l0.display.flex,F.l0.flex.row,F.l0.px(8),F.l0.py(4),F.l0.rowWithGap(8)],info:[F.l0.p(8)],key:[F.l0.px(4)],wrapper:[F.l0.backgroundColor.backgroundHigher,F.l0.borderRadius(4),F.l0.cursor.default,F.l0.font.default],mobileButtons:[F.l0.flex.grow(1)],mobileHint:[F.l0.justify.center]}),cp={borderTop:"1px solid ".concat(F.TV.outlineDimmer),borderBottom:"1px solid ".concat(F.TV.outlineDimmer),borderRadius:0};function cm(e){return(0,E.BX)(M.G,{css:ch.wrapper,style:e.onMobile?cp:void 0,children:[(0,E.BX)(M.G,{css:ch.info,style:{textAlign:e.onMobile?"center":"inherit"},children:[(0,E.tZ)(M.G,{children:"The value you pasted looks like a secret."}),(0,E.tZ)(M.G,{children:e.supportsSecrets?"Store it securely using our Secrets feature.":"Anyone will be able to see this."})]}),e.onMobile?(0,E.tZ)(cg,(0,C._)({},e)):(0,E.tZ)(cv,(0,C._)({},e))]})}function cv(e){return(0,E.BX)(E.HY,{children:[e.supportsSecrets?(0,E.BX)(M.G,{css:ch.hint,onClick:e.onClickUseSecrets,children:[(0,E.tZ)(cd.Z,{}),"Press",(0,E.tZ)(M.G,{css:ch.key,children:(0,E.tZ)(n7.bM,{keyCombo:"Tab",small:!0})}),"to use Secrets"]}):null,(0,E.BX)(M.G,{css:ch.hint,onClick:e.onClickPasteAnyway,children:[(0,E.tZ)(cf.Z,{}),"Press",(0,E.tZ)(M.G,{css:ch.key,children:(0,E.tZ)(n7.bM,{keyCombo:"Enter",small:!0})}),"to paste anyway"]}),e.supportsSecrets?null:(0,E.BX)(M.G,{css:ch.hint,onClick:e.onClickUndo,children:[(0,E.tZ)(cf.Z,{}),"Press",(0,E.tZ)(M.G,{css:ch.key,children:(0,E.tZ)(n7.bM,{keyCombo:"Escape",small:!0})}),"to undo"]})]})}function cg(e){return(0,E.BX)(M.G,{css:[ch.hint,ch.mobileHint],children:[e.supportsSecrets?(0,E.tZ)(t9.zx,{css:ch.mobileButtons,iconLeft:(0,E.tZ)(cd.Z,{}),text:"Use Secrets",onClick:e.onClickUseSecrets,colorway:"primary"}):null,(0,E.tZ)(t9.zx,{css:ch.mobileButtons,iconLeft:(0,E.tZ)(cf.Z,{}),text:"Paste Anyway",onClick:e.onClickPasteAnyway}),e.supportsSecrets?null:(0,E.tZ)(t9.zx,{css:ch.mobileButtons,iconLeft:(0,E.tZ)(cd.Z,{}),text:"Undo",onClick:e.onClickUndo})]})}var cy=n(68004),cb=n(30249),cZ=(0,tS.X)({border:[F.l0.border({color:ih.TV.accentPrimaryDefault,direction:"y",width:1})],title:[F.l0.display.flex,F.l0.rowWithGap(8),F.l0.align.center,F.l0.justify.spaceBetween,F.l0.px(8),F.l0.pt(4),F.l0.font.default],wrapper:[F.l0.backgroundColor.backgroundRoot,F.l0.py(0),F.l0.position.relative,F.l0.zIndex(200)]});function cw(e){return(0,cy.Z)(e.onClose),(0,E.tZ)(ci.MT,{autoFocus:!0,contain:!0,children:(0,E.tZ)(M.G,{css:cZ.wrapper,children:(0,E.BX)(M.G,{css:cZ.border,children:[(0,E.BX)(M.G,{css:cZ.title,children:[(0,E.BX)(eT.xv,{multiline:!1,children:["Access the secret ",(0,E.tZ)("strong",{children:e.keyName}),":"]}),(0,E.tZ)(t7.hU,{alt:"Close",onClick:e.onClose,children:(0,E.tZ)(tQ.Z,{})})]}),(0,E.tZ)(iL.Tg,{background:"root",children:(0,E.tZ)(cb.Z,{keyName:e.keyName,filePath:e.filePath,onInsert:e.onInsert})})]})})})}var cx=ac.V.compute([ce.xg],function(e){var t=e.field(ce.xg).iter();if(null===t.value)return null;for(var n=[];null!==t.value;){var r=t.from,i=t.to,o=t.value;n.push({from:r,to:i,insert:o.result.secret}),t.next()}return n}),cC=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r){var i;return(0,eJ._)(this,n),(i=t.call(this)).secret=e,i.as=r,i}var r=n.prototype;return r.toDOM=function(e){var t=this,n=(0,eA.VV)((0,E.tZ)(cm,{supportsSecrets:e.state.facet(ce.$X),onMobile:"pocket"===this.as,onClickUseSecrets:function(){e.dispatch({effects:ce.Lo.of(t.secret)})},onClickPasteAnyway:function(){(0,ce.Pz)(e),e.focus()},onClickUndo:function(){e.dispatch({effects:ce.uh.of(t.secret.id)}),e.focus()}}));return"pocket"===this.as&&(n.style.zIndex="200",n.style.position="relative",this.adjustForGutter(n,e)),n},r.updateDOM=function(e,t){return this.adjustForGutter(e,t),!0},r.adjustForGutter=function(e,t){var n=t.dom.querySelector(".cm-gutters");e.style.marginLeft=n?"-".concat(n.clientWidth,"px"):"inherit"},n}(e_.l9),c_=cr.t.compute([ce.xv],function(e){var t=e.facet(tU.Yp),n=e.field(ce.xv);return n&&t?{key:"pasteScannerModal",node:function(e){var t;return(0,E.tZ)(cu,{isOpen:!0,initialValue:n.result.secret,provider:n.result.provider,onSaveSecret:(t=(0,eZ._)(function(t){var r,i,o,a,l;return(0,ew.Jh)(this,function(c){for(r=e.state.field(ce.xg).iter(),i=[];r.value;)o=r.from,a=r.to,(l=r.value).id===n.id&&(i.push(ce.uh.of(l.id)),i.push(ce.Yt.of({secret:t,from:o,to:a}))),r.next();return e.dispatch({effects:(0,S._)(i).concat([ce.ZB.of(null)])}),[2]})}),function(e){return t.apply(this,arguments)}),onCancel:function(){return e.dispatch({effects:ce.ZB.of(null)})}})}}:null}),ck=e_.tk.decorations.compute([ce.Do],function(e){var t=e.field(ce.Do).iter(),n=t.from,r=t.to,i=t.value,o=e.facet(tU.Yp);return i&&o?e_.p.set(e_.p.widget({widget:new cS(i.key,o),side:1,block:!0}).range(n,r)):e_.p.none}),cS=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r){var i;return(0,eJ._)(this,n),(i=t.call(this)).key=e,i.filePath=r,i}var r=n.prototype;return r.toDOM=function(e){var t=(0,eA.VV)((0,E.tZ)(cw,{keyName:this.key,filePath:this.filePath,onClose:function(){return e.dispatch({effects:ce.qs.of(null)})},onInsert:function(t){e.dispatch(e.state.changeByRange(function(e){return{range:ex.jT.cursor(e.from+t.length),changes:{from:e.from,to:e.to,insert:t}}})),e.focus(),(0,tw.j)(tw.U3.PASTE_SCANNER_USED,{action:"secret_key_inserted"})}}));return this.adjustForGutter(t,e),t},r.updateDOM=function(e,t){return this.adjustForGutter(e,t),!0},r.adjustForGutter=function(e,t){var n=t.dom.querySelector(".cm-gutters");e.style.marginLeft=n?"-".concat(n.clientWidth,"px"):"inherit"},n}(e_.l9),cE=[cx,(u=[ce.xv,ce.xg],d=function(e){return null!=e.field(ce.xv,!1)?null:e.field(ce.xg,!1)||null},[e_.hJ.compute(u,function(e){var t=d(e);if(!t||e.facet(cn.h))return null;for(var n=t.iter();n.value;){var r=function(){var e=new cC(n.value,"tooltip");return{v:{arrow:!0,pos:n.to,create:function(t){return{dom:e.toDOM(t)}}}}}();if("object"===(0,ct._)(r))return r.v}return null}),e_.tk.decorations.compute(u,function(e){var t=d(e);if(!t||!e.facet(cn.h))return e_.p.none;for(var n=t.iter();n.value;){var r=new cC(n.value,"pocket");return e_.p.set(e_.p.widget({widget:r,side:1,block:!0}).range(n.to,n.to))}return e_.p.none})]),c_,ck],cT=n(23394),cR=new nX.j(function(e){return[ce.$X.of(!e),ce.Do,ce.xg,ce.xv,cE,ce.Gv]}),cI=e_.tk.theme({"&":{contain:"size"},"& > .cm-scroller":{contain:"strict"}}),cD=e_.tk.theme({".cm-ruler-element":{backgroundColor:F.TV.backgroundHigher}}),cG=ex.QQ.define({create:function(e){return 0===e.doc.length},update:function(e,t){return t.docChanged?0===t.state.doc.length:e}}),cB=(0,e_.EY)({above:!1,class:"cm-ruler-layer",update:function(e){return(0,rZ.a)(e,cP,cG,rI.R)},markers:function(e){if(e.state.field(cG,!1))return[];var t=e.state.facet(cP);if(0===t.length)return[];var n=[],r=e.dom.getBoundingClientRect(),i=e.contentDOM.getBoundingClientRect().left-r.left,o=r.width-2,a=Math.max(r.height,e.contentHeight),l=!0,c=!1,s=void 0;try{for(var u,d=t[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=i+e.defaultCharacterWidth*f;h<o&&n.push(new e_.dc("cm-ruler-element",h,0,2,a))}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return n}}),cP=ex.r$.define({enables:[cG,cB,cD]}),cA=new nX.j(function(e){return e.map(function(e){return cP.of(e)})}),cN=n(21677),cU=n(8818),cL=e_.tk.theme({"& .cm-gutters.cm-minimap-gutter":{backgroundColor:ih.TV.backgroundDefault,borderLeft:"1px solid ".concat(ih.TV.backgroundHigher)},"& .cm-minimap-box-shadow":{boxShadow:"unset"}}),cO=ex.QQ.define({create:function(e){return 0===e.doc.length||e.doc.lines>1e3},update:function(e,t){return t.docChanged?0===t.state.doc.length||t.state.doc.lines>1e3:e}}),cX=new nX.j(function(e,t,n){var r=function(){return{dom:document.createElement("div")}};return e?null:[cL,cO,cU.a.compute([o4,cO],function(e){if(e.field(cO,!1)||"blocks"!==t&&"characters"!==t)return null;var i=e.field(o4,!1),o={};if(i)for(var a=1;a<=e.doc.lines;a++)switch(i.getLineChangeType(a)){case o1.dQ.COVERED:o[a]=n.values.global.greenDefault;break;case o1.dQ.MODIFIED:o[a]=n.values.global.blueDefault}return{create:r,displayText:t,gutters:[o]}})]}),cM=n(53304),cF=n.n(cM),cW="".concat('url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><circle cx="10" cy="10" r="10" fill="black" /></svg>\')',", linear-gradient(transparent, transparent)"),cH="".concat('url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none" d="M2.5 10H15.5M15.5 10L9.5 5M15.5 10L9.5 15M18 4V16"/></svg>\')',", linear-gradient(transparent, transparent)"),cV=e_.tk.theme({".cm-vws-space":{backgroundColor:F.TV.foregroundDimmest,maskImage:cW,maskSize:"0.375ch",maskPosition:"center",maskRepeat:"no-repeat","-webkit-mask-image":cW,"-webkit-mask-size":"0.375ch","-webkit-mask-position":"center","-webkit-mask-repeat":"no-repeat","&.cm-vws-leading":{opacity:.325},"&.cm-vws-enclosed":{opacity:.5},"&.cm-vws-trailing":{opacity:.5},"&.cm-vws-selected":{opacity:.75}},".cm-vws-tab":{backgroundColor:F.TV.foregroundDimmest,maskImage:cH,maskSize:"1.75ch 1.75ch",maskPosition:"center",maskRepeat:"no-repeat","-webkit-mask-image":cH,"-webkit-mask-size":"1.75ch 1.75ch","-webkit-mask-position":"center","-webkit-mask-repeat":"no-repeat","&.cm-vws-leading":{opacity:.325,maskPosition:"left min(95%, 0.25ch) top 50%","-webkit-mask-position":"left min(95%, 0.25ch) top 50%"},"&.cm-vws-enclosed, &.cm-vws-trailing":{opacity:.5,maskPosition:"calc(50% - 0.25ch) 50%","-webkit-mask-position":"calc(50% - 0.25ch) 50%"},"&.cm-vws-selected":{opacity:.75}}}),cz=cF()(function(e,t,n){var r="cm-vws-".concat(" "===e?"space":"tab"," cm-vws-").concat(t).concat(n?" cm-vws-selected":"");return e_.p.mark({class:r})},function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)});function cj(e,t,n){var r=e.facet(c$);if(!r.leading&&!r.enclosed&&!r.trailing&&!r.selected)return[];for(var i=[],o=e.doc.lineAt(t),a=e.doc.lineAt(n),l=o.number;l<=a.number;l++)!function(o){var a=e.doc.line(o),l=a.text.length;if(0!==l){var c=0===a.text.trim().length,s=!!r.selected&&e.selection.ranges.some(function(e){return!e.empty&&e.from<a.to&&e.to>=a.from});if(r.leading||r.enclosed||r.trailing||s){if(c){if(r.leading||r.trailing||s)for(var u=0;u<l;u++)!function(o){var l=a.text[o],c=a.from+o;if(!(c<t)&&!(c>=n)&&(" "===l||"	"===l)){var u=s&&e.selection.ranges.some(function(e){return e.from<=c&&e.to>c});(r.leading||r.trailing||u)&&i.push(cz(l,"trailing",u).range(c,c+1))}}(u);return}for(var d=l-a.text.trimStart().length,f=a.text.trim().length,h=0;h<l;h++)!function(o){var l=a.text[o],c=a.from+o;if(!(c<t)&&!(c>=n)&&(" "===l||"	"===l)){var u=void 0;u=o>=d+f?"trailing":o>d?"enclosed":"leading";var h=s&&e.selection.ranges.some(function(e){return e.from<=c&&e.to>c});(r[u]||h)&&i.push(cz(l,u,h).range(c,c+1))}}(h)}}}(l);return i}var cq=function(){"use strict";function e(t){(0,eJ._)(this,e),this.decorations=e_.p.set(cj(t.state,0,t.state.doc.length))}return e.prototype.update=function(e){if((0,rZ.a)(e,c$)){this.decorations=e_.p.set(cj(e.state,0,e.state.doc.length));return}var t=e.state.facet(c$);if(e.docChanged||e.selectionSet&&t.selected){var n=this.decorations,r=null,i=null;if(e.selectionSet&&t.selected){var o=e.startState.selection.ranges.filter(function(e){return!e.empty}),a=(0,S._)(e.state.selection.ranges).concat((0,S._)(e.startState.selection.map(e.changes).ranges)).filter(function(e){return!e.empty});o.length&&(r=ex.jT.create(o)),a.length&&(i=ex.jT.create(a))}if(e.docChanged&&e.changes.iterChangedRanges(function(t,n,o,a){var l=ex.jT.range(e.startState.doc.lineAt(t).from,e.startState.doc.lineAt(n).to);r=r?r.addRange(l):ex.jT.create([l]);var c=ex.jT.range(e.state.doc.lineAt(o).from,e.state.doc.lineAt(a).to);i=i?i.addRange(c):ex.jT.create([c])}),r){var l=r.ranges;n=n.update({filter:function(e,t){return!l.some(function(n){return n.from<=e&&n.to>=t})},filterFrom:l[0].from,filterTo:l[l.length-1].to})}e.docChanged&&(n=n.map(e.changes)),i&&(n=n.update({add:i.ranges.map(function(t){return cj(e.state,t.from,t.to)}).flat()})),this.decorations=n}},e}(),cY=e_.lg.fromClass(cq,{decorations:function(e){return e.decorations}}),c$=ex.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:{}},enables:[cV,ex.Wl.highest(cY)]}),cJ=new nX.j(function(e,t,n,r){return e||t||n||r?c$.of({leading:e,enclosed:t,trailing:n,selected:r}):null}),cK=n(52590),cQ=n(91479),c0=n(72067),c1=n(39426),c2=new nX.j(function(e,t,n,r,i){if(!t||!n)return[];var o,a=cQ.Lf.of({deprecated:!0,format:(o=(0,eZ._)(function(n){var r;return(0,ew.Jh)(this,function(i){return 0===n.length?[2,{result:n.toString()}]:(r=nU.Z.from(n.toString()).toBuffer(),[2,t.request({file:{path:e,content:r}}).then(function(e){return e.error||!e.file?{error:!0}:{result:nU.Z.from(e.file.content).toString()}})])})}),function(e){return o.apply(this,arguments)}),identifier:"formatter_service",onError:function(){r("Sorry, formatting ".concat(e," failed"),1500)},onSuccess:function(){i("Formatted ".concat(e," successfully"),1500)}});return ex.Wl.lowest(a)}),c8=n(31384),c4=n(58962),c3=n(9069),c5=n(23896),c6=n(15482),c9=n(21084),c7=n(1660),se=new nX.j(function(e,t,n,r,i,o,a,l,c,s,u){return t?t.formatters.map(function(t){var d,f,h;return 2===(f=t.id.split("/")).length&&f[1].includes("languageServer")&&(null==r?void 0:r.isSupportedFile(c))?r&&r.isSupportedFile(c)&&i&&i.isFormatSupported&&l?c3.Lf.of({format:(h=(0,eZ._)(function(e){return(0,ew.Jh)(this,function(t){return[2,r.request.format(c,{insertSpaces:o,tabSize:a}).then(function(t){return"error"in t||t.cancelled||!t.result?{error:!0}:{result:(0,c9.Z)(t.result,e.toString())}})]})}),function(e){return h.apply(this,arguments)}),identifier:r.clientId,name:r.clientName,onError:function(){u("Sorry, formatting ".concat(c," failed"),1500)},onSuccess:function(){s("Formatted ".concat(c," successfully"),1500)}}):[]:(0,c6.F)(c,t)&&e?c3.Lf.of({format:(d=(0,eZ._)(function(e){var r,i,o,a,l;return(0,ew.Jh)(this,function(s){switch(s.label){case 0:if(!t.startCommand)throw Error("Expected formatter command");return r=(0,c7.Z)({container:n}),i=t.startCommand.args.map(function(e){return"$file"===e?c:e}),o="",a="",l=[r.onOutput(function(e){return o+=e}),r.onStderr(function(e){return a+=e}),r.dispose],[4,r.request((0,_._)((0,C._)({},t.startCommand),{args:i,lifecycle:c4.api.Exec.Lifecycle.STDIN,stdin:e.toString()})).then(function(e){var t=e.error;return l.forEach(function(e){return e()}),t?{error:!0,message:a}:{result:o}})];case 1:return[2,s.sent()]}})}),function(e){return d.apply(this,arguments)}),identifier:t.id,name:t.name,onSuccess:s,onError:u}):null}).filter(Boolean):null}),st=n(34880),sn=n(9331);function sr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(!e.valid)return[];for(var r=[],i=e.getCursor(t),o=i.next();!o.done&&r.length<n;)r.push(o.value),o=i.next();return r}var si=n(95571),so=n(68681),sa=n(94655),sl=n(6303),sc=n(50626);function ss(e){return e>420?"large":"small"}var su=M.K.div,sd=(0,tS.X)({root:[F.l0.rowWithGap(4),F.l0.px(4),F.l0.py(6),{borderBottom:"1px solid",borderColor:F.TV.outlineDimmest}],panelButtonWrapper:[F.l0.center,F.l0.height(32)],content:[F.l0.display.grid,F.l0.flex.growAndShrink(1),{gridTemplateAreas:'"search search-controls"',gridTemplateRows:"1fr",gridTemplateColumns:"1fr max-content",gap:F.TV.space8}],contentExpanded:[{gridTemplateAreas:'"search search-controls" "replace replace-controls"',gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr max-content"}],contentExpandedSmall:[{gridTemplateAreas:'"search" "search-controls" "replace" "replace-controls"',gridTemplateRows:"1fr max-content 1fr max-content",gridTemplateColumns:"1fr"}],contentSmall:[{gridTemplateAreas:'"search" "search-controls"',gridTemplateRows:"1fr max-content",gridTemplateColumns:"1fr"}],matchLabel:[F.l0.position.absolute,F.l0.top(0),F.l0.right(0),F.l0.height("100%"),F.l0.center,F.l0.pr(4)],inputControlsSmall:[F.l0.colWithGap(8),F.l0.flex.growAndShrink(1)],searchInputWrapper:[F.l0.position.relative,{gridArea:"search"}],searchControls:[F.l0.display.flex,F.l0.align.center,F.l0.rowWithGap(8),F.l0.flex.wrap,{gridArea:"search-controls"}],replaceInputWrapper:[{gridArea:"replace"}],replaceControls:[F.l0.display.flex,F.l0.align.center,F.l0.rowWithGap(8),F.l0.flex.wrap,{gridArea:"replace-controls"}],searchSettings:F.l0.flex.row,jumpIconButton:[F.l0.height(32),F.l0.width(32)]}),sf=new eA.Jf(O.forwardRef(function(e,t){var n=e.view,r=e.query,i=e.updateQuery,o=(0,k._)(O.useState(!1),2),a=o[0],l=o[1],c=(0,k._)(O.useState([]),2),s=c[0],u=c[1],d=(0,k._)(O.useState(null),2),f=d[0],h=d[1],p=s.length,m=(0,n4.Z)(r),v=(0,n4.Z)(s);function g(){(0,st.g)(n);var e=n.state.selection.main;n.dispatch({effects:e_.tk.scrollIntoView(e.from,{y:"center",x:"center"})}),p<=1||h(function(t){if(null===t){var n=s.findIndex(function(t){return t.from===e.from&&t.to===e.to});return -1===n?1:n+1}return t>=p?1:t+1})}function y(){(0,st.a7)(n);var e=n.state.selection.main;n.dispatch({effects:e_.tk.scrollIntoView(e.from,{y:"center",x:"center"})}),p<=1||h(function(t){if(null===t){var n=s.findIndex(function(t){return t.from===e.from&&t.to===e.to});return -1===n?1:n+1}return t<=1?p||1:t-1})}O.useImperativeHandle(t,function(){return{onSelectionSet:function(){var e=n.state.selection.main,t=v.current.findIndex(function(t){return t.from<=e.anchor&&t.to>=e.anchor});h(-1!==t?t+1:null)},onDocChanged:function(){u(sr(m.current,n.state.doc)),h(null)},onExpandRequested:function(){l(!0)}}},[n,m,v]),O.useEffect(function(){var e=sr(r,n.state.doc);u(e);var t=n.state.selection.main,i=e.findIndex(function(e){return e.from<=t.anchor&&e.to>=t.anchor});h(-1!==i?i+1:null)},[n,r]);var b=(0,k._)(O.useState(ss(0)),2),Z=b[0],w=b[1],x=(0,i1.Z)(function(e){e.width&&w(ss(e.width))});function C(e){return(0,e_.$1)(n,e,"search-panel")}var _=p>0,S=r.search.length>0?"0 / 0":null,T=_?"".concat(f||1," / ").concat(p):S,R=T?8*T.length:null,I=(0,E.BX)(M.G,{css:sd.searchSettings,children:[(0,E.tZ)(so.Z,{alt:"case sensitive",icon:(0,E.tZ)(sc.Z,{}),checked:r.caseSensitive,onClick:function(){i({caseSensitive:!r.caseSensitive})}}),(0,E.tZ)(so.Z,{alt:"regular expressions",icon:(0,E.tZ)(sl.Z,{}),checked:r.regexp,onClick:function(){i({regexp:!r.regexp})}})]}),D=[sd.content];return"small"!==Z&&a?D.push(sd.contentExpanded):"small"===Z&&a?D.push(sd.contentExpandedSmall):"small"!==Z||a||D.push(sd.contentSmall),(0,E.tZ)(su,{ref:x,onKeyDown:function(e){C(e)&&e.preventDefault()},children:(0,E.BX)(iL.Tg,{elevated:!0,css:sd.root,children:[(0,E.tZ)(M.G,{css:sd.panelButtonWrapper,children:(0,E.tZ)(t7.hU,{alt:a?"Close replace panel":"Show replace panel",css:sd.jumpIconButton,onClick:function(){l(function(e){return!e})},children:(0,E.tZ)(sn.Z,{rotate:a?90:0,style:{transition:"200ms ease"}})})}),(0,E.BX)(M.G,{css:D,children:[(0,E.BX)(M.G,{css:sd.searchInputWrapper,children:[(0,E.tZ)(sa.h,{style:{padding:4,paddingRight:null!=R?R:void 0},placeholder:"Search",value:r.search,name:"search","main-field":"true",onKeyDown:function(e){if((0,si.j)(e)&&"f"===e.key){e.currentTarget.select();return}if(!("enter"!==e.key.toLowerCase()||C(e))){if(e.preventDefault(),e.shiftKey){y();return}g()}},onChange:function(e){i({search:e})}}),T?(0,E.tZ)(M.G,{css:sd.matchLabel,children:(0,E.tZ)(eT.xv,{variant:"small",color:"dimmest",multiline:!1,children:T})}):null]}),(0,E.BX)(M.G,{css:sd.searchControls,children:[(0,E.BX)(M.G,{css:F.l0.flex.row,children:[(0,E.tZ)(t7.hU,{css:sd.jumpIconButton,alt:"Previous",onClick:function(){y()},children:(0,E.tZ)(sn.Z,{rotate:-90})}),(0,E.tZ)(t7.hU,{css:sd.jumpIconButton,alt:"Next",onClick:function(){g()},children:(0,E.tZ)(sn.Z,{rotate:90})})]}),(0,E.tZ)(t9.zx,{text:"Select all",onClick:function(){(0,st.i3)(n),n.focus()}}),I]}),a?(0,E.BX)(E.HY,{children:[(0,E.tZ)(M.G,{css:sd.replaceInputWrapper,children:(0,E.tZ)(iN.II,{style:{padding:4},placeholder:"Replacement",name:"replace",value:r.replace,onKeyDown:function(e){"enter"!==e.key.toLowerCase()||C(e)||(e.preventDefault(),(0,st.K9)(n))},onChange:function(e){i({replace:e.target.value})}})}),(0,E.BX)(M.G,{css:sd.replaceControls,children:[(0,E.tZ)(t9.zx,{text:"Replace",onClick:function(){(0,st.K9)(n)}}),(0,E.tZ)(t9.zx,{text:"Replace all",onClick:function(){(0,st.ko)(n)}})]})]}):null]}),(0,E.tZ)(M.G,{css:sd.panelButtonWrapper,children:(0,E.tZ)(t7.hU,{alt:"Close Search Panel",tooltipHidden:!0,onClick:function(){(0,st.N$)(n)},children:(0,E.tZ)(tQ.Z,{})})})]})})})),sh=ex.Py.define(),sp=[(0,st.yC)({createPanel:function(e){var t=!1,n=!1,r=!1,i=!1,o=!1,a=function(t){var n,r,i,o,a,l,c=(0,st.uP)(e.state),s=new st.Jb({search:null!==(n=t.search)&&void 0!==n?n:c.search,caseSensitive:null!==(r=t.caseSensitive)&&void 0!==r?r:c.caseSensitive,literal:null!==(i=t.literal)&&void 0!==i?i:c.literal,regexp:null!==(o=t.regexp)&&void 0!==o?o:c.regexp,replace:null!==(a=t.replace)&&void 0!==a?a:c.replace,wholeWord:null!==(l=t.wholeWord)&&void 0!==l?l:c.wholeWord});s.eq(c)||e.dispatch({effects:st.ql.of(s)})},l=sf.create({view:e,query:(0,st.uP)(e.state),updateQuery:a});return{dom:l,top:!0,update:function(t){(0,rZ.a)(t,st.ql)&&sf.set(l,{view:e,query:(0,st.uP)(t.state),updateQuery:a}),t.selectionSet&&!i&&(i=!0,requestAnimationFrame(function(){if(!n){var e;i=!1,null===(e=sf.ref(l))||void 0===e||e.onSelectionSet()}})),t.docChanged&&!r&&(r=!0,requestAnimationFrame(function(){if(!n){var e;r=!1,null===(e=sf.ref(l))||void 0===e||e.onDocChanged()}})),(0,rZ.a)(t,sh)&&!o&&(o=!0,requestAnimationFrame(function(){if(!n){var e;o=!1,null===(e=sf.ref(l))||void 0===e||e.onExpandRequested()}}))},mount:function(){t||(t=!0,requestAnimationFrame(function(){if(!n){t=!1;var e=l.querySelector("[main-field]");e&&(e.focus(),e.select())}}))},destroy:function(){return n=!0}}}}),e_.$f.of([{win:"Ctrl-h",linux:"Ctrl-h",preventDefault:!0,run:function(e){return!!((0,st.Ep)(e.state)||(0,st.nx)(e))&&(e.dispatch({effects:sh.of(null)}),!0)}}])],sm=n(72282),sv=n.n(sm),sg=new Set,sy=sv()(function(){var e=!0,t=!1,n=void 0;try{for(var r,i=sg[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;(0,tw.j)(tw.U3.WS_TYPED,{fileExt:o})}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}sg.clear()},18e4),sb=e_.tk.updateListener.of(function(e){if(e.docChanged){var t=e.state.facet(tU.Yp);if(t){var n=(0,nB.r6)(t)||(0,nB.UO)(t);!e.transactions.some(function(e){return e.annotation(ex.YW.remote)})&&(sg.has(n)||(sg.add(n),sy()))}}}),sZ=n(31270),sw=(0,tS.X)({root:[F.l0.p(16),F.l0.align.center,F.l0.colWithGap(8),{marginTop:"10%",pointerEvents:"none","*":{pointerEvents:"all"}}],button:[F.l0.reset.button,F.l0.rowWithGap(4),F.l0.align.center,F.l0.color.foregroundDimmest,F.l0.cursor.pointer,{fontFamily:F.TV.fontFamilyDefault,"*":{borderColor:F.TV.foregroundDimmest,color:F.TV.foregroundDimmest},":hover *":{borderColor:F.TV.foregroundDefault,color:F.TV.foregroundDefault}}]}),sx={layer:"cm-empty-state-layer",dom:"cm-empty-state-dom"},sC=e_.tk.theme((w={},(0,eq._)(w,".".concat(sx.layer),{width:"100%",height:"100%",pointerEvents:"none",zIndex:"201 !important"}),(0,eq._)(w,".".concat(sx.dom),{position:"absolute",width:"100%",pointerEvents:"none",display:"flex",justifyContent:"center"}),w)),s_=function(){"use strict";function e(t){(0,eJ._)(this,e),this.options=t}var t=e.prototype;return t.draw=function(){var e=this.options,t=e.ctas,n=e.view,r=e.width,i=(0,eA.VV)((0,E.tZ)(M.G,{css:sw.root,children:t.map(function(e){return(0,E.BX)(M.G,{css:sw.button,onClick:function(){return e.onClick(n)},children:[e.icon,(0,E.tZ)(eT.xv,{variant:"small",children:e.text}),e.shortcut?(0,E.tZ)(n7.bM,{keyCombo:e.shortcut,small:!0}):null]},e.text)})}));return i.className=sx.dom,i.style.width=r+"px",i.style.visibility=r>240?"visibile":"hidden",i.style.left="0px",i},t.eq=function(e){return rx()(e.options,this.options)},e}(),sk=new nX.j(function(e){var t=function(e){var t;return!(e.doc.length>0||e.field(aO.$))&&(null===(t=e.field(ce.xg,!1))||void 0===t||!t.size)},n=ex.QQ.define({create:t,update:function(e,n){return t(n.state)}}),r=(0,e_.EY)({above:!0,class:sx.layer,update:function(e){return(0,rZ.a)(e,n)},markers:function(t){if(!t.state.field(n,!1))return[];var r=t.dom.getBoundingClientRect();return[new s_({ctas:e,width:Math.round(t.contentDOM.getBoundingClientRect().right-r.left),view:t})]}});return[sC,n,r]}),sS=n(73164),sE=n(75582),sT=n(93295),sR=n(23982),sI=n(66039);function sD(){var e=(0,sT._)(["\n  query EditorEmptyStateCurrentUser {\n    currentUser {\n      id\n      userSubscriptionType\n      userPowerUpsByType {\n        __typename\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n            CTA\n          }\n        }\n      }\n    }\n  }\n"]);return sD=function(){return e},e}var sG={},sB=(0,sR.Ps)(sD()),sP=n(88883),sA=n(73524),sN={python:'from replit.ai.modelfarm import ChatExample, ChatMessage, ChatModel, ChatSession\n\nmodel = ChatModel("chat-bison")\nresponse = model.chat([\n  ChatSession(\n    context="You are philosophy bot.",\n    examples=[\n      ChatExample(\n        input=ChatMessage(content="1 + 1"),\n        output=ChatMessage(content="2")\n      )\n    ],\n    messages=[\n      ChatMessage(author="USER", content="How much wood can a woodchuck chuck?"),\n    ],\n  )\n], temperature=0.2)\n\nprint(response.responses[0].candidates[0].message.content)',typescript:"import * as replitai from '@replit/ai-modelfarm';\n\nconst result = await replitai.chat({\n  model: 'chat-bison',\n  temperature: 0.5,\n  messages: [{ author: 'user', content: 'how are you?' }],\n});\n\nconsole.log(result);"};function sU(){var e=(0,sT._)(["\n  query ReplCodeExamples($language: String!) {\n    languageExamples(language: $language) {\n      ... on LanguageExamples {\n        examples {\n          ... on LanguageExample {\n            mainFile\n            name\n            code\n          }\n        }\n      }\n    }\n  }\n"]);return sU=function(){return e},e}var sL={},sO=(0,sR.Ps)(sU());function sX(e){var t=(0,C._)({},sL,e);return sI.a(sO,t)}var sM=n(29479),sF=n(4498),sW=M.K.button;function sH(e){var t=e.name,n=e.children,r=e.onClick;return(0,E.BX)(sW,{onClick:function(){return r()},css:[li.gU.nofill,F.l0.p(8),F.l0.focusRing,F.l0.textAlign.left],children:[(0,E.tZ)(eT.xv,{variant:"subheadDefault",css:F.l0.pb(16),multiline:!1,children:t}),(0,E.tZ)(M.G,{css:[F.l0.backgroundColor.backgroundDefault,F.l0.p(8),F.l0.borderRadius(8)],children:n})]})}var sV="@media (min-width: ".concat(sM.j.tabletMax,"px)"),sz=(0,iA.iv)([F.l0.colWithGap(16),(0,eq._)({},sV,{width:"calc(50%  - 8px)",flex:"0 0 auto",gap:"16px"})]);function sj(e){var t=e.children;return(0,E.tZ)(M.G,{css:[(0,eq._)({},sV,[F.l0.rowWithGap(16)])],children:t})}function sq(e){var t=e.mainFile,n=e.examples,r=e.onSelect;return(0,E.BX)(M.G,{css:[F.l0.colWithGap(24)],children:[(0,E.tZ)(eT.h4,{level:1,variant:"headerDefault",children:"Code examples"}),(0,E.tZ)(eT.xv,{children:"Get started with some program examples."}),(0,E.BX)(sj,{css:[F.l0.colWithGap(16)],children:[(0,E.tZ)(M.G,{css:sz,children:n.slice(0,(n.length+1)/2).map(function(e){return(0,E.tZ)(sH,{name:e.name,onClick:function(){return r(e)},children:(0,E.tZ)(sF.Z,{code:e.code,filePath:t,fontSize:12,disableCursorStyling:!0})},e.name)})}),(0,E.tZ)(M.G,{css:sz,children:n.slice((n.length+1)/2).map(function(e){return(0,E.tZ)(sH,{name:e.name,onClick:function(){return r(e)},children:(0,E.tZ)(sF.Z,{code:e.code,filePath:t,fontSize:12,disableCursorStyling:!0})},e.name)})})]})]})}function sY(e){var t=e.filePath,n=e.language,r=e.onSelect,i=sX({variables:{language:n}}),o=i.data,a=i.loading,l=i.error;if(a)return(0,E.tZ)(M.G,{css:[F.l0.colWithGap(0),F.l0.justify.center,F.l0.align.center,F.l0.pt(32),F.l0.pb(32)],children:(0,E.tZ)(t0.Z,{})});if(l)return(0,E.tZ)(M.G,{css:[F.l0.colWithGap(0),F.l0.justify.center,F.l0.align.center,F.l0.pt(32),F.l0.pb(32)],children:l.message});var c=(null==o?void 0:o.languageExamples.__typename)==="LanguageExamples"?o.languageExamples.examples:null;return(null==c?void 0:c.length)?(null==c?void 0:c.length)?(0,E.tZ)(sq,{mainFile:t,examples:c,onSelect:r}):(0,E.tZ)(M.G,{css:[F.l0.colWithGap(0),F.l0.justify.center,F.l0.align.center,F.l0.pt(32),F.l0.pb(32)],children:(0,E.BX)(eT.xv,{children:["Sorry, this language doesnt have any examples. Want to add some? Contact us at ",(0,E.tZ)("a",{href:"mailto:support@replit.com",children:"support@replit.com"}),"!"]})}):null}var s$=n(917),sJ=n(70781),sK=ex.Py.define(),sQ=ex.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,eE.j)(t,sK,function(e){n=e.value}),n}}),s0=cr.t.from(sQ,function(e){if(!e)return null;var t=e.language,n=e.filePath;return{key:"examplesModal",node:function(e){var r=function(){e.dispatch({effects:sK.of(null)})};return(0,E.tZ)(co.u,{maxWidth:872,isOpen:!0,onRequestClose:r,children:(0,E.tZ)(s2,{onRequestClose:r,language:t,filePath:n})})}}}),s1=[sQ,s0];function s2(e){var t=e.onRequestClose,n=e.language,r=e.filePath,i=(0,sJ.e)(s$.y.Examples),o=(0,sJ.e)(s$.y.Editor),a=(0,k._)((0,O.useState)(!1),2),l=a[0],c=a[1],s=(0,sP.Z)(r),u=(0,O.useRef)(null==i?void 0:i.isActive),d=(0,O.useRef)();d.current=null==i?void 0:i.isActive;var f=(0,O.useRef)(null==i?void 0:i.goto);return(f.current=null==i?void 0:i.goto,(0,O.useEffect)(function(){return function(){var e;d.current&&(null===(e=f.current)||void 0===e||e.call(f,s$.y.Editor))}},[]),(0,O.useEffect)(function(){if((null==o?void 0:o.isActive)&&!u.current){if(!l){c(!0);return}o.goto(s$.y.Examples)}},[o,t,l]),(0,O.useEffect)(function(){if(null==i?void 0:i.isActive){u.current=!0;return}u.current&&t(null)},[t,null==i?void 0:i.isActive]),s)?(0,E.tZ)("div",{ref:null==i?void 0:i.delegateTooltip,children:(0,E.tZ)(sY,{filePath:r,language:n,onSelect:function(e){s({code:e.code,insertAt:0}),t({exampleName:e.name})}})}):(0,E.tZ)("div",{children:"Please make sure you have a file open"})}var s8=function(e){"use strict";(0,eK._)(n,e);var t=(0,e0._)(n);function n(e,r){var i;return(0,eJ._)(this,n),(i=t.call(this)).src=e,i.pos=r,i}var r=n.prototype;return r.eq=function(e){return this.src===e.src&&this.pos===e.pos},r.toDOM=function(){var e=document.createElement("img");return e.src=this.src,e.dataset.pos=this.pos.toString(),e.style.maxHeight="64px",e.style.maxWidth="256px",e},r.ignoreEvent=function(){return!1},n}(e_.l9),s4=/"data:image\/\w+;base64,[^"\s]+"/g,s3=Number.MAX_VALUE,s5=new nX.j(function(e){return e?e_.lg.define(function(e){var t=new e_.Y1({regexp:s4,decoration:function(e,t,n){if(void 0===e[0])throw Error("Failed to match image");var r=e[0].substring(1,e[0].length-1);return e_.p.replace({widget:new s8(r,n)})},maxLength:s3});return{matcher:t,deco:t.createDeco(e),update:function(e){e.docChanged&&(this.deco=t.updateDeco(e,this.deco))}}},{decorations:function(e){return e.deco},provide:function(e){return e_.tk.atomicRanges.of(function(t){var n=t.plugin(e);return n?n.deco:e_.p.none})}}):null}),s6=n(8131);function s9(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z,w,x,R,I,D,G,B,N,U,L,X,M,F,W,H,z,q,$,J,K,Q,ee,et,er,ei,eo,ea,eg,ex,eC,eS,eE,eT,eR,eI,eD,eG,eB,eP,eA,eN,eU,eL,eO,eX,eM,eF,eW,eH,ez,eq,eY,e$,eJ,eK,eQ,e0,e2,e8,e4,e3,e5,e6,e9,e7,te,tt,tn,tr,ti,to,ta,tl,tc,ts,tu,td,tf,th,tp,tm,tv,tg,ty,tb,tx,t_,tS,tE,tT,tR,tI,tD,tG,tB,tP,tA,tN,tL,tO,tX,tM,tF,tW,tV,tz,tj,tY,t$,tJ,tK,tQ,t0,t1,t2,t3,t6,t9,t7,nt,nn,nr,ni,na,nl,nc,nu,nh,np,nm,nv,nD,nG,nP,nA,nN,nU,nX,nq,n$,nJ,rr,ro,rc,rp,rv,rg,ry,rb,rZ,rw,rx,rC,r_,rk,rS,rE,rT,rI,rD,rG,rB,rP,rA,rN,rU,rL,rO,rX,rM,rF,rW,rH,rV,rz=e.filePath,rj=e.autoFocus,rq=e.isHidden,rY=e.deeplink,rJ=e.onDeeplinkUpdated,r0=e.openFile,r2=e.openThreadsInbox,r3=e.openPane,r5=(0,eu.Z)(),r6=r5.fs,r9=r5.debuggest,ia=r5.presence,id=r5.runner,iv=(0,eb.Z)().preferences,ig=(0,al.Z)(),iy=ig.ref,ib=ig.view;(0,Y.VD)(ib),(0,cK.g)(ib);var iZ=(0,r1.uV)(),iw=(0,l6.FS)(),ix=r8.M.use(!!(null==iw?void 0:iw.match(/Chrome/i))&&!!(null==iw?void 0:iw.match(/Android/i))),iC=(0,tH.P5)({controlName:"flag-ultra-hardcore",logFlagToAnalytics:!1}),i_="/replEnvironmentDesktop"===A().pathname,ik=(0,O.useContext)(ai.B3),iS=(0,r1.jT)(),iE=(eT=(eE={path:rz,isHidden:rq}).path,eR=eE.isHidden,eI=(0,oS.NH)(),eD=oT.use(eI),eG=oR.use(eI),(0,O.useEffect)(function(){eI(eT,{type:eR?"hidden":"unhidden"})},[eR,eI,eT]),(0,O.useEffect)(function(){return function(){eI(eT,{type:"unmount"})}},[eI,eT]),(0,O.useMemo)(function(){return[eD,eG]},[eD,eG])),iT=(eA=(eB={view:ib,presence:ia,fs:r6,filePath:rz}).view,eN=eB.presence,eU=eB.fs,eL=eB.filePath,eO=r$.use(eL,eU,eN),eX=rK.use(eN),eM=(0,rQ.Z)().trackTimeToLoadFileEnd,eF=(0,r1.uV)(),eW=(0,r1.Id)(),eH=(0,r1.I7)(),ez=(0,O.useMemo)(function(){return{trackTimeToLoadFileEnd:eM,throwBsod:eF,setBsodFilePathVersion:eW,deleteBsodFilePathVersion:eH}},[eH,eW,eF,eM]),eq=r7.use(eL,eU,ez),eY=null===(eP=(0,ie.IK)(eA,r4.o))||void 0===eP||eP,e$=(0,O.useMemo)(function(){return[eq,eO,eX]},[eq,eO,eX]),(0,O.useMemo)(function(){return{isLoading:eY,extensions:e$}},[eY,e$])),iR=iT.isLoading,iI=iT.extensions;eK=(eJ={view:ib,autoFocus:rj,isLoading:iR}).view,eQ=eJ.isLoading,e0=eJ.autoFocus,O.useEffect(function(){e0&&eK&&!eQ&&eK.focus()},[eK,eQ,e0]),e8=(e2={view:ib,filePath:rz,isLoading:iR}).view,e4=e2.filePath,e3=e2.isLoading,e5=(0,ii.Z)(),e6=function(){var e=(0,O.useContext)(it.ZP);if(!e)throw Error("Expected codemirror state to be in codemirror state context");return e}(),e9=(0,eh.Z)({view:e8}),(0,O.useEffect)(function(){var e,t=function(e){var t,r=e6.current.fileMap.get(n),i=null!==(t=null==r?void 0:r.scrollPos)&&void 0!==t?t:0;e6.current.fileMap.set(n,{scrollPos:i,editorState:e}),a()};if(e8&&!e3){var n="".concat(e5,":").concat(e4),r=e6.current.fileMap.get(n);if(r&&e8.state.doc.eq(r.editorState.doc)){if(e8.state.field(V.cE,!1))throw Error("History was preconfigured on this view, if you want to use state cache, please make sure history is not already configured for this view");var i=[];(0,e1.q2)(r.editorState).between(0,e8.state.doc.length,function(e,t){i.push(e1.SW.of({from:e,to:t}))}),e8.dispatch({effects:(0,S._)(i).concat([e_.tk.scrollIntoView(r.scrollPos,{y:"start"})]),selection:r.editorState.selection}),e=[V.cE.init(function(){return r.editorState.field(V.cE)}),(0,V.m8)()]}else e=(0,V.m8)();var o=!1,a=j()(function(){var e;(null!==(e=globalThis.requestIdleCallback)&&void 0!==e?e:globalThis.requestAnimationFrame)(function(){ir.Z.set("stateCache",(0,it.oZ)(e6.current))})},500),l={read:function(e){if(!o){var t=e6.current.fileMap.get(n);if(t){var r=function(e){var t=e.scrollDOM.getBoundingClientRect();if(0===t.top&&0===t.bottom)return null;var n=t.top+e.defaultLineHeight;return e.posAtCoords({x:0,y:n},!1)}(e);null===r||r>t.editorState.doc.length||(e6.current.fileMap.set(n,(0,_._)((0,C._)({},t),{scrollPos:r})),a())}}}},c=!1;return e8.dispatch({effects:e9.reconfigure([e,e_.tk.updateListener.of(function(e){!o&&(t(e.state),c||(c=!0,e.view.requestMeasure(l),setTimeout(function(){return c=!1},500)))})])}),function(){o=!0,e8.dispatch({effects:e9.reconfigure([])})}}},[e8,e4,e6,e3,e9]),(0,oi.Y)({view:ib});var iD=(0,nY.ql)();te=(e7={view:ib,filePath:rz,isLoading:iR,openFile:r0,askGhostwriter:(0,O.useCallback)(function(e){r3({type:"ghostwriterChat"}),iD({chatMessage:e})},[iD,r3])}).view,tt=e7.filePath,tn=e7.isLoading,tr=e7.openFile,ti=e7.askGhostwriter,to=(0,eb.Z)().preferences.codeIntelligence,ta=(0,eu.Z)().fs,tc=ey(tl=(0,ev.Z)(tt)),ts=tn||!to||!te||!tl||!tc||!tl.isSupportedFile(tt),tu=(0,eh.Z)({view:te}),td=tq.b.use(tc),tf=rR.use(ta,tl,tt,tc,tr,ti),O.useEffect(function(){if(ts){te&&!to&&te.dispatch((0,ej._c)(te.state));return}return te.dispatch({effects:tu.reconfigure([td,tf])}),function(){te.dispatch({effects:tu.reconfigure([(0,ej.wB)()])})}},[td,tf,to,tu,ts,te]),tp=(th={view:ib,debuggest:r9,filePath:rz,isLoading:iR}).view,tm=th.debuggest,tv=th.filePath,tg=th.isLoading,ty=(0,eu.Z)().fs,tb=(0,ef.Z)(),tx=(0,ec.Z)(tm.mainClient),t_=(0,eh.Z)({view:tp}),O.useEffect(function(){if(!tg&&tb&&tx&&tp){var e=(0,ed.ZF)("/home/runner/".concat(tb.slug,"/").concat(tv)),t=(0,es.Rr)(tp,tx,e,ty),n=t.extensions,r=t.dispose;return tp.dispatch({effects:t_.reconfigure(n)}),function(){tp.dispatch({effects:t_.reconfigure([])}),r()}}},[tx,tp,tb,tv,tg,ty,t_]),(0,em.Z)({filePath:rz,view:ib,isLoading:iR,deeplink:rY,onDeeplinkUpdated:rJ});var iG=s5.use((0,el.f6)()),iB=(tT=(tS={view:ib,filePath:rz}).view,tR=tS.filePath,tI=(0,eu.Z)().fs,tD=(0,el.xZ)(null!==(tE=null==tT?void 0:tT.state.facet(tU.Yp))&&void 0!==tE?tE:null),(0,k._)((0,oo.L)({accept:[en.z.Code,oa.FILE],drop:function(e,t){if(tT){var n=t.getClientOffset(),r=n?tT.posAtCoords(n):null;if(null!==r){var i=function(e){tT.focus(),tT.dispatch({changes:{from:r,insert:e},selection:{anchor:r,head:r+e.length}})};if(e.type===en.z.Code)i(e.code);else{var o=!0,a=!1,l=void 0;try{for(var c,s=e.files[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;tD?(0,nI.L0)(u).then(function(e){return i('"'+e+'"')}):tR&&(0,nB.gK)(tR)&&nL(u,tI,tR).then(i)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}}}}}}),2)[1]);(0,ep.Z)({view:ib,filePath:rz});var iP=(tB=(tG={view:ib,filePath:rz,isLoading:iR,enable:i_,openThreadsInbox:r2}).view,tP=tG.filePath,tA=tG.isLoading,tN=tG.enable,tL=tG.openThreadsInbox,tO=(0,iu.kM)(),O.useEffect(function(){tB&&tO&&tB.dispatch({effects:[is.YM.of(tO),is.eR.of(tO)]})},[tB,tO]),tX=(0,im.F)().theme,tF=(tM=(0,k._)(O.useState([ih.TV.accentPrimaryDimmest,ih.TV.accentPrimaryDimmer]),2))[0],tW=tM[1],O.useEffect(function(){var e=tX.values.global.accentPrimaryDimmest,t=(0,ip.w)(e);tW(["rgba(".concat(t.join(","),", 0.5)"),ih.TV.accentPrimaryDimmer])},[tX]),tV=ic(tP,tA,!0,tN),tz=(0,eu.Z)().fs,tY=(tj=(0,io.kL)(tP)).contentRef,t$=tj.loadedFile,tJ=tj.transformSelectionRef,O.useEffect(function(){var e=!1,t=tJ.current,n=tY.current;if(t$&&t&&n&&!tA&&tB){var r=Object.values(tV);if(0===r.length){tB.dispatch({effects:is.qi.of({})});return}Promise.all(r.map(function(e){return(0,io.Ft)({anchor:e,version:tz.getOTVersion(tP),transformSelection:t,content:n})})).then(function(t){if(!e){var n=t.filter(function(e){return!!e}).map(function(e){if(!e)throw Error("expected resolved anchor");return(0,C._)({},e.anchor,null==e?void 0:e.newSelection)});return tB.dispatch({effects:is.qi.of(n.reduce(function(e,t){return e[t.id]=t,e},{}))}),function(){e=!0,tB&&tB.dispatch({effects:is.qi.of({})})}}})}},[tV,tB,t$,tz,tJ,tY,tP,tA]),on.use(tN,tF,tL));tQ=(tK={view:ib,filePath:rz}).view,t0=tK.filePath,t1=(0,P.useRouter)(),t2=(0,T.Vg)(t1),t3=(0,O.useRef)({revisionId:oc()(),textEditorState:om(t0),hasGhostwriterSuggestion:!1}),t6=(0,O.useRef)(t0),t9=(0,ow.Z)().engine,t7=(0,eh.Z)({view:tQ}),(0,O.useEffect)(function(){if(tQ&&t2){var e=ov(t0,tQ);t3.current={revisionId:oc()(),textEditorState:e,hasGhostwriterSuggestion:t3.current.hasGhostwriterSuggestion},og(t0,tQ,t3.current);var t=function(t){var n,r=(0,tZ.Z)(tQ.state),i=(null===(n=t3.current)||void 0===n?void 0:n.hasGhostwriterSuggestion)!==r;t.docChanged?(t3.current={revisionId:oc()(),textEditorState:e,hasGhostwriterSuggestion:r},og(t0,tQ,t3.current)):(t.selectionSet||t.focusChanged||i)&&(t3.current={revisionId:t3.current.revisionId,textEditorState:e,hasGhostwriterSuggestion:r},og(t0,tQ,t3.current))};return tQ.dispatch({effects:t7.reconfigure(e_.tk.updateListener.of(function(e){t(e)}))}),function(){tQ.dispatch({effects:t7.reconfigure([])})}}},[tQ,t0,t7,t2]),(0,O.useEffect)(function(){if(tQ&&t2){var e=function(e){og(t0,tQ,t3.current,e.messageId)},t=function(t){oZ(t0,t6.current,tQ,t3.current,t,t9)?e(t):(0,od.pl)(t.messageId)},n=function(t){oZ(t0,t6.current,tQ,t3.current,t,t9)?e(t):(0,od.pl)(t.messageId)},r=function(r){try{var i=r.data;if(!(0,os.CF)(i)||i.protocolVersion!==os.Wj)return;var o=i.payload;i.messageDirection===os.s1.TO_NATIVE&&(0,os.H7)(o)&&(t6.current=o.activePaneFilePath),(0,od.fp)(r,function(r){var o=r.type;switch(o){case os.cF.TEXT_EDITOR_STATE_REQUEST:e(i);break;case os.cF.REQUEST_SET_SELECTION:case os.cF.REQUEST_REPLACE_SELECTION:case os.cF.REQUEST_SET_TEXT:case os.cF.REQUEST_INSERT_TEXT:case os.cF.REQUEST_PASTE_TEXT:t(i);break;case os.cF.TEXT_EDITOR_REQUEST_ACTION:n(i);break;default:(0,ox.Z)(o)}})}catch(e){throw Error("Invalid message: ".concat(e))}};return window.addEventListener("message",r),og(t0,tQ,t3.current),function(){(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oc()(),n={messageType:os.cF.TEXT_EDITOR_CLOSED,filePath:e};(0,od.bG)(n,t)})(t0),window.removeEventListener("message",r)}}},[tQ,t0,t2,t9]);var iA=(nt=(0,oC.K)((0,nf.Z)(function(){return{path:rz}},[rz])),o_.use(nt)),iN=(nr=(nn={filePath:rz}).filePath,na=void 0!==(ni=nn.disableDiff)&&ni,nc=void 0!==(nl=nn.disableConflicts)&&nl,nu=(0,tH.P5)({controlName:"flag-git-gud",logFlagToAnalytics:!1}),nh=(0,tH.P5)({controlName:"flag-git-gud-gutter",logFlagToAnalytics:!1}),np=(0,tH.P5)({controlName:"flag-editor-git-conflict-markers",logFlagToAnalytics:!1}),nm=(0,eu.Z)().git,na=!nu||!nh||na,nc=!nu||!np||nc,ar.use(nm,void 0===nr?null:nr,na,nc)),iU=(0,T.T3)(),iL=(0,el.xZ)(null!==(rV=null==ib?void 0:ib.state.facet(tU.Yp))&&void 0!==rV?rV:null),iO=l5.use(iL,iU),iX=nW.use(iL,r6),iM=l7.use(iU),iF=cA.use(iv.rulers),iW=cN.U.use(iU),iH=(0,im.F)(),iV=cX.use(iU,iv.minimapDisplay,iH),iz=cQ.NS.use(id),ij=(nv={filePath:rz},nD=(0,eu.Z)().container,nP=(nG=(0,il.Z)()).showError,nA=nG.showConfirm,nN=(0,c5.T)(),nU=(0,eb.Z)().preferences,nq=ey(nX=(0,ev.Z)(nv.filePath)),n$=(0,tH.P5)({controlName:"flag-toolchain-formatters",logFlagToAnalytics:!1}),se.use(n$,nN,nD,nX,nq,nU.indentIsSpaces,nU.indentSize,nU.codeIntelligence,nv.filePath,function(){return nA("Formatted ".concat(nv.filePath," successfully"),1500)},function(){return nP("Sorry, formatting ".concat(nv.filePath," failed"),1500)})),iq=(nJ=(0,cT.Z)(),rr=(0,eu.Z)().container,rc=(ro=(0,il.Z)()).showError,rp=ro.showConfirm,rv=c1.ZP.supportsFormatting(nJ),rg=(0,c0.Z)({container:rr,service:"format",skip:!rv}).channel,ry=c2.use(rz,rg,rv,rc,rp),(0,O.useMemo)(function(){return ry},[ry])),iY=(0,tH.P5)({controlName:"flag-editor-visible-whitespace",logFlagToAnalytics:!1}),i$=cJ.use(!!iY&&iv.showLeadingWhitespace,!!iY&&iv.showEnclosedWhitespace,!!iY&&iv.showTrailingWhitespace,!!iY&&iv.showSelectedWhitespace),iJ=rs({path:rz}),iK=rd({path:rz,fs:r6}),iQ=ru({path:rz}),i0=(0,O.useCallback)(function(){ib&&iJ(ib)},[ib,iJ]),i1=(0,O.useCallback)(function(){ib&&iQ(ib)},[ib,iQ]),i2=(rk=(rb={isMobile:iU,generateCode:iJ,filePath:rz,openPane:r3}).isMobile,rS=rb.filePath,rE=rb.generateCode,rT=rb.openPane,rI=(0,n7.gf)(re.x.id),rG=sX({variables:{language:rD=null!==(rC=null===(rZ=sS.$R.from(rS))||void 0===rZ?void 0:rZ.id)&&void 0!==rC?rC:null},skip:!rD}).data,er=(K={openPane:rT,filePath:rS,language:rD}).filePath,ei=K.language,eo=K.openPane,ea=(0,T.T3)(),ex=((null==(eg=(Q=(0,C._)({},sG,void 0),sI.a(sB,Q)).data)?void 0:null===(ee=eg.currentUser)||void 0===ee?void 0:ee.userSubscriptionType)===sE.HP.Hacker||(null==eg?void 0:null===(et=eg.currentUser)||void 0===et?void 0:et.userSubscriptionType)===sE.HP.HackerPro)&&ei&&["python","javascript","typescript","javascriptreact","typescriptreact"].includes(ei),eC=(0,sP.Z)(er),eS=(0,O.useCallback)(function(){if(ei){var e="python"===ei?"python":"typescript";(0,tw.j)(tw.U3.GHOSTWRITER_CHAT_MODELFARM_PLACEHOLDER_CLICKED,{language:e}),eo({type:"docs",data:{url:sA.TT.MODEL_FARM+"/".concat(e,"#installation")}}),eC&&eC({code:sN[e],insertAt:0})}},[eC,ei,eo]),rB=ea?null:ex?eS:null,rP=(null!==(r_=null==rG?void 0:null===(rx=rG.languageExamples)||void 0===rx?void 0:null===(rw=rx.examples)||void 0===rw?void 0:rw.length)&&void 0!==r_?r_:0)>=1,rA=(0,O.useMemo)(function(){var e=[];return(0,nB.gK)(rS)||e.push({icon:(0,E.tZ)(n1.Z,{}),text:"Generate Code with AI",shortcut:rk?void 0:rI,onClick:function(e){nO({cta:"generate",version:"new"}),rE(e)}}),rB&&e.push({icon:(0,E.tZ)(sZ.Z,{}),text:"Build an AI app for free with ModelFarm",onClick:function(){nO({cta:"modelFarm",version:"new"}),rB()}}),rD&&rP&&e.push({icon:(0,E.tZ)(nE.Z,{}),text:"Start with a code example",onClick:function(e){nO({cta:"examples",version:"new"}),e.dispatch({effects:sK.of({language:rD,filePath:rS})})}}),e},[rk,rI,rB,rD,rP,rE,rS]),[sk.use(rA),s1]),i8=(0,O.useCallback)(function(){r3({type:"ghostwriterChat"})},[r3]),i4=(0,O.useCallback)(function(e){r3({type:"searchReplace",data:{initialQuery:e}})},[r3]),i3=(rU=(rN={onEditCode:i1,onGenerateCode:i0,onReplyInChat:i8}).onGenerateCode,rL=rN.onEditCode,rO=rN.onReplyInChat,rX=(0,tH.P5)({controlName:"flag-inline-generate-2"}),rM=lG.use(rO),rF=l1.use(rX),rW=aQ.use(rU,rL),(0,O.useMemo)(function(){return[l$,aO.$,aO.u,lJ,lK,aM,lQ,az,l0,rW,rF,rM]},[rW,rF,rM])),i5=(0,c8.av)(),i6=i5.onContextMenu,i9=i5.openContextMenu,i7=(U=(t={openFile:r0,openSearchAndReplace:i4,path:rz,view:ib,onCommand:function(e){if(ib){var t=ib.state.selection.main.head;if(t){var n=ib.coordsAtPos(t);n&&i9({target:{x:n.left,y:n.top},command:[i7(),e],width:275})}}}}).path,L=t.openFile,X=t.openSearchAndReplace,M=t.view,F=t.onCommand,W=(n=(0,eu.Z)().fs,r=rs({path:U}),i=ru({path:U}),o=rd({fs:n,path:U}),a=(0,n7.gf)(re.x.id),(0,O.useCallback)(function(e){var t=[],n=!e.state.selection.main.empty;return r&&!n&&t.push(rl({label:"Generate",icon:(0,E.tZ)(n1.Z,{css:ra.ghostwriterIcon}),keyboardShortcut:a,run:function(){r(e)},dataCy:"context-menu-GenerateCode"})),n&&(t.push(rl({label:"Explain",icon:(0,E.tZ)(n2.Z,{css:ra.ghostwriterIcon}),dataCy:"context-menu-ExplainCode",run:function(){o(e)}})),t.push(rl({label:"Modify",icon:(0,E.tZ)(n8.Z,{css:ra.ghostwriterIcon}),keyboardShortcut:a,dataCy:"context-menu-TransformCode",run:function(){i(e)}}))),t},[r,i,o,a])),H=(l=(0,n7.gf)("editor.action.startThread"),(0,O.useCallback)(function(e){var t=[];return t.push(rl({label:"Start thread",icon:(0,E.tZ)(nj.Z,{}),keyboardShortcut:l,run:function(){(0,rt.h$)(e)}})),t},[l])),z=(0,O.useCallback)(function(e){var t=[rl({label:"Copy link to position",icon:(0,E.tZ)(nH.Z,{}),run:function(){var t=(0,ek.s)(e.state.doc,e.state.selection.main.head),n=t.line,r=t.character,i=(0,nV.dr)({path:U,line:n+1,col:r});(0,nZ.Z)(i)}}),rl({label:"Copy",icon:(0,E.tZ)(nC.Z,{}),keyboardShortcut:(0,nb.l2)({cmdOrCtrl:!0,key:"c"}),run:function(){var t=nx(e.state).text;(0,nZ.Z)(t)}}),rl({label:"Cut",icon:(0,E.tZ)(n_.Z,{}),keyboardShortcut:(0,nb.l2)({cmdOrCtrl:!0,key:"x"}),run:function(){var t=nx(e.state),n=t.text,r=t.ranges;(0,nZ.Z)(n),e.state.readOnly||e.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"})}})];return window.navigator.clipboard&&"readText"in window.navigator.clipboard&&t.push(rl({label:"Paste",icon:(0,E.tZ)(nR.Z,{}),keyboardShortcut:(0,nb.l2)({cmdOrCtrl:!0,key:"v"}),run:function(){return(0,eZ._)(function(){var t,n;return(0,ew.Jh)(this,function(r){switch(r.label){case 0:t="",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.navigator.clipboard.readText()];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),tC.kg.error("CodeMirror context menu paste failed",{message:n.message}),[2];case 4:return nM({filePath:U,view:e,clipboardText:t}),[2]}})})()}})),t},[U]),q=(s=(c={path:U,openFile:L,openSearchAndReplace:X}).path,u=c.openFile,d=c.openSearchAndReplace,h=ey(f=(0,ev.Z)(s)),p=(0,O.useRef)(null),m=(0,eu.Z)().fs,v=(0,tH.P5)({controlName:"flag-clui-ctx-menu-rename-all",logFlagToAnalytics:!1}),g=(0,n7.gf)("editor.action.goToDefinition"),y=(0,n7.gf)("editor.action.goToTypeDefinition"),b=(0,n7.gf)("editor.action.goToImplementation"),Z=(0,n7.gf)("editor.action.goToReferences"),w=(0,n7.gf)("editor.selection.allOccurrences"),(0,O.useCallback)(function(e){var t=[],n=h&&f;n&&h.isFindDefinitionSupported&&u&&t.push(rl({label:"Go to definition",icon:(0,E.tZ)(nk.Z,{}),dataCy:"context-menu-JumpToDefinition",run:function(t){(0,rn.wK)(e,t)},keyboardShortcut:g})),n&&h.isFindTypeDefinitionSupported&&u&&t.push(rl({label:"Go to type definition",icon:(0,E.tZ)(nS.Z,{}),run:function(){(0,rn.OM)(e)},keyboardShortcut:y})),n&&h.isFindImplementationSupported&&u&&t.push(rl({label:"Go to implementation",icon:(0,E.tZ)(nE.Z,{}),run:function(){(0,rn.Zc)(e)},keyboardShortcut:b})),n&&(h.isFindDefinitionSupported||h.isFindReferencesSupported)&&t.push(rl({label:"Go to references",icon:(0,E.tZ)(ri.Z,{}),keyboardShortcut:Z,run:function(){(0,t5.Z)(e)}})),d&&t.push(rl({label:"Find in Repl",icon:(0,E.tZ)(ny.Z,{}),run:function(){d(nx(e.state).text)}})),n&&h.isRenameSupported&&(v?t.push(rl({label:rf,icon:(0,E.tZ)(nT.Z,{}),keyboardShortcut:"F2",run:function(){ns(e)}})):t.push({match:nw.pl,data:{type:"context",label:rf,icon:(0,E.tZ)(nT.Z,{}),keyboardShortcut:"F2"},commands:function(t){var n=t.active,r=t.search;return n&&r?[{match:function(){return{score:1}},data:{type:"action",label:"Rename",icon:(0,E.tZ)(ne.Z,{}),keyboardShortcut:"Enter",run:function(){return(0,eZ._)(function(){var t,n,i;return(0,ew.Jh)(this,function(o){switch(o.label){case 0:if(t=e.state.selection.main.head,!e.state.wordAt(t))return[2,{type:"error",message:"You cannot rename this element"}];return p.current&&f.notify.cancelRequest(p.current),p.current=f.generateId(),[4,f.request.rename(s,(0,ek.s)(e.state.doc,t),r,{id:p.current,tap:function(t){return(0,t4.SC)(e,t)}})];case 1:if((n=o.sent()).cancelled)return[2];if("error"in n)return[2,{type:"error",message:"Something went wrong renaming ".concat(n.error.message)}];if(!(i=n.result))return[2];return(0,no.w)({edit:i,fs:m,client:f}),[2]}})})()}}}]:[]}})),t.push(rl({label:"Select all occurrences",icon:(0,E.tZ)(nK.Z,{}),keyboardShortcut:w,run:function(){(0,rt.SK)(e)}}));var r=void 0!==e.state.field(es.K0,!1);return n&&r&&t.push(rl({label:"Toggle breakpoint",icon:(0,E.tZ)(nz.Z,{}),run:function(){(0,rt.QF)(e)}})),n&&h.isCodeActionsSupported&&t.push({match:nw.pl,data:{type:"context",label:"More actions",icon:(0,E.tZ)(nd.Z,{}),keyboardShortcut:(0,nb.l2)({key:".",cmdOrCtrl:!0})},commands:function(t){var n=t.active;return(0,eZ._)(function(){var t,r,i;return(0,ew.Jh)(this,function(o){switch(o.label){case 0:if(!n||f.getServerState()!==eV.a.INITIALIZED)return[2,[]];return r=(t=e.state).selection.main,[4,f.request.codeActions(s,{start:(0,ek.s)(t.doc,r.from),end:(0,ek.s)(t.doc,r.to)})];case 1:if(i=o.sent(),(0,tw.j)(tw.U3.EDITOR_CONTEXT_MENU_CODE_ACTIONS_REQUESTED,{success:!("error"in i),numActions:"result"in i&&i.result?i.result.length:null}),"error"in i)return ng.Tb(Error(i.error.message)),[2,[]];if(null===i.result||0===i.result.length)return[2,[]];return[2,i.result.map(function(e){return rl({icon:(0,E.tZ)(nQ.Z,{}),label:e.title,run:function(){n0(e,f,m)}})})]}})})()}}),t},[h,f,u,d,w,g,y,b,Z,v,s,m])),$=(x=(0,n6.s6)(n5.Y.EditorContextMenu),(0,O.useCallback)(function(e){var t=[];return t.push({data:{type:"group",key:"extensions"},commands:(0,eZ._)(function(){var t;return(0,ew.Jh)(this,function(n){switch(n.label){case 0:var r;return t=[{data:{filePath:e.filePath,selection:e.view.state.selection.toJSON()}}],[4,Promise.all(x.map((r=(0,eZ._)(function(e){var n;return(0,ew.Jh)(this,function(r){switch(r.label){case 0:return[4,e.create({path:t})];case 1:if(!(n=r.sent()))return[2,null];return[2,(0,n9.C)(n,{path:t})]}})}),function(e){return r.apply(this,arguments)})))];case 1:return[2,n.sent().filter(Boolean)]}})})}),t},[x])),J=(0,O.useMemo)(function(){return M?q(M):[]},[M,q]),I=(R={view:M,commands:J,onCommand:F}).view,D=R.commands,G=R.onCommand,B=(0,n4.Z)(G),N=(0,eh.Z)({view:I}),(0,O.useEffect)(function(){if(I){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=D[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)!function(){var t=i.value,n=t.data;if(("context"===n.type||"action"===n.type)&&n.keyboardShortcut){var r=Array.isArray(n.keyboardShortcut)?n.keyboardShortcut.join(" "):n.keyboardShortcut;e.push({run:function(){if("action"===n.type)return n.run(null),!0;var e=I.state.selection.main.head;return"context"!==n.type||n.label!==rf||I.state.wordAt(e)?B.current(t):(0,t8.J)(I,{message:"You cannot rename this element",offset:e}),!0},key:r,preventDefault:!0})}}()}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}try{I.dispatch({effects:N.reconfigure(e_.$f.of(e))})}catch(e){(0,e_.OO)(I.state,e,"contextMenu")}return function(){try{I.dispatch({effects:N.reconfigure([])})}catch(e){(0,e_.OO)(I.state,e,"contextMenu")}}}},[I,D,N,B]),(0,O.useCallback)(function(){var e=M?[{data:{type:"context",label:"AI",icon:(0,E.tZ)(tk.Z,{})},commands:function(){return W(M)}},{data:{type:"context",label:"Code actions",icon:(0,E.tZ)(nd.Z,{})},commands:function(){return q(M)}},{data:{type:"context",label:"Social",icon:(0,E.tZ)(nj.Z,{})},commands:function(){return H(M)}},{data:{type:"context",label:"Clipboard",icon:(0,E.tZ)(nR.Z,{})},commands:function(){return z(M)}},{data:{type:"context",label:"Extensions",icon:(0,E.tZ)(n3.Z,{})},commands:function(){return $({view:M,filePath:U})}}]:[];return{data:{type:"context",label:"Search actions",icon:(0,E.tZ)(ny.Z,{})},commands:function(){return e}}},[M,W,q,H,z,U,$])),oe=(0,O.useCallback)(function(e){i6(e,{command:i7(),width:275})},[i7,i6]),ot=(0,O.useCallback)(function(e,t){i9({target:e,command:[i7(),t],width:275})},[i7,i9]),ol=rh.use(iU,oe),ou=rm.use(ot),of=(0,O.useCallback)(function(e){i9({target:{x:e.right-275,y:e.top},width:275,command:i7()})},[i7,i9]),oh=(0,re.W)({editCode:iQ,explainCode:iK,generateCode:iJ,onMoreClick:of}),op=(rH=(0,cT.T)(),cR.use(rH)),oy=(0,tH.P5)({controlName:"flag-problems-pane"}),ob=s6.y.use(oy);return(0,E.tZ)("div",{css:ok.ac,"data-cy":iR?"workspace-cm-editor-loading":"workspace-cm-editor-".concat(rz),children:(0,E.tZ)(aa.ZP,{ref:iy,elementRef:iB,css:ok.Mp,filePath:rz,hideTooltips:rq,extensions:[ol,ou,iI,i2,iW,iO,ix,iM,iN,iV,nF,iX,r8.k,i3,op,cI,iF,i$,iz,ij,iq,a3,iA,iP,sp,sb,iG,iU?[]:oh,iE,ob],onException:function(e){var t,n={filePath:rz,cursorPosition:JSON.stringify(null==ik?void 0:null===(t=ik.get(ao._s))||void 0===t?void 0:t.position),fileVersion:iS({filePath:rz})};if(ib){var r=ib.plugin(r8.k),i=null==r?void 0:r.logs();null==r||r.flush(),n.domText=ib.contentDOM.innerText,n.keystrokes=JSON.stringify(i),n.selection=JSON.stringify(ib.state.selection.main.toJSON()),n.updateDoc=ib.state.doc.sliceString(0)}if(iC){iZ({error:e,tags:{codemirror:!0},extras:n,origin:"CodemirrorEditor: useEditor/onException"});return}(0,or.O)(e,{tags:{origin:"CodemirrorEditor: useEditor/onException",codemirror:!0},extras:n})},noHistory:!0})})}var s7=n(57369),ue=n(19858),ut=n(87959),un=(0,tS.X)({base:[F.l0.backgroundColor.backgroundDefault,F.l0.color.foregroundDimmer,F.l0.borderRadius(0),F.l0.height("auto"),F.l0.py(4),F.l0.px(6),{"> div":F.l0.rowWithGap(4)}]}),ur=function(e){var t=e.css,n=e.innerRef,r=(0,eQ._)(e,["css","innerRef"]);return(0,E.tZ)(iL.Tg,{background:"root",children:(0,E.tZ)(t9.zx,(0,C._)({size:"small",css:[un.base,t],ref:n},r))})};function ui(e){var t,n=e.performPaneOperation,r=(0,ue.Z)((t=(0,eZ._)(function(e){var t,n,r,i;return(0,ew.Jh)(this,function(o){switch(o.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=o.sent()).error)return[2,t];if(n=t.type,r=null,!(n!==s7.y5.INITIALIZING))return[3,3];return[4,e.status()];case 2:if((i=o.sent()).error)return[2,i];r=i,o.label=3;case 3:return[2,{branchName:null==r?void 0:r.branch,error:null}]}})}),function(e){return t.apply(this,arguments)})),i=!r||r.error?null:r.branchName;return i?(0,E.tZ)(ur,{onClick:function(){return null==n?void 0:n({operation:"open",pane:{type:"git"}})},text:i,iconLeft:(0,E.tZ)(ut.Z,{color:ih.TV.foregroundDimmer,size:12})}):null}var uo=n(80711),ua=n(99418),ul=(0,tS.X)({rounded:[{borderBottomRightRadius:ih.TV.space6}]});function uc(e){var t=e.onOpen,n=e.rounded;return(0,E.tZ)(ur,{text:"History",iconRight:(0,E.tZ)(uo.Z,{size:12}),onClick:function(){(0,ua.p)("historyOpened"),t()},css:(void 0===n||n)&&ul.rounded})}var us=n(68514),uu=n(40227),ud=n(48272),uf=n(37951),uh=n(11718),up=n(49615),um=n(11470),uv=n(90648),ug=n(50494),uy=n(99071),ub=n(44471),uZ=(0,tS.X)({surface:[F.l0.height("100%")],cursorOverlay:{cursor:"pointer"},menu:[F.l0.p(8),F.l0.colWithGap(8),F.l0.maxWidth(390),F.l0.minWidth(390)],close:[F.l0.position.absolute,F.l0.top(4),F.l0.right(4)],file:[F.l0.pl(4),F.l0.display.inlineFlex,F.l0.rowWithGap(4),F.l0.align.center,{verticalAlign:"top"}],space:[F.l0.width(2),F.l0.color.foregroundDimmer,F.l0.textAlign.center],section:[F.l0.rowWithGap(8),F.l0.align.center,F.l0.justify.spaceBetween],header:[F.l0.colWithGap(2),F.l0.flex.shrink(1)],selects:[F.l0.rowWithGap(4)],sizeInput:{border:"none"},buttonsGroup:[F.l0.rowWithGap(8),F.l0.align.center,F.l0.justify.spaceBetween],saveButtons:[F.l0.rowWithGap(4)],red:[F.l0.color.redDefault],row:[F.l0.rowWithGap(8),F.l0.align.center],staticWidth:[F.l0.flex.grow(0),F.l0.flex.shrink(1)],variableWidth:[F.l0.flex.grow(1),F.l0.flex.shrink(0),{flexBasis:0}],flexEnd:[F.l0.align.end]});function uw(e){var t,n=(0,Y.uN)(),r=null==n?void 0:null===(t=n.state)||void 0===t?void 0:t.facet(tU.Yp);return r?(0,E.tZ)(ux,{fileName:r,openSettings:e.openSettings}):null}function ux(e){var t=e.fileName,n=e.openSettings,r=(0,eu.Z)(),i=r.dotReplit,o=r.lspnix,a=(0,eb.Z)().preferences.codeIntelligence,l=(0,Y.uN)(),c=(0,k._)((0,O.useState)(!1),2),s=c[0],u=c[1],d=(0,ev.Z)(t),f=(0,k._)((0,O.useState)(null==d?void 0:d.getServerState()),2),h=f[0],p=f[1],m=(0,k._)((0,O.useState)(null==d?void 0:d.getServerHealth()),2),v=m[0],g=m[1],y=(0,k._)((0,O.useState)(!1),2),b=y[0],Z=y[1],w=(0,O.useMemo)(function(){var e=[F.l0.p(4),F.l0.borderRadius(0),F.l0.align.center,F.l0.rowWithGap(4)];return s?(e.unshift(li.gU.filled),e.push({pointerEvents:"none"})):e.unshift(li.gU.nofill),(0,iA.iv)(e)},[s]),x=(0,ie.IK)(l,tU.Q$),S=(0,O.useMemo)(function(){var e,n,r,i;return(r=null===(e=sS.$R.from(t))||void 0===e?void 0:e.name)?r:(r=null==x?void 0:null===(n=x.language)||void 0===n?void 0:n.name)&&r.length>0?(i=r).slice(0,1).toUpperCase()+i.slice(1).toLowerCase():(r=(0,nB.r6)(t),x)?r:"Plain Text"},[t,x]),T=(0,O.useMemo)(function(){if(!a)return 6;if(null!==d&&v===eV.N.STALLED)return 3;var e=null!=d&&v===eV.N.READY;return b||h===eV.a.INITIALIZING||h===eV.a.INITIALIZED&&!e?0:e?1:h===eV.a.EXITED?2:null!==x?4:5},[d,b,x,v,h,a]),I=(0,O.useCallback)(function(){a&&(o.disable(),o.enable(),Z(!0))},[o,a]);(0,O.useEffect)(function(){if(d)return Z(!1),p(d.getServerState()),g(d.getServerHealth()),(0,uy.uf)([d.onServerStateChange(function(e){p(e)}),d.onServerHealthChange(function(e){g(e)})])},[d]);var D=(0,ie.IK)(l,c3.i5),G=(0,ie.IK)(l,c3.dt),B=(0,k._)((0,O.useState)(D?{title:D.name,value:D.id}:void 0),2),P=B[0],A=B[1],N=(0,O.useRef)(!1),U=(0,O.useMemo)(function(){var e;return null!==(e=null==G?void 0:G.map(function(e){return{title:e.name,value:e.id,icon:void 0}}))&&void 0!==e?e:[]},[G]);(0,O.useEffect)(function(){N.current||(null==P?void 0:P.value)===(null==D?void 0:D.id)||A(D?{title:D.name,value:D.id}:void 0)},[P,D]);var L=(0,k._)((0,O.useState)(!1),2),X=L[0],W=L[1],H=(0,ug.e)("prettier-formatter");return(0,O.useEffect)(function(){var e,t=null!==(e=null==l?void 0:l.plugin(ie.pE))&&void 0!==e?e:null;if(l&&t&&!t.destroyed){var n=null,r=t.bind({changed:function(e){return(0,rZ.a)(e,cQ.pm)},callback:function(e){H.isDone||(n&&"Prettier"===n.name&&(W(!0),u(!0),H.setAsDone()),n=e.state.facet(cQ.pm))}});return function(){return r()}}},[H,l]),(0,E.BX)(uu.xo,{label:"Language support",placement:"top",isOpen:s,onOpenChange:function(e){u(e),X&&W(!1)},children:[function(e){return(0,E.tZ)(la.u,{tooltip:"Language support",isDisabled:s,children:(0,E.tZ)("div",{css:uZ.cursorOverlay,children:(0,E.BX)(M.K.button,(0,_._)((0,C._)({},e),{css:w,children:[(0,E.tZ)(uS,{state:T}),(0,E.tZ)(uC,{text:S,color:"dimmer",variant:"small"})]}))})})},(0,E.BX)(M.G,{css:uZ.menu,children:[(0,E.tZ)(M.G,{css:uZ.close,children:(0,E.tZ)(t7.hU,{alt:"Close",onClick:function(){return u(!1)},children:(0,E.tZ)(tQ.Z,{})})}),(0,E.BX)(eT.h4,{level:1,children:["Language support for ",(0,E.BX)("span",{css:uZ.file,children:[(0,E.tZ)(R.Z,{path:t,size:16})," ",(0,E.tZ)("span",{children:(0,nB.UO)(t)})]})]}),(0,E.tZ)(us.R,{}),(0,E.tZ)(uk,{client:d,restart:I,state:T,openSettings:n,filePath:t}),G&&P?(0,E.BX)(E.HY,{children:[(0,E.tZ)(us.R,{}),(0,E.BX)(M.G,{css:uZ.section,children:[(0,E.tZ)(M.G,{css:[uZ.header,uZ.staticWidth],children:(0,E.tZ)(eT.xv,{multiline:!1,children:"Code Formatter"})}),1===G.length?(0,E.tZ)(M.G,{css:[uZ.header,uZ.variableWidth,uZ.flexEnd],children:(0,E.tZ)(eT.xv,{multiline:!1,children:P.title})}):(0,E.tZ)(M.G,{css:uZ.selects,children:(0,E.tZ)(ud.P,{placement:"top",items:U,selectedItem:(0,_._)((0,C._)({},P),{icon:N.current?(0,E.tZ)(t0.Z,{size:12}):void 0}),disabled:N.current,onChange:function(e){e.value!==P.value&&(N.current=!0,A(e),(function(e,t){return uE.apply(this,arguments)})(i,{path:t,formatterId:e.value}).finally(function(){return N.current=!1}))}})})]}),X?(0,E.tZ)(M.G,{css:uZ.section,children:(0,E.tZ)(uf.E,{text:"".concat(P.title," was used to format this file. ").concat(G.length>1?"You can change your code formatter with the dropdown above.":""),closable:!0,closeAction:function(){return W(!1)}})}):null]}):null]})]})}function uC(e){var t=e.text,n=(0,eQ._)(e,["text"]);return(0,E.tZ)(eT.xv,(0,_._)((0,C._)({},n),{children:t}))}function u_(e){var t=(0,E.tZ)("a",{tabIndex:0,role:"button",onClick:e.restart,onKeyDown:function(t){"Enter"===t.key&&e.restart()},children:"Restart"});switch(e.state){case 0:return(0,E.tZ)(eT.xv,{multiline:!1,color:"dimmer",children:"Loading"});case 1:return(0,E.tZ)(eT.xv,{multiline:!1,color:"dimmer",children:"Active"});case 3:return(0,E.BX)(M.G,{css:uZ.row,children:[(0,E.tZ)(eT.xv,{css:uZ.red,multiline:!1,children:"Stalled"})," ",t]});case 2:return(0,E.BX)(M.G,{css:uZ.row,children:[(0,E.tZ)(eT.xv,{css:uZ.red,multiline:!1,children:"Stopped"})," ",t]});default:return null}}function uk(e){var t=function(){switch(e.state){case 0:case 1:case 2:case 3:return(0,E.BX)(E.HY,{children:[(0,E.tZ)(M.G,{css:[uZ.header,uZ.variableWidth],children:(0,E.tZ)(eT.xv,{multiline:!1,children:e.client?e.client.clientName:"Language Server for ".concat(e.filePath)})}),(0,E.tZ)(M.G,{css:[uZ.header,uZ.staticWidth],children:(0,E.tZ)(u_,{restart:e.restart,state:e.state})})]});case 5:case 4:return(0,E.tZ)(M.G,{css:uZ.header,children:(0,E.tZ)(eT.xv,{color:"dimmer",children:"Limited language support because the language server is not available."})});case 6:return(0,E.tZ)(M.G,{css:uZ.header,children:(0,E.BX)(eT.xv,{multiline:!0,color:"dimmer",children:["Code intelligence is disabled. Enable it in settings.",(0,E.tZ)("br",{}),(0,E.tZ)("a",{tabIndex:0,role:"button",onClick:e.openSettings,onKeyDown:function(t){"Enter"===t.key&&e.openSettings()},children:"Open settings"})]})});default:return null}}();return t?(0,E.BX)(M.G,{css:uZ.section,children:[" ",t," "]}):null}function uS(e){switch(e.state){case 3:case 6:case 4:return(0,E.tZ)(uv.Z,{size:16});case 0:return(0,E.tZ)(t0.Z,{size:16,color:F.TV.blueStronger});case 1:return(0,E.tZ)(M.G,{dataCy:"ws-code-intelligence-active",children:(0,E.tZ)(up.Z,{size:16})});case 2:return(0,E.tZ)(um.Z,{size:16});case 5:return(0,E.tZ)(uh.Z,{size:16})}}function uE(){return(uE=(0,eZ._)(function(e,t){var n,r;return(0,ew.Jh)(this,function(i){return(n=".".concat((0,ub.mD)(t.path)),r="rules/formatter/fileExtensions/".concat(n,"/id"),t.formatterId)?[2,e.updateDotReplit([{path:"rules/formatter/fileExtensions",op:"add",value:JSON.stringify((0,eq._)({},"".concat(n),{id:t.formatterId}))}])]:[2,e.updateDotReplit([{path:r,op:"remove"}])]})})).apply(this,arguments)}function uT(e){if(e.facet(r4.o))return"";var t=e.selection,n="",r=0;if(t.ranges.length>1){r=t.ranges.reduce(function(e,t){return e+(t.to-t.from)},0);var i=t.ranges.length;n="".concat(i," selections")}else{var o=t.ranges[0],a=e.doc.lineAt(o.head),l=o.head-a.from;r=o.to-o.from,n="Ln ".concat(a.number,", Col ").concat(l+1)}return r>0&&(n+=" (".concat(r," chars)")),n}function uR(){var e,t=(0,O.useRef)(null),n=(0,Y.uN)();return(0,O.useEffect)(function(){var e,r=t.current,i=null!==(e=null==n?void 0:n.plugin(ie.pE))&&void 0!==e?e:null;if(r&&n&&i&&!i.destroyed){var o=null,a=n.state;r.textContent=uT(a);var l=i.bind({changed:function(e){return(0,rZ.a)(e,"selection",r4.o)},callback:function(e){a=e.state,null===o&&(o=requestAnimationFrame(function(){o=null,r.textContent=a?uT(a):""}))}});return function(){l(),null!==o&&cancelAnimationFrame(o),r.textContent=""}}},[n]),!n&&(null===(e=t.current)||void 0===e?void 0:e.textContent)&&(t.current.textContent=""),(0,O.useMemo)(function(){return(0,E.tZ)(ur,{text:(0,E.tZ)("span",{ref:t,"data-cy":"current-position"}),css:[F.l0.color.foregroundDimmest],onClick:n?function(){return(0,st.zo)(n)}:void 0})},[n])}(f=x||(x={}))[f.Loading=0]="Loading",f[f.Ready=1]="Ready",f[f.Exited=2]="Exited",f[f.Stalled=3]="Stalled",f[f.Partial=4]="Partial",f[f.Missing=5]="Missing",f[f.Disabled=6]="Disabled";var uI=n(85621),uD=(0,tS.X)({text:[{textTransform:"capitalize"}]});function uG(){var e,t,r,i,o=(0,k._)((0,O.useState)(null),2),a=o[0],l=o[1],c=(0,O.useRef)(null),s=(0,Y.uN)(),u=(0,eb.Z)().preferences,d=(null==u?void 0:u.keyboardHandler)==="vim",f=(0,O.useCallback)(function(e){if(c.current){var t=null!=e?e:"";if(s&&a&&void 0===e){var n,r,i=a.getCM(s);t=null!==(r=null==i?void 0:null===(n=i.state.vim)||void 0===n?void 0:n.mode)&&void 0!==r?r:"normal"}c.current.innerText!==t&&(c.current.innerText=t||"")}},[s,a]);return(0,O.useEffect)(function(){d&&!a&&n.e(6689).then(n.bind(n,65231)).then(function(e){l(e),f()})},[d,a,f]),e=[f,d,a],t="ModeStatus",r=(0,k._)((0,O.useState)(function(){return new ex.F6}),1)[0],i=(0,n4.Z)(function(){return d&&a?e_.tk.updateListener.of(function(){setTimeout(function(){f()},0)}):(f(null),null)}),(0,O.useEffect)(function(){if(s){var e=i.current();if(e){var n=void 0===r.get(s.state)?ex.Py.appendConfig.of(r.of(e)):r.reconfigure(e);try{s.dispatch({effects:n})}catch(e){(0,e_.OO)(s.state,e,t)}return function(){try{s.dispatch({effects:r.reconfigure([])})}catch(e){(0,e_.OO)(s.state,e,t)}}}}},[s,r,i,t].concat((0,S._)(e))),(0,E.tZ)(E.HY,{children:d?(0,E.tZ)(ur,{disabled:!0,iconLeft:(0,E.tZ)(uI.Z,{}),text:(0,E.tZ)("span",{css:uD.text,ref:c})}):null})}var uB=n(34581),uP=n(76568),uA=n(70210),uN=n(73157),uU=(0,tS.X)({group:[F.l0.align.center,F.l0.rowWithGap(4)],row:[F.l0.align.center,F.l0.rowWithGap(8)]});function uL(){var e,t=(0,Y.uN)(),n=null==t?void 0:null===(e=t.state)||void 0===e?void 0:e.facet(tU.Yp);return n?(0,E.tZ)(uO,{fileName:n}):null}function uO(e){var t,n,r,i,o,a,l=e.fileName,c=(0,Y.uN)(),s=(n=(t=(0,k._)((0,O.useState)(null),2))[0],r=t[1],i=(0,ev.Z)(l),o=(0,uB.nC)(),a=(0,uP.dr)(),(0,O.useEffect)(function(){if(i){var e=function(e){var t,n=o().find(function(e){var t=(0,k._)(e,2);return"problems"===(t[0],t[1]).type});if(n){var r=a(n[0]);r&&"problems"===r.type&&(null===(t=r.updateProblems)||void 0===t||t.call(r,l,e))}};if(i.isOpen(l)){var t=i.getDiagnostics(l);r(t),e(t)}var n=i.onDiagnostics(function(t){t.path===l&&(r(t.diagnostics),e(t.diagnostics))});return function(){n(),o().some(function(e){var t=(0,k._)(e,2),n=(t[0],t[1]);return"codeEditor"===n.type&&n.data.path===l})||e([])}}},[i,l,o,a]),n),u=(0,O.useMemo)(function(){var e;return s?(e=s.reduce(function(e,t){return void 0===t.severity||(e[t.severity]=(e[t.severity]||0)+1),e},{}),s.length>0&&0===Object.keys(e).length&&(e[eI.DiagnosticSeverity.Error]=s.length),e):null},[s]);if(!u)return null;var d=u[eI.DiagnosticSeverity.Error]||0,f=u[eI.DiagnosticSeverity.Warning]||0,h="";return 0===d&&0===f&&(h="No problems"),d>0&&(h+="".concat((0,uN.Z)("Error",d),": ").concat(d)),f>0&&(h.length>0&&(h+=", "),h+="".concat((0,uN.Z)("Warning",f),": ").concat(f)),(0,E.tZ)(la.u,{tooltip:h,children:(0,E.tZ)(ur,{text:(0,E.BX)(M.G,{css:uU.row,children:[(0,E.BX)(M.G,{css:uU.group,children:[(0,E.tZ)(uA.Z,{severity:eI.DiagnosticSeverity.Error,size:12}),(0,E.tZ)(eT.xv,{color:"dimmer",variant:"small",multiline:!1,children:String(d)})]}),(0,E.BX)(M.G,{css:uU.group,children:[(0,E.tZ)(uA.Z,{severity:eI.DiagnosticSeverity.Warning,size:12}),(0,E.tZ)(eT.xv,{color:"dimmer",variant:"small",multiline:!1,children:String(f)})]})]}),disabled:!c,onClick:c?function(){return(0,s6.C)(c)}:void 0})})}var uX=n(31405),uM="StatusBar",uF=(0,tS.X)({root:[F.l0.display.flex,(0,eq._)({},F.nC.max(550,uM),[F.l0.display.none])]});function uW(e){var t=e.children;return(0,E.tZ)(M.G,{css:uF.root,children:t})}var uH=(0,tS.X)({root:[F.l0.display.none,(0,eq._)({},F.nC.max(550,uM),[F.l0.display.flex])]});function uV(e){var t=e.children;return(0,E.tZ)(M.G,{css:uH.root,children:t})}var uz=(0,tS.X)({base:[F.l0.backgroundColor.backgroundDefault,F.l0.color.foregroundDimmer,F.l0.borderRadius(0),F.l0.height("100%"),F.l0.py(8),F.l0.px(12),{"> div":F.l0.rowWithGap(4)}]}),uj=function(e){var t=e.css,n=e.size,r=(0,eQ._)(e,["css","size"]);return(0,E.tZ)(iL.Tg,{background:"default",children:(0,E.tZ)(t7.hU,(0,_._)((0,C._)({css:[uz.base,t]},r),{size:void 0===n?12:n}))})},uq=(0,tS.X)({iconButtonToggled:[F.l0.backgroundColor.accentPrimaryDimmer,{"&&:hover":[F.l0.backgroundColor.accentPrimaryDefault]}]});function uY(){var e=(0,Y.uN)(),t=(0,ie.IK)(e,at);if(!e||!t||null===t.head)return null;var n=t.mode===y.INLINE_DIFF,r=function(){e.dispatch({effects:ae.of(n?y.GUTTER_DIFF:y.INLINE_DIFF)})};return(0,E.BX)(E.HY,{children:[(0,E.tZ)(uW,{children:(0,E.tZ)(ur,{text:n?"Diffing":"Diff",colorway:n?"primary":void 0,iconLeft:(0,E.tZ)(uX.Z,{}),onClick:r})}),(0,E.tZ)(uV,{children:(0,E.tZ)(la.u,{tooltip:"Toggle Diff",placement:"top-start",children:(0,E.tZ)(uj,{css:n&&uq.iconButtonToggled,alt:"Toggle Diff",onClick:r,colorway:n?"primary":void 0,children:(0,E.tZ)(uX.Z,{color:n?ih.TV.foregroundDefault:void 0})})})})]})}var u$=n(10044),uJ=n(27783);function uK(e,t,n){var r=[],i=0,o=!0,a=!1,l=void 0;try{for(var c,s=e.iterLines()[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,d=i;if(i=i+u.length+1,0!==u.length){var f=(0,uJ.L)(u,t),h=u.trimStart(),p=d+(u.length-h.length);if(0!==f&&d!==p){var m="";if(n===u$.Q.TABS){var v=Math.floor(f/t),g=f%t;m="	".repeat(v)+" ".repeat(g)}else n===u$.Q.SPACES&&(m=" ".repeat(f));m+h!==u&&r.push({from:d,to:p,insert:m})}}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return ex.as.of(r,e.length)}var uQ=n(17907),u0=n(26),u1=n(58003),u2=n(2532),u8=n(81662),u4=(0,tS.X)({surface:[F.l0.height("100%")],cursorOverlay:{cursor:"pointer"},menu:[F.l0.p(8),F.l0.colWithGap(8),F.l0.maxWidth(410)],close:[F.l0.position.absolute,F.l0.top(4),F.l0.right(4)],file:[F.l0.pl(4),F.l0.display.inlineFlex,F.l0.rowWithGap(4),F.l0.align.center,{verticalAlign:"top"}],space:[F.l0.width(2),F.l0.color.foregroundDimmer,F.l0.textAlign.center],section:[F.l0.rowWithGap(8),F.l0.align.center,F.l0.justify.spaceBetween],header:[F.l0.colWithGap(2),F.l0.flex.shrink(1)],selects:[F.l0.rowWithGap(4)],sizeInput:{border:"none"},buttonsGroup:[F.l0.rowWithGap(8),F.l0.align.center,F.l0.justify.spaceBetween],saveButtons:[F.l0.rowWithGap(4)]});function u3(e){var t,n=e.path,r=e.openSettings,i=(0,eb.Z)().preferences,o=(0,Y.uN)(),a=(0,ie.IK)(o,r4.o),l=null!==a&&!!i.indentDetection&&a,c=(0,ie.IK)(o,uQ.K_),s=(0,ie.IK)(o,uQ.E2),u=(0,ie.IK)(o,uQ.vO),d=null!==(t=(0,ie.IK)(o,ex.yy.tabSize))&&void 0!==t?t:i.indentSize,f="	"===(0,ie.IK)(o,e1.c)?u$.Q.TABS:u$.Q.SPACES,h=(0,k._)((0,O.useState)(!1),2),p=h[0],m=h[1],v=(0,k._)((0,O.useState)(f),2),g=v[0],y=v[1],b=(0,k._)((0,O.useState)(d),2),Z=b[0],w=b[1],x=(0,k._)((0,O.useState)(!1),2),T=x[0],I=x[1],D=(0,k._)((0,O.useState)(!1),2),G=D[0],B=D[1],P=(0,k._)((0,O.useState)(!1),2),A=P[0],N=P[1],U=(0,k._)((0,O.useState)(!1),2),L=U[0],X=U[1];(0,O.useEffect)(function(){T||(y(f),w(d))},[f,d,T]),(0,O.useEffect)(function(){p||(y(f),w(d),I(!1))},[p,f,d]),(0,O.useEffect)(function(){g===f&&Z===d&&I(!1)},[g,Z,f,d]),(0,O.useEffect)(function(){if(G||A||L){var e=setTimeout(function(){B(!1),N(!1),X(!1)},1e3);return function(){return clearTimeout(e)}}},[G,A,L]),l&&p&&m(!1);var W=(0,O.useCallback)(function(){if(o){var e=uK(o.state.doc,d,f);o.dispatch({changes:e,effects:uQ.Fm.of(!0)}),N(!0)}},[o,f,d]),H=(0,O.useCallback)(function(){o&&(o.dispatch({effects:uQ.Fm.of(!0)}),o.state.field(uQ.E2)&&o.dispatch({effects:uQ.O4.of({type:void 0,size:void 0})}),X(!0))},[o]),V=(0,O.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(o){var t=void 0,n=[uQ.O4.of({type:g,size:Z})];if(e){if(g!==f&&(t=uK(o.state.doc,d,g)),g===u$.Q.SPACES&&Z!==d){var r=function(e,t,n,r){if(t===u$.Q.TABS)return ex.as.empty(e.length);var i=" ".repeat(r),o=[],a=0,l=!0,c=!1,s=void 0;try{for(var u,d=e.iterLines()[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=a;if(a=a+f.length+1,0!==f.length){var p=(0,uJ.L)(f,n),m=f.trimStart(),v=h+(f.length-m.length);if(0!==p&&h!==v){var g=Math.floor(p/n),y=p%n,b=i.repeat(g)+" ".repeat(y);b+m!==f&&o.push({from:h,to:v,insert:b})}}}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return ex.as.of(o,e.length)}(t?t.apply(o.state.doc):o.state.doc,g,d,Z);t=t?t.compose(r):r}t&&n.push(uQ.Fm.of(!0))}o.dispatch({changes:t,effects:n}),I(!1),B(!0)}},[o,f,d,g,Z]),z=(0,O.useCallback)(function(){m(!1),r()},[r]),j=(0,O.useMemo)(function(){if(s){var e=s.size,t=s.type===u$.Q.SPACES?"spaces":"tabs";return"This file appears to use a unit of ".concat(e," ").concat(t,".")}return u?"Indentation detection hasn't been run on this file yet.":"This file is too small for indentation detection."},[s,u]),q=(0,O.useMemo)(function(){var e=[F.l0.p(4),F.l0.rowWithGap(4),F.l0.align.center,F.l0.borderRadius(0)];return p?(e.push({pointerEvents:"none"}),e.unshift(li.gU.filled)):e.unshift(li.gU.nofill),(0,iA.iv)(e)},[p]);return(0,E.BX)(uu.xo,{label:"File indentation",placement:"top",isOpen:p,onOpenChange:m,children:[function(e){return(0,E.tZ)(la.u,{tooltip:"File indentation",isDisabled:p,children:(0,E.tZ)("div",{css:u4.cursorOverlay,children:(0,E.BX)(M.K.button,(0,_._)((0,C._)({},e),{ref:e.ref,css:q,children:[(0,E.tZ)(u6,{type:f,loading:l}),(0,E.tZ)(u9,{type:f,size:d,loading:l})]}))})})},(0,E.BX)(M.G,{css:u4.menu,children:[(0,E.tZ)(M.G,{css:u4.close,children:(0,E.tZ)(t7.hU,{alt:"Close",onClick:function(){return m(!1)},children:(0,E.tZ)(tQ.Z,{})})}),(0,E.BX)(eT.h4,{level:1,children:["Indentation for",(0,E.BX)("span",{css:u4.file,children:[(0,E.tZ)(R.Z,{path:n,size:16})," ",(0,E.tZ)("span",{children:(0,nB.UO)(n)})]})]}),c?(0,E.tZ)(uf.E,{colorway:"warning",icon:(0,E.tZ)(cf.Z,{}),text:"This file type requires that ".concat(c===u$.Q.SPACES?"spaces":"tabs"," be used for indentation.")}):null,(0,E.tZ)(us.R,{}),(0,E.BX)(M.G,{css:u4.section,children:[(0,E.BX)(M.G,{css:u4.header,children:[(0,E.tZ)(eT.xv,{multiline:!1,children:"Indentation unit"}),(0,E.tZ)(eT.xv,{variant:"small",color:"dimmer",children:"The size and character to use when indenting lines."})]}),(0,E.BX)(M.G,{css:u4.selects,children:[(0,E.tZ)(u8.qm,{css:u4.sizeInput,size:Z,onChange:function(e){e!==Z&&(w(e),I(!0))}}),(0,E.tZ)(ud.P,{items:(0,S._)(u8.Ly),selectedItem:u8.Ly.find(function(e){return e.value===(g===u$.Q.SPACES?"spaces":"tabs")}),onChange:function(e){var t=(null==e?void 0:e.value)==="spaces"?u$.Q.SPACES:u$.Q.TABS;t!==g&&(y(t),I(!0))}})]})]}),(0,E.tZ)(us.R,{}),i.indentDetection?(0,E.BX)(E.HY,{children:[(0,E.BX)(M.G,{css:u4.section,children:[(0,E.BX)(M.G,{css:u4.header,children:[(0,E.tZ)(eT.xv,{multiline:!1,children:"Detected indentation unit"}),(0,E.tZ)(eT.xv,{variant:"small",color:"dimmer",children:j})]}),L?(0,E.tZ)(t9.zx,{colorway:"positive",text:"Detected!",iconLeft:(0,E.tZ)(ne.Z,{}),onClick:H}):(0,E.tZ)(t9.zx,{text:s?"Re-detect":"Detect",iconLeft:(0,E.tZ)(a6.Z,{}),disabled:!u&&!s,onClick:H})]}),(0,E.tZ)(us.R,{})]}):null,(0,E.BX)(M.G,{css:u4.buttonsGroup,children:[(0,E.tZ)(t9.zx,{text:"Global settings",iconLeft:(0,E.tZ)(u1.Z,{}),onClick:z}),(0,E.tZ)(M.G,{css:u4.saveButtons,children:G||A?(0,E.tZ)(E.HY,{children:G?(0,E.tZ)(t9.zx,{text:"Saved!",colorway:"positive",iconLeft:(0,E.tZ)(ne.Z,{}),onClick:function(){return V(!1)}}):(0,E.tZ)(t9.zx,{text:"Re-indented!",colorway:"positive",iconLeft:(0,E.tZ)(ne.Z,{}),onClick:W})}):(0,E.tZ)(E.HY,{children:T?(0,E.BX)(E.HY,{children:[(0,E.tZ)(t9.zx,{text:"Save and re-indent",colorway:"primary",iconLeft:(0,E.tZ)(u2.Z,{}),onClick:function(){return V(!0)}}),(0,E.tZ)(t9.zx,{text:"Save",iconLeft:(0,E.tZ)(ne.Z,{}),onClick:function(){return V(!1)}})]}):(0,E.tZ)(t9.zx,{text:"Re-indent file",iconLeft:(0,E.tZ)(u2.Z,{}),onClick:W})})})]})]})]})}function u5(e){var t=e.size,n=void 0===t?16:t,r=(0,eQ._)(e,["size"]);return(0,E.tZ)(u0.Z,(0,_._)((0,C._)({size:n},r),{children:(0,E.tZ)("circle",{cx:n,cy:n,r:n/2,fillRule:"evenodd"})}))}function u6(e){var t=e.type;return e.loading?(0,E.tZ)(t0.Z,{size:12}):t===u$.Q.SPACES?(0,E.tZ)(u5,{color:F.TV.foregroundDimmer,size:12}):(0,E.tZ)(u2.Z,{color:F.TV.foregroundDimmer,size:12})}function u9(e){var t=e.type,n=e.size;if(e.loading)return(0,E.tZ)(eT.xv,{variant:"small",color:"dimmest",children:"Detecting..."});var r=t===u$.Q.SPACES?"Spaces":"Tabs";return(0,E.BX)(eT.xv,{variant:"small",color:"dimmer",children:[r,": ",n]})}function u7(){var e=(0,sT._)(["\n  query StatusBarGhostwriterCompleteCodeStatus {\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return u7=function(){return e},e}var de={},dt=(0,sR.Ps)(u7()),dn=n(67914),dr=n(60769),di=n(71999),da=n(27879),dl=n(48581),dc=n(96905),ds=(0,tS.X)({roundedContainer:[{borderBottomLeftRadius:F.TV.space6}],featureHeader:[F.l0.rowWithGap(8),F.l0.align.center],popover:[F.l0.p(8),F.l0.borderRadius(8),F.l0.maxWidth(260),F.l0.colWithGap(8)],featureTitle:[F.l0.rowWithGap(4),F.l0.align.center,F.l0.flex.growAndShrink(1),F.l0.fontWeight.medium],enableAutocomplete:[F.l0.rowWithGap(4),F.l0.align.center],text:[F.l0.colWithGap(8)],hint:[F.l0.rowWithGap(4),F.l0.align.center]});function du(e){var t=(0,O.useId)();return(0,E.BX)(iL.Tg,{css:ds.popover,children:[(0,E.BX)(M.G,{css:ds.featureHeader,children:[(0,E.BX)(M.G,{css:ds.featureTitle,children:[(0,E.tZ)(dn.Z,{color:F.TV.blurpleDefault}),(0,E.tZ)(eT.xv,{children:"AI Autocomplete"})]}),(0,E.BX)(M.G,{css:ds.enableAutocomplete,children:[(0,E.tZ)(M.G,{tag:"label",htmlFor:t,children:(0,E.tZ)(eT.xv,{color:"dimmer",variant:"small",children:"Enable"})}),(0,E.tZ)(dr.X,{id:t,checked:e.checked,onChange:e.onChange})]})]}),(0,E.BX)(M.G,{css:ds.text,children:[(0,E.tZ)(eT.xv,{color:"dimmer",variant:"small",children:"Suggest lines of code as you type based on existing context."}),(0,E.BX)(M.G,{css:ds.hint,children:[(0,E.tZ)(eT.xv,{color:"dimmer",variant:"small",children:"Press"}),(0,E.tZ)(n7.bM,{small:!0,keyCombo:"Tab"}),(0,E.tZ)(eT.xv,{color:"dimmer",variant:"small",children:"to accept result"})]})]})]})}function dd(e,t){var n=e.view,r=e.skip,i=e.effect,o=(0,n4.Z)(t);(0,O.useEffect)(function(){if(n&&!r){var e=new ex.F6,t=e_.tk.updateListener.of(function(e){(0,eE.j)(e,i,function(t){return o.current(t,e)})});return n.dispatch({effects:ex.Py.appendConfig.of(e.of(t))}),function(){n.dispatch({effects:e.reconfigure([])})}}},[n,r,o,i])}var df=function(e){var t,n=e.rounded,r=void 0===n||n,i=function(){l({codeSuggestion:!a}),(0,tw.j)(tw.U3.CODE_SUGGESTION_TOGGLED,{enabled:!a,source:"editor_footer"})},o=(0,eb.Z)(),a=o.preferences.codeSuggestion,l=o.update,c=(0,k._)((0,di.KO)(dl.t),1)[0],s=(0,O.useRef)(!0),u=(0,ug.o)("ai-code-completion"),d=(0,tH.P5)({controlName:"flag-gw-charizard"}),f=(t=(0,C._)({},de,{skip:!d}),sI.a(dt,t)),h=f.data,p=f.loading,m=null==h?void 0:h.currentUser,v=(null==m?void 0:m.userSubscriptionType)===sE.HP.HackerPro,g=(0,O.useRef)(null),y=!u.isDone&&!v,b=(0,O.useRef)(!1),Z=(0,da.d)({onOpenChange:function(e){if(e){b.current=!0;return}setTimeout(function(){b.current=!1}),y&&u.setAsDone()}}),w=(0,Y.uN)();dd({view:w,effect:dc.dp,skip:!y},function(){s.current=!1,Z.open()}),dd({view:w,effect:oh.OK,skip:!y},function(e,t){var n=t.startState.field(oh.WF),r=t.state.field(oh.WF);!n.presented&&r.presented&&(s.current=!1,Z.open())});var x=(0,n4.Z)(Z);(0,O.useEffect)(function(){c.tooltipOpen&&(null==w?void 0:w.hasFocus)&&(s.current=!1,x.current.open())},[c.tooltipOpen,w,x]);var _=(0,E.tZ)(tk.Z,{color:a?F.TV.blurpleDefault:void 0});if(p||u.isLoading)return(0,E.BX)(E.HY,{children:[(0,E.tZ)(uW,{children:(0,E.tZ)(ur,{disabled:!0,text:"AI",iconLeft:_,css:r&&ds.roundedContainer})}),(0,E.tZ)(uV,{children:(0,E.tZ)(uj,{disabled:!0,alt:"AI",css:r&&ds.roundedContainer,children:_})})]});if(d)return(0,E.BX)(E.HY,{children:[(0,E.BX)(M.G,{innerRef:g,children:[(0,E.tZ)(uW,{children:(0,E.tZ)(ur,{text:"AI",iconLeft:_,css:r&&ds.roundedContainer,onClick:function(){b.current||Z.open()}})}),(0,E.tZ)(uV,{children:(0,E.tZ)(la.u,{tooltip:"AI",placement:"top-start",children:(0,E.tZ)(uj,{alt:"AI",css:r&&ds.roundedContainer,onClick:function(){b.current||Z.open()},children:_})})})]}),Z.isOpen?(0,E.tZ)(uu.Bf,{placement:"top left",background:"default",triggerRef:g,onOpenChange:Z.setOpen,isOpen:Z.isOpen,children:(0,E.tZ)(uu.Vq,{role:"dialog","aria-label":"AI Autocomplete",children:(0,E.tZ)(du,{onChange:i,checked:a})})}):null]});var S=a?"Disable":"Enable";return(0,E.BX)(E.HY,{children:[(0,E.tZ)(uW,{children:(0,E.tZ)(la.u,{tooltip:"".concat(S," ").concat(d?"AI":"Ghostwriter"," Code Completion"),placement:"top-start",children:(0,E.tZ)(ur,{text:d?"AI":"Ghostwriter",iconLeft:_,onClick:i,css:r&&ds.roundedContainer})})}),(0,E.tZ)(uV,{children:(0,E.tZ)(la.u,{tooltip:"".concat(S," ").concat(d?"AI":"Ghostwriter"," Code Completion"),placement:"top-start",children:(0,E.tZ)(uj,{alt:"".concat(S," ").concat(d?"AI":"Ghostwriter"," Code Completion"),onClick:i,css:r&&ds.roundedContainer,children:_})})})]})},dh=n(21012),dp=(0,tS.X)({root:[F.l0.position.relative,F.l0.rowWithGap(16),F.l0.align.center,F.l0.justify.spaceBetween,F.l0.backgroundColor.backgroundDefault,F.l0.container("StatusBar"),{borderTop:"1px solid ".concat(F.TV.backgroundHigher)},{height:"29px",contain:"strict"}],group:[F.l0.flex.row,F.l0.flex.shrink(1),F.l0.align.center]});function dm(e){var t=e.filePath,n=e.performPaneOperation,r=(0,tH.P5)({controlName:"flag-lsp-diagnostics-in-footer",logFlagToAnalytics:!1}),i=(0,$.d)(),o=(0,dh.ZP)(),a=(0,tH.P5)({controlName:"flag-status-bar-branch",logFlagToAnalytics:!1}),l=(0,tH.P5)({controlName:"flag-editor-git-inline-diff",logFlagToAnalytics:!1}),c=(0,T.T3)()?void 0:{borderBottomLeftRadius:7,borderBottomRightRadius:7},s=(0,nf.Z)(function(){return function(){n({operation:"replace",pane:{type:"history",data:{path:t}}})}},[t,n]),u=(0,nf.Z)(function(){return function(){n({operation:"open",pane:{type:"preferences"}})}},[n]);return(0,E.BX)(iL.Tg,{css:dp.root,style:c,children:[(0,E.BX)(M.G,{css:dp.group,children:[(0,dh.G_)(o)&&!i?(0,E.tZ)(df,{}):null,i?null:(0,E.tZ)(uw,{openSettings:u}),!i&&r?(0,E.tZ)(uL,{}):null,a?(0,E.tZ)(ui,{performPaneOperation:n}):null,l?(0,E.tZ)(uY,{}):null,(0,E.tZ)(uG,{})]}),(0,E.BX)(M.G,{css:dp.group,children:[(0,E.tZ)(uR,{}),(0,E.tZ)(u3,{path:t,openSettings:u}),(0,E.tZ)(uc,{onOpen:s,rounded:!i})]})]})}var dv=n(41084),dg=n(1518),dy=n(12915),db=n(50244),dZ=n(20399),dw=n(52413),dx=n(3705),dC=n(42267),d_=(0,iA.iv)([li.gU.nofill,{transitionProperty:"background-color, box-shadow, opacity",opacity:.8,":focus":{zIndex:1,opacity:1}}]),dk={button:(0,iA.iv)([F.l0.reset.button,F.l0.p(2),F.l0.rowWithGap(4),F.l0.align.center,d_]),text:(0,iA.iv)({fontSize:F.TV.fontSizeSmall})},dS={opacity:1};function dE(e){var t=e.icon,n=e.text,r=e.innerRef,i=e.ariaProps,o=e.active,a=(0,dw.U)(i,r).buttonProps,l=(0,dx.XI)({}),c=l.hoverProps,s=l.isHovered;return(0,E.BX)(M.G,(0,_._)((0,C._)({tag:"button",css:dk.button,style:s||o?dS:void 0,innerRef:r},(0,dC.dG)(a,c)),{children:[t?(0,O.cloneElement)(t,{size:16}):null,(0,E.tZ)(M.G,{css:dk.text,children:n})]}))}var dT=n(42634),dR=n(10910),dI={underlay:(0,iA.iv)([F.l0.coverContainer,F.l0.position.fixed]),surface:(0,iA.iv)([F.l0.borderRadius(8),{boxShadow:F.TV.shadow2,border:"1px solid",borderColor:F.TV.backgroundHighest}])};function dD(e){var t=e.state,n=e.triggerRef,r=e.placement,i=e.children,o=(0,k._)((0,dR.Z)(),2),a=o[0],l=o[1],c=(0,dT.Sv)({placement:r,triggerRef:n,popoverRef:a,offset:8},t),s=c.popoverProps,u=c.underlayProps;return(0,E.BX)(dT.aV,{children:[(0,E.tZ)(M.G,(0,_._)((0,C._)({},u),{css:dI.underlay})),(0,E.BX)(iL.Tg,(0,_._)((0,C._)({elevated:!0,css:dI.surface,innerRef:l},s),{children:[(0,E.tZ)(dT.U4,{onDismiss:t.close}),i,(0,E.tZ)(dT.U4,{onDismiss:t.close})]}))]})}var dG=n(88298),dB=(0,iA.iv)([F.l0.p(4)]);function dP(e){var t=e.items,n=e.children,r=e.menuProps,i=e.selectedKeys,o=e.onAction,a=(0,dG.D)({items:t,children:n,selectedKeys:i,selectionMode:"single"}),l=(0,O.useRef)(null),c=(0,db.H9)((0,C._)({items:t,onAction:o},r),a,l);return(0,E.tZ)(M.G,(0,_._)((0,C._)({},c.menuProps),{innerRef:l,css:dB,children:(0,S._)(a.collection).map(function(e){return(0,E.tZ)(dU,{item:e,state:a},e.key)})}))}var dA={root:(0,iA.iv)([F.l0.flex.row,F.l0.align.center,F.l0.position.relative,d_]),selected:(0,iA.iv)([{opacity:1,backgroundColor:li.vb.interactiveBackground}])},dN={opacity:1};function dU(e){var t=e.item,n=e.state,r=(0,O.useRef)(null),i=(0,db.iX)({key:t.key},n,r),o=i.menuItemProps,a=i.isSelected,l=(0,dx.XI)({}),c=l.hoverProps,s=l.isHovered;return(0,E.tZ)(M.G,(0,_._)((0,C._)({innerRef:r,css:[dA.root,a&&dA.selected],style:s||a?dN:void 0},(0,dC.dG)(o,c)),{children:t.rendered}))}var dL={root:(0,iA.iv)([F.l0.p(4),F.l0.rowWithGap(4),F.l0.align.center]),text:(0,iA.iv)([F.l0.truncate,F.l0.flex.growAndShrink(1),{fontSize:F.TV.fontSizeDefault}])};function dO(e){return(0,E.BX)(M.G,{css:[dL.root],children:[e.icon?(0,O.cloneElement)(e.icon,{size:16}):null,(0,E.tZ)(M.G,{css:dL.text,children:e.text})]})}var dX=n(21158),dM=n(52686),dF=n(71104),dW=n(31070),dH=n(84271),dV=n(71064),dz=n(18514),dj=n(67337),dq=n(39810),dY=n(51828),d$=n(19012),dJ=function(e){var t=new Set(d$.Z),n=new Map,r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=(0,k._)(a.value,3),s=c[0],u=c[1],d=c[2];if(!t.has(s))throw Error("Symbol not supported by LSP client. Please add to the supported symbol icons array");if("string"==typeof u){var f=dY.s.get(u);if(!f)throw Error("Couldn't find matching icon for ".concat(u));u=f}n.set(s,[u,null!=d?d:F.TV.foregroundDefault])}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}([[eI.SymbolKind.Array,dz.Z],[eI.SymbolKind.Boolean,B.Z],[eI.SymbolKind.Class,"class",F.TV.yellowDefault],[eI.SymbolKind.Constant,"constant",F.TV.blueStronger],[eI.SymbolKind.Constructor,"method",F.TV.blurpleDefault],[eI.SymbolKind.Enum,dF.Z,F.TV.orangeDefault],[eI.SymbolKind.EnumMember,dq.Z,F.TV.blueStronger],[eI.SymbolKind.Event,dX.Z],[eI.SymbolKind.Field,dj.Z],[eI.SymbolKind.File,dW.Z],[eI.SymbolKind.Function,"function",F.TV.blurpleStronger],[eI.SymbolKind.Interface,dH.Z,F.TV.blueStronger],[eI.SymbolKind.Key,dV.Z],[eI.SymbolKind.Method,"method",F.TV.blurpleDefault],[eI.SymbolKind.Module,sZ.Z,F.TV.purpleDefault],[eI.SymbolKind.Namespace,dM.Z],[eI.SymbolKind.Object,B.Z,F.TV.blueDimmer],[eI.SymbolKind.Operator,B.Z],[eI.SymbolKind.Package,sZ.Z,F.TV.purpleDefault],[eI.SymbolKind.Property,dj.Z],[eI.SymbolKind.String,G.Z],[eI.SymbolKind.Struct,dM.Z],[eI.SymbolKind.TypeParameter,dq.Z],[eI.SymbolKind.Variable,dq.Z,F.TV.blueStronger]]);function dK(e){var t,n=e.kind,r=(0,k._)(null!==(t=dJ.get(n))&&void 0!==t?t:[B.Z,F.TV.foregroundDefault],2),i=r[0],o=r[1];return(0,E.tZ)(i,{color:o,size:16})}function dQ(e){return CSS.escape(e.name)}function d0(e){var t=e.selectedSymbol,n=e.symbols,r=e.moveCursor,i=e.icon,o=e.text,a=(0,dy.W)({onOpenChange:function(e){e&&(0,tw.j)(tw.U3.CODE_NAVIGATION_USED,{action:"opened"})}}),l=O.useRef(null),c=(0,db.u4)({},a,l),s=c.menuTriggerProps,u=c.menuProps,d=t?new Set([t.name]):void 0;return(0,E.BX)(E.HY,{children:[(0,E.tZ)(dE,{text:o,icon:i,innerRef:l,ariaProps:s,active:a.isOpen}),a.isOpen?(0,E.tZ)(dD,{triggerRef:l,state:a,placement:"bottom left",children:(0,E.tZ)(dP,{menuProps:u,items:n,selectedKeys:d,onAction:function(e){var t=n.find(function(t){return dQ(t)===e});t&&(r(t.selectionRange.start),(0,tw.j)(tw.U3.CODE_NAVIGATION_USED,{action:"jumped"}))},children:function(e){return(0,E.tZ)(dZ.ck,{children:(0,E.tZ)(dO,{icon:(0,E.tZ)(dK,{kind:e.kind}),text:e.name})},dQ(e))}})}):null]})}var d1=O.memo(function(e){var t=e.symbols,n=e.symbolsPath,r=e.moveCursor,i=n.length?n[n.length-1]:null,o=i?i.children:t;return(0,E.BX)(E.HY,{children:[n.map(function(e,i){var o=0===i?t:n[i-1].children;return o?(0,E.BX)(O.Fragment,{children:[(0,E.tZ)(sn.Z,{size:12}),(0,E.tZ)(d0,{symbols:o,icon:(0,E.tZ)(dK,{kind:e.kind}),text:e.name,selectedSymbol:e,moveCursor:r})]},dQ(e)):null}),(null==o?void 0:o.length)?(0,E.BX)(E.HY,{children:[(0,E.tZ)(sn.Z,{size:12}),(0,E.tZ)(d0,{symbols:o,text:"...",moveCursor:r})]}):null]})}),d2=(0,O.memo)(function(e){var t,n=e.view,r=(0,O.useCallback)(function(e){null==n||n.dispatch({scrollIntoView:!0,selection:ex.jT.cursor((0,ek.R)(n.state.doc,e))}),null==n||n.focus()},[n]),i=(0,O.useDeferredValue)({symbols:(0,ie.IK)(n,rk),symbolsPath:(0,ie.IK)(n,rT)});return(null===(t=i.symbols)||void 0===t?void 0:t.length)?(0,E.tZ)(d1,{symbols:i.symbols,symbolsPath:i.symbolsPath||[],moveCursor:r}):null}),d8=n(12506),d4=n(66995);function d3(e){var t=e.path,n=e.performPaneOperation,r=(0,Y.uN)(),i=(0,O.useCallback)(function(e){n({operation:"open",pane:(0,d8.$E)(e)})},[n]);return(0,E.tZ)(d8.h4,{children:(0,E.tZ)(d8.Qc,{children:(0,E.tZ)(d4.tr,{path:t,onFileClick:i,children:(0,E.tZ)(d2,{view:r})})})})}function d5(e){var t=(0,dg.Z)(),n=(0,el.xZ)(e.filePath),r=(0,dv.Z)(s$.y.Editor),i=(0,X.Z)(),o=e.performPaneOperation,a=(0,O.useCallback)(function(e){return o({operation:"open",pane:e,secondary:!0})},[o]);return(0,E.BX)("div",{ref:r,css:{position:"relative",display:"flex",flexDirection:"column",overflowY:"hidden",height:"100%",width:"100%",boxShadow:"".concat(t?"0 3px 0 3px ".concat(t):"0"),borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"},children:[e.performPaneOperation?(0,E.tZ)(d3,{performPaneOperation:e.performPaneOperation,path:e.filePath}):null,(0,E.BX)("div",{css:ok.ev,children:[(0,E.tZ)(s9,{openPane:a,openFile:e.openFile,openThreadsInbox:e.openThreadsInbox,filePath:e.filePath,autoFocus:e.autoFocus,hideMobileKeyboardToolbar:e.hideMobileKeyboardToolbar,isHidden:e.isHidden,deeplink:e.deeplink,onDeeplinkUpdated:e.onDeeplinkUpdated}),n?(0,E.tZ)(ea,{}):null]}),(0,E.tZ)("div",{css:{display:i?"none":"block"},children:(0,E.tZ)(dm,{filePath:e.filePath,performPaneOperation:e.performPaneOperation})}),e.hideMobileKeyboardToolbar?null:(0,E.tZ)(et,{filePath:e.filePath,isLoading:!1})]})}var d6=n(31171),d9=n(81),d7=(0,tS.X)({root:[F.l0.coverContainer,F.l0.center,F.l0.p(16)]});function fe(e){var t=e.message;return(0,E.tZ)(M.G,{css:d7.root,children:(0,E.tZ)(M.G,{children:(0,E.tZ)(uf.E,{icon:(0,E.tZ)(cf.Z,{}),colorway:"orange",text:t})})})}var ft=n(68099),fn=n(92809),fr=n(36617),fi=n(8622),fo=fn.Type.Object({type:fn.Type.Literal("codeEditor"),data:fn.Type.Object({path:fn.Type.Union([fn.Type.String({minLength:1}),fn.Type.Null()]),line:fn.Type.Optional(fn.Type.Number()),col:fn.Type.Optional(fn.Type.Number())})}),fa={Content:function(e){var t=e.pane,n=e.options;return(0,E.tZ)(fc,(0,_._)((0,C._)({},t.data),{isActive:n.isActive,isHidden:n.isHidden,performPaneOperation:n.performPaneOperation}))},Icon:function(e){var t=e.pane,n=e.size;return(0,E.tZ)(R.Z,{path:t.data.path||"",size:n})},getTitle:function(e){return e.data.path?(0,nB.UO)(e.data.path):"No file open"},decode:function(e){return fr.B4.Decode(fo,e)}};function fl(e){var t,n,r,i,o,a=e.path,l=e.performPaneOperation,c=(0,Y.uN)(),s=(0,nf.Z)(function(){return c?{match:nw.pl,data:{type:"action",label:"Toggle all folds",icon:(0,E.tZ)(sn.Z,{}),run:function(){0===(0,e1.q2)(c.state).size?(0,e1.g_)(c):(0,e1.jZ)(c)}}}:null},[c]),u=(0,ie.IK)(c,fi.W),d=(0,ie.IK)(c,cQ.Gz),f=(0,ie.IK)(c,cQ.SD);(0,O.useEffect)(function(){u&&l({operation:"commit"})},[u,l]);var h=(0,nf.Z)(function(){return c&&f?d?{type:"action",icon:(0,E.tZ)(t0.Z,{}),label:"Formatting...",run:function(){}}:{dataCy:"ws-format-btn",type:"action",icon:(0,E.tZ)(d9.Z,{}),label:"Format "+(0,nB.UO)(a),run:function(){(0,cQ.z1)(c)}}:null},[c,f,d,a]),p=(0,d8.Mp)({path:a,performPaneOperation:l}),m=(t=(0,T.T3)(),r=(n=(0,eb.Z)()).preferences.minimapDisplay,i=n.update,(0,nf.Z)(function(){return t?null:{match:nw.pl,data:{label:"Minimap",icon:(0,E.tZ)(I.Z,{}),type:"context"},commands:function(e){var t=e.active,n=e.search;return t||n?[{value:"none",label:"Hide",icon:(0,E.tZ)(D.Z,{})},{value:"characters",label:"Characters",icon:(0,E.tZ)(G.Z,{})},{value:"blocks",label:"Blocks",icon:(0,E.tZ)(B.Z,{})}].filter(function(e){return e.value!==r}).map(function(e){return{match:nw.pl,data:{type:"action",label:e.label,icon:e.icon,run:function(){i({minimapDisplay:e.value})}}}}):[]}}},[i,r,t])),v=(o=function(){return l({operation:"replace",pane:{type:"history",data:{path:a}}})},(0,nf.Z)(function(){return{match:nw.pl,data:{label:"History",icon:(0,E.tZ)(uo.Z,{}),type:"action",run:function(){o()}}}},[o]));return(0,uP.L5)(function(){var e,t=function(e){return{label:"Preview",icon:(0,E.tZ)(ca.Z,{}),type:"action",run:function(){l({operation:"replace",pane:{type:e,data:{path:a}}})}}};if(c){var n=[];return n.push(v),m&&n.push(m),s&&n.push(s),p&&n.push.apply(n,(0,S._)(p)),h&&(e=[h]),(0,nB.B4)(a)&&(e=e&&e.length?[e[0],t("media")]:[t("media")]),(0,nB.gK)(a)&&(e=e&&e.length?[e[0],t("markdown")]:[t("markdown")]),{type:"codeEditor",actions:e,commands:n,getEditorView:function(){return c},getCurrentSelectionText:function(){if(!c.state.selection.main.empty)return c.state.sliceDoc(c.state.selection.main.from,c.state.selection.main.to)},insertGhostwriterChatCode:function(e,t){a8({view:c,insert:e,overwrite:t})},revertGhostwriterChatCode:function(){a4(c)},fetchProblems:function(){var e;return(0,ft.j)(c),null!==(e=c.state.field(ej.G0,!1))&&void 0!==e?e:[]}}}},[c,h,s,p,m,v,l,a]),(0,uP.Wk)(function(){return c},[c]),null}function fc(e){var t,n,r,i,o=e.path,a=e.line,l=e.col,c=e.isActive,s=e.isHidden,u=e.performPaneOperation,d=(0,k._)((0,O.useState)(function(){return(0,N.MT)()}),1)[0],f=(0,k._)((0,O.useState)(function(){return(0,N.MT)()}),1)[0],h=(0,P.useRouter)(),p=!(A().query.embed||A().query.lite)&&!(0,T.Vg)(h)&&c,m=(t=(0,eu.Z)().fs,r=(n=(0,k._)((0,O.useState)(null),2))[0],i=n[1],(0,O.useEffect)(function(){if(o){var e=t.watchPathStat(o,{onNewStat:function(e){if(!e.exists){i('No file found at "'.concat(o,'", it may have been deleted'));return}if(e.type===r0.Tv.Directory){i('"'.concat(o,'" is a directory'));return}i(null)},onError:function(){i('Unknown error occured while read "'.concat(o,'", try re-opening the editor'))}});return function(){e(),i(null)}}},[t,o]),r),v=(0,nf.Z)(function(){return{line:a,col:l}},[a,l]),g=(0,nf.Z)(function(){return function(){u({operation:"replace",pane:{type:"codeEditor",data:{path:o}}})}},[u,o]),y=(0,nf.Z)(function(){return function(e){u({operation:"commit"}),u({operation:"open",pane:{type:"codeEditor",data:e}})}},[u]),b=(0,O.useCallback)(function(){u({operation:"open",secondary:!0,pane:{type:"threadInbox"}})},[u]);return o?m?(0,E.tZ)(fe,{message:m}):(0,E.tZ)(Y.Cl.Provider,{value:d,children:(0,E.BX)(d6.ox.Provider,{value:f,children:[(0,E.tZ)(d5,{filePath:o,autoFocus:p,isHidden:null!=s&&s,deeplink:v,onDeeplinkUpdated:g,hideMobileKeyboardToolbar:!0,performPaneOperation:u,openFile:y,openThreadsInbox:b},o),(0,E.tZ)(fl,{path:o,isActive:c,performPaneOperation:u})]})}):null}},94255:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(92809),i=n(36617),o=r.Type.Object({type:r.Type.Literal("commands"),data:r.Type.Object({autoFocus:r.Type.Boolean()})}),a=function(e){return i.B4.Decode(o,e)}},14985:function(e,t,n){n.d(t,{R:function(){return al}});var r,i,o,a,l,c,s,u,d,f=n(32477),h=n(8182),p=n(52902),m=n(43429),v=n(56596),g=n(29287),y=n(34142),b=n(87682),Z=n(60427),w=n(50782),x=n(37951),C=n(93918),_=n(45087),k=n(7877),S=n(18514),E=n(58003),T=n(20573),R=n(75582),I=n(1498),D=n(93496),G=n(38080),B=n(14186),P=n(50494),A=(0,C.X)({root:[{borderBottom:"1px solid ".concat(g.TV.outlineDimmest)}],inner:[g.l0.position.relative,{"::before":{content:'""',display:"block",position:"absolute",left:0,width:8,height:"100%",background:"linear-gradient(90deg, ".concat(g.TV.backgroundDefault," 0%, rgba(0,0,0,0) 100%);"),zIndex:1},"::after":{content:'""',display:"block",position:"absolute",right:0,width:8,height:"100%",background:"linear-gradient(270deg, ".concat(g.TV.backgroundDefault," 0%, rgba(0,0,0,0) 100%);"),zIndex:1}}],tabs:[g.l0.flex.row,g.l0.align.center,g.l0.overflowX("auto"),g.l0.pl(8)],tab:[D.gU.nofill,g.l0.borderRadius(0),g.l0.px(12),g.l0.position.relative,{transition:"none",height:38,marginRight:1,"::after":{content:'""',display:"block",position:"absolute",right:-2,width:1,height:16,backgroundColor:g.TV.outlineDimmest},"&:last-child":{marginRight:0,"::after":{display:"none"}}}],dot:[g.l0.position.absolute,g.l0.borderRadius(16),g.l0.width(8),g.l0.height(8),g.l0.backgroundColor.accentPrimaryStronger,{top:8,right:8}]}),N=function(e){var t=e.tabs,n=e.activeView,r=e.onClick,i=(0,P.o)("deployment-analytics-dot"),o=i.isLoading,a=i.isDone;return(0,h.tZ)(G.Tg,{css:A.root,children:(0,h.tZ)(v.G,{css:A.inner,children:(0,h.tZ)(v.G,{css:A.tabs,children:t.map(function(e){return(0,h.BX)(v.G,{css:g.l0.position.relative,children:[(0,h.tZ)(I.zx,{style:{borderBottom:"1px solid "+(n===e.view?g.TV.foregroundDefault:"transparent")},css:A.tab,text:e.label,iconLeft:e.icon,onClick:function(){return r(e)}}),e.view!==B.k.Analytics||o||a?null:(0,h.tZ)(v.G,{css:A.dot})]},e.view)})})})})},U=n(45903),L=n(25e3),O=n(70322),X=n(92977),M=[g.l0.px(8),g.l0.pt(16)],F=(0,C.X)({root:[M],rootMaxWidth:[M,X.Qw.maxWidth]}),W=function(e){var t=e.children,n=e.maxWidth,r=(0,O._)(e,["children","maxWidth"]);return(0,h.tZ)(v.G,(0,L._)((0,U._)({},r),{css:n?F.rootMaxWidth:F.root,children:t}))},H=n(39698),V=n(74833),z=n(16704),j=n(21166),q=n(54449),Y=n(70671),$=n(8279),J=n(93295),K=n(23982),Q=n(66039);function ee(){var e=(0,J._)(["\n  fragment ReplAnalyticsPageViewDataPoint on ReplAnalyticsPageViewsData {\n    __typename\n    timestamp\n    success\n    failure\n  }\n"]);return ee=function(){return e},e}function et(){var e=(0,J._)(["\n  fragment ReplAnalyticsPageViews on ReplAnalyticsPageViews {\n    __typename\n    uniques\n    results {\n      ...ReplAnalyticsPageViewDataPoint\n    }\n  }\n  ","\n"]);return et=function(){return e},e}function en(){var e=(0,J._)(["\n  query ReplAnalyticsPageViews(\n    $id: String!\n    $input: ReplAnalyticsPageViewsInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsPageViews(input: $input) {\n          ... on ReplAnalyticsPageViews {\n            ...ReplAnalyticsPageViews\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return en=function(){return e},e}var er={},ei=(0,K.Ps)(ee()),eo=(0,K.Ps)(et(),ei),ea=(0,K.Ps)(en(),eo),el=n(22539),ec=n(83109),es=n(25201),eu=n(51535),ed=n(51384),ef=(0,ed.iv)([g.l0.maxHeight(320),g.l0.minHeight(240),{aspectRatio:"2 / 1"}]);function eh(){var e=(0,Y.F)().values;return{animation:{duration:0},backgroundColor:e.global.backgroundHigher,borderColor:e.global.outlineDimmer,borderWidth:1,titleFont:{family:"'IBM Plex Sans', sans-serif"},bodyFont:{family:"'IBM Plex Sans', sans-serif"},footerFont:{family:"'IBM Plex Sans', sans-serif"},padding:8,cornerRadius:6}}el.kL.register(el.uw,el.f$,el.od,el.jn,el.u);var ep=function(e){var t=e.labels,n=e.datasets,r=e.maintainAspectRatio,i=(0,Y.F)().values,o={labels:t.map(function(e){return e.toISOString()}),datasets:n.map(function(e){return(0,L._)((0,U._)({},e),{data:e.data.map(function(e){var t=e.x,n=e.y;return{x:t.toISOString(),y:n}}),pointRadius:.5,tension:.1})})},a=t.length;return(0,h.tZ)(eu.x1,{options:{clip:4,interaction:{mode:"nearest",intersect:!1},transitions:{active:{animation:{duration:0}}},elements:{point:{hoverRadius:4},line:{borderWidth:2}},responsive:!0,maintainAspectRatio:void 0===r||r,plugins:{tooltip:(0,L._)((0,U._)({},eh()),{callbacks:{title:function(e){var t=new Date(e[0].label);return(0,ec.Z)(t,"MMM d, HH:mm (z)")}}})},scales:{y:{title:{display:!0,text:"# Requests",color:i.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:i.global.outlineDimmest},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:i.global.foregroundDimmer,callback:function(e){if("number"==typeof e&&Math.floor(e)===e)return e}},min:0},x:{title:{display:!0,text:"Time",color:i.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:i.global.outlineDimmest},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:i.global.foregroundDimmer,callback:function(e,n){var r=t[n];if(a<=24){if(r.getHours()%4!=0)return;return(0,ec.Z)(r,"HH:mm")}if(r.toISOString()===(0,es.Z)(r).toISOString())return(0,ec.Z)(r,"MMM d")}}}}},data:o})},em=function(e){var t=e.data,n=e.start,r=e.hours,i=(0,Y.F)().values,o=Array(r).fill(0).map(function(e,t){return(0,q.Z)(n,t)}),a=t.results.reduce(function(e,t){return e.set(t.timestamp,t),e},new Map),l=[{label:"Connected",data:o.map(function(e){var t;return{y:(null!==(t=a.get(e.toISOString()))&&void 0!==t?t:{success:0}).success,x:e}}),borderColor:i.global.accentPrimaryDefault,backgroundColor:i.global.accentPrimaryDefault},{label:"Failed",data:o.map(function(e){var t;return{y:(null!==(t=a.get(e.toISOString()))&&void 0!==t?t:{failure:0}).failure,x:e}}),borderColor:i.global.accentNegativeDefault,backgroundColor:i.global.accentNegativeDefault}];return(0,h.tZ)(ep,{labels:o,datasets:l,maintainAspectRatio:!1})},ev=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=(0,f._)((0,m.useState)(void 0),2),c=l[0],s=l[1],u=(t=(0,U._)({},er,{variables:{id:i,input:{start:o,hours:a,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsPageViews.__typename){case"UserError":case"NotFoundError":s(Error(e.repl.analyticsPageViews.message))}}}),Q.a(ea,t)),d=u.data,p=u.loading,y=u.error,b=(null==d?void 0:null===(n=d.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=d.repl.analyticsPageViews)||void 0===r?void 0:r.__typename)==="ReplAnalyticsPageViews"?d.repl.analyticsPageViews:void 0,Z=b?b.uniques:void 0;return y&&s(y),(0,h.BX)(v.G,{css:[g.l0.colWithGap(8)],children:[(0,h.BX)(v.G,{css:[g.l0.flex.row,g.l0.align.center,g.l0.justify.spaceBetween],children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",multiline:!1,children:"Requests"}),Z?(0,h.BX)(V.xv,{multiline:!1,children:[(0,h.tZ)("strong",{children:Z})," unique visitors"]}):null]}),(0,h.BX)(v.G,{children:[p?(0,h.tZ)(v.G,{css:[g.l0.width("100%"),ef,g.l0.borderRadius(8),$.p.backgroundPulse()]}):null,c?(0,h.tZ)(x.E,{text:c.message,colorway:"negative"}):null,b?(0,h.tZ)(v.G,{css:ef,children:(0,h.tZ)(em,{data:b,start:o,hours:a})}):null]})]})},eg=n(21289),ey=n(60671);function eb(){var e=(0,J._)(["\n  fragment ReplAnalyticsTopListResult on ReplAnalyticsTopList {\n    __typename\n    results {\n      __typename\n      value\n      count\n    }\n  }\n"]);return eb=function(){return e},e}function eZ(){var e=(0,J._)(["\n  query ReplAnalyticsTopList($id: String!, $input: ReplAnalyticsTopInput!) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsTopList(input: $input) {\n          ... on ReplAnalyticsTopList {\n            ...ReplAnalyticsTopListResult\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return eZ=function(){return e},e}var ew={},ex=(0,K.Ps)(eb()),eC=(0,K.Ps)(eZ(),ex),e_=n(96546),ek=n.n(e_),eS=n(35908),eE=n(87599),eT=n(15146),eR=function(e){var t=e.data,n=e.variant;if(0===t.results.length)return(0,h.tZ)(V.xv,{multiline:!1,children:"No results"});switch(n){case"map":return(0,h.tZ)(eG,{data:t});case"pie":return(0,h.tZ)(eD,{data:t,devices:!1});case"device-pie":return(0,h.tZ)(eD,{data:t,devices:!0});case"table":return(0,h.tZ)(eI,{data:t})}},eI=function(e){var t=e.data;return el.kL.register(el.qi),(0,h.tZ)(v.G,{children:t.results.map(function(e,t){return(0,h.BX)(v.G,{css:[g.l0.rowWithGap(16),g.l0.py(8),{borderBottom:"1px solid ".concat(g.TV.outlineDimmest)},{"&:last-of-type":{borderBottom:"none"}}],children:[(0,h.tZ)(v.G,{css:[g.l0.flex.grow(1),g.l0.maxWidth("90%")],children:(0,h.tZ)(V.xv,{title:e.value,multiline:!1,children:e.value})}),(0,h.tZ)(v.G,{children:(0,h.tZ)(V.xv,{multiline:!1,children:e.count})})]},t)})})},eD=function(e){var t=e.data,n=e.devices,r=(0,Y.F)().values,i=[r.global.blueDefault,r.global.blurpleDefault,r.global.greenDefault,r.global.limeDefault,r.global.magentaDefault,r.global.orangeDefault,r.global.pinkDefault,r.global.purpleDefault,r.global.redDefault,r.global.tealDefault,r.global.yellowDefault],o=new Map;return n?t.results.forEach(function(e){var t=e.value,n=e.count,r=t.match(/\(.*\)/);if(r&&r.length){var i=r[0].substring(1,r[0].length-1),a=o.get(i)||0;o.set(i,a+n)}else{var l=o.get("Unknown")||0;o.set("Unknown",l+n)}}):t.results.forEach(function(e){var t=e.value,n=e.count,r=t.replace(/ \(.*\)/,""),i=o.get(r)||0;o.set(r,i+n)}),(0,h.tZ)(v.G,{css:ef,children:(0,h.tZ)(eu.by,{options:{radius:"90%",maintainAspectRatio:!1,plugins:{tooltip:eh()}},data:{labels:(0,eg._)(o.keys()),datasets:[{borderWidth:(0,eg._)(o.keys()).length>1?1:0,borderColor:r.global.outlineDimmest,data:(0,eg._)(o.values()),backgroundColor:Array(o.size).fill(0).map(function(e,t){return i[t%i.length]})}]}})})},eG=function(e){var t=e.data,r=ek()(function(){return Promise.all([n.e(5381),n.e(4096),n.e(1275),n.e(1455)]).then(n.bind(n,11455))},{loadableGenerated:{webpack:function(){return[11455]}},ssr:!1}),i=t.results.map(function(e){return{country:e.value,numHits:e.count}});return(0,h.tZ)(r,{countries:i})},eB=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=e.metric,c=e.count,s=e.variant,u=void 0===s?"table":s,d=e.expandable,p=(0,ey.CZ)(l),y=(0,f._)((0,m.useState)(void 0),2),b=y[0],Z=y[1],w=(0,f._)((0,m.useState)(!1),2),C=w[0],_=w[1],k=(t=(0,U._)({},ew,{variables:{id:i,input:{metric:l,start:o,hours:a,deployment:!0,count:C?3*c:c}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsTopList.__typename){case"UserError":case"NotFoundError":Z(Error(e.repl.analyticsTopList.message))}}}),Q.a(eC,t)),S=k.data,E=k.loading,T=k.error;return T&&Z(T),(0,h.BX)(v.G,{css:g.l0.colWithGap(8),children:[(0,h.BX)(v.G,{css:g.l0.rowWithGap(8),children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",multiline:!1,children:"device-pie"===u?"Top Devices":"Top ".concat(p)}),void 0!==d&&d?(0,h.tZ)(eT.hU,{alt:C?"Collapse list":"Expand list",onClick:function(){return _(!C)},children:C?(0,h.tZ)(eE.Z,{}):(0,h.tZ)(eS.Z,{})}):null]}),(0,h.BX)(v.G,{children:[E?(0,h.tZ)(v.G,{css:[g.l0.height(80),g.l0.borderRadius(8),$.p.backgroundPulse()]}):null,b?(0,h.tZ)(x.E,{text:b.message,colorway:"negative"}):null,(null==S?void 0:null===(n=S.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=S.repl.analyticsTopList)||void 0===r?void 0:r.__typename)==="ReplAnalyticsTopList"?(0,h.tZ)(eR,{variant:u,data:S.repl.analyticsTopList}):null]})]})};function eP(){var e=(0,J._)(["\n  fragment ReplAnalyticsTimeSeriesDataPoint on ReplAnalyticsTimeSeriesData {\n    __typename\n    timestamp\n    value\n    count\n  }\n"]);return eP=function(){return e},e}function eA(){var e=(0,J._)(["\n  fragment ReplAnalyticsTimeSeries on ReplAnalyticsTimeSeries {\n    __typename\n    results {\n      ...ReplAnalyticsTimeSeriesDataPoint\n    }\n  }\n  ","\n"]);return eA=function(){return e},e}function eN(){var e=(0,J._)(["\n  query ReplAnalyticsTimeSeries(\n    $id: String!\n    $input: ReplAnalyticsTimeSeriesInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsTimeSeries(input: $input) {\n          ... on ReplAnalyticsTimeSeries {\n            ...ReplAnalyticsTimeSeries\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return eN=function(){return e},e}var eU={},eL=(0,K.Ps)(eP()),eO=(0,K.Ps)(eA(),eL),eX=(0,K.Ps)(eN(),eO),eM=function(e){var t=e.data,n=e.start,r=e.hours,i=e.colorFn,o=Array(r).fill(0).map(function(e,t){return(0,q.Z)(n,t)}),a=t.results.reduce(function(e,t){var n,r=t.timestamp,i=t.value,o=t.count,a=null!==(n=e.get(i))&&void 0!==n?n:new Map;return a.set(r,o),e.set(i,a),e},new Map),l=(0,eg._)(a.keys()).map(function(e,t){var n=i(e,t),r=a.get(e);return{label:e,data:o.map(function(e){var t,n=null!==(t=null==r?void 0:r.get(e.toISOString()))&&void 0!==t?t:0;return{x:new Date(e),y:n}}),borderColor:n,backgroundColor:n}});return(0,h.tZ)(ep,{labels:o,datasets:l,maintainAspectRatio:!1})},eF=function(e){var t,n,r,i=e.replId,o=e.title,a=e.metric,l=e.start,c=e.hours,s=e.colorFn,u=(0,f._)((0,m.useState)(void 0),2),d=u[0],p=u[1],y=(t=(0,U._)({},eU,{variables:{id:i,input:{metric:a,start:l,hours:c,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsTimeSeries.__typename){case"UserError":case"NotFoundError":p(Error(e.repl.analyticsTimeSeries.message))}}}),Q.a(eX,t)),b=y.data,Z=y.loading,w=y.error,C=(null==b?void 0:null===(n=b.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=b.repl.analyticsTimeSeries)||void 0===r?void 0:r.__typename)==="ReplAnalyticsTimeSeries"?b.repl.analyticsTimeSeries:void 0;return w&&p(w),(0,h.BX)(v.G,{css:[g.l0.colWithGap(8)],children:[(0,h.tZ)(v.G,{css:[g.l0.flex.row,g.l0.align.center,g.l0.justify.spaceBetween],children:(0,h.tZ)(V.xv,{variant:"subheadDefault",multiline:!1,children:o})}),(0,h.BX)(v.G,{children:[Z?(0,h.tZ)(v.G,{css:[g.l0.width("100%"),ef,g.l0.borderRadius(8),$.p.backgroundPulse()]}):null,d?(0,h.tZ)(x.E,{text:d.message,colorway:"negative"}):null,C?(0,h.tZ)(v.G,{css:ef,children:(0,h.tZ)(eM,{data:C,start:l,hours:c,colorFn:s})}):null]})]})};function eW(){var e=(0,J._)(["\n  fragment ReplAnalyticsDurationResult on ReplAnalyticsDuration {\n    __typename\n    results {\n      __typename\n      value\n      count\n    }\n  }\n"]);return eW=function(){return e},e}function eH(){var e=(0,J._)(["\n  query ReplAnalyticsDuration(\n    $id: String!\n    $input: ReplAnalyticsDurationInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsDuration(input: $input) {\n          ... on ReplAnalyticsDuration {\n            ...ReplAnalyticsDurationResult\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return eH=function(){return e},e}var eV={},ez=(0,K.Ps)(eW()),ej=(0,K.Ps)(eH(),ez),eq=function(e){var t=e.data;el.kL.register(el.ZL);var n=(0,Y.F)().values;return(0,h.tZ)(eu.$Q,{options:{responsive:!0,maintainAspectRatio:!1,datasets:{bar:{categoryPercentage:1,barPercentage:1}},plugins:{tooltip:eh()},scales:{y:{title:{display:!0,text:"# Requests",color:n.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:n.global.foregroundDimmer,callback:function(e){if("number"==typeof e&&Math.floor(e)===e)return e}},grid:{color:n.global.outlineDimmest}},x:{title:{font:{family:"'IBM Plex Sans', sans-serif"},display:!0,text:"Duration (ms)",color:n.global.foregroundDimmer},ticks:{autoSkip:!1,maxRotation:20,color:n.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:n.global.outlineDimmest}}}},data:{labels:t.results.map(function(e){var t=e.value.replace("ms","").split("-"),n=t[t.length-1];return n.includes("s+")?n.replace("s+","000+"):"< "+n}),datasets:[{borderWidth:0,data:t.results.map(function(e){return e.count}),backgroundColor:Array(t.results.length).fill(n.global.tealDefault)}]}})},eY=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=(0,f._)((0,m.useState)(void 0),2),c=l[0],s=l[1],u=(t=(0,U._)({},eV,{variables:{id:i,input:{start:o,hours:a,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsDuration.__typename){case"UserError":case"NotFoundError":s(Error(e.repl.analyticsDuration.message))}}}),Q.a(ej,t)),d=u.data,p=u.loading,y=u.error;return y&&s(y),(0,h.BX)(v.G,{css:g.l0.colWithGap(8),children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",children:"Request Durations (ms)"}),(0,h.BX)(v.G,{children:[p?(0,h.tZ)(v.G,{css:[ef,g.l0.borderRadius(8),$.p.backgroundPulse()]}):null,c?(0,h.tZ)(x.E,{text:c.message,colorway:"negative"}):null,(null==d?void 0:null===(n=d.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=d.repl.analyticsDuration)||void 0===r?void 0:r.__typename)==="ReplAnalyticsDuration"?(0,h.tZ)(v.G,{css:ef,children:(0,h.tZ)(eq,{data:d.repl.analyticsDuration})}):null]})]})},e$=n(20399),eJ=n(99741),eK=n(59868),eQ=function(e){var t=e.context;(0,eK.j)(eK.U3.DEPLOYMENT_SECTION_VIEWED,{context:t})},e0=[{label:"six hours",key:6},{label:"one day",key:24},{label:"five days",key:120},{label:"one week",key:168},{label:"two weeks",key:336},{label:"thirty days",key:720}],e1={label:"one week",key:168},e2=g.nC.min(600),e8=(0,C.X)({fullWidth:(0,H._)({},e2,{gridColumn:"span 2"})}),e4=(0,C.X)({container:(0,H._)({display:"grid",gap:32},e2,{gridTemplateColumns:"repeat(2, minmax(0, 1fr))"}),fullWidth:e8.fullWidth,map:[e8.fullWidth],pies:[e8.fullWidth,g.l0.flex.column,(0,H._)({gap:32},g.nC.min(480),[g.l0.flex.row,{" > *":{flex:1}}])]}),e3=function(e){var t=e.replId,n=(0,f._)((0,m.useState)(e1),2),r=n[0],i=r.key,o=r.label,a=n[1],l=(0,f._)((0,m.useState)((0,z.Z)((0,j.Z)(new Date),i-1)),2),c=l[0],s=l[1],u=(0,P.o)("deployment-analytics-dot"),d=u.isDone,p=u.setAsDone,y=(0,z.Z)((0,j.Z)(new Date),23),b=(0,Y.F)().values,Z=[b.global.redDefault,b.global.redDimmer,b.global.redStronger,b.global.redDimmest],w=[b.global.orangeDefault,b.global.orangeDimmer,b.global.orangeStronger,b.global.orangeDimmest],x=[b.global.blueDefault,b.global.blueDimmer,b.global.blueStronger,b.global.blueDimmest],C=[b.global.greenDefault,b.global.greenDimmer,b.global.greenStronger,b.global.greenDimmest];return m.useEffect(function(){eQ({context:B.k.Analytics})},[]),m.useEffect(function(){d||p()},[d,p]),(0,h.tZ)(W,{children:(0,h.BX)(v.G,{css:e4.container,children:[(0,h.tZ)(v.G,{css:e4.fullWidth,children:(0,h.tZ)(e$.ZE,{items:e0,label:"Past ".concat(o),icon:(0,h.tZ)(eJ.Z,{}),onAction:function(e){var t,n="string"==typeof e?parseInt(e,10):e;a(null!==(t=e0.find(function(e){return e.key===n}))&&void 0!==t?t:e1),s((0,z.Z)((0,j.Z)(new Date),n-1))},cssProps:[g.l0.width("fit-content")],children:e0.map(function(e){return(0,h.tZ)(e$.ck,{children:(0,h.tZ)(v.G,{css:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.color.foregroundDefault],children:(0,h.tZ)(V.xv,{multiline:!1,children:e.label})})},e.key)})})}),(0,h.tZ)(v.G,{css:e4.fullWidth,children:(0,h.tZ)(ev,{replId:t,start:c,hours:i})}),(0,h.tZ)(eB,{replId:t,metric:ey.Pc.Url,start:c,hours:i,count:4,expandable:!0}),(0,h.tZ)(eB,{replId:t,metric:ey.Pc.Referrer,start:c,hours:i,count:4,expandable:!0}),(0,h.tZ)(eF,{replId:t,title:"HTTP Statuses (24h)",metric:ey.RH.Statuses,start:y,hours:24,colorFn:function(e,t){var n=Number(e);return n<300?C[t%C.length]:n<400?x[t%x.length]:n<500?w[t%w.length]:Z[t%Z.length]}}),(0,h.tZ)(eY,{replId:t,start:c,hours:i}),(0,h.BX)(v.G,{css:e4.pies,children:[(0,h.tZ)(eB,{replId:t,metric:ey.Pc.Browser,start:c,hours:i,count:100,variant:"pie"}),(0,h.tZ)(eB,{replId:t,metric:ey.Pc.Browser,start:c,hours:i,count:100,variant:"device-pie"})]}),(0,h.tZ)(v.G,{css:e4.map,children:(0,h.tZ)(eB,{replId:t,metric:ey.Pc.Country,start:c,hours:i,count:100,variant:"map"})})]})})},e5=n(66932),e6=n(95309),e9=(i={},(0,H._)(i,R.r4.Gce,"Reserved VM"),(0,H._)(i,R.r4.CloudRun,"Autoscale"),(0,H._)(i,R.r4.Static,"Static"),i),e7=n(36010),te=n.n(e7),tt=n(63388),tn=n(44620),tr=n(97411),ti=function(e){var t=e.currentBuild,n=(0,f._)(m.useState([]),2),r=n[0],i=n[1];return m.useEffect(function(){var e=(null===(r=t.repl.hostingDeployment)||void 0===r?void 0:r.__typename)==="HostingDeployment"&&t.repl.hostingDeployment.id,n=[];switch(t.provider){case R.r4.Goval:n.push({href:"https://".concat(e,".id.repl.co"),private:!0});break;case R.r4.Gce:case R.r4.CloudRun:case R.r4.Static:var r,o,a,l,c,s,u=(null===(o=t.repl.hostingDeployment)||void 0===o?void 0:o.__typename)==="HostingDeployment"?null===(a=t.repl.hostingDeployment)||void 0===a?void 0:a.replitAppSubdomain:void 0;!u&&(null===(l=t.repl.owner)||void 0===l?void 0:l.username)&&(u="".concat(t.repl.slug,"-").concat(t.repl.owner.username)),u&&n.push({href:"https://".concat(u).concat((null===(s=window)||void 0===s?void 0:null===(c=s.location)||void 0===c?void 0:c.hostname)!=="replit.com"?".staging":"",".replit.app"),private:!1})}if(t.repl.domains){var d=t.repl.domains.filter(function(t){return(null==t?void 0:t.hosting_deployment_id)===e}),f=!0,h=!1,p=void 0;try{for(var m,v=d[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;g&&n.push({href:"https://".concat(g.domain),private:!1,state:"verified"!==g.state?g.state:void 0})}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}}i(n)},[t]),(0,h.tZ)(v.G,{css:[g.l0.colWithGap(2),g.l0.flex.growAndShrink(1)],children:r.map(function(e,t){return(0,h.BX)(v.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,h.tZ)(V.xv,{css:[g.l0.flex.shrink(1)],multiline:!1,children:(0,h.tZ)("a",{href:e.href,target:"_blank",css:[g.l0.color.foregroundDefault],children:e.href})}),e.private?(0,h.tZ)(tr.Z,{color:g.TV.foregroundDefault}):null,(0,h.tZ)("a",{href:e.href,target:"_blank",css:[g.l0.display.flex,g.l0.align.center],children:(0,h.tZ)(tn.Z,{color:g.TV.foregroundDefault})}),e.state?(0,h.BX)(V.xv,{multiline:!1,children:["(",e.state,")"]}):null]},"domains-".concat(t))})})},to=n(25425),ta=n(23211),tl=(0,ed.F4)("\n    50% {\n      background-color: ".concat(g.TV.accentPositiveDimmest,";\n      outline: 1px solid ").concat(g.TV.accentPositiveDimmer,";\n      box-shadow: 0px 0px 32px rgba(0, 145, 24, 0.3);\n    }\n")),tc=(0,C.X)({deploymentInfo:[g.l0.colWithGap(8),g.l0.p(16),g.l0.borderRadius(8),{outline:"1px solid transparent"}]}),ts=(0,C.X)({textButton:[g.l0.cursor.pointer,g.l0.reset.button,g.l0.color.accentPrimaryStronger,g.l0.focusRing,g.l0.hover(g.l0.color.accentPrimaryStrongest),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],textLink:g.l0.hover(g.l0.color.accentPrimaryStrongest),labeledSection:[g.l0.flex.growAndShrink(1),(0,H._)({},g.nC.min(400),[g.l0.flex.row,g.l0.align.baseline])],labeledSectionFullWidth:[g.l0.flex.growAndShrink(1),(0,H._)({},g.nC.min(400),[g.l0.flex.row,g.l0.align.baseline,g.l0.flex.grow(1),g.l0.justify.spaceBetween])],buildStatus:[g.l0.rowWithGap(4),g.l0.align.center],deploymentInfo:tc.deploymentInfo,deploymentInfoAnimate:[tc.deploymentInfo,{animation:"".concat(tl," 700ms ease-out")}],deploymentInfoContent:[g.l0.colWithGap(8),(0,H._)({},g.nC.min(400),g.l0.colWithGap(4))]}),tu=function(e){var t=e.text,n=e.onClick;return(0,h.tZ)("button",{css:ts.textButton,onClick:n,children:t})},td=function(e){var t=e.name,n=e.sku,r=e.canManage,i=e.usageLink,o=e.onManageClick;return(0,h.BX)(v.G,{css:[g.l0.rowWithGap(6),g.l0.flex.wrap],children:[(0,h.tZ)(V.xv,{multiline:!1,children:t}),n?(0,h.BX)(V.xv,{color:"dimmest",multiline:!1,children:["(",n,")"]}):null,r?(0,h.tZ)(tu,{text:"Manage",onClick:o}):null,i?(0,h.tZ)(te(),{legacyBehavior:!0,href:"/account#resource-usage",passHref:!0,children:(0,h.tZ)("a",{css:ts.textLink,children:(0,h.tZ)(V.xv,{children:"See all usage"})})}):null]})},tf=function(e){var t=e.label,n=e.children,r=e.fullWidth;return(0,h.BX)(v.G,{css:r?ts.labeledSectionFullWidth:ts.labeledSection,children:[(0,h.tZ)(v.G,{css:g.l0.minWidth(100),children:(0,h.tZ)(V.xv,{css:g.l0.color.foregroundDimmer,multiline:!1,children:t})}),n]})},th=function(e){var t=e.provider,n=e.machine,r=e.onViewBuildLogs,i=e.onManageClick,o=(0,Z.kW)(),a=(0,Z.Sl)((0,w.Z)()).hostingTier,l=(0,Z.$y)(),c=(0,to.P5)({controlName:ta.dD,logFlagToAnalytics:!1}),s=void 0!==l,u=t===R.r4.Gce&&s&&!c&&!a,d=t!==R.r4.Static&&s&&null===l.hasImageTag,f=!!((o===e6.z.Ready||o===e6.z.Suspended)&&!d),p=null,g=null,y=null,b=null,C=(0,Z.pn)(),_=m.useRef(void 0);m.useEffect(function(){C&&(_.current=null==C?void 0:C.id)},[C,null==C?void 0:C.id]);var k=(null==l?void 0:l.status)===R.Fe.Success,S=(null==l?void 0:l.id)===_.current;switch(l&&(p=(0,h.BX)(h.HY,{children:[(0,h.tZ)(tf,{label:"Status",children:(0,h.tZ)(v.G,{css:ts.buildStatus,children:(0,h.tZ)(tt.hD,{onClick:function(){r(l)}})})}),(0,h.tZ)(tf,{label:"Domains",children:(0,h.tZ)(ti,{currentBuild:l})})]})),t){case R.r4.Gce:if(c){g=(0,h.tZ)(tf,{label:"Type",fullWidth:!s,children:(0,h.tZ)(td,{name:e9[t],sku:null==n?void 0:n.configurationLabel,canManage:f,onManageClick:i})});break}if(!a)break;g=(0,h.tZ)(tf,{label:"Type",fullWidth:!s,children:(0,h.tZ)(td,{name:e9[t],sku:(null==n?void 0:n.configurationLabel)||(0,e5.$)(a.sku),canManage:f,onManageClick:i})});break;case R.r4.CloudRun:g=(0,h.tZ)(tf,{label:"Type",fullWidth:!s,children:(0,h.tZ)(td,{name:e9[t],sku:n?"".concat(n.configurationLabel," / ").concat(n.maxInstances," Max"):"Beta",canManage:f,usageLink:!0,onManageClick:i})});break;case R.r4.Static:g=(0,h.tZ)(tf,{label:"Type",fullWidth:!s,children:(0,h.tZ)(td,{name:e9[t],sku:void 0,canManage:f&&s,onManageClick:i})});case R.r4.Goval:}return(d&&(y=(0,h.tZ)(v.G,{children:(0,h.tZ)(x.E,{icon:(0,h.tZ)(T.Z,{}),colorway:"warning",text:"To upgrade, please redeploy."})})),u&&(b=(0,h.tZ)(I.zx,{onClick:function(){i()},text:"Select hosting tier"})),p||g||y||b)?(0,h.BX)(G.Tg,{elevated:!0,css:k&&S?ts.deploymentInfoAnimate:ts.deploymentInfo,style:{paddingTop:l?12:16},children:[l?(0,h.tZ)(V.xv,{variant:"subheadDefault",multiline:!1,children:"Production"}):null,(0,h.BX)(v.G,{css:ts.deploymentInfoContent,children:[p,g,y,b]})]}):null},tp=n(97615),tm=n(14207),tv=n(88936),tg=n(40102),ty=function(e){return e.loading?(0,h.tZ)(v.G,{css:[g.l0.p(8),g.l0.center],children:(0,h.tZ)(tv.Z,{})}):null},tb=(0,C.X)({error:[g.l0.flex.grow(0),g.l0.mt(0)]}),tZ=function(e){var t=e.text;return(0,h.tZ)(W,{css:tb.error,children:(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:t})})},tw=(0,C.X)({back:[g.l0.flex.row,g.l0.align.center]}),tx=function(e){var t=e.onBack;return(0,h.tZ)(v.G,{css:tw.back,children:(0,h.tZ)(eT.hU,{alt:"Back",tooltipHidden:!0,onClick:t,children:(0,h.tZ)(tg.Z,{})})})};function tC(){var e=(0,J._)(["\n  fragment HostingActivityLogBuild on HostingBuild {\n    id\n    status\n    provider\n    timeCreated\n    user {\n      id\n      displayName\n    }\n  }\n"]);return tC=function(){return e},e}function t_(){var e=(0,J._)(["\n  fragment HostingActivityLogLine2 on HostingActivityLog {\n    id\n    build {\n      ...HostingActivityLogBuild\n    }\n    type\n    user {\n      id\n      displayName\n    }\n    timeCreated\n  }\n  ","\n"]);return t_=function(){return e},e}function tk(){var e=(0,J._)(["\n  query HostingDeploymentActivityLogs2(\n    $replId: String!\n    $after: String\n    $count: Int\n  ) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        hostingDeployment {\n          ... on HostingDeployment {\n            id\n            currentBuild {\n              id\n            }\n            activityLogs(after: $after, count: $count) {\n              items {\n                ...HostingActivityLogLine2\n              }\n              pageInfo {\n                hasNextPage\n                nextCursor\n              }\n            }\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on UnauthorizedError {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return tk=function(){return e},e}function tS(){var e=(0,J._)(["\n  query HostingActivityLogBuildHistory(\n    $input: HostingBuildDeployActionHistoryInput!\n  ) {\n    hostingBuildDeployActionHistory(input: $input) {\n      ... on HostingBuildDeployActionHistoryResults {\n        results {\n          ... on HostingBuildDeployStatusAction {\n            status\n            message\n          }\n          ... on HostingBuildDeployLogAction {\n            log\n          }\n        }\n      }\n    }\n  }\n"]);return tS=function(){return e},e}var tE={},tT=(0,K.Ps)(tC()),tR=(0,K.Ps)(t_(),tT),tI=(0,K.Ps)(tk(),tR),tD=(0,K.Ps)(tS());function tG(){var e=(0,J._)(["\n  fragment DeploymentsDeployOptionsDeployment on HostingDeployment {\n    id\n    replitAppSubdomain\n    currentBuild {\n      id\n      provider\n      envVars {\n        name\n        value\n      }\n    }\n  }\n"]);return tG=function(){return e},e}function tB(){var e=(0,J._)(["\n  query DeploymentsDeployOptions($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...DeploymentsDeployOptionsDeployment\n      }\n    }\n  }\n  ","\n"]);return tB=function(){return e},e}var tP={},tA=(0,K.Ps)(tG()),tN=(0,K.Ps)(tB(),tA);function tU(){var e=(0,J._)(["\n  query HostingDeploymentConfigRedeploy($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        replitAppSubdomain\n        activityLogs(count: 20) {\n          items {\n            id\n            ...HostingActivityLogLine2\n          }\n          pageInfo {\n            hasNextPage\n            nextCursor\n          }\n        }\n        currentBuild {\n          id\n          envVars {\n            name\n            value\n          }\n        }\n        ...DeploymentsDeployOptionsDeployment\n      }\n    }\n  }\n  ","\n  ","\n"]);return tU=function(){return e},e}var tL={},tO=(0,K.Ps)(tU(),tR,tA),tX=n(52924),tM=n(80502);function tF(){var e=(0,J._)(["\n  query HostingDeployActionHistory(\n    $input: HostingBuildDeployActionHistoryInput!\n  ) {\n    hostingBuildDeployActionHistory(input: $input) {\n      ... on HostingBuildDeployActionHistoryResults {\n        results {\n          ... on HostingBuildDeployLogAction {\n            log\n          }\n          ... on HostingBuildDeployStatusAction {\n            status\n            message\n          }\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return tF=function(){return e},e}var tW={},tH=(0,K.Ps)(tF()),tV=n(58200),tz=n(49932),tj=n(23291),tq=n(81764),tY=n(32377),t$=n(62340),tJ=function(e){var t=e.stage,n=e.activeStage;return t===e.erroredStage?(0,h.tZ)(T.Z,{alt:"error"}):t<n?(0,h.tZ)(tY.Z,{alt:"success"}):t===n?(0,h.tZ)(tv.Z,{alt:"current"}):(0,h.tZ)(tq.Z,{alt:"waiting"})},tK=function(e){var t=e.stage,n=e.activeStage,r=e.erroredStage;return n?t===r?"negative":t<n?"positive":t===n?"primary":null:null},tQ=function(e){var t,n=e.stage,r=e.totalStagesWithTitle,i=e.activeStage,o=e.text,a=e.erroredStage,l=(0,t$.d)({tablet:!0});return(0,h.tZ)(tj.D,{text:i?o:"",colorway:null!==(t=tK({stage:n,activeStage:i,erroredStage:a}))&&void 0!==t?t:void 0,variant:"filled",css:[g.l0.border({color:tz.TV.backgroundDefault}),g.l0.overflow("hidden"),i||l?{}:$.p.foregroundPulse(),(0,H._)({flex:1,height:26,zIndex:r-n,":first-of-type":{paddingLeft:6,paddingRight:6},":not(:first-of-type)":{paddingLeft:24},":not(:last-of-type)":{marginRight:-24}," span":g.l0.display.none},g.nC.min(400),{" span":g.l0.display.flex,":first-of-type":{paddingLeft:16,paddingRight:0}})],iconRight:i?(0,h.tZ)(tJ,{stage:n,activeStage:i,erroredStage:a}):void 0})},t0=n(68514),t1=n(5039),t2=n(67313),t8=[{id:0,title:"Provision",statusType:R.Fe.Pending},{id:1,title:"Build",statusType:R.Fe.Building},{id:2,title:"Bundle",statusType:R.Fe.Running},{id:3,title:"Promote",statusType:R.Fe.Promoting},{id:4,statusType:R.Fe.Success}],t4=t8.filter(function(e){return"title"in e}),t3=function(e){return t8.find(function(t){return t.statusType===e})},t5=(0,C.X)({base:{borderRadius:6,paddingLeft:6,paddingRight:6,height:24},disabled:{pointerEvents:"none",color:g.TV.greyDefault}}),t6=[g.l0.borderRadius(8),{border:"1px solid var(--outline-dimmest)"}],t9=(0,C.X)({container:t6,top:[g.l0.colWithGap(12),g.l0.p(16),g.l0.pt(12)],header:[g.l0.rowWithGap(40)],started:[g.l0.rowWithGap(6),g.l0.flex.growAndShrink(1),g.l0.justify.end],cancel:t5.base,canceling:[t5.base,t5.disabled],stages:[g.l0.flex.row,g.l0.flex.grow(1),{zIndex:0}],bottom:[g.l0.borderRadius(0,0,8,8),g.l0.overflow("hidden")],logsOpen:[g.l0.overflow("hidden"),g.l0.height("auto")],logsClosed:[g.l0.overflow("hidden"),g.l0.height(0)],xterm:[g.l0.width("100%"),g.l0.maxWidth("100%"),g.l0.height(340)]}),t7=function(e){return(0,h.BX)(v.G,{css:t9.top,children:[(0,h.BX)(v.G,{css:t9.header,children:[(0,h.BX)(v.G,{css:g.l0.rowWithGap(8),children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",multiline:!1,children:"Deploying"}),(0,h.tZ)(I.zx,{style:{opacity:e.onCancel?1:0},size:"small",text:"Cancel",css:e.isCanceling?t9.canceling:t9.cancel,onClick:e.onCancel,iconRight:e.isCanceling?(0,h.tZ)(tv.Z,{}):void 0})]}),(0,h.BX)(v.G,{css:t9.started,children:[e.timeStarted&&e.userDisplayName?(0,h.BX)(V.xv,{css:g.l0.color.greyStronger,multiline:!1,children:["Started ".concat((0,t1.Z)(new Date(e.timeStarted),Date.now(),{addSuffix:!0})," by "),(0,h.tZ)("span",{css:g.l0.color.foregroundDefault,children:e.userDisplayName})]}):null,e.onViewBuildLogs?(0,h.tZ)(eT.hU,{onClick:e.onViewBuildLogs,alt:"View deploy logs",children:e.viewBuildLogs?(0,h.tZ)(t2.Z,{}):(0,h.tZ)(eJ.Z,{})}):null]})]}),(0,h.tZ)(v.G,{css:t9.stages,children:t4.map(function(t){var n=t.id,r=t.title;return(0,h.tZ)(tQ,{stage:n,totalStagesWithTitle:t4.length,text:r,activeStage:e.activeStage,erroredStage:e.erroredStage},n)})})]})},ne=function(e){return(0,Z.kW)()===e6.z.Preparing?(0,h.tZ)(v.G,{css:t9.container,children:(0,h.tZ)(t7,{})}):(0,h.tZ)(nt,(0,U._)({},e))},nt=function(e){var t,n,r,i,o,a,l,c,s,u,d,p,w,x=e.initialBuild,C=e.viewBuildLogsOnLoad,_=e.onViewLogs,k=e.onCanceled,S=e.onError,E=e.openFile,T=(0,Z.rm)(),I=(0,Z.pn)(),D=I?{id:I.id,status:I.status,provider:I.provider,timeStarted:I.timeCreated,userDisplayName:I.user.displayName}:void 0,G=m.useRef(x||D),B=(t={skip:!(null===(i=G.current)||void 0===i?void 0:i.id),variables:{input:{buildId:null!==(w=null===(o=G.current)||void 0===o?void 0:o.id)&&void 0!==w?w:""}},fetchPolicy:"network-only",ssr:!1,onCompleted:function(e){if(null==e?void 0:e.hostingBuildDeployActionHistory)switch(e.hostingBuildDeployActionHistory.__typename){case"NotFoundError":break;case"UnauthorizedError":S(e.hostingBuildDeployActionHistory.message);break;case"HostingBuildDeployActionHistoryResults":var t=e.hostingBuildDeployActionHistory.results;if(t&&t.length>0){var n=[],r=[],i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;switch(s.__typename){case"HostingBuildDeployLogAction":n.push(s.log);break;case"HostingBuildDeployStatusAction":r.push(s)}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}ee({type:"history",payload:n});var u=!0,d=!1,f=void 0;try{for(var h,p=r[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value;et(m.status)}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}}break;default:S("Unexpected typename.")}},onError:function(e){S(e.message)}},n=(0,U._)({},tW,t),Q.a(tH,n)),P=B.loading,A=B.refetch;(0,Z.U)(function(e){switch(e.__typename){case"HostingBuildDeployLogAction":ee({type:"update",payload:e.log});break;case"HostingBuildDeployStatusAction":et(e.status)}});var N=(0,f._)(m.useState(G.current?null===(a=t3(G.current.status))||void 0===a?void 0:a.id:void 0),2),L=N[0],O=N[1],X=(0,f._)(m.useState((null===(l=G.current)||void 0===l?void 0:l.status)==="failed"?null===(c=t3(null===(s=G.current)||void 0===s?void 0:s.status))||void 0===c?void 0:c.id:void 0),2),M=X[0],F=X[1],W=(0,f._)(m.useState(!1),2),H=W[0],V=W[1],z=(0,Z.XZ)(),j=(0,f._)((0,tM.Z)({openFile:E,listFiles:z.listFiles}),2),q=j[0],Y=j[1],$=(0,tV.f)(),J=(0,f._)(m.useReducer(function(e,t){switch(t.type){case"history":return q&&q.clear(),(0,eg._)(t.payload).concat((0,eg._)(e));case"update":return[t.payload];case"refetch":return q&&q.clear(),P||A(),[]}},[]),2),K=J[0],ee=J[1],et=function(e){if(e===R.Fe.Failed)F(L);else{var t=t3(e);if(!t)return;O(t.id)}},en=(r=(0,y._)(function(){return(0,b.Jh)(this,function(e){switch(e.label){case 0:return V(!0),[4,T()];case 1:return e.sent(),k(),[2]}})}),function(){return r.apply(this,arguments)}),er=(0,f._)(m.useState(C||!1),2),ei=er[0],eo=er[1],ea=function(){eo(!ei),ei||eQ({context:"deploy_progress_logs"})};m.useEffect(function(){eQ({context:"deploy_progress"})},[]),m.useEffect(function(){var e;(null===(e=G.current)||void 0===e?void 0:e.id)&&I&&I.id!==G.current.id&&(G.current={id:I.id,status:I.status,provider:I.provider,timeStarted:I.timeCreated,userDisplayName:I.user.displayName},O(void 0),F(void 0),ee({type:"refetch"}))},[I,null===(u=G.current)||void 0===u?void 0:u.id,A]),m.useEffect(function(){var e;void 0!==L&&(null===(e=G.current)||void 0===e?void 0:e.status)==="failed"&&F(L)},[L,null===(d=G.current)||void 0===d?void 0:d.status]),m.useEffect(function(){q&&K.forEach(function(e){return q.write(e)})},[K,q]);var el=null===(p=t8.find(function(e){return e.id===L}))||void 0===p?void 0:p.statusType,ec=el!==R.Fe.Success&&!M;return G.current?(0,h.BX)(v.G,{css:t9.container,children:[(0,h.tZ)(t7,{onCancel:ec?en:void 0,isCanceling:H,onViewBuildLogs:ea,viewBuildLogs:ei,timeStarted:G.current.timeStarted,userDisplayName:G.current.userDisplayName,activeStage:L,erroredStage:M}),(0,h.BX)(v.G,{css:t9.bottom,children:[(0,h.BX)(v.G,{css:ei?t9.logsOpen:t9.logsClosed,children:[(0,h.tZ)(t0.R,{}),(0,h.tZ)(v.G,{css:[g.l0.display.flex,g.l0.pt(12),g.l0.pl(16),g.l0.overflow("hidden"),{backgroundColor:null==$?void 0:$.background}],children:(0,h.tZ)(v.K.div,{css:t9.xterm,ref:Y})})]}),M&&el?(0,h.BX)(h.HY,{children:[(0,h.tZ)(t0.R,{}),el===R.Fe.Building?(0,h.tZ)(no,{provider:G.current.provider,logs:K.slice(-3),openFile:E,viewBuildLogs:ei,onViewBuildLogs:ea}):null,el===R.Fe.Promoting?(0,h.tZ)(ni,{provider:G.current.provider,logs:K.slice(-3),openFile:E,viewBuildLogs:ei,onViewBuildLogs:ea,onViewApplicationLogs:_}):null]}):null]})]}):null},nn=(0,C.X)({errorContainer:[g.l0.p(12),g.l0.colWithGap(12)],warning:[g.l0.colWithGap(8)],warningTitle:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.fontWeight.medium],link:{color:g.TV.foregroundDefault,textDecoration:"underline",":hover":{color:g.TV.accentPrimaryStronger}},xtermContainer:[g.l0.display.flex,g.l0.pt(12),g.l0.pl(16),g.l0.overflow("hidden"),g.l0.borderRadius(8,8,0,0)],xterm:[g.l0.width("100%"),g.l0.maxWidth("100%"),g.l0.height(120)],xtermButton:g.l0.borderRadius(0,0,8,8),list:[{listStyle:"inside"}],listCta:g.l0.display.inlineFlex}),nr=function(e){var t=e.title,n=e.description,r=e.logs,i=e.viewBuildLogs,o=e.onViewBuildLogs,a=e.openFile,l=(0,tV.f)(),c=(0,Z.XZ)(),s=(0,f._)((0,tM.Z)({openFile:a,listFiles:c.listFiles}),2),u=s[0],d=s[1],p=m.useRef(r?r.slice(-3):[]);return m.useEffect(function(){p.current.length&&p.current.forEach(function(e){null==u||u.write(e)})},[u]),(0,h.BX)(G.Tg,{elevated:!0,css:nn.errorContainer,children:[(0,h.BX)(v.G,{css:nn.warning,children:[(0,h.BX)(v.G,{css:nn.warningTitle,children:[(0,h.tZ)(T.Z,{color:g.TV.accentNegativeStronger}),(0,h.tZ)(V.xv,{multiline:!1,children:t})]}),(0,h.tZ)(V.xv,{children:n})]}),void 0===i||i?null:(0,h.BX)(v.G,{children:[(0,h.tZ)(v.G,{css:nn.xtermContainer,style:{backgroundColor:null==l?void 0:l.background},children:(0,h.tZ)(v.K.div,{css:nn.xterm,ref:d})}),(0,h.tZ)(I.zx,{text:"View all",iconLeft:(0,h.tZ)(eS.Z,{}),onClick:o,css:nn.xtermButton})]})]})};function ni(e){var t=(0,Z.am)();return(0,h.tZ)(nr,(0,U._)({title:"Your app failed to promote",description:(0,h.BX)(h.HY,{children:["Common issues for promote stage errors can be an error occurring while trying to run your run command, your application exiting unexpectedly, an error on your app server or a provisioning issue.",(0,h.tZ)("br",{}),(0,h.tZ)("br",{}),"Ways to debug:",(0,h.BX)("ul",{css:nn.list,children:[(null==t?void 0:t.isVnc)?(0,h.tZ)("li",{children:"This promotion may also be failing due to VNC incompatibilities."}):null,(0,h.tZ)("li",{children:"make sure your repl runs in the Workspace"}),(0,h.BX)("li",{children:["view our"," ",(0,h.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",target:"_blank",css:nn.link,onClick:function(){return eQ({context:"troubleshooting_doc"})},children:"troubleshooting tips"})]}),e.provider!==R.r4.Static&&e.onViewApplicationLogs?(0,h.BX)("li",{children:["look for errors in your application's server logs"," ",(0,h.tZ)(I.zx,{text:"Logs",size:"small",iconLeft:(0,h.tZ)(S.Z,{}),onClick:e.onViewApplicationLogs,css:g.l0.display.inlineFlex})," "]}):null,(0,h.tZ)("li",{children:"look for errors in your promote stage logs"})]})]})},e))}function no(e){var t=(0,Z.am)();return(0,h.tZ)(nr,(0,U._)({title:"Your app failed to build",description:(0,h.BX)(h.HY,{children:["Common issues for build stage errors can be an error occurring while trying to run your build command or an compilation issue with your application code.",(0,h.tZ)("br",{}),(0,h.tZ)("br",{}),"Ways to debug:",(0,h.BX)("ul",{css:nn.list,children:[(null==t?void 0:t.isVnc)?(0,h.tZ)("li",{children:"This promotion may also be failing due to VNC incompatibilities."}):null,(0,h.tZ)("li",{children:"make sure your repl runs in the Workspace"}),(0,h.BX)("li",{children:["view our"," ",(0,h.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",target:"_blank",css:nn.link,onClick:function(){return eQ({context:"troubleshooting_doc"})},children:"troubleshooting tips"})]}),(0,h.tZ)("li",{children:"look for errors in your build stage logs"})]})]})},e))}var na=n(92741),nl=n(7444),nc=n(99656),ns=n(73157),nu=n(52489);function nd(e){var t=e.secrets,n=e.otherSecrets,r=new Map,i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=(0,f._)(l.value,2),u=s[0],d=s[1];t.has(u)||r.set(u,d)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return{missing:r}}var nf=(0,C.X)({root:[g.l0.borderRadius(8),{border:"1px solid "+g.TV.outlineDimmer}],button:[g.l0.reset.button,D.gU.nofill,g.l0.rowWithGap(8),g.l0.align.center,g.l0.height(32),g.l0.px(8),{border:"0 none",borderBottomLeftRadius:0,borderBottomRightRadius:0}],buttonText:[g.l0.flex.growAndShrink(1),g.l0.rowWithGap(8),g.l0.align.center],expanded:[g.l0.px(8),g.l0.pb(8)],missingItems:[g.l0.colWithGap(8)],missingItem:[g.l0.rowWithGap(8)],missingSecret:[g.l0.rowWithGap(8),g.l0.flex.growAndShrink(1)],subtitle:[{borderTop:"1px solid "+g.TV.outlineDimmest,top:-1},g.l0.py(8),g.l0.position.relative]});function nh(e){var t=e.secrets,n=e.otherSecrets,r=e.otherEnvName,i=e.onAddSecret,o=e.initialExpanded,a=nd({secrets:t,otherSecrets:n}).missing,l=(0,f._)((0,m.useState)(o),2),c=l[0],s=l[1],u=0===a.size;if((0,m.useEffect)(function(){u&&s(!1)},[u]),u)return null;var d="".concat(a.size," ").concat((0,ns.Z)("secret",a.size)," out of sync"),p=1===a.size?"A ".concat(r," secret is missing from this environment"):"".concat(a.size," ").concat(r," secrets are missing from this environment");return(0,h.BX)(v.G,{css:nf.root,children:[(0,h.BX)(v.G,{css:nf.button,tag:"button",onClick:function(){return s(function(e){return!e})},children:[(0,h.BX)(v.G,{css:nf.buttonText,children:[(0,h.tZ)(T.Z,{color:g.TV.orangeDefault}),(0,h.tZ)(V.xv,{multiline:!1,children:d})]}),c?(0,h.tZ)(t2.Z,{}):(0,h.tZ)(eJ.Z,{})]}),c?(0,h.BX)(v.G,{css:nf.expanded,children:[(0,h.tZ)(V.xv,{css:nf.subtitle,color:"dimmer",children:p}),(0,h.tZ)(v.G,{css:nf.missingItems,children:(0,eg._)(a.entries()).map(function(e){var t=(0,f._)(e,2),n=t[0],r=t[1];return(0,h.BX)(v.G,{css:nf.missingItem,children:[(0,h.BX)(v.G,{css:nf.missingSecret,children:[(0,h.tZ)(nu.u_,{value:n}),(0,h.tZ)(nu.BH,{value:r})]}),r?(0,h.tZ)(I.zx,{iconLeft:(0,h.tZ)(nc.Z,{}),variant:"outlined",text:"Add secret",onClick:function(){return i({key:n,value:r})}}):null]},n)})})]}):null]})}var np=n(28268);function nm(e){var t=e.fs,n=(0,f._)((0,m.useState)(null),2),r=n[0],i=n[1],o=(0,f._)((0,m.useState)(null),2),a=o[0],l=o[1];return(0,m.useEffect)(function(){return t.watchFile(".env",{onChange:function(e){var t=np.Z.parse(e.toString());i(new Map(Object.entries(t).map(function(e){var t=(0,f._)(e,2);return[t[0],t[1]]})))},onMoveOrDelete:function(){return i(null)},onError:l})},[t]),{devSecrets:r,error:a}}var nv=n(92153),ng=n(8668),ny=n(30084),nb=n(10981),nZ=n(18836);function nw(){var e=(0,J._)(["\n  query CheckReplitAppSubdomainAvailability(\n    $subdomain: String!\n    $deploymentId: String\n  ) {\n    replitAppSubdomainAvailability(\n      subdomain: $subdomain\n      deploymentId: $deploymentId\n    ) {\n      __typename\n      ... on ReplitAppSubdomainAvailabilityResult {\n        available\n        message\n      }\n      ... on UserError {\n        errorMessage: message\n      }\n    }\n  }\n"]);return nw=function(){return e},e}var nx={},nC=(0,K.Ps)(nw()),n_=n(59639),nk=n(30983),nS=n(58719),nE=n(22487),nT=function(e){var t=e.id,n=e.value,r=e.loading,i=e.disabled,o=e.onChange,a=e.error,l=(0,ng.Ar)(n),c=(0,m.useId)();return(0,h.BX)(v.G,{css:[g.l0.colWithGap(4)],children:[(0,h.tZ)(nZ.II,{id:t,value:l?n:"",onChange:function(e){return o(e.target.value)},css:[g.l0.color.greyStrongest],disabled:r||i,"aria-describedby":c}),a?(0,h.tZ)(v.G,{css:[g.l0.color.accentNegativeStronger],"aria-live":"polite","aria-atomic":"true",id:c,children:(0,h.tZ)("span",{children:a})}):null]})},nR=(0,C.X)({root:[g.l0.rowWithGap(8),g.l0.align.center],iconButton:[g.l0.height("100%"),g.l0.borderRadius(8),{"& button":g.l0.height(32)}],keyInput:[g.l0.width("40%")],valueInput:[g.l0.flex.growAndShrink(1)]}),nI=function(e){var t=e.index,n=e.name,r=e.value,i=e.disabled,o=e.updateEnvVarName,a=e.updateEnvVarValue,l=e.removeEnvVar,c=e.otherKeys,s=(0,nb.U)(),u=(0,f._)((0,m.useState)(""===n||""===r),2),d=u[0],p=u[1],y=!!(n&&r),b=(0,nl.Z)(y),Z=(0,nE.Z)(function(){Z.current&&b.current&&p(!1)},[b]);return d?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:nR.root,innerRef:Z,children:[(0,h.tZ)(v.G,{css:nR.keyInput,children:(0,h.tZ)(nZ.II,{placeholder:"Name",id:"".concat(s,"-name-").concat(t),value:n,onChange:function(e){return o(e.currentTarget.value)},onKeyDown:function(e){"Enter"===e.key&&y&&p(!1)},disabled:i})}),(0,h.tZ)(v.G,{css:nR.valueInput,children:(0,h.tZ)(nZ.II,{placeholder:"Value",name:"".concat(s,"-value-").concat(t),value:r,onChange:function(e){return a(e.currentTarget.value)},onKeyDown:function(e){"Enter"===e.key&&y&&p(!1)},disabled:i})}),i?null:(0,h.tZ)(G.Tg,{elevated:!0,css:nR.iconButton,children:(0,h.tZ)(eT.hU,{alt:"Add",tooltipHidden:!0,onClick:function(){y?p(!1):l()},children:y?(0,h.tZ)(tY.Z,{}):(0,h.tZ)(nS.Z,{})})})]}),c.includes(n)?(0,h.BX)(V.xv,{variant:"small",css:{color:g.TV.accentNegativeDefault},children:['Secret "',n,'" already exists']}):null]}):(0,h.BX)(v.G,{css:nR.root,children:[(0,h.tZ)(nu.u_,{value:n}),(0,h.tZ)(nu.BH,{value:r}),(0,h.tZ)(nu.$M,{onEdit:function(){return p(!0)},onDelete:function(){return l()}})]})},nD=function(e){var t,n,r,i,o,a=e.id,l=e.subdomain,c=e.deploymentId,s=e.onChange,u=e.updateValidity,d=(t={variables:{subdomain:l,deploymentId:c},skip:0===l.length},n=(0,U._)({},nx,t),Q.a(nC,n)),f=d.data,p=d.loading,y=d.error,b=(null==f?void 0:f.replitAppSubdomainAvailability.__typename)==="ReplitAppSubdomainAvailabilityResult"&&f.replitAppSubdomainAvailability.available,Z=(null==f?void 0:f.replitAppSubdomainAvailability.__typename)==="ReplitAppSubdomainAvailabilityResult"?f.replitAppSubdomainAvailability.message:null==f?void 0:null===(r=f.replitAppSubdomainAvailability)||void 0===r?void 0:r.errorMessage;return((0,m.useEffect)(function(){u(b)},[b]),y)?(0,h.tZ)(x.E,{colorway:"negative",text:"Something went wrong, please try refreshing the page."}):(0,h.BX)(v.G,{children:[(0,h.BX)(v.G,{css:[g.l0.rowWithGap(4),g.l0.align.center],children:[(0,h.tZ)(nZ.II,{id:a,placeholder:"subdomain",value:l,onChange:function(e){return s(e.target.value)}}),(0,h.BX)(V.xv,{multiline:!1,children:[(null===(o=window)||void 0===o?void 0:null===(i=o.location)||void 0===i?void 0:i.hostname)!=="replit.com"?".staging":"",".replit.app"]})]}),(0,h.BX)(v.G,{css:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.pt(4)],children:[p?(0,h.BX)(h.HY,{children:[(0,h.tZ)(tv.Z,{}),(0,h.tZ)(V.xv,{multiline:!1,children:"Checking availability"})]}):null,b?(0,h.BX)(h.HY,{children:[(0,h.tZ)(tY.Z,{color:"green"}),(0,h.tZ)(V.xv,{css:[g.l0.color.greenDefault],multiline:!1,children:"Available"})]}):null,b||p?null:(0,h.BX)(h.HY,{children:[(0,h.tZ)(T.Z,{color:"red"}),(0,h.tZ)(V.xv,{css:[g.l0.color.redDefault],multiline:!1,children:Z})]})]})]})},nG=function(e){var t=e.appType,n=e.onChange,r=(0,nb.U)();return(0,h.tZ)(n_.hE,{name:"deploymentTargetSelector",value:t,onChange:n,row:!0,css:[g.l0.width("100%"),g.l0.flex.row],children:[{value:R.Vp.Server,name:"Web Server",description:"ex. an API or website"},{value:R.Vp.Worker,name:"Background Worker",description:"ex. a Discord or Slack bot"}].map(function(e,t){return(0,h.tZ)(v.G,{css:[g.l0.flex.grow(1)],children:(0,h.tZ)(nk.u,{tooltip:e.description,children:(0,h.tZ)(n_.rK,{id:r(e.value),value:e.value,text:e.name})})},t)})})},nB=(0,C.X)({label:[g.l0.rowWithGap(8),g.l0.align.center],labelText:{},header:[g.l0.display.flex,g.l0.flex.row,g.l0.justify.spaceBetween,g.l0.align.center],actions:[g.l0.rowWithGap(4)]}),nP=function(e){var t=e.id,n=e.title,r=e.information,i=e.optional,o=e.actions,a=e.children;return(0,h.BX)(v.G,{css:g.l0.colWithGap(8),children:[(0,h.BX)(v.G,{css:nB.header,children:[(0,h.BX)(v.G,{tag:"label",htmlFor:t,css:nB.label,children:[(0,h.tZ)(V.xv,{color:"dimmer",multiline:!1,children:n}),(0,h.tZ)(nk.u,{tooltip:r,children:(0,h.tZ)(tp.Z,{color:g.TV.foregroundDimmest})}),void 0!==i&&i?(0,h.tZ)(V.xv,{variant:"small",color:"dimmest",multiline:!1,children:"optional"}):null]}),o?(0,h.tZ)(v.G,{css:nB.actions,children:o}):null]}),a]})},nA=n(49344),nN=n(55534);function nU(){return(nU=(0,y._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g;return(0,b.Jh)(this,function(y){switch(y.label){case 0:t=["webpack.config.js","vite.config.js","webpack.config.ts","vite.config.ts"],n=!0,r=!1,i=void 0,y.label=1;case 1:y.trys.push([1,6,7,8]),o=t[Symbol.iterator](),y.label=2;case 2:if(n=(a=o.next()).done)return[3,5];return l=a.value,[4,e.stat(l)];case 3:if(!((c=y.sent()).exists&&c.type===ny.Tv.File))return[3,4];return[2,"dist"];case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return s=y.sent(),r=!0,i=s,[3,8];case 7:try{n||null==o.return||o.return()}finally{if(r)throw i}return[7];case 8:u=["dist","build","public"],d=!0,f=!1,h=void 0,y.label=9;case 9:y.trys.push([9,14,15,16]),p=u[Symbol.iterator](),y.label=10;case 10:if(d=(m=p.next()).done)return[3,13];return v=m.value,[4,e.stat(v)];case 11:if(!((g=y.sent()).exists&&g.type===ny.Tv.Directory))return[3,12];return[2,v];case 12:return d=!0,[3,10];case 13:return[3,16];case 14:return s=y.sent(),f=!0,h=s,[3,16];case 15:try{d||null==p.return||p.return()}finally{if(f)throw h}return[7];case 16:return[2]}})})).apply(this,arguments)}var nL=function(e){var t,n,r,i,o,a,l,c,s,u,d,p,w,x,C,_,S,E=e.deploymentId,T=e.initialSubdomain,D=e.provider,G=e.machine,B=e.fs,P=e.dotReplit,A=e.onDeploy,N=e.onCancel,L=e.onError,O=e.initialSecretsSyncExpanded,X=(0,Z.kW)(),M=(0,Z.XA)(),F=(t=(0,U._)({},tP,{skip:!E,variables:{id:null!=E?E:""},fetchPolicy:"cache-and-network",ssr:!1,onCompleted:function(e){var t,n=(null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?e.hostingDeployment:null;n&&(n.replitAppSubdomain&&(et(n.replitAppSubdomain),ei(!0)),ev(n.currentBuild.envVars.map(function(e){return{name:e.name,value:e.value}})))}}),Q.a(tN,t)),W=F.data,H=F.loading,z=(r=(n={provider:D,fs:B,dotReplit:P,isNewDeployment:!E,onError:L,onOptions:function(e){e.appType&&J(e.appType),e.envVars&&ev(e.envVars),e.ignorePorts&&eb(e.ignorePorts),e.buildCommand&&el(e.buildCommand),e.runCommand&&eu(e.runCommand),e.publicDir&&ex(e.publicDir)}}).isNewDeployment,i=n.provider,o=n.fs,a=n.onOptions,l=n.onError,c=n.dotReplit,u=(s=(0,f._)(m.useState(!0),2))[0],d=s[1],p=(0,nl.Z)(l),w=(0,nl.Z)(a),m.useEffect(function(){var e=!1;function t(){return(t=(0,y._)(function(){var t,n,a,l,s,u,h,p,m;return(0,b.Jh)(this,function(v){switch(v.label){case 0:return t=R.Vp.Server,n=null,a=null,l=null,s=null,[4,Promise.all([r?(0,tm.xk)(o):Promise.resolve(null),(0,tm.$f)(c)])];case 1:if(h=(u=f._.apply(void 0,[v.sent(),2]))[0],p=u[1],e)return[2];if(r)switch(i){case R.r4.Gce:t=p.ignorePorts?R.Vp.Worker:R.Vp.Server;break;case R.r4.CloudRun:t=R.Vp.CloudRun;break;case R.r4.Static:t=R.Vp.Static}else p.appType&&(t=p.appType);if(a=p.buildCommand,!(t!==R.Vp.Static))return[3,2];return n=p.runCommand,[3,5];case 2:if(!p.publicDir)return[3,3];return l=p.publicDir,[3,5];case 3:return[4,function(e){return nU.apply(this,arguments)}(o)];case 4:(m=v.sent())&&(l=m),v.label=5;case 5:return i===R.r4.Gce&&(s=p.ignorePorts),w.current({appType:t,envVars:h,buildCommand:a,runCommand:n,publicDir:l,ignorePorts:s}),d(!1),[2]}})})).apply(this,arguments)}try{!function(){t.apply(this,arguments)}()}catch(e){p.current(e.message),d(!1)}return function(){e=!0}},[i,o,c,p,w,r]),{loading:u}).loading,j=(null==W?void 0:null===(_=W.hostingDeployment)||void 0===_?void 0:_.__typename)==="HostingDeployment"?W.hostingDeployment:null,q=null==j?void 0:j.currentBuild,Y=(0,f._)(m.useState(R.Vp.Server),2),$=Y[0],J=Y[1],K=(0,f._)(m.useState(T),2),ee=K[0],et=K[1],en=(0,f._)(m.useState(!1),2),er=en[0],ei=en[1],eo=(0,f._)(m.useState(null),2),ea=eo[0],el=eo[1],ec=(0,f._)(m.useState(null),2),es=ec[0],eu=ec[1],ed=(0,f._)(m.useState(void 0),2),ef=ed[0],eh=ed[1],ep=(0,f._)(m.useState(null!==(S=null==q?void 0:q.envVars.map(function(e){return{name:e.name,value:e.value}}))&&void 0!==S?S:[]),2),em=ep[0],ev=ep[1],eg=(0,f._)(m.useState(!1),2),ey=eg[0],eb=eg[1],eZ=(0,f._)(m.useState(null),2),ew=eZ[0],ex=eZ[1],eC=(0,f._)(m.useState(void 0),2),e_=eC[0],ek=eC[1],eS=nm({fs:B}).devSecrets;m.useEffect(function(){eQ({context:"deploy_options"})},[]);var eE=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.value;ev(function(e){return(0,nv.ZP)(e,function(e){e.push({name:null!=t?t:"",value:null!=n?n:""})})})},eR=function(e,t){ev(function(n){return(0,nv.ZP)(n,function(n){n[e].name=t})})},eI=function(e,t){ev(function(n){return(0,nv.ZP)(n,function(n){n[e].value=t})})},eD=function(e){ev(function(t){return(0,nv.ZP)(t,function(t){t.splice(e,1)})})},eG=(x=(0,y._)(function(){var e,t;return(0,b.Jh)(this,function(n){switch(n.label){case 0:if(!(e=er&&ee.length?ee:void 0))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,M({envVars:em.filter(function(e){return(0,ng.GV)(e)}),subdomain:e,machineConfigurationId:(null==G?void 0:G.configurationId)||void 0,maxMachineInstances:(null==G?void 0:G.maxInstances)||void 0,config:{buildCommand:ea,runCommand:es,appType:$,ignorePorts:ey,publicDir:ew}})];case 2:return n.sent(),A(),[3,4];case 3:if((t=n.sent())instanceof na.ZG)return eh("Run command cannot be empty."),[2];if(t instanceof na.SF)return ek("Public directory cannot be empty."),[2];return L(t.message),[3,4];case 4:return[2]}})}),function(){return x.apply(this,arguments)}),eB=(0,f._)(m.useState(!1),2),eP=eB[0],eA=eB[1],eN=(0,f._)(m.useState(!1),2),eU=eN[0],eL=eN[1],eO=H||z||X===e6.z.Preparing,eX=eO||!er,eM=em.map(function(e){return e.name}),eF=$!==R.Vp.Static,eW=D===R.r4.Gce,eH=$===R.Vp.Static,eV=(0,nN.Z)(),ez=(C=(0,y._)(function(){var e,t,n,r,i,o;return(0,b.Jh)(this,function(a){switch(a.label){case 0:return eA(!0),e=em.reduce(function(e,t){return e[t.name]=t.value,e},{}),[4,B.readFile(".env")];case 1:if(t=a.sent(),n="",t.error&&t.error!==ny.Df.NotFound)return eV.showError("Failed to overwrite secrets"),eA(!1),[2];return t.error||(n=t.content.toString()),r=np.Z.parse(n),i=(0,U._)({},r,e),o=np.Z.serialize(i),[4,B.writeFile(".env",o)];case 2:return a.sent().error&&eV.showError("Failed to overwrite secrets"),eA(!1),eL(!1),[2]}})}),function(){return C.apply(this,arguments)});return(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:[g.l0.colWithGap(16)],children:[(null==j?void 0:j.replitAppSubdomain)?null:(0,h.tZ)(nP,{id:"primaryDomain",title:"Primary domain",information:"You can add more custom domains after deploying",children:(0,h.tZ)(nD,{id:"primaryDomain",subdomain:ee,deploymentId:E||void 0,onChange:et,updateValidity:ei})}),eH?(0,h.tZ)(nP,{id:"publicDir",title:"Public directory",information:"The public directory is the folder where the browser should start when serving your static site",children:(0,h.tZ)(nT,{id:"publicDir",value:ew,onChange:ex,loading:z,disabled:eO,error:e_})}):null,(0,h.tZ)(nP,{id:"buildCommand",title:"Build command",information:"The build command is the command-line statement that compiles your app at build time.",optional:!0,children:(0,h.tZ)(nT,{id:"buildCommand",value:ea,onChange:el,loading:z,disabled:eO})}),eF?(0,h.tZ)(nP,{id:"runCommand",title:"Run command",information:"The run command is the command-line statement that launches your app after it has been built.",children:(0,h.tZ)(nT,{id:"runCommand",value:es,onChange:eu,loading:z,disabled:eO,error:ef})}):null,(0,h.tZ)(nP,{id:"envVars",title:"Deployment secrets",information:"Secrets, or environment variables, are private keys you can use to access APIs and services",actions:E&&em.length>0?(0,h.tZ)(eT.hU,{alt:"Copy all secrets from Deployment to Development.",disabled:eP,onClick:function(){eL(!0)},children:(0,h.tZ)(tg.Z,{})}):null,children:(0,h.BX)(v.G,{css:[g.l0.colWithGap(12)],children:[em.length>0?em.map(function(e,t){var n=e.name,r=e.value;return(0,h.tZ)(nI,{index:t,name:n,value:r,updateEnvVarName:function(e){return eR(t,e)},updateEnvVarValue:function(e){return eI(t,e)},removeEnvVar:function(){return eD(t)},disabled:eO,otherKeys:eM.filter(function(e,n){return n!==t})},t)}):null,eS?(0,h.tZ)(nh,{secrets:new Map(em.map(function(e){return[e.name,e.value]})),otherSecrets:eS,otherEnvName:"workspace",onAddSecret:function(e){return eE({name:e.key,value:e.value})},initialExpanded:O}):null,(0,h.tZ)(I.zx,{onClick:function(){return eE()},text:"Add deployment secret",iconLeft:(0,h.tZ)(nc.Z,{}),disabled:H})]})}),eW?(0,h.tZ)(nP,{id:"deploymentAppType",title:"App type",information:"Configure your app based on whether it needs to serve traffic from the web.",children:(0,h.tZ)(nG,{appType:$,onChange:function(e){J(e),eb((e===R.Vp.Server||e===R.Vp.Worker)&&e===R.Vp.Worker)}})}):null,(0,h.BX)(v.G,{css:[g.l0.rowWithGap(8),g.l0.pt(12)],children:[q?(0,h.tZ)(I.zx,{text:"Cancel",onClick:N}):null,(0,h.tZ)(v.G,{css:g.l0.flex.grow(1),children:(0,h.tZ)(I.zx,{colorway:"primary",onClick:eG,text:X===e6.z.Preparing&&"Preparing"||z&&"Fetching options"||"Deploy",iconLeft:z?(0,h.tZ)(tv.Z,{}):(0,h.tZ)(k.Z,{}),disabled:eX})})]})]}),(0,h.tZ)(nA.u,{isOpen:eU,onRequestClose:function(){eP||eL(!1)},children:(0,h.BX)(v.G,{css:[g.l0.colWithGap(8)],children:[(0,h.tZ)(V.xv,{variant:"subheadBig",children:"Copy secrets from Deployment to Development?"}),(0,h.tZ)(V.xv,{children:"Are you sure you want to copy all of your secrets from Deployment to Development? Secrets already present in Development will be overwritten and lost permanently."}),(0,h.BX)(v.G,{css:[g.l0.rowWithGap(8),g.l0.justify.end,g.l0.pt(8)],children:[(0,h.tZ)(I.zx,{text:"Cancel",disabled:eP,onClick:function(){eL(!1)}}),(0,h.tZ)(I.zx,{text:"Yes, copy secrets",colorway:"negative",disabled:eP,loading:eP,onClick:ez})]})]})})]})},nO=n(65143),nX=(0,C.X)({container:[g.l0.align.center,g.l0.colWithGap(4)],qrContainer:[g.l0.align.center,g.l0.justify.center]});function nM(e){var t=e.color;return(0,h.BX)(v.G,{css:nX.container,children:[(0,h.BX)(v.G,{css:nX.qrContainer,children:[(0,h.tZ)("svg",{viewBox:"0 0 128 128",css:[g.l0.height(128),g.l0.width(128),g.l0.borderRadius(2),D.gU.nofill],target:"_blank",onClick:function(){window.open("/mobile")},children:(0,h.tZ)("path",{fill:null!=t?t:g.TV.foregroundDefault,d:"m0,13.58v13.58h27.15V0H0v13.58ZM34.91,1.94v1.94h-3.88v3.88h3.88v-3.88h7.76v3.88h3.88v-3.88h-3.88V0h-7.76v1.94Zm31.03,0v1.94h-15.52v7.76h-15.52v3.88h7.76v7.76h-3.88v-3.88h-7.76v11.64h-15.52v7.76h-3.88v3.88h-3.88v-3.88H0v3.88h7.76v3.88H0v7.76h3.88v3.88H0v3.88h3.88v3.88H0v3.88h3.88v3.88H0v3.88h3.88v3.88H0v3.88h15.52v3.88h-3.88v7.76h3.88v-3.88h3.88v-3.88h7.76v-3.88h-7.76v-7.76h3.88v3.88h3.88v-3.88h3.88v-3.88h3.88v-19.39h7.76v-3.88h-3.88v-3.88h-3.88v-3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h3.88v-3.88h3.88v-7.76h3.88v3.88h3.88v7.76h-3.88v3.88h11.64v-3.88h3.88v3.88h15.52v3.88h-3.88v3.88h3.88v11.64h11.64v3.88h-11.64v3.88h-3.88v3.88h15.52v7.76h-3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v3.88h3.88v15.52h3.88v15.52h7.76v3.88h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-7.76v-3.88h-3.88v3.88h3.88v3.88h-11.64v-3.88h3.88v-7.76h7.76v-3.88h7.76v-3.88h-3.88v-3.88h-3.88v-3.88h3.88v-11.64h-11.64v3.88h3.88v3.88h-7.76v-3.88h-7.76v-3.88h-7.76v3.88h7.76v7.76h-7.76v-3.88h-15.52v7.76h3.88v-3.88h7.76v3.88h3.88v3.88h-3.88v3.88h-11.64v-3.88h-3.88v-7.76h-3.88v15.52h3.88v3.88h3.88v-3.88h3.88v3.88h3.88v3.88h3.88v3.88h7.76v-3.88h-7.76v-3.88h15.52v-3.88h-3.88v-3.88h7.76v-7.76h11.64v7.76h-7.76v3.88h-3.88v7.76h-3.88v3.88h3.88v3.88h27.15v-7.76h3.88v7.76h7.76v-3.88h3.88v3.88h3.88v-3.88h-3.88v-7.76h3.88v3.88h3.88v-3.88h3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v-11.64h3.88v3.88h3.88v3.88h7.76v-3.88h-3.88v-3.88h-7.76v-7.76h-3.88v-7.76h7.76v7.76h7.76v-3.88h-3.88v-7.76h-7.76v-3.88h-7.76v3.88h-3.88v-11.64h3.88v3.88h7.76v-3.88h-7.76v-3.88h3.88v-7.76h3.88v-3.88h3.88v3.88h3.88v3.88h-3.88v15.52h3.88v-11.64h3.88v-7.76h-3.88v-7.76h3.88v-7.76h-3.88v-11.64h-3.88v11.64h3.88v3.88h-3.88v3.88h-7.76v-3.88h3.88v-3.88h-3.88v-3.88h3.88v-3.88h-3.88v3.88h-3.88v-7.76h-7.76v3.88h3.88v3.88h-11.64v-3.88h3.88v-11.64h-3.88v7.76h-3.88v-11.64h3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v-3.88h7.76V3.88h3.88v3.88h3.88V0h-7.76v3.88h-3.88V0h-3.88v3.88h-7.76V0h-7.76v1.94Zm34.91,11.64v13.58h27.15V0h-27.15v13.58Zm-31.03-5.82v3.88h-7.76v3.88h-3.88v7.76h3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v7.76h-3.88v-7.76h-3.88v7.76h-3.88v3.88h-3.88v-3.88h-11.64v-3.88h11.64v-3.88h3.88v-7.76h3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h3.88v-3.88h-7.76v-3.88h3.88v-3.88h3.88v3.88h3.88v-7.76h7.76v-3.88h3.88v3.88Zm-46.8,5.82v9.45H4.13V4.13h18.89v9.45Zm100.85,0v9.45h-18.89V4.13h18.89v9.45Zm-116.11,0v5.82h11.64V7.76H7.76v5.82Zm73.7-3.88v1.94h-3.88v7.76h-3.88v3.88h3.88v3.88h3.88v-7.76h3.88v7.76h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v-3.88h3.88v-3.88h-3.88v-11.64h3.88v3.88h3.88V7.76h7.76v1.94Zm27.15,3.88v5.82h11.64V7.76h-11.64v5.82Zm-38.79,11.64v1.94h3.88v-3.88h-3.88v1.94Zm-27.15,3.88v1.94h3.88v-3.88h-3.88v1.94Zm46.55,7.76v1.94h-11.64v-3.88h11.64v1.94Zm-62.06,7.76v1.94h-3.88v3.88h11.64v3.88h-11.64v3.88h3.88v3.88h3.88v11.64h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v-3.88h-3.88v-7.76h3.88v-11.64h3.88v3.88h3.88v-7.76h-7.76v-3.88h-3.88v-3.88h3.88v-3.88h15.52v1.94Zm81.45,1.94v3.88h3.88v7.76h-3.88v7.76h-3.88v3.88h-3.88v-3.88h3.88v-11.64h-3.88v-3.88h-3.88v-3.88h-3.88v-3.88h15.52v3.88Zm-96.97,1.94v1.94h3.88v-3.88h-3.88v1.94Zm89.21,0v1.94h3.88v3.88h3.88v-3.88h-3.88v-3.88h-3.88v1.94Zm-81.45,3.88v1.94h3.88v-3.88h-3.88v1.94Zm77.58,3.88v1.94h-3.88v-3.88h3.88v1.94Zm-77.58,9.7v3.88h-7.76v7.76h3.88v-3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h-3.88v-3.88h3.88v-3.88h-7.76v3.88Zm19.39-1.94v1.94h3.88v-3.88h-3.88v1.94Zm0,11.64v1.94h-3.88v7.76h-3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-7.76h-3.88v-3.88h3.88v-3.88h-3.88v1.94Zm58.18,7.76v1.94h3.88v-3.88h3.88v11.64h-7.76v-3.88h-3.88v-7.76h3.88v1.94Zm15.52,0v1.94h-3.88v-3.88h3.88v1.94ZM0,95.03v1.94h7.76v-3.88H0v1.94Zm23.27,0v1.94h3.88v-3.88h-3.88v1.94Zm46.55,0v1.94h-3.88v-3.88h3.88v1.94Zm38.79,7.76v5.82h-11.64v-11.64h11.64v5.82ZM0,114.42v13.58h27.15v-27.15H0v13.58Zm65.94-11.64v1.94h-3.88v-3.88h3.88v1.94Zm34.91,0v1.94h3.88v-3.88h-3.88v1.94Zm-42.67,3.88v1.94h-3.88v3.88h-3.88v-3.88h3.88v-3.88h3.88v1.94Zm-35.16,7.76v9.45H4.13v-18.89h18.89v9.45Zm-15.26,0v5.82h11.64v-11.64H7.76v5.82Zm100.85,3.88v1.94h-3.88v-3.88h3.88v1.94Zm-69.82,3.88v1.94h-3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h-3.88v-3.88h-3.88v1.94Zm54.3,0v1.94h-3.88v-3.88h3.88v1.94Zm31.03,3.88v1.94h3.88v-3.88h-3.88v1.94Z"})}),(0,h.tZ)(nO.Z,{size:32,css:[g.l0.position.absolute],color:t})]}),(0,h.tZ)(V.xv,{variant:"small",color:"dimmer",children:"Scan to install"})]})}var nF=n(31661),nW=n(67795),nH=(0,C.X)({row:[g.l0.pb(12),g.l0.rowWithGap(2),g.l0.justify.center],buttonLeft:[g.l0.borderRadius(8,0,0,8),g.l0.flex.growAndShrink(1)],buttonRight:[g.l0.borderRadius(0,8,8,0)]});function nV(e){var t=e.shouldShow,n=e.onDismissTour,r=(0,f._)((0,m.useState)(!1),2),i=r[0],o=r[1];return(0,h.BX)(h.HY,{children:[t?(0,h.BX)(v.G,{css:nH.row,children:[(0,h.tZ)(I.zx,{iconLeft:(0,h.tZ)(nF.Z,{}),onClick:function(){(0,eK.j)(nW.U3.DEPLOYMENT_MOBILE_DOWNLOAD_QR_VIEWED),o(!0)},text:"Deploy with the Replit App!",css:nH.buttonLeft}),(0,h.tZ)(I.zx,{css:nH.buttonRight,text:"",iconLeft:(0,h.tZ)(nS.Z,{}),onClick:n})]}):null,(0,h.tZ)(nA.u,{isOpen:i,onRequestClose:function(){o(!1),n()},children:(0,h.tZ)(nM,{})})]})}var nz=(0,C.X)({root:{flexDirection:"row",gap:8,flexWrap:"wrap"},loading:t6,deployOptions:[g.l0.p(16),g.l0.pt(12),g.l0.borderRadius(8),g.l0.border({color:g.TV.outlineDimmest})]}),nj=function(e){var t=e.deploymentId,n=e.dotReplit,r=e.fs,i=e.onError,o=e.expanded,a=e.setExpanded,l=e.shouldShowMobileTour,c=e.onDismissMobileTour,s=(0,Z.XA)(),u=(E=(C={deploymentId:t,dotReplit:n}).deploymentId,R=C.dotReplit,G=(D=(0,f._)(m.useState(null),2))[0],B=D[1],m.useEffect(function(){var e=!1;function t(){return(t=(0,y._)(function(){var t;return(0,b.Jh)(this,function(n){switch(n.label){case 0:return[4,(0,tm.$f)(R)];case 1:if(t=n.sent(),e)return[2];return B(t),[2]}})})).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){e=!0}},[R]),N=(P=(0,U._)({},tL,{variables:{id:E},ssr:!1,fetchPolicy:"cache-and-network"}),A=Q.a(tO,P)).data,L=A.loading,O=A.error,X=(null==N?void 0:null===(_=N.hostingDeployment)||void 0===_?void 0:_.__typename)==="HostingDeployment"?N.hostingDeployment:null,(null==N?void 0:null===(S=N.hostingDeployment)||void 0===S?void 0:S.__typename)==="NotFoundError"?{deployment:null,config:null,error:"Deployment not found",loading:!1}:null===G||!X&&L?{data:null,erorr:null,loading:!0}:O||!X?{deployment:null,config:null,error:"Something went wrong",loading:!1}:{deployment:X,config:G,error:null,loading:!1}),d=nm({fs:r}).devSecrets,p=null===(M=u.deployment)||void 0===M?void 0:M.currentBuild.envVars,g=(0,m.useMemo)(function(){return d?nd({secrets:new Map(null==p?void 0:p.map(function(e){return[e.name,e.value]})),otherSecrets:d}).missing.size:0},[d,p]),w=(0,Z.kW)();if(w===e6.z.Preparing||w===e6.z.Deploying)return(0,h.tZ)(v.G,{css:nz.loading,children:(0,h.tZ)(t7,{})});if(u.error)return(0,h.tZ)(tZ,{text:u.error});if(o){var C,_,S,E,R,D,G,B,P,A,N,L,O,X,M,F,W=null===(F=u.deployment)||void 0===F?void 0:F.currentBuild;return W?(0,h.tZ)(v.G,{css:nz.deployOptions,children:(0,h.tZ)(nL,{initialSubdomain:"",provider:W.provider,deploymentId:t,fs:r,dotReplit:n,onCancel:function(){return a(!1)},onDeploy:function(){return a(!1)},onError:i,initialSecretsSyncExpanded:g>0})}):(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:"Provider not found"})}var H=u.loading||!(w===e6.z.Ready||w===e6.z.Suspended);return(0,h.BX)(v.G,{css:nz.root,children:[(0,h.tZ)(I.zx,{disabled:H,onClick:(0,y._)(function(){var e;return(0,b.Jh)(this,function(t){switch(t.label){case 0:if(u.loading)return[2];return[4,s({subdomain:null!==(e=u.deployment.replitAppSubdomain)&&void 0!==e?e:void 0})];case 1:return t.sent(),[2]}})}),text:w===e6.z.Suspended?"Resume":"Redeploy",iconLeft:(0,h.tZ)(k.Z,{})}),(0,h.tZ)(I.zx,{disabled:H,text:g>0?"".concat(g," ").concat((0,ns.Z)("secrets",g)," out of sync"):"Edit env",iconLeft:g>0?(0,h.tZ)(T.Z,{}):(0,h.tZ)(tX.Z,{}),onClick:function(){return a(!0)}}),(0,h.tZ)(nV,{shouldShow:l,onDismissTour:c})]})},nq=n(35597),nY=n(79217),n$=n(95891);(o||(o={})).Current="current";var nJ=(0,H._)({},"current",{icon:(0,h.tZ)(function(e){var t=e.color;return(0,h.tZ)(v.G,{css:[g.l0.align.center,g.l0.rowWithGap(8),{textTransform:"capitalize"}],children:(0,h.tZ)(v.G,{tag:"span",css:[g.l0.width("8px"),g.l0.height("8px"),g.l0.borderRadius("full"),{backgroundColor:t,boxShadow:"0 0 12px ".concat(t)}]})})},{color:g.TV.blueStronger}),text:"Current deployment"}),nK=v.K.div,nQ=function(e){var t=e.activityLogItem.type,n=(0,f._)(m.useState(!1),2),r=n[0],i=n[1],o=(0,f._)(m.useState(!1),2),a=o[0],l=o[1],c=m.useRef(!1);m.useEffect(function(){c.current=!0;var e=setTimeout(function(){l(r)},200);return function(){clearTimeout(e)}},[r]);var s=t in nJ&&nJ[t];if(!s)return null;var u=s.icon,d=s.text;return(0,h.tZ)(v.G,{css:[g.l0.p(8)],onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},children:(0,h.BX)(n$.Z,{isOpen:a,onClickOutside:function(){return l(!1)},padding:8,children:[(0,h.tZ)(nK,{css:g.l0.cursor.pointer,children:u}),(0,h.tZ)(v.G,{css:[g.l0.maxWidth(240)],children:(0,h.tZ)(V.xv,{children:d})})]})})},n0=n(34396),n1=function(e){var t=e.build,n=t.id.slice(0,8),r=(0,f._)(m.useState(!1),2),i=r[0],o=r[1],a=(0,f._)(m.useState(!1),2),l=a[0],c=a[1],s=m.useRef(!1);return m.useEffect(function(){s.current=!0;var e=setTimeout(function(){c(i)},200);return function(){clearTimeout(e)}},[i]),(0,h.tZ)("span",{onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},children:(0,h.BX)(n$.Z,{isOpen:l,onClickOutside:function(){return c(!1)},padding:8,children:[(0,h.tZ)("span",{css:[D.gU.listItem,g.l0.display.inlineBlock,g.l0.px(2),g.l0.py(0),g.l0.borderRadius(4)],children:n}),(0,h.tZ)(v.G,{css:[g.l0.maxWidth(260)],children:(0,h.tZ)(V.xv,{variant:"small",children:t.id})})]})})},n2=(a={},(0,H._)(a,n0.dD.Deploy,function(e){return(0,h.BX)(h.HY,{children:["deployed ",(0,h.tZ)(n1,{build:e})]})}),(0,H._)(a,n0.dD.Rollback,function(e){return(0,h.BX)(h.HY,{children:["rolled back ",(0,h.tZ)(n1,{build:e})]})}),(0,H._)(a,n0.dD.Fail,function(e){return(0,h.BX)(h.HY,{children:["failed to deploy ",(0,h.tZ)(n1,{build:e})]})}),a),n8=function(e){var t=e.activityLogItem,n=t.type,r=t.build,i=t.user.displayName,o=n in n2&&n2[n](r);return o?(0,h.BX)(V.xv,{multiline:!1,children:[(0,h.tZ)("span",{css:g.l0.fontWeight.medium,children:i+" "}),o]}):null},n4=(0,C.X)({line:{width:1,position:"absolute",left:3},circlePast:{position:"absolute",top:10,left:1,width:5,height:5,borderRadius:"100%",opacity:.5}}),n3=(0,C.X)({container:{width:7,position:"relative"},linePast:[n4.line,{backgroundColor:g.TV.outlineDimmest,top:15,bottom:-10}],linePresent:[n4.line,{backgroundImage:"linear-gradient(to top, ".concat(g.TV.outlineDimmest,", ").concat(g.TV.outlineDimmer,")"),top:27,bottom:-10}],lineFuture:[n4.line,{borderRight:"1px dashed "+g.TV.outlineDimmer,top:23,bottom:-20}],lineFutureFailClosed:[n4.line,{backgroundColor:g.TV.outlineDimmest,top:19,bottom:-20}],lineFutureFailOpen:[n4.line,{borderRight:"1px dashed "+g.TV.outlineDimmer,top:22,bottom:-18}],circlePastGreen:[n4.circlePast,g.l0.backgroundColor.accentPositiveDefault],circlePastRed:[n4.circlePast,g.l0.backgroundColor.accentNegativeDefault],circlePastGray:[n4.circlePast,g.l0.backgroundColor.outlineDimmer],circlePresent:[g.l0.backgroundColor.accentPrimaryStronger,{position:"absolute",top:20,left:0,width:7,height:7,borderRadius:"100%"}],circleFuture:{position:"absolute",top:12,left:-1,width:9,height:9},circleFutureFailClosed:[g.l0.backgroundColor.accentNegativeDefault,{position:"absolute",top:14,left:1,width:5,height:5,borderRadius:"100%",opacity:.6}]});function n5(e){var t,n;switch(e.type){case"pastSuccess":t=n3.linePast,n=(0,h.tZ)(v.G,{css:n3.circlePastGreen});break;case"pastFail":t=n3.linePast,n=(0,h.tZ)(v.G,{css:n3.circlePastRed});break;case"pastNeutral":t=n3.linePast,n=(0,h.tZ)(v.G,{css:n3.circlePastGray});break;case"present":t=n3.linePresent,n=(0,h.tZ)(v.G,{css:n3.circlePresent});break;case"future":t=n3.lineFuture,n=(0,h.tZ)("svg",{viewBox:"0 0 9 9",css:n3.circleFuture,children:(0,h.tZ)("circle",{cx:4.5,cy:4.5,r:4,fill:"none",stroke:g.TV.outlineStrongest,strokeDasharray:"2 1"})});break;case"futureFailClosed":t=n3.lineFutureFailClosed,n=(0,h.tZ)(v.G,{css:n3.circleFutureFailClosed});break;case"futureFailOpen":t=n3.lineFutureFailOpen,n=null}return(0,h.BX)(v.G,{css:n3.container,children:[(0,h.tZ)(v.G,{css:t,"data-timeline-line":!0}),n]})}function n6(e){var t=e.onViewBuildLogs,n=e.type,r=(0,w.Z)();return(0,h.tZ)(rc,{replId:r,onSelect:t,type:void 0===n?"default":n})}var n9=t8.filter(function(e){return"title"in e}),n7=(0,C.X)({root:[g.l0.flex.row,g.l0.px(8),g.l0.pb(8),{zIndex:0}]});function re(e){var t=e.activeStage,n=e.erroredStage;return(0,h.tZ)(v.G,{css:n7.root,children:n9.map(function(e){return(0,h.tZ)(tQ,{stage:e.id,text:e.title,totalStagesWithTitle:n9.length,activeStage:t,erroredStage:n},e.id)})})}var rt=(0,C.X)({root:[g.l0.colWithGap(8),g.l0.height("100%")],header:[g.l0.pt(8),g.l0.px(8),g.l0.rowWithGap(8),g.l0.align.center],divider:[{marginLeft:8,marginRight:8,borderBottom:"1px solid "+g.TV.outlineDimmest}],name:[g.l0.color.foregroundDefault,g.l0.fontWeight.medium],content:[g.l0.p(8),g.l0.flex.growAndShrink(1),g.l0.position.relative],loading:[g.l0.coverContainer,g.l0.center],error:[g.l0.m(8),g.l0.borderRadius(8),g.l0.overflow("hidden")],xterm:[g.l0.coverContainer,{overflow:"hidden",borderBottomLeftRadius:8,borderBottomRightRadius:8,"& > div":[g.l0.coverContainer,g.l0.p(8)]}]});function rn(e){var t,n,r=e.build,i=e.onBack,o=e.fs,a=e.openFile,l=e.onViewAppLogs,c=(0,f._)((0,tM.Z)({openFile:a,listFiles:o.listFiles}),2),s=c[0],u=c[1],d=(t={variables:{input:{buildId:r.id}},ssr:!1,fetchPolicy:"cache-and-network"},n=(0,U._)({},tE,t),Q.a(tD,n)),p=d.data,y=d.loading,b=(0,m.useMemo)(function(){if(!p)return null;var e=[],t="HostingBuildDeployActionHistoryResults"===p.hostingBuildDeployActionHistory.__typename?p.hostingBuildDeployActionHistory.results:null;if(t){var n=void 0,r=void 0,i=void 0,o=!0,a=!1,l=void 0;try{for(var c,s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0)!function(){var t=s.value;if("HostingBuildDeployLogAction"===t.__typename)return e.push(t.log);t8.some(function(e){return e.statusType===t.status})&&(n=t.status),t.status===R.Fe.Failed&&(r=n)}()}catch(e){a=!0,l=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw l}}var d=n?null===(c=t3(n))||void 0===c?void 0:c.id:void 0;return r&&(i=d),{logs:e,activeStage:d,erroredStage:i,erroredStatus:r}}},[p]);return(0,m.useEffect)(function(){if(s&&b){var e=!0,t=!1,n=void 0;try{for(var r,i=b.logs[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;s.write(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},[s,b]),(0,h.BX)(v.G,{css:rt.root,children:[(0,h.BX)(v.G,{css:rt.header,children:[(0,h.tZ)(eT.hU,{alt:"Back to timeline",onClick:function(){return i()},children:(0,h.tZ)(tg.Z,{})}),(0,h.tZ)(v.G,{children:(0,h.BX)(V.xv,{color:"dimmer",multiline:!1,children:[(0,h.tZ)("span",{css:rt.name,children:r.user.displayName+" "}),(0,tt.BX)(r.status)]})}),(0,h.tZ)(n1,{build:r})]}),(null==b?void 0:b.erroredStatus)?(0,h.BX)(v.G,{css:rt.error,children:[(null==b?void 0:b.erroredStatus)===R.Fe.Building?(0,h.tZ)(no,{provider:r.provider,openFile:a}):null,(null==b?void 0:b.erroredStatus)===R.Fe.Promoting?(0,h.tZ)(ni,{provider:r.provider,openFile:a,onViewApplicationLogs:l}):null]}):null,(0,h.tZ)(re,{activeStage:null==b?void 0:b.activeStage,erroredStage:null==b?void 0:b.erroredStage}),(0,h.tZ)(v.G,{css:rt.divider}),(0,h.BX)(G.Tg,{css:rt.content,children:[(0,h.tZ)(v.G,{css:rt.xterm,innerRef:u}),y||!s?(0,h.tZ)(v.G,{css:rt.loading,children:(0,h.tZ)(tv.Z,{color:g.TV.white,size:24})}):null]})]})}var rr=(0,C.X)({item:g.l0.rowWithGap(12),past:{":last-of-type":{"[data-timeline-line]":{display:"none"}}},future:{":last-of-type":{"[data-timeline-line]":{bottom:-19}}},animate:{animation:(0,X.Gs)(36.4)+" 300ms ease-out forwards"}}),ri=(0,C.X)({root:[g.l0.colWithGap(8)],empty:[g.l0.pb(8),g.l0.center,g.l0.align.stretch],items:[],loadMore:[g.l0.center],item:[g.l0.rowWithGap(8),g.l0.pl(8),g.l0.pr(4),g.l0.pb(12),g.l0.align.center,g.l0.flex.growAndShrink(1),g.l0.color.foregroundDimmest,g.l0.hover(g.l0.color.foregroundDefault)],itemMainText:[g.l0.flex.growAndShrink(1),(0,H._)({},g.nC.min(640),g.l0.flex.growAndShrink(0))],itemLine:[g.l0.display.none,(0,H._)({},g.nC.min(640),[g.l0.display.flex,g.l0.flex.growAndShrink(1),g.l0.border({color:g.TV.outlineDimmest,direction:"top"})])],itemRight:[g.l0.rowWithGap(6),g.l0.justify.end,g.l0.textAlign.right],itemContent:[g.l0.rowWithGap(8),g.l0.flex.growAndShrink(1),g.l0.align.center],itemPast:[rr.item,rr.past],itemPastAnimate:[rr.item,rr.past,rr.animate],itemFuture:[rr.item,rr.future],itemFutureAnimate:[rr.item,rr.future,rr.animate]}),ro=(0,C.X)({button:[g.l0.reset.button,g.l0.cursor.pointer,g.l0.borderRadius(8),g.l0.display.flex,g.l0.rowWithGap(6),g.l0.align.center,g.l0.px(8),g.l0.color.foregroundDimmer,g.l0.height(32),g.l0.hover(g.l0.color.foregroundDefault)]}),ra=(0,C.X)({button:ro.button,buttonHighlight:[ro.button,g.l0.color.accentNegativeStrongest,g.l0.backgroundColor.accentNegativeDimmest,g.l0.border({color:g.TV.accentNegativeDimmer})],buttonOpen:g.l0.flex.growAndShrink(1),buttonClosed:[g.l0.flex.growAndShrink(1),g.l0.pb(12)],buttonContent:[g.l0.flex.growAndShrink(1),g.l0.rowWithGap(8),g.l0.align.center]});function rl(e){var t=e.items,n=e.onClick,r=(0,f._)((0,m.useState)(!1),2),i=r[0],o=r[1],a=(0,Z.pn)(),l=m.useRef(void 0);m.useEffect(function(){(null==a?void 0:a.status)!==void 0&&(l.current=null==a?void 0:a.status)},[a,null==a?void 0:a.status]);var c=!a&&l.current!==R.Fe.Building&&l.current!==R.Fe.Success,s=c?g.TV.accentNegativeStronger:g.TV.foregroundDimmer;return 0===t.length?null:(0,h.BX)(v.G,{children:[(0,h.BX)(v.G,{css:g.l0.rowWithGap(12),children:[(0,h.tZ)(n5,{type:i?"futureFailOpen":"futureFailClosed"}),(0,h.tZ)(v.G,{css:i?ra.buttonOpen:ra.buttonClosed,children:(0,h.BX)("button",{onClick:function(){return o(!i)},css:c?ra.buttonHighlight:ra.button,children:[(0,h.BX)(v.G,{css:ra.buttonContent,children:[c?(0,h.tZ)(T.Z,{color:g.TV.accentNegativeStronger}):null,(0,h.BX)(V.xv,{children:[t.length," ",(0,ns.Z)("build",t.length)," failed"]}),i?null:(0,h.BX)(V.xv,{children:[t.length>1?"Most recent: ":null,(0,t1.Z)(new Date(t[0].timeCreated),Date.now(),{addSuffix:!0})]})]}),i?(0,h.tZ)(t2.Z,{color:s}):(0,h.tZ)(eJ.Z,{color:s})]})})]}),i?(0,h.tZ)(v.G,{css:g.l0.pt(8),children:t.map(function(e){return(0,h.tZ)(rs,{item:e,onClick:function(){return n(e.build)},type:"future"},e.id)})}):null]})}function rc(e){var t,n,r,i=e.replId,o=e.onSelect,a=e.type,l=void 0===a?"default":a,c=(t=(0,U._)({},tE,{variables:{replId:i,count:20},fetchPolicy:"cache-and-network",ssr:!1}),Q.a(tI,t)),s=c.data,u=c.previousData,d=c.loading,f=c.error,p=c.fetchMore,g=null!=s?s:u,w=(null==g?void 0:g.repl.__typename)==="Repl"?g.repl:null,C=(null==w?void 0:null===(r=w.hostingDeployment)||void 0===r?void 0:r.__typename)==="HostingDeployment"?w.hostingDeployment:null,_=(n=(0,y._)(function(){var e;return(0,b.Jh)(this,function(t){switch(t.label){case 0:if(!(e=null==C?void 0:C.activityLogs.pageInfo.nextCursor))return[2];return[4,p({variables:{after:e,count:20}})];case 1:return t.sent(),[2]}})}),function(){return n.apply(this,arguments)}),k=(0,nq.Z)({onLoadMore:_,rootMargin:"0px 0px 300px 0px"}).targetRef,S=m.useRef(""),E=(0,Z.$y)(),I=(0,Z.pn)(),D=m.useRef(void 0);if(m.useEffect(function(){(null==I?void 0:I.id)!==void 0&&(D.current=null==I?void 0:I.id)},[null==I?void 0:I.id]),d&&!C)return"failureQueue"===l?null:(0,h.tZ)(rd,{});if(!(null==C?void 0:C.activityLogs))return null;var G=C.activityLogs,B=G.items,P=G.pageInfo;if(0===B.length)return null;if(f)return(0,h.tZ)(v.G,{css:ri.empty,children:(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:"Something went wrong"})});B.length&&(B[0].build.id===(null==E?void 0:E.id)&&B[1]?S.current=B[1].build.id:S.current=B[0].build.id);var A=function(e,t){var n=[],r=(null==t?void 0:t.timeCreated)?new Date(t.timeCreated):null,i=!0,o=!1,a=void 0;try{for(var l,c=e[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;if(s.type!==R.dD.Fail||r&&r.getTime()>new Date(s.build.timeCreated).getTime()||(null==t?void 0:t.id)===s.build.id)break;n.push(s)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n}(B,E);return"failureQueue"===l?(0,h.tZ)(X.un,{render:A.length>0,initialHeight:44,children:(0,h.tZ)(rl,{items:A,onClick:o})}):(0,h.BX)(v.G,{css:ri.root,"data-history-timeline-items":B.length-A.length,children:[(0,h.tZ)(v.G,{css:ri.items,children:B.map(function(e,t){return e.build.id===(null==E?void 0:E.id)||t<A.length?null:(0,h.tZ)(rs,{item:e,onClick:function(){return o(e.build)}},e.id)})}),P.nextCursor?(0,h.tZ)(v.G,{css:ri.loadMore,children:(0,h.tZ)(eT.hU,{disabled:d,tooltipHidden:!0,alt:"Show more",onClick:_,ref:k,children:d?(0,h.tZ)(tv.Z,{}):(0,h.tZ)(nY.Z,{})})}):null]})}function rs(e){var t=e.item,n=e.onClick,r=e.timeline,i=e.type,o=(0,h.BX)(v.G,{css:ri.item,children:[(0,h.tZ)(v.G,{css:ri.itemMainText,children:(0,h.tZ)(n8,{activityLogItem:t})}),(0,h.tZ)(v.G,{css:ri.itemLine}),(0,h.BX)(v.G,{css:ri.itemRight,children:[(0,h.tZ)(nQ,{activityLogItem:t}),(0,h.tZ)(V.xv,{multiline:!1,children:(0,t1.Z)(new Date(t.timeCreated),Date.now(),{addSuffix:!0})}),(0,h.tZ)(eT.hU,{alt:"View deploy logs",onClick:n,children:(0,h.tZ)(S.Z,{})})]})]});return void 0===r||r?(0,h.BX)(v.G,{css:"past"===(void 0===i?"past":i)?ri.itemPast:ri.itemFuture,children:[(0,h.tZ)(n5,{type:t.type===R.dD.Fail?"pastFail":"pastSuccess"}),o]}):o}var ru=(0,C.X)({loading:[g.l0.rowWithGap(12),{":last-of-type":{"[data-timeline-line]":{display:"none"}}}],loadingItem:[$.p.backgroundPulse(),g.l0.height(20.4),g.l0.mt(2),g.l0.ml(4),g.l0.flex.growAndShrink(1),g.l0.borderRadius(6),{opacity:.5,marginBottom:14}]});function rd(){return(0,h.tZ)(v.G,{children:[,,,].fill(0).map(function(e,t){return(0,h.BX)(v.G,{css:ru.loading,children:[(0,h.tZ)(n5,{type:"pastNeutral"}),(0,h.tZ)(G.Tg,{elevated:!0,css:ru.loadingItem})]},t)})})}var rf=n(53937),rh=n(74440),rp=n(44166),rm=n(90234),rv=[1,2,3,4,5,6,7,8,9,10],rg=rv.length-1,ry=1/(2*rg),rb=(0,rm.cn)(2),rZ=(0,rm.cn)(function(e){return rv[e(rb)]}),rw=(0,rm.cn)(function(e){return(e(rh.Qc)*e(rZ)).toFixed(6)}),rx=(0,rm.cn)(function(e){return e(rh.Ig)*e(rZ)}),rC=(0,rm.cn)(0),r_=(0,rm.cn)(function(e){var t=0/rg,n=rv.length-1/rg,r=0,i=0;return e(rC)<t&&(r=(t-e(rC))/ry,i=t-ry),e(rC)>n&&(r=(e(rC)-n)/ry,i=n+ry),{overage:r,point:i}});(r=l||(l={})).None="0ms",r.Normal="120ms";var rk=["ArrowLeft","ArrowRight","Home","End"],rS=(0,ed.iv)({position:"relative",height:"16px",width:"100%",touchAction:"none"}),rE=(0,ed.iv)({position:"absolute",zIndex:2,top:"0",width:"16px",height:"16px",backgroundColor:g.TV.white,borderRadius:"100%",outline:"none",cursor:"pointer",willChange:"left, transition",boxShadow:"0 0 8px rgba(0,0,0,0.15)",":focus":{outline:"2px solid ".concat(g.TV.accentPrimaryDefault),":not(:focus-visible)":{outlineColor:"transparent"}}}),rT=n(71999),rR="min(var(--point), var(--position))",rI="max(var(--point), var(--position))",rD=(0,m.forwardRef)(function(e,t){var n=(0,rT.Dv)(r_),r=n.overage,i=n.point,o=(0,rT.Dv)(rC),a=(0,m.useRef)(null);return(0,m.useEffect)(function(){(0,rp.A)(a,"--opacity",String(r))},[r]),(0,m.useEffect)(function(){(0,rp.A)(a,"--point",String(100*i)+"%")},[i]),(0,m.useEffect)(function(){(0,rp.A)(a,"--position",String(100*o)+"%")},[o]),(0,m.useMemo)(function(){return(0,h.BX)(h.HY,{children:[(0,h.tZ)("div",{ref:t,"aria-hidden":!0,css:{position:"relative",top:"0",width:"100%",height:"16px",margin:"0",cursor:"pointer"}}),(0,h.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"5px",left:"0",width:"100%",height:"6px",margin:"0",overflow:"hidden",pointerEvents:"none",backgroundColor:D.vb.interactiveBorder,borderRadius:"2px"},children:(0,h.tZ)("div",{ref:a,"aria-hidden":!0,css:{"--opacity":0,"--point":0,"--position":0,backgroundImage:"\n                linear-gradient(\n                  to right, transparent ".concat(rR,", \n                  ").concat(D.vb.interactiveBorderHover," ").concat(rR,", \n                  ").concat(D.vb.interactiveBorderHover," ").concat(rI,", \n                  transparent ").concat(rI," \n                )"),opacity:"var(--opacity)",width:"100%",height:"100%"}})})]})},[t])}),rG=(0,m.forwardRef)(function(e,t){var n=(0,f._)((0,rT.KO)(rZ),1)[0],r=(0,m.useRef)(null);return(0,m.useImperativeHandle)(t,function(){return r.current}),n&&r.current&&(r.current.setAttribute("aria-valuemin",String(rv[0])),r.current.setAttribute("aria-valuemax",String(rv[rv.length-1])),r.current.setAttribute("aria-valuenow",String(n))),(0,m.useMemo)(function(){return(0,h.tZ)("div",{ref:r,role:"slider",tabIndex:0,css:[rE,{left:"calc((100% - 16px) * var(--max-instances-progress, 0))",transition:"left var(--max-instances-transition-time, 100ms) ease-out"}]})},[])}),rB=n(57330);function rP(e){var t=e.setAttrs,n=(0,f._)((0,rT.KO)(rb),2),r=n[0],i=n[1],o=(0,f._)((0,m.useState)(!1),2),a=o[0],c=o[1],s=(0,m.useRef)(null),u=(0,m.useRef)(null),d=(0,m.useRef)(null),p=(0,m.useCallback)(function(e){t.setTransitionTime(e)},[t]),y=(0,m.useCallback)(function(e){t.setProgress(e)},[t]);return void 0===r||a||(y(r/rg),p(l.Normal)),(0,m.useEffect)(function(){if(void 0!==r&&u.current&&d.current&&!a){var e=u.current,t=d.current,n=function(n){if(0===n.button){c(!0),t.focus();var r=e.getBoundingClientRect(),o=t.getBoundingClientRect(),a=r.width,s=o.width,u=n.target===e?s/2:n.clientX-o.left,d=null,f=function(e){var t=Math.max(0,Math.min(1,(e-r.left-u)/(a-s)));t!==d&&(d=t,y(t),i(Math.round(t*rg)))};f(n.clientX);var h=function(e){p(l.None),f(e.clientX),e.preventDefault(),e.stopPropagation()},m=function(){window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",m),p(l.Normal),c(!1)};window.addEventListener("pointermove",h),window.addEventListener("pointerup",m),window.addEventListener("pointercancel",m),n.preventDefault(),n.stopPropagation()}};return e.addEventListener("pointerdown",n),t.addEventListener("pointerdown",n),function(){e.removeEventListener("pointerdown",n),t.removeEventListener("pointerdown",n)}}},[r,a,i,y,p]),(0,m.useEffect)(function(){if(void 0!==r&&d.current&&!a){var e=d.current,t=function(e){if(void 0!==r&&rk.includes(e.key)){var t=Math.max(0,r-1),n=Math.min(rg,r+1),o=null;switch(e.key){case"ArrowLeft":o=t;break;case"ArrowRight":o=n;break;case"Home":o=0;break;case"End":o=rg}null!==o&&(i(o),e.preventDefault(),e.stopPropagation())}};return e.addEventListener("keydown",t),function(){e.removeEventListener("keydown",t)}}},[a,r,i]),(0,m.useMemo)(function(){return(0,h.tZ)(v.G,{css:g.l0.colWithGap(8),children:(0,h.BX)(v.G,{innerRef:s,css:rS,children:[(0,h.tZ)(rD,{ref:u}),(0,h.tZ)(rG,{ref:d})]})})},[])}var rA=(0,C.X)({costInfo:[g.l0.rowWithGap(4),g.l0.flex.shrink(1),g.l0.align.center]});function rN(e){var t=e.setAttrs,n=(0,f._)((0,rT.KO)(rZ),1)[0],r=(0,f._)((0,rT.KO)(rw),1)[0],i=(0,f._)((0,rT.KO)(rx),1)[0];return(0,h.BX)(v.G,{css:rB.B.container,children:[(0,h.BX)(v.G,{css:rB.B.label,children:[(0,h.BX)(V.xv,{css:rB.B.resource,multiline:!1,children:[n," ",(0,ns.Z)("machine",n)]}),(0,h.BX)(v.G,{css:rA.costInfo,children:[(0,h.BX)(v.G,{css:rB.B.cost,children:[(0,h.BX)(V.xv,{multiline:!1,children:[i," compute units"]}),(0,h.tZ)(V.xv,{color:"dimmer",variant:"small",multiline:!1,children:"/s at max traffic"})]}),(0,h.tZ)(nk.u,{tooltip:(0,h.BX)(v.G,{css:rB.B.cost,children:[(0,h.BX)(V.xv,{multiline:!1,children:["$",r]}),(0,h.tZ)(V.xv,{variant:"small",color:"dimmest",multiline:!1,children:"/s"})]}),children:(0,h.tZ)(tp.Z,{color:g.TV.foregroundDimmest})})]})]}),(0,h.tZ)(rP,{setAttrs:t})]})}var rU=n(10454),rL=[g.l0.colWithGap(12),g.l0.borderRadius(12),g.l0.p(16)],rO=(0,C.X)({container:[rL],disabled:[rL,{opacity:.5,pointerEvents:"none"}],text:[g.l0.colWithGap(4)],title:[g.l0.rowWithGap(4),g.l0.align.center],cost:[g.l0.flex.row,g.l0.align.baseline,g.l0.fontWeight.medium,{gap:3}],builder:[g.l0.colWithGap(8),g.l0.position.relative,{"--max-instances-transition-time":l.Normal,"--max-instances":1," *":{transitionTimingFunction:"ease"}}]});function rX(e){var t=e.maxMachineInstances,n=e.disabled,r=e.onError,i=(0,m.useRef)(null),o=(0,rT.b9)(rC),a=(0,rT.b9)(rb);return m.useEffect(function(){if(t){var e=rv.indexOf(t);if(-1===e){r("An error occurred while setting selected max machine instances.");return}a(e)}},[t,a,r]),(0,h.BX)(G.Tg,{elevated:!0,css:n?rO.disabled:rO.container,children:[(0,h.BX)(v.G,{css:rO.text,children:[(0,h.BX)(v.G,{css:rO.title,children:[(0,h.tZ)(rU.Z,{}),(0,h.tZ)(V.xv,{variant:"subheadDefault",multiline:!1,children:"Max number of machines"})]}),(0,h.tZ)(V.xv,{multiline:!0,variant:"small",color:"dimmer",children:"The most machines that should ever spin up to handle your highest traffic. More machines means a faster experience for your users."})]}),(0,h.tZ)(v.G,{css:rO.builder,innerRef:i,children:(0,h.tZ)(rN,{setAttrs:{setTransitionTime:function(e){(0,rp.A)(i,"--max-instances-transition-time",e)},setProgress:function(e){(0,rp.A)(i,"--max-instances-progress",e.toString()),o(e)}}})})]})}var rM=n(4927);function rF(){var e=(0,J._)(["\n  query AutoscaleMachineConfigurations {\n    hostingMachineConfigurations(input: { provider: cloud_run }) {\n      __typename\n      ... on HostingMachineConfigurationsResults {\n        results {\n          ...MachineConfiguration\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return rF=function(){return e},e}var rW={},rH=(0,K.Ps)(rF(),rM.bN),rV=n(12874),rz=n(73524),rj=function(e){var t,n,r=(0,Z.kW)(),i=(0,Z.hn)(),o=(0,Z.$y)(),a=void 0!==(0,Z.pn)(),l=!a&&"string"!=typeof i,c=(0,rT.Dv)(rh.aH),s=(0,rT.Dv)(rh.sA),u=(0,rT.Dv)(rZ),d=(t=(0,U._)({},rW,{onCompleted:function(t){"HostingMachineConfigurationsResults"!==t.hostingMachineConfigurations.__typename&&e.onError("Something went wrong")},onError:function(t){return e.onError(t.message)}}),Q.a(rH,t)),f=d.data,p=d.loading,w=(null==f?void 0:f.hostingMachineConfigurations.__typename)==="HostingMachineConfigurationsResults"?f.hostingMachineConfigurations.results:null;m.useEffect(function(){eQ({context:B.k.AutoscaleMachineConfiguration})},[]);var x=(n=(0,y._)(function(){var t,n,r,i;return(0,b.Jh)(this,function(o){return(t=null==w?void 0:w.find(function(e){var t=e.vcpu,n=e.memory;return c.toString()===t&&s.toString()===n}))?(n=t.id,r=t.label,i=t.slug,e.onConfirm({configurationId:n,configurationLabel:r,configurationSlug:i,maxInstances:u})):e.onError("An error occurred trying to validate selected machine configuration"),[2]})}),function(){return n.apply(this,arguments)}),C=p||e.fetching||a||r!==e6.z.Ready;return(0,h.BX)(h.HY,{children:[(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(tx,{onBack:e.onBack})}),(0,h.tZ)(W,{maxWidth:!0,children:(0,h.BX)(v.G,{css:g.l0.colWithGap(16),children:[(0,h.BX)(v.G,{css:g.l0.colWithGap(4),children:[(0,h.tZ)(V.xv,{variant:"subheadBig",children:"Autoscale machine configuration"}),(0,h.tZ)(V.xv,{variant:"small",color:"dimmer",children:"Autoscale apps spin up enough machines to meet demand at any point in time. You are billed for the total number of compute units across all machines."})]}),(0,h.BX)(v.G,{css:g.l0.colWithGap(16),children:[(0,h.tZ)(rf.Z,{machineConfiguration:null==o?void 0:o.machineConfiguration,disabled:C}),(0,h.tZ)(rX,{maxMachineInstances:null==o?void 0:o.maxMachineInstances,disabled:C,onError:e.onError})]}),(0,h.BX)(v.G,{css:[g.l0.colWithGap(8),g.l0.pt(8)],children:[(0,h.tZ)(I.zx,{colorway:"primary",text:l?"Approve and configure build settings":"Approve and update",iconRight:(0,h.tZ)(rV.Z,{}),onClick:x,loading:p}),(0,h.BX)(V.xv,{color:"dimmest",children:["Your deployed app will utilize any available monthly free allotment before charging for additional resource usage."," ",(0,h.tZ)("a",{href:rz.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})]})]})})]})},rq=n(26592),rY=n(71411),r$=n(14819),rJ=n(56335),rK=n(27187),rQ=n(70315),r0=n(52682),r1=(0,C.X)({container:g.l0.colWithGap(24),pauseAndResumeButtons:g.l0.colWithGap(8),sectionContainer:g.l0.colWithGap(8),sectionButton:[g.l0.color.accentNegativeStrongest,g.l0.transition.snappy,(0,H._)({backgroundColor:D.vb.interactiveBackground,borderColor:"transparent"},g.wl.hover,{borderColor:"transparent"})]}),r2=function(e){var t=e.hideResume,n=e.hideSuspend,r=e.onLifecycleCommand,i=(0,Z.kW)(),o=(0,Z.$y)(),a=(0,f._)(m.useState(!1),2),l=a[0],c=a[1],s=(0,w.Z)(),u=(0,Z.FN)(s),d=(null==o?void 0:o.status)===R.Fe.Resuming,p=(null==o?void 0:o.status)===R.Fe.Suspending,g=(null==o?void 0:o.status)===R.Fe.Suspended,y=d||p||i===e6.z.ProcessingLifecycleCommand||i===e6.z.Deploying,b=!(void 0!==t&&t)&&u&&(g||d)&&(null==o?void 0:o.hasImageTag),x=!(void 0!==n&&n)&&!g&&!d&&(p||i===e6.z.Deploying||i===e6.z.Ready)&&(null==o?void 0:o.hasImageTag);return(0,h.tZ)(h.HY,{children:(0,h.BX)(v.G,{css:r1.container,children:[b||x?(0,h.BX)(v.G,{css:r1.pauseAndResumeButtons,children:[b?(0,h.BX)(h.HY,{children:[(0,h.tZ)(I.zx,{text:d?"Resuming":"Resume",onClick:function(){return r({command:R.Qc.Resume})},loading:d,disabled:y,iconLeft:d?(0,h.tZ)(tv.Z,{}):(0,h.tZ)(rK.Z,{})}),(0,h.tZ)(V.xv,{color:"dimmer",children:"Your app will become accessible to users again"})]}):null,x?(0,h.BX)(h.HY,{children:[(0,h.tZ)(I.zx,{text:"Pause",onClick:function(){return r({command:R.Qc.Suspend})},loading:p,disabled:y,iconLeft:p?(0,h.tZ)(tv.Z,{}):(0,h.tZ)(rJ.Z,{})}),(0,h.tZ)(V.xv,{color:"dimmer",children:"Your deployment billing will continue, but all users will lose access to your app"})]}):null]}):null,(0,h.tZ)(r8,{setIsDestroying:c,onLifecycleCommand:r}),(0,h.tZ)(r4,{isDestroying:l,setIsDestroying:c,onLifecycleCommand:r})]})})};function r8(e){var t=e.setIsDestroying,n=e.onLifecycleCommand,r=(0,f._)(m.useState(!1),2),i=r[0],o=r[1];return(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:r1.sectionContainer,children:[(0,h.tZ)(I.zx,{text:"Change deployment type",onClick:function(){return o(!0)},iconLeft:(0,h.tZ)(rQ.Z,{})}),(0,h.tZ)(V.xv,{color:"dimmer",children:"To change your deployment type, you will need to shut down and create a new deployment."})]}),(0,h.tZ)(nA.u,{isOpen:i,onRequestClose:function(){return o(!1)},children:(0,h.tZ)(r$.Z,{confirmLabel:"Yes, delete my deployment",title:"Change Deployment Type",isDestructive:!0,onConfirm:function(){t(!0),o(!1),n({command:R.Qc.Destroy})},onCancel:function(){return o(!1)},children:"To change your deployment type, you will need to shut down and create a new deployment. This will destroy your deployment and any associated deployment tiers, saved replit.app domain and deployment history. You can always come back and redeploy your repl again."})})]})}function r4(e){var t=e.isDestroying,n=e.setIsDestroying,r=e.onLifecycleCommand,i=(0,f._)(m.useState(!1),2),o=i[0],a=i[1];return(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:r1.sectionContainer,children:[(0,h.tZ)(I.zx,{text:"Shut down",colorway:"negative",variant:"outlined",css:r1.sectionButton,onClick:function(){return a(!0)},disabled:t,iconLeft:(0,h.tZ)(r0.Z,{})}),(0,h.tZ)(V.xv,{color:"dimmer",children:"Your deployment billing will be canceled, and your deployed app will cease to exist"})]}),(0,h.tZ)(nA.u,{isOpen:o,onRequestClose:function(){return a(!1)},children:(0,h.tZ)(r$.Z,{confirmLabel:"Yes, delete my deployment",title:"Delete Deployment",isDestructive:!0,onConfirm:function(){n(!0),a(!1),r({command:R.Qc.Destroy})},onCancel:function(){return a(!1)},children:"This will destroy your deployment and any associated deployment tiers, saved replit.app domain and deployment history. You can always come back and redeploy your repl again."})})]})}var r3=function(e){var t=e.onBack,n=e.onCheckout,r=e.onLifecycleCommand,i=(0,Z.hn)(),o=!(void 0!==(0,Z.pn)())&&"string"!=typeof i,a=(0,w.Z)(),l=(0,Z.FN)(a),c=(0,f._)(m.useState(!1),2),s=c[0],u=c[1],d=(0,rY.P)({step:"not_shown"});return(m.useEffect(function(){eQ({context:"tier_selection"})},[]),m.useEffect(function(){if("checkout_success"===d.currentStep.step){u(!0);return}"not_shown"===d.currentStep.step&&d.goTo({step:"power_up_details",powerUpCategory:"hosting_tier"})},[d]),"not_shown"===d.currentStep.step)?(0,h.tZ)(h.HY,{}):(0,h.tZ)(W,{children:(0,h.BX)(v.G,{css:[g.l0.colWithGap(16),X.Qw.maxWidth],children:[l&&o?null:(0,h.tZ)(rq.s,(0,L._)((0,U._)({},d),{analyticsContext:"workspace_hosting_pane",goBack:function(){if("checkout_success"===d.currentStep.step){n();return}if("power_up_details"!==d.currentStep.step){d.goBack();return}t()}})),s?(0,h.tZ)(I.zx,{colorway:o?"primary":void 0,onClick:n,text:o?"Deploy your project":"Back to deployment"}):null,l&&o?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,h.tZ)(eT.hU,{alt:"Back",onClick:t,children:(0,h.tZ)(tg.Z,{})}),(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:"To upgrade hosting tier, please deploy your repl first."})]}),(0,h.tZ)(r2,{hideResume:!0,hideSuspend:!0,onLifecycleCommand:r})]}):null]})})},r5=n(40664),r6=n(2038),r9=n(48272);function r7(){var e=(0,J._)(["\n  query ReservedVMMachineConfigurations {\n    hostingMachineConfigurations(input: { provider: gce }) {\n      __typename\n      ... on HostingMachineConfigurationsResults {\n        results {\n          ...MachineConfiguration\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return r7=function(){return e},e}var ie={},it=(0,K.Ps)(r7(),rM.bN),ir=(0,C.X)({header:[g.l0.colWithGap(4),g.l0.mb(16)],costWrapper:[g.l0.rowWithGap(2),g.l0.align.center,g.l0.flex.shrink(1)],cost:[g.l0.rowWithGap(4),g.l0.align.baseline],selectWrapper:g.l0.rowWithGap(12),selectInner:[g.l0.flex.growAndShrink(1)],select:[g.l0.border({color:tz.TV.outlineDefault}),{flex:"1 1 auto"}]});function ii(e){switch(e){case"e2-micro":return[.00833,"6.40"];case"e2-small":return[.0166,"12.80"];case"e2-medium":return[.0333,"25.60"];case"n1-custom-1-4096":return[.0687,"52.80"];case"e2-standard-2":return[.1375,"105.60"];case"e2-standard-4":return[.275,"211.20"];default:return[null,null]}}var io=function(e){var t,n=e.initialMachineConfiguration,r=e.onChange,i=e.onConfirm,o=e.onError,a=e.onBack,l=(0,f._)(m.useState(n?(0,L._)((0,U._)({},n),{maxInstances:1}):void 0),2),c=l[0],s=l[1],u=(0,f._)(ii(null==c?void 0:c.configurationSlug),2),d=u[0],p=u[1],y=(0,f._)(m.useState(!1),2),b=y[0],Z=y[1],w=(t=(0,U._)({},ie,{onCompleted:function(e){"HostingMachineConfigurationsResults"!==e.hostingMachineConfigurations.__typename&&o("Something went wrong")},onError:function(e){return o(e.message)}}),Q.a(it,t)),x=w.data,C=w.loading,_=(null==x?void 0:x.hostingMachineConfigurations.__typename)==="HostingMachineConfigurationsResults"?x.hostingMachineConfigurations.results:null;m.useEffect(function(){eQ({context:B.k.AutoscaleMachineConfiguration})},[]),m.useEffect(function(){if(_&&!c){var e=_[0],t={configurationId:e.id,configurationLabel:e.label,configurationSlug:e.slug,maxInstances:1};s(t),"function"==typeof r&&r(t)}},[_,c,r]);var k=_&&(null==_?void 0:_.length)>0,S=C||b||!k;return(0,h.BX)(h.HY,{children:[(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(tx,{onBack:a})}),(0,h.BX)(W,{maxWidth:!0,children:[(0,h.BX)(v.G,{css:ir.header,children:[(0,h.tZ)(V.xv,{variant:"subheadBig",children:"Reserved VM configuration"}),(0,h.tZ)(V.xv,{variant:"small",color:"dimmer",children:"Reserved VM apps are always on and can have a dedicated machine. You are billed for the total number of hours your machines have been running for. The cost per hour changes depending on your machine configuration."})]}),(0,h.tZ)(nP,{id:"machineConfiguration",title:"Machine Configuration",information:"The build command is the command-line statement that compiles your app at build time.",children:c?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:ir.selectWrapper,children:[(0,h.tZ)(v.G,{css:ir.selectInner,children:(0,h.tZ)(r9.P,{css:ir.select,initialSelectedItem:{id:c.configurationId,title:c.configurationLabel},items:k?Object.values(_).map(function(e){var t=e.id;return{title:e.label,id:t}}):[],onChange:function(e){var t=e.id,n=null==_?void 0:_.find(function(e){return e.id===t});if(!n){o("An error occurred trying to validate selected machine configuration");return}var i={configurationId:n.id,configurationLabel:n.label,configurationSlug:n.slug,maxInstances:1};s(i),"function"==typeof r&&r(i)},disabled:S})}),(0,h.tZ)(v.G,{css:ir.costWrapper,children:(0,h.BX)(v.G,{css:ir.cost,children:[(0,h.BX)(V.xv,{variant:"subheadDefault",multiline:!1,children:["$",p]}),(0,h.tZ)(V.xv,{color:"dimmer",variant:"small",multiline:!1,children:"per month"}),(0,h.BX)(V.xv,{color:"dimmer",variant:"small",multiline:!1,children:["($",d,"/hour)"]})]})})]}),"function"==typeof i?(0,h.BX)(v.G,{css:[g.l0.colWithGap(8),g.l0.pt(8)],children:[(0,h.tZ)(I.zx,{colorway:"primary",text:"Approve and update",iconRight:(0,h.tZ)(rV.Z,{}),onClick:function(){if(!c){o("An error occurred trying to validate selected machine configuration");return}Z(!0),i(c)},loading:C,disabled:S}),(0,h.BX)(V.xv,{color:"dimmest",children:["Your deployed app will incur charges for any resource usage."," ",(0,h.tZ)("a",{href:rz.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})]}):null]}):(0,h.tZ)(v.G,{css:[$.p.foregroundPulse(),g.l0.borderRadius(8)],children:(0,h.tZ)(nZ.II,{disabled:!0})})})]})]})},ia=n(96503),il=n(33580),ic=(0,C.X)({deployOptionsWithCurrentBuild:[g.l0.p(16),g.l0.pt(12),g.l0.borderRadius(8),g.l0.border({color:g.TV.outlineDimmest})],back:[g.l0.pb(8),g.l0.flex.growAndShrink(1)],subViewOuter:[g.l0.rowWithGap(12)],subView:[g.l0.pb(12),g.l0.flex.growAndShrink(1),g.l0.colWithGap(12)],deploymentInfoWrapper:[g.l0.rowWithGap(12),{':has( + [data-history-timeline-items="1"])':{"[data-timeline-line]":{display:"none"}}}],deploymentInfo:[g.l0.pb(16),g.l0.flex.growAndShrink(1),g.l0.colWithGap(12)]}),is=function(e){var t=e.view,n=e.onViewAction,r=e.onError,i=e.openFile,o=e.onLifecycleCommand,a=e.refetch,l=(0,Z.kW)(),c=(0,Z.hn)(),s=(0,Z.$y)(),u=(0,Z.pn)(),d=(0,Z.XZ)(),p=(0,r6.rv)(),g=(0,to.P5)({controlName:ta.dD,logFlagToAnalytics:!1}),y=void 0!==s,b=(0,w.Z)(),C=(0,Z.FN)(b),_=null==s?void 0:s.provider,k=y&&s.machineConfiguration?{configurationId:s.machineConfiguration.id,configurationLabel:s.machineConfiguration.label,configurationSlug:s.machineConfiguration.slug,maxInstances:null==s?void 0:s.maxMachineInstances}:void 0,S=(0,r5.Z)("deployments-pane","deployments-mobile-download"),E=S.shouldDisplay,T=S.dismiss,I=S.register,D=(0,ia.q)(),G=D.loading,P=(0,O._)(D,["loading"]);(0,m.useEffect)(function(){I()},[I]);var A=(null==s?void 0:s.status)&&s.status===R.Fe.Success&&E&&!p,N=(0,f._)((0,m.useState)(!1),2),U=N[0],L=N[1],X=_===R.r4.Gce&&y&&!g&&!C,M=l===e6.z.Ready||l===e6.z.Suspended,F=(0,f._)((0,m.useState)(null),2),H=F[0],V=F[1],z=(0,f._)((0,m.useState)(null),2),j=z[0],q=z[1];m.useEffect(function(){eQ({context:B.k.Deployment})},[]),m.useEffect(function(){(l===e6.z.Preparing||l===e6.z.Deploying)&&(t===B.k.DeploymentInProgress||H||n({type:B.a.ChangeView,payload:{view:B.k.DeploymentInProgress}}))},[l,t,n,H]);var Y=m.useRef(void 0);m.useEffect(function(){Y.current=null==u?void 0:u.id},[null==u?void 0:u.id]);var $=(null==s?void 0:s.status)===R.Fe.Success,J=(null==s?void 0:s.id)===Y.current;m.useEffect(function(){$&&J&&n({type:B.a.ChangeView,payload:{view:B.k.Deployment}})},[$,J,n]);var K=null==u?void 0:u.status,Q=(0,m.useRef)(K);(0,m.useEffect)(function(){K&&(Q.current=K)},[K]);var ee=(0,Z.v5)();if(H)return(0,h.tZ)(rn,{build:H,fs:d,openFile:i,onBack:function(){V(null)},onViewAppLogs:function(){n({type:B.a.ChangeView,payload:{view:B.k.Logs}})}});if(j===R.r4.CloudRun)return(0,h.tZ)(rj,{onError:r,onConfirm:function(e){n({type:B.a.SendDeploymentLifecycleCommand,payload:{command:R.Qc.UpdateMachineConfiguration,machineConfigurationId:e.configurationId,maxMachineInstances:e.maxInstances}})},onBack:function(){return q(null)}});if(j===R.r4.Gce)return g?(0,h.tZ)(io,{initialMachineConfiguration:k,onConfirm:function(e){n({type:B.a.SendDeploymentLifecycleCommand,payload:{command:R.Qc.UpdateMachineConfiguration,machineConfigurationId:e.configurationId,maxMachineInstances:e.maxInstances}})},onBack:function(){return q(null)},onError:r}):(0,h.tZ)(r3,{onLifecycleCommand:o,onCheckout:function(){a(),q(null)},onBack:function(){q(null)}});var et=X||!y||!c;return(0,h.BX)(h.HY,{children:[g&&!G&&P.hasReservedVMs?(0,h.tZ)(W,{children:(0,h.tZ)(il.Z,{})}):null,(0,h.tZ)(W,{children:(0,h.BX)(v.G,{children:[(0,h.BX)(v.G,{css:ic.subViewOuter,children:[y?(0,h.tZ)(n5,{type:"future"}):null,(0,h.BX)(v.G,{css:ic.subView,children:[!et&&M?(0,h.tZ)(nj,{dotReplit:ee,fs:d,deploymentId:c,onError:r,expanded:U,setExpanded:L,shouldShowMobileTour:null!=A&&A,onDismissMobileTour:T}):null,t===B.k.DeploymentInProgress?(0,h.tZ)(ne,{openFile:i,viewBuildLogsOnLoad:!y,onViewLogs:function(){n({type:B.a.ChangeView,payload:{view:B.k.Logs}})},onCanceled:function(){n({type:B.a.ChangeView,payload:{view:B.k.Deployment}}),r("Build cancelled")},onError:r}):null]})]}),y?(0,h.BX)(h.HY,{children:[(0,h.tZ)(n6,{type:"failureQueue",onViewBuildLogs:V}),(0,h.BX)(v.G,{css:ic.deploymentInfoWrapper,children:[(0,h.tZ)(n5,{type:"present"}),(0,h.BX)(v.G,{css:ic.deploymentInfo,children:[(0,h.tZ)(th,{provider:_,machine:k,onViewBuildLogs:V,onManageClick:function(){if(_===R.r4.CloudRun||_===R.r4.Gce){q(_);return}_===R.r4.Static&&n({type:B.a.ChangeView,payload:{view:B.k.Settings}})}}),X?(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(tp.Z,{}),text:"Your deployment requires a tier in order to re-deploy"}):null]})]}),(0,h.tZ)(n6,{onViewBuildLogs:V})]}):null]})})]})},iu=n(66587),id=n(55330),ih=n(93302),ip=n(52932),im=n(4513),iv=n(84731),ig=n(81340),iy=n(97764),ib=n(76566),iZ=n(59811),iw=n(50946),ix=n(96239),iC=n(4773),i_=n(40028),ik=n(70078),iS=n(87001),iE=n(16560),iT=function(){var e=(0,Z.gg)(),t=e.isDeployableRepl,n=e.reason;return t?null:(0,h.tZ)(x.E,{colorway:"warning",text:n})};function iR(){var e=(0,J._)(["\n  fragment DeploymentsNewDeploymentRepl on Repl {\n    id\n    slug\n    owner {\n      ... on User {\n        id\n        username\n      }\n      ... on Team {\n        id\n        username\n      }\n    }\n    powerUps {\n      ... on ReplPowerUpTypes {\n        hostingTier {\n          sku\n        }\n      }\n    }\n  }\n"]);return iR=function(){return e},e}function iI(){var e=(0,J._)(["\n  query DeploymentsNewDeployment($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...DeploymentsNewDeploymentRepl\n      }\n    }\n  }\n  ","\n"]);return iI=function(){return e},e}var iD={},iG=(0,K.Ps)(iR()),iB=(0,K.Ps)(iI(),iG);function iP(){var e=(0,J._)(["\n  query DeploymentsPaneIntro($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        owner {\n          __typename\n          ... on Team {\n            id\n          }\n        }\n        hostingDeploymentPermissions {\n          canDeployReservedVm {\n            isDeployable\n            explanation\n          }\n          canDeployAutoscale {\n            isDeployable\n            explanation\n          }\n          canDeployStatic {\n            isDeployable\n            deploymentCount\n            limit\n            explanation\n          }\n        }\n        ...DeploymentsNewDeploymentRepl\n      }\n    }\n    currentUser {\n      id\n      userSubscriptionType\n      usageBasedBilling(input: { capabilitiesOnly: true }) {\n        __typename\n        ... on UserUsageBasedBillingSummary {\n          capabilities {\n            canUseUsageBasedBilling\n            explanation\n            hasPaymentMethod\n          }\n        }\n        ... on ServiceUnavailable {\n          message\n        }\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserError {\n          message\n        }\n      }\n      usageInterval {\n        __typename\n        ... on UsageInterval {\n          resources {\n            autoscaleComputeUnits {\n              allotment\n              usage\n            }\n          }\n        }\n        ... on ServiceUnavailable {\n          message\n        }\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserError {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return iP=function(){return e},e}var iA={},iN=(0,K.Ps)(iP(),iG),iU=(0,C.X)({type:[g.l0.borderRadius(8),g.l0.p(8)],hostingTierFlow:g.l0.colWithGap(8),manageReserved:g.l0.colWithGap(16),manageReservedHeader:[g.l0.rowWithGap(8),g.l0.align.center]});function iL(e){var t,n,r=e.replId,i=e.initialState,o=e.fs,a=e.dotReplit,l=e.onBack,c=e.onDeploy,s=e.onError,u=e.onLifecycleCommand,d=(0,f._)((0,m.useState)(i),2),p=d[0],g=d[1],y=(t=(0,U._)({},iD,{variables:{replId:r},onError:function(e){return s(e.message)}}),Q.a(iB,t)),b=y.data,Z=y.loading,w=y.refetch,C=(null==b?void 0:b.repl.__typename)==="Repl"?b.repl:null,_=C?(0,ng.Jw)({replSlug:C.slug,username:null===(n=C.owner)||void 0===n?void 0:n.username}):"",k=(null==C?void 0:C.powerUps.__typename)==="ReplPowerUpTypes"?C.powerUps.hostingTier:null,S=(0,to.P5)({controlName:ta.dD,logFlagToAnalytics:!1});return Z?(0,h.tZ)(ty,{loading:!0}):C?p.type===R.r4.Static?(0,h.BX)(h.HY,{children:[(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(eT.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return l()},children:(0,h.tZ)(tg.Z,{})})}),(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(G.Tg,{css:iU.type,elevated:!0,children:(0,h.tZ)(tf,{label:"Type",fullWidth:!0,children:(0,h.tZ)(td,{name:e9[p.type]})})})}),(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(nL,{initialSubdomain:_,deploymentId:null,provider:p.type,onError:s,onCancel:function(){return l()},onDeploy:c,fs:o,dotReplit:a})})]}):p.type===R.r4.Gce?k&&p.didCheckout?p.manage?(0,h.tZ)(W,{maxWidth:!0,children:(0,h.BX)(v.G,{css:iU.manageReserved,children:[(0,h.BX)(v.G,{css:iU.manageReservedHeader,children:[(0,h.tZ)(eT.hU,{alt:"Back",onClick:function(){return g({type:p.type,didCheckout:p.didCheckout,manage:!1})},children:(0,h.tZ)(tg.Z,{})}),(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:"To upgrade hosting tier, please deploy your repl first."})]}),(0,h.tZ)(r2,{hideResume:!0,hideSuspend:!0,onLifecycleCommand:u})]})}):(0,h.BX)(h.HY,{children:[(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(G.Tg,{css:iU.type,elevated:!0,children:(0,h.tZ)(tf,{label:"Type",fullWidth:!0,children:(0,h.tZ)(td,{name:e9[p.type],sku:(0,e5.$)(k.sku),canManage:!0,onManageClick:function(){g({type:p.type,didCheckout:p.didCheckout,manage:!0})}})})})}),(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(nL,{initialSubdomain:_,deploymentId:null,provider:p.type,onError:s,onCancel:function(){return l()},onDeploy:c,fs:o,dotReplit:a})})]}):!k&&S?(0,h.BX)(h.HY,{children:[(0,h.tZ)(io,{onBack:l,onError:s,onChange:function(e){g({type:R.r4.Gce,machine:e})}}),(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(nL,{initialSubdomain:_,deploymentId:null,provider:p.type,machine:p.machine,onError:s,onCancel:l,onDeploy:c,fs:o,dotReplit:a})}),(0,h.tZ)(W,{maxWidth:!0,children:(0,h.BX)(V.xv,{color:"dimmest",children:["Your deployed app will incur charges for any resource usage."," ",(0,h.tZ)("a",{href:rz.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})})]}):(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(iO,{onBack:l,onCheckout:function(){g({type:p.type,didCheckout:!0,manage:!1}),w()}})}):p.machine?(0,h.BX)(h.HY,{children:[(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(eT.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return g({type:R.r4.CloudRun,machine:null})},children:(0,h.tZ)(tg.Z,{})})}),(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(G.Tg,{css:iU.type,elevated:!0,children:(0,h.tZ)(tf,{label:"Type",fullWidth:!0,children:(0,h.tZ)(td,{name:e9[p.type],sku:"".concat(p.machine.configurationLabel," / ").concat(p.machine.maxInstances," Max"),canManage:!0,onManageClick:function(){g({type:R.r4.CloudRun,machine:null})}})})})}),(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(nL,{initialSubdomain:_,deploymentId:null,provider:p.type,machine:p.machine,onError:s,onCancel:function(){return g({type:R.r4.CloudRun})},onDeploy:c,fs:o,dotReplit:a})})]}):(0,h.tZ)(W,{maxWidth:!0,children:(0,h.tZ)(rj,{onBack:l,onError:s,onConfirm:function(e){g({type:R.r4.CloudRun,machine:e})}})}):null}var iO=function(e){var t=e.onBack,n=e.onCheckout,r=(0,w.Z)(),i=(0,Z.Sl)(r),o=i.hostingTier,a=i.refetch,l=(0,rY.P)({step:"power_up_details",powerUpCategory:"hosting_tier"}),c=l.currentStep.step;return(0,m.useEffect)(function(){"checkout_success"===c&&a()},[c,a]),(0,h.BX)(v.G,{css:iU.hostingTierFlow,children:[(0,h.tZ)(rq.s,{currentStep:l.currentStep,canGoBack:l.canGoBack||"power_up_details"===c,goTo:l.goTo,analyticsContext:"workspace_hosting_pane",goBack:function(){if("checkout_success"===l.currentStep.step){n();return}if("power_up_details"!==l.currentStep.step){l.goBack();return}t()}}),o?(0,h.tZ)(I.zx,{colorway:"primary",onClick:n,text:"Deploy your project"}):null]})},iX=g.nC.min(440),iM={order:"--provider-order"},iF={order:"var(".concat(iM.order,")")},iW=(0,ed.iv)([g.l0.reset.button,g.l0.overflow("hidden"),g.l0.position.relative,g.l0.focusRing,g.l0.borderRadius(8),g.l0.flex.growAndShrink(1)]),iH=(0,C.X)({loading:[iW,$.p.foregroundPulse(),g.l0.border({color:g.TV.backgroundHighest})],self:[iW,D.gU.filledAndOutlined,g.l0.border({color:g.TV.outlineDimmer}),(c={},(0,H._)(c,iX,{order:iF.order}),(0,H._)(c,"&::after",{content:"none"}),c)],selfActive:[iW,g.l0.cursor.pointer,g.l0.backgroundColor.accentPrimaryDimmest,g.l0.border({color:g.TV.accentPrimaryStronger}),(s={},(0,H._)(s,iX,{order:iF.order}),(0,H._)(s,"&::after",{content:"none"}),s)],content:[g.l0.p(8),g.l0.colWithGap(4),(0,H._)({},iX,g.l0.py(12))],contentRecommended:[g.l0.p(8),g.l0.colWithGap(4),(0,H._)({},iX,{paddingTop:12,paddingBottom:20})],recommended:[g.l0.py(4),g.l0.backgroundColor.backgroundHighest],recommendedActive:[g.l0.py(4),g.l0.backgroundColor.accentPrimaryDimmer],icon:[g.l0.display.none,g.l0.color.foregroundDimmer,g.l0.center,(0,H._)({},iX,g.l0.display.flex)],iconActive:[g.l0.display.none,g.l0.color.accentPrimaryStrongest,g.l0.center,(0,H._)({},iX,g.l0.display.flex)],tiersTitle:[g.l0.rowWithGap(8),g.l0.align.center]});function iV(e){var t,n,r,i,o=e.loading,a=e.active,l=e.provider,c=e.onClick,s=e.title,u=e.description,d=e.recommended,f=e.index,p=(i={},(0,H._)(i,R.r4.CloudRun,(0,h.tZ)(iZ.Z,{size:32})),(0,H._)(i,R.r4.Gce,(0,h.tZ)(rU.Z,{size:32})),(0,H._)(i,R.r4.Static,(0,h.tZ)(ix.Z,{size:32})),i)[l];return(0,h.BX)("button",{css:(n=(t={loading:o,active:a}).loading,r=t.active,n?iH.loading:r?iH.selfActive:iH.self),onClick:function(){return c(l)},disabled:o,style:(0,H._)({},iM.order,f),children:[d?(0,h.tZ)(v.G,{css:a?iH.recommendedActive:iH.recommended,children:(0,h.tZ)(V.xv,{variant:"small",children:"Recommended"})}):null,(0,h.BX)(v.G,{css:d?iH.contentRecommended:iH.content,children:[(0,h.tZ)(v.G,{css:a?iH.iconActive:iH.icon,children:p}),(0,h.BX)(v.G,{children:[(0,h.tZ)(v.G,{css:[g.l0.rowWithGap(4),g.l0.center],children:(0,h.tZ)(V.xv,{variant:"subheadDefault",multiline:!1,children:s})}),(0,h.tZ)(V.xv,{multiline:!1,variant:"small",children:u})]})]})]})}var iz=(0,C.X)({container:[g.l0.colWithGap(12),g.l0.maxWidth(400),{marginLeft:"auto",marginRight:"auto"}],item:[g.l0.align.center,{display:"grid",gridTemplateColumns:"56px auto",gap:20}],text:[g.l0.flex.growAndShrink(1),g.l0.textAlign.left],autoscaleHours:{}});function ij(e){var t=e.header,n=e.info;return(0,h.BX)(v.G,{css:iz.container,children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",children:t}),n.map(function(e,t){return(0,h.BX)(v.G,{css:iz.item,children:[e.icon,(0,h.tZ)(V.xv,{css:iz.text,children:e.text})]},t)})]})}var iq=[R.r4.Gce,R.r4.CloudRun,R.r4.Static],iY=(0,C.X)({container:[g.l0.colWithGap(32),g.l0.py(32),g.l0.textAlign.center,X.Qw.maxWidth],title:[g.l0.colWithGap(4),g.l0.width("100%"),g.l0.maxWidth(288),{marginLeft:"auto",marginRight:"auto"}],providers:[g.l0.flex.column,g.l0.align.stretch,(0,H._)({gap:8},iX,[g.l0.flex.row,g.l0.align.center,{gap:12}])],cta:[g.l0.width("100%"),g.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],secondaryCta:[g.l0.width("100%"),g.l0.maxWidth(320)],ctaContainer:[g.l0.colWithGap(8),g.l0.align.center],ctaStatusBanner:[g.l0.textAlign.left],oldCta:[g.l0.px(8),g.l0.colWithGap(16)],payment:[g.l0.p(16),g.l0.borderRadius(12),g.l0.textAlign.left,g.l0.shadow(2)],budgetContainer:[g.l0.colWithGap(8),g.l0.border(),g.l0.borderRadius(8),g.l0.p(8)],disabledBanner:[g.l0.py(6),{alignSelf:"center"}]}),i$=function(e){var t,n,r,i,o,a,l,c=e.replId,s=e.onError,u=e.onDeploy,d=e.onLifecycleCommand,p=e.initialSelectedProvider,w=(0,Z.FN)(c),x=(0,Z.gg)().isDeployableRepl,C=(0,Z.XZ)(),_=(0,Z.v5)(),k=(0,f._)(m.useState(void 0),2),S=k[0],E=k[1],T=(0,f._)(m.useState(void 0),2),I=T[0],D=T[1],B=(0,f._)(m.useState(!1),2),P=B[0],A=B[1],N=(0,f._)(m.useState(!1),2),L=N[0],O=N[1],X=(0,f._)(m.useState(null!=p?p:null),2),M=X[0],F=X[1];m.useEffect(function(){eQ({context:"intro"})},[]);var z=(t=(0,U._)({},iA,{variables:{id:c},onError:function(e){return s(e.message)}}),Q.a(iN,t)),j=z.loading,q=z.data,Y=z.refetch,$=(0,f._)(m.useState(!1),2),J=$[0],K=$[1],ee=(null==q?void 0:q.repl.__typename)==="Repl"&&(null===(n=q.repl.owner)||void 0===n?void 0:n.__typename)==="Team",et=(null==q?void 0:q.repl.__typename)==="Repl"&&(null==q?void 0:null===(r=q.repl.owner)||void 0===r?void 0:r.id)&&(0,ik.xm)(null==q?void 0:null===(i=q.repl.owner)||void 0===i?void 0:i.id),en=(0,to.P5)({controlName:ta.dD,logFlagToAnalytics:!1});m.useEffect(function(){(0,y._)(function(){var e,t;return(0,b.Jh)(this,function(n){switch(n.label){case 0:if(j)return[2];if(ee&&!et)return E(R.r4.Gce),D(R.r4.Gce),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,tm.$f)(_)];case 2:if(null===(e=n.sent()).appType)return E(R.r4.CloudRun),D(R.r4.CloudRun),[2];if((t=(0,ip.oU)(e.appType))===R.r4.Goval||t===R.r4.Extension)return s("Did not recognize template deployment provider"),[2];return E(t),D(t),[3,4];case 3:return n.sent(),s("Something went wrong"),[3,4];case 4:return[2]}})})()},[s,_,j,ee,et]);var er=m.useMemo(function(){var e=function(e){var t=e.data,n=null==t?void 0:t.usageInterval;if(n&&"UsageInterval"===n.__typename)return Math.max(0,n.resources.autoscaleComputeUnits.allotment-n.resources.autoscaleComputeUnits.usage)}({data:null==q?void 0:q.currentUser});if(void 0===e||0===e)return"You you will be charged by usage of compute units";var t=(0,ih.fZ)(e,{resourceUsageType:"ComputeUnits"});return"You have ".concat(t," left this month")},[q]),ei=m.useCallback((0,y._)(function(){return(0,b.Jh)(this,function(e){switch(e.label){case 0:return K(!0),[4,Y()];case 1:return e.sent(),K(!1),[2]}})}),[Y,K]),eo=(0,iv.Q)();if(M||w)return(0,h.tZ)(iL,{replId:c,initialState:w||!M?{type:R.r4.Gce,didCheckout:!0}:{type:M},fs:C,dotReplit:_,onDeploy:u,onBack:function(){return F(null)},onError:s,onLifecycleCommand:d});var ea=function(){if(!q||(null==q?void 0:q.repl.__typename)!=="Repl"||!S)return{isDeployable:!1,explanation:"Loading"};if(S===R.r4.Static){var e=q.repl.hostingDeploymentPermissions.canDeployStatic;return{isDeployable:e.isDeployable,explanation:e.explanation}}if(S===R.r4.CloudRun){var t=q.repl.hostingDeploymentPermissions.canDeployAutoscale;return{isDeployable:t.isDeployable,explanation:t.explanation}}if(S===R.r4.Gce){var n=q.repl.hostingDeploymentPermissions.canDeployReservedVm;return{isDeployable:n.isDeployable,explanation:n.explanation}}(0,i_.Z)(S)}(),el=ea.isDeployable,ec=ea.explanation,es=j||J||void 0===S,eu=null==q?void 0:null===(o=q.currentUser)||void 0===o?void 0:o.userSubscriptionType,ed=eu===R.HP.Hacker,ef=eu===R.HP.HackerPro,eh=(null==q?void 0:null===(a=q.currentUser)||void 0===a?void 0:a.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?q.currentUser.usageBasedBilling.capabilities:null,ep=(l={title:"Deploy to production",subtitle:"Deploy a stable, public version of your project, unaffected by the changes you make in the workspace."},(0,H._)(l,R.r4.Gce,{display:!0,title:"Reserved VM",subtitle:"Servers that stay on",header:"Reserved VM is for apps that don't tolerate restarts",info:[{text:"Reserved VM apps have 99.9% uptime, preventing restarts that interrupt apps that rely on information between client sessions",icon:(0,h.tZ)(im.lV,{})},{text:function(){if(en){var e=(0,f._)(ii("e2-micro"),1)[0];return"Reserved VMs are billed in compute hours starting at $".concat(e,"/hour.")}return"Flat monthly price based on your custom power level, starting at $7/month"}(),icon:(0,h.tZ)(im.G8,{})},{text:"Perfect for Discord bots, Slack bots, stateful APIs, and long-running jobs",icon:(0,h.tZ)(im.KU,{})}]}),(0,H._)(l,R.r4.CloudRun,{display:!0,title:"Autoscale",subtitle:"Meet demand exactly",header:"Autoscale is the best choice for most projects",info:[{text:"Automatically scales from zero to any level of demand, making it inexpensive for most apps and effortless for when you go viral",icon:(0,h.tZ)(im.Qm,{})},{text:ed||ef?"".concat(ef?"6 million":"3 million"," compute units per month are included in Replit ").concat(ef?eo:iS.ZK," plan. Additional usage is billed at $").concat(iE.m0," per compute unit"):"Compute units are included in Replit plans, then billed at $".concat(iE.m0," per compute unit"),icon:(0,h.tZ)(function(){return ed?(0,h.tZ)(im.GN,{}):ef?(0,h.tZ)(im.T3,{}):(0,h.tZ)(im.fG,{})},{})},{text:"Perfect for web apps, and stateless APIs",icon:(0,h.tZ)(im.KU,{})}]}),(0,H._)(l,R.r4.Static,{display:!0,title:"Static",subtitle:"Easy client-side apps",header:"Static lets you share client-side apps fast",info:[{text:"No server compute means free usage  you are only responsible for outbound data transfer (included in Replit plans)",icon:(0,h.tZ)(im.Lv,{})},{text:"Extremely fast deploy times allow you to move quickly on your production sites",icon:(0,h.tZ)(im.lt,{})},{text:"Perfect for HTML sites and Static content",icon:(0,h.tZ)(im.KU,{})}]}),l);return(0,h.BX)(W,{children:[(0,h.tZ)(nA.u,{isOpen:L,onRequestClose:function(){return O(!1)},children:(0,h.tZ)(id.Z,{onRequestClose:function(){return O(!1)}})}),(0,h.BX)(v.G,{css:iY.container,children:[(0,h.BX)(v.G,{css:iY.title,children:[(0,h.tZ)(V.xv,{variant:"subheadBig",children:ep.title}),(0,h.tZ)(V.xv,{color:"dimmer",children:ep.subtitle}),(0,h.tZ)(V.xv,{css:g.l0.textAlign.center,children:(0,h.tZ)("a",{href:"https://docs.replit.com/category/deployments",target:"_blank",rel:"noopener",children:"Learn more"})})]}),(0,h.BX)(v.G,{css:g.l0.colWithGap(16),children:[(0,h.tZ)(v.G,{css:iY.providers,children:iq.map(function(e,t){if(!ep[e].display)return null;var n=ep[e],r=n.title,i=n.subtitle;return(0,h.tZ)(iV,{provider:e,loading:es,active:S===e,onClick:function(e){E(e),A(!1)},title:r,description:i,recommended:I===e,index:e===I&&0===t?1.5:e===I&&2===t?.5:t},e)})}),(0,h.BX)(v.G,{css:g.l0.colWithGap(8),children:[(0,h.tZ)(iJ,{activeProvider:S,isDeployable:el,isDeployableExplanation:ec,loading:es,ubbExplanation:null==eh?void 0:eh.explanation,hasPaymentMethod:null==eh?void 0:eh.hasPaymentMethod,isDeployableRepl:x,handleOnProviderContinue:function(){S&&F(S)},refetchUbbCapabilitiesQueryData:ei,setShowPaymentMethodForm:function(){return A(!0)},showPaymentMethodForm:P,setShowSupportForm:function(){return O(!0)},hasUBBReservedVMs:en}),S===R.r4.CloudRun?(0,h.tZ)(V.xv,{color:"dimmer",children:er}):null,P?(0,h.tZ)(G.Tg,{elevated:!0,css:iY.payment,children:(0,h.tZ)(iy.q,{onSuccess:(0,y._)(function(){return(0,b.Jh)(this,function(e){switch(e.label){case 0:return A(!1),[4,ei()];case 1:return e.sent(),[2]}})}),context:"workspace_hosting_pane"})}):null]}),(0,h.tZ)(iT,{})]}),(0,h.tZ)(v.G,{css:g.l0.colWithGap(16),children:S?(0,h.tZ)(ij,{header:ep[S].header,info:ep[S].info}):null})]})]})};function iJ(e){var t=e.activeProvider,n=e.isDeployable,r=e.isDeployableExplanation,i=e.loading,o=e.ubbExplanation,a=e.hasPaymentMethod,l=e.isDeployableRepl,c=e.handleOnProviderContinue,s=e.refetchUbbCapabilitiesQueryData,u=e.setShowPaymentMethodForm,d=e.showPaymentMethodForm,f=e.setShowSupportForm,p=e.hasUBBReservedVMs,m=(0,r6.rv)();return n?t!==R.r4.Gce||p?o===R.Fp.NeedsSubscription||o===R.Fp.NeedsSubscriptionOrPaymentMethod?m?(0,h.tZ)(x.E,{text:"You need a subscription to deploy. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,h.tZ)(T.Z,{}),css:iY.ctaStatusBanner}):(0,h.BX)(v.G,{css:iY.ctaContainer,children:[(0,h.tZ)(iC.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to deploy",css:iY.cta,colorway:"primary",disabled:d,onPlanCheckoutComplete:s}),(0,h.tZ)(I.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:iY.cta,disabled:d,loading:i,iconLeft:(0,h.tZ)(iw.Z,{}),onClick:function(){return u()}})]}):o===R.Fp.NeedsSmsVerification?(0,h.tZ)(iu.Z,{context:R.jv.Deployments,onSuccess:s}):o===R.Fp.NeedsPaymentMethod?m?(0,h.tZ)(x.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,h.tZ)(T.Z,{}),css:iY.ctaStatusBanner}):(0,h.tZ)(I.zx,{colorway:"primary",text:"Add a payment method",css:iY.cta,disabled:d,loading:i,iconLeft:(0,h.tZ)(iw.Z,{}),onClick:function(){return u()}}):o===R.Fp.NeedsUnbanning?(0,h.tZ)(ib.u,{text:"Your account currently has restrictions on deploying. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,h.tZ)(T.Z,{}),css:iY.ctaStatusBanner,onClick:function(){return f()}}):o===R.Fp.InsufficientBudget?(0,h.BX)(h.HY,{children:[(0,h.tZ)(x.E,{text:"You've reached your monthly usage budget. Increase your budget to continue deploying.",colorway:"warning",icon:(0,h.tZ)(T.Z,{}),css:iY.ctaStatusBanner}),(0,h.tZ)(v.G,{css:iY.budgetContainer,children:(0,h.tZ)(ig.L,{onUpdateSuccess:s})})]}):(0,h.BX)(h.HY,{children:[(0,h.tZ)(I.zx,{colorway:"primary",onClick:c,text:"Set up your deployment",disabled:!l,loading:i,css:iY.cta}),!1===a?(0,h.tZ)(ib.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,h.tZ)(T.Z,{}),css:iY.ctaStatusBanner,onClick:function(){return m?null:u()}}):null]}):(0,h.tZ)(I.zx,{colorway:"primary",onClick:c,text:"Set up your deployment",disabled:!l,loading:i,css:iY.cta}):(0,h.tZ)(h.HY,{children:(0,h.tZ)(x.E,{text:r,colorway:"grey",css:iY.disabledBanner})})}function iK(){var e=(0,J._)(["\n  fragment ReplLogLine2 on ReplLog {\n    __typename\n    timestamp\n    line\n  }\n"]);return iK=function(){return e},e}function iQ(){var e=(0,J._)(["\n  query HostingDeploymentLogs2($replId: String!, $deploymentId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        __typename\n        hostingDeploymentLogs(deploymentId: $deploymentId) {\n          ... on ReplLogs {\n            result {\n              ...ReplLogLine2\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return iQ=function(){return e},e}function i0(){var e=(0,J._)(["\n  subscription HostingDeploymentLogUpdates(\n    $input: HostingDeploymentLogUpdatesInput!\n  ) {\n    hostingDeploymentLogUpdates(input: $input) {\n      ... on ReplLog {\n        line\n        timestamp\n      }\n    }\n  }\n"]);return i0=function(){return e},e}var i1={},i2=(0,K.Ps)(iK()),i8=(0,K.Ps)(iQ(),i2),i4=(0,K.Ps)(i0()),i3=n(47357),i5=(0,C.X)({root:[{overflow:"auto"},g.l0.coverContainer],rows:{width:"100%",position:"relative","& > div:nth-child(even)":[g.l0.backgroundColor.backgroundHigher]},timestamp:[g.l0.p(6),{color:g.TV.foregroundDimmer,cursor:"pointer"}],logContainer:[g.l0.pl(6),g.l0.py(6),g.l0.pr(4),g.l0.flex.growAndShrink(1),g.l0.position.relative,g.l0.minHeight(26),{cursor:"pointer"}],logTruncated:[g.l0.flex.growAndShrink(1),g.l0.truncate],row:[g.l0.flex.row,g.l0.align.start,g.l0.font.code,g.l0.fontSize(12),{position:"absolute",top:0,left:0,width:"100%"}],noLogsContainer:[g.l0.colWithGap(8),g.l0.pt(4)],noLogsText:[g.l0.textAlign.center]}),i6=function(e){var t=e.deploymentId,n=e.replId;return t?(0,h.tZ)(i7,{replId:n,deploymentId:t}):(0,h.tZ)(W,{children:(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:"Deployment not found"})})};function i9(e){var t=e.log,n=e.y,r=e.height,i=e.resizeRef,o=e.index,a=(0,f._)((0,m.useState)(!1),2),l=a[0],c=a[1],s=(0,m.useRef)({x:0,y:0});function u(e){var t=s.current;e.clientY===t.y&&e.clientX===t.x&&c(function(e){return!e})}function d(e){s.current={x:e.clientX,y:e.clientY}}return(0,h.BX)(v.G,{title:t.line,css:i5.row,style:{height:r,transform:"translateY(".concat(n,"px)")},children:[(0,h.BX)(v.G,{css:i5.timestamp,onClick:u,onMouseDown:d,children:[new Date(t.timestamp).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})," ",new Date(t.timestamp).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})]}),(0,h.tZ)(v.G,{css:i5.logContainer,onClick:u,onMouseDown:d,innerRef:i,"data-index":o,children:(0,h.tZ)(v.G,{css:!l&&i5.logTruncated,children:t.line})}),l?(0,h.tZ)(nu.qi,{value:t.line}):null]})}function i7(e){var t,n,r,i=e.deploymentId,o=(t={variables:{replId:e.replId,deploymentId:i}},n=(0,U._)({},i1,t),Q.a(i8,n)),a=o.data,l=o.loading,c=o.error,s=o.subscribeToMore;(0,m.useEffect)(function(){return s({document:i4,variables:{input:{deploymentId:i}},updateQuery:function(e,t){var n=t.subscriptionData;return(0,nv.ZP)(e,function(e){var t=(null==e?void 0:e.repl.__typename)==="Repl"?e.repl.hostingDeploymentLogs.result:null;t&&t.unshift(n.data.hostingDeploymentLogUpdates)})}})},[s,i]);var u=(0,m.useRef)(null),d=(null==a?void 0:a.repl.__typename)==="Repl"?a.repl.hostingDeploymentLogs.result:null,f=(0,i3.MG)({count:d?d.length:0,getScrollElement:function(){return u.current},estimateSize:function(){return 28},overscan:10});return(m.useEffect(function(){eQ({context:B.k.Logs})},[]),l)?(0,h.tZ)(ty,{loading:!0}):c?(0,h.tZ)(W,{children:(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:null!==(r=c.message)&&void 0!==r?r:"Something went wrong"})}):d&&(null==d?void 0:d.length)!==0?(0,h.tZ)(v.G,{innerRef:u,css:i5.root,children:(0,h.tZ)(v.G,{style:{height:f.getTotalSize()},css:i5.rows,children:f.getVirtualItems().map(function(e){var t=d[e.index];return t?(0,h.tZ)(i9,{log:t,height:e.size,y:e.start,resizeRef:f.measureElement,index:e.index},e.key):null})})}):(0,h.tZ)(W,{children:(0,h.tZ)(oe,{message:(null==d?void 0:d.length)===0?"No logs yet":"No logs are available because the most recent build failed before it was promoted."})})}var oe=function(e){var t=e.message;return(0,h.BX)(v.G,{css:i5.noLogsContainer,children:[(0,h.tZ)(V.xv,{css:i5.noLogsText,children:t}),(0,h.BX)(V.xv,{color:"dimmer",css:i5.noLogsText,children:["Having trouble?"," ",(0,h.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",onClick:function(){return eQ({context:"troubleshooting_doc"})},children:"Troubleshooting tips"})]})]})},ot=n(43910),on=n(13440);function or(){var e=(0,J._)(["\n  fragment HostingDeploymentDomainsDomain on HostingDeploymentDomain {\n    id\n    state\n    domain\n  }\n"]);return or=function(){return e},e}function oi(){var e=(0,J._)(["\n  fragment HostingDeploymentDomainsHostingDeployment on HostingDeployment {\n    id\n    currentBuild {\n      id\n      status\n    }\n    repl {\n      id\n      apexProxy\n    }\n    domains {\n      id\n      ...HostingDeploymentDomainsDomain\n    }\n    legacyReplDomains {\n      id\n      ...HostingDeploymentDomainsDomain\n    }\n  }\n  ","\n"]);return oi=function(){return e},e}function oo(){var e=(0,J._)(["\n  query HostingDeploymentDomains($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n      }\n    }\n  }\n  ","\n"]);return oo=function(){return e},e}function oa(){var e=(0,J._)(["\n  mutation LinkHostingDeploymentDomain(\n    $input: LinkHostingDeploymentDomainInput!\n  ) {\n    linkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        domains {\n          ...HostingDeploymentDomainsDomain\n        }\n      }\n    }\n  }\n  ","\n"]);return oa=function(){return e},e}var ol={},oc=(0,K.Ps)(or()),os=(0,K.Ps)(oi(),oc),ou=(0,K.Ps)(oo(),os),od=(0,K.Ps)(oa(),oc);function of(){var e=(0,J._)(["\n  query HostingDeploymentSettings($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n        currentBuild {\n          id\n          provider\n          machineConfiguration {\n            ...MachineConfiguration\n          }\n          envVars {\n            name\n            value\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return of=function(){return e},e}var oh={},op=(0,K.Ps)(of(),os,rM.bN),om=n(61314),ov=n.n(om),og=n(91608),oy=n(5344),ob=n(10041),oZ=(0,og.$)(["paddingRight"]),ow=oZ.cssVars,ox=oZ.styleTokens,oC=(0,C.X)({inputWrapper:[g.l0.position.relative,g.l0.flex.growAndShrink(1),{input:[{paddingRight:ox.paddingRight}]}],copyButton:[g.l0.position.absolute,g.l0.top("50%"),g.l0.right(4),{transform:"translateY(-50%)"}]});function o_(e){return(0,h.BX)(v.G,{css:oC.inputWrapper,style:(0,H._)({},ow.paddingRight,e.value?"36px":"8px"),children:[(0,h.tZ)(nZ.II,(0,L._)((0,U._)({},e),{onClick:function(e){return e.currentTarget.select()}})),e.value?(0,h.tZ)(eT.hU,{css:oC.copyButton,alt:"Copy",tooltipHidden:!0,onClick:function(){return e.value&&(0,ob.Z)(e.value)},children:(0,h.tZ)(oy.Z,{})}):null]})}var ok=(0,C.X)({root:[g.l0.flex.column,(u={gap:8},(0,H._)(u,g.nC.min("mobileMax"),[g.l0.flex.row,{"& > div:nth-of-type(1)":{width:"30%"},"& > div:nth-of-type(2)":{maxWidth:50}}]),(0,H._)(u,"label",[g.l0.color.foregroundDimmer,{fontSize:g.TV.fontSizeSmall}]),u)],col:[g.l0.colWithGap(4),g.l0.flex.growAndShrink(1)],records:[g.l0.px(12),g.l0.pt(8),g.l0.pb(16),g.l0.colWithGap(16),g.l0.borderRadius(12),(0,H._)({},g.nC.min("mobileMax"),g.l0.colWithGap(12))],divider:(0,H._)({display:"flex",height:1,backgroundColor:g.TV.outlineDimmest},g.nC.min("mobileMax"),g.l0.display.none)});function oS(e){return(0,h.BX)(v.G,{css:ok.root,children:[(0,h.BX)(v.G,{css:ok.col,children:[(0,h.tZ)(v.G,{tag:"label",children:"Hostname"}),(0,h.tZ)(nZ.II,{value:e.hostname,readOnly:!0})]}),(0,h.BX)(v.G,{css:ok.col,children:[(0,h.tZ)(v.G,{tag:"label",children:"Type"}),(0,h.tZ)(nZ.II,{value:e.type,readOnly:!0})]}),(0,h.BX)(v.G,{css:ok.col,children:[(0,h.tZ)(v.G,{tag:"label",children:"Record"}),(0,h.tZ)(o_,{value:e.record,readOnly:!0})]})]})}function oE(e){var t="replit-verify=".concat(e.deploymentId);return(0,h.BX)(G.Tg,{background:"default",css:ok.records,children:[(0,h.tZ)(oS,{hostname:e.hostname,type:"A",record:e.apexProxy}),(0,h.tZ)(v.G,{css:ok.divider}),(0,h.tZ)(oS,{hostname:e.hostname,type:"TXT",record:t})]})}var oT="https://docs.replit.com/hosting/deployments/custom-domains",oR=n(8017),oI=n(22699),oD=(0,C.X)({root:[g.l0.colWithGap(16),g.l0.p(8),g.l0.borderRadius(8),g.l0.border({color:g.TV.outlineDimmer})],labelRow:[g.l0.rowWithGap(8),g.l0.align.center],labelText:[g.l0.flex.growAndShrink(1)],controls:[g.l0.rowWithGap(8),g.l0.justify.spaceBetween,{"& > button":[g.l0.flex.growAndShrink(1)]}],domainSection:[g.l0.colWithGap(8)],error:[g.l0.rowWithGap(4),g.l0.align.center],recordsSection:[g.l0.colWithGap(8)],valueRow:[g.l0.borderRadius(8),g.l0.pl(8),g.l0.pr(4),g.l0.height(32),g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.spaceBetween,{a:g.l0.hover(g.l0.color.accentPrimaryStrongest)}]});function oG(e){var t,n=(0,f._)((0,m.useState)(!0),2),r=n[0],i=n[1],o=(0,f._)((0,m.useState)(""),2),a=o[0],l=o[1],c=(0,f._)((0,m.useState)(!1),2),s=c[0],u=c[1],d=(0,f._)((t=(0,U._)({},ol,{onCompleted:function(){e.onAdd()}}),on.D(od,t)),2),p=d[0],y=d[1].loading,b=(0,m.useRef)(null),Z=(0,m.useId)(),w=ov()(a,{require_valid_protocol:!1})&&a.split(".").length>=2,x=!w||y,C=w?null:"Enter a valid domain",_=y?(0,h.tZ)(tv.Z,{}):(0,h.tZ)(rV.Z,{});return r||y||(_=(0,h.tZ)(oR.Z,{})),(0,h.BX)(v.G,{tag:"form",css:oD.root,onSubmit:function(t){if(t.preventDefault(),r){var n;i(!1),null===(n=b.current)||void 0===n||n.focus();return}p({variables:{input:{hostingDeploymentId:e.deploymentId,domain:a}}})},children:[(0,h.BX)(v.G,{css:oD.domainSection,children:[(0,h.BX)(v.G,{tag:"label",htmlFor:Z,css:oD.labelRow,children:[w&&!r?(0,h.tZ)(tY.Z,{color:g.TV.accentPositiveDefault}):null,(0,h.tZ)(V.xv,{color:"dimmer",children:"First, enter your domain"})]}),r?(0,h.tZ)(nZ.II,{id:Z,autoFocus:!0,placeholder:"example.com",value:a,disabled:y,onChange:function(e){return l(e.currentTarget.value)},onBlur:function(e){return u(!!e.currentTarget.value)}}):(0,h.BX)(G.Tg,{elevated:!0,css:oD.valueRow,children:[(0,h.tZ)(v.G,{href:"https://"+a,tag:"a",target:"_blank",children:a}),(0,h.tZ)(eT.hU,{alt:"Edit",onClick:function(){return i(!0)},children:(0,h.tZ)(tX.Z,{color:g.TV.foregroundDimmer})})]}),C&&s?(0,h.BX)(v.G,{css:oD.error,children:[(0,h.tZ)(T.Z,{size:12,color:g.TV.orangeDefault}),(0,h.tZ)(V.xv,{variant:"small",children:C})]}):null]}),!r&&w?(0,h.tZ)(oB,{apexProxy:e.apexProxy,domain:a,deploymentId:e.deploymentId}):null,(0,h.BX)(v.G,{css:oD.controls,children:[(0,h.tZ)(I.zx,{type:"button",text:"Cancel",onClick:e.onCancel}),(0,h.tZ)(I.zx,{ref:b,iconRight:_,colorway:"primary",type:"submit",disabled:x,text:r?"Next":"Link domain"})]})]})}function oB(e){return(0,h.BX)(v.G,{css:oD.recordsSection,children:[(0,h.BX)(v.G,{css:oD.labelRow,children:[(0,h.tZ)(oI.Z,{color:g.TV.foregroundDimmest}),(0,h.BX)(V.xv,{multiline:!0,css:oD.labelText,children:["Next, add the following records your domain's DNS settings."," ",(0,h.tZ)("a",{target:"_blank",href:oT,children:"Learn more"})]})]}),(0,h.tZ)(oE,{apexProxy:e.apexProxy,hostname:e.domain,deploymentId:e.deploymentId})]})}function oP(){var e=(0,J._)(["\n  mutation HostingDeploymentsUnlinkDomain(\n    $input: UnlinkHostingDeploymentDomainInput!\n  ) {\n    unlinkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        domains {\n          id\n        }\n      }\n    }\n  }\n"]);return oP=function(){return e},e}function oA(){var e=(0,J._)(["\n  mutation HostingDeploymentsVerifyDomain(\n    $input: VerifyHostingDeploymentDomainInput!\n  ) {\n    verifyHostingDeploymentDomain(input: $input) {\n      ... on HostingDeploymentDomain {\n        id\n        state\n      }\n    }\n  }\n"]);return oA=function(){return e},e}var oN={},oU=(0,K.Ps)(oP()),oL=(0,K.Ps)(oA()),oO=n(73722),oX=(0,C.X)({root:[g.l0.colWithGap(8),g.l0.borderRadius(8),g.l0.pl(8),g.l0.pr(4),g.l0.height(32),g.l0.justify.center]}),oM=(0,C.X)({root:oX.root,rootExpanded:[oX.root,g.l0.height("auto"),g.l0.pt(4),g.l0.pb(12),g.l0.justify.start],domainRow:[g.l0.reset.button,g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.spaceBetween],iconButtons:[g.l0.flex.row],expanded:[g.l0.colWithGap(12),g.l0.pl(4),g.l0.pr(8)],domainWrapper:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.flex.shrink(1),g.l0.color.accentPrimaryStronger,{a:g.l0.hover(g.l0.color.accentPrimaryStrongest)}],statusDot:[g.l0.borderRadius("full"),g.l0.width(6),g.l0.height(6)],status:[g.l0.rowWithGap(4),g.l0.align.center],dnsRecords:[g.l0.colWithGap(6)],buttons:[g.l0.flex.column,g.l0.justify.spaceBetween,(d={gap:8},(0,H._)(d,g.nC.min("mobileMax"),g.l0.flex.row),(0,H._)(d,"button",[g.l0.flex.growAndShrink(1)]),d)],warning:[g.l0.rowWithGap(6),g.l0.align.center]}),oF={verified:{color:g.TV.accentPositiveDefault,text:"Verified"},verifying:{color:g.TV.orangeDefault,text:"Verifying"},failed:{color:g.TV.accentNegativeDefault,text:"Failed"}};function oW(e){var t,n,r,i=e.domain,o=e.deploymentId,a=e.apexProxy,l=(0,f._)((0,m.useState)(!1),2),c=l[0],s=l[1],u=(0,f._)((0,m.useState)(!1),2),d=u[0],p=u[1],y=(0,f._)((t=(0,U._)({},ol,{variables:{id:o},fetchPolicy:"network-only",ssr:!1}),ot.t(ou,t)),2),b=y[0],Z=y[1].loading,w=(0,f._)((n=(0,U._)({},oN,void 0),on.D(oU,n)),2),x=w[0],C=w[1].loading,_=(0,f._)((r=(0,U._)({},oN,void 0),on.D(oL,r)),2),k=_[0],S=_[1].loading,E=i.state===R.zt.Failed,D=(0,f._)((0,m.useState)(!1),2),B=D[0],P=D[1];return(0,h.BX)(G.Tg,{elevated:!0,css:c?oM.rootExpanded:oM.root,children:[(0,h.BX)(v.G,{css:oM.domainRow,style:{borderBottomLeftRadius:c?0:void 0,borderBottomRightRadius:c?0:void 0},children:[(0,h.BX)(v.G,{css:oM.domainWrapper,children:[(0,h.tZ)(V.xv,{multiline:!1,children:(0,h.tZ)("a",{target:"_blank",href:"https://"+i.domain,children:i.domain})}),(0,h.BX)(v.G,{css:oM.status,children:[(0,h.tZ)(v.G,{css:oM.statusDot,style:{backgroundColor:oF[i.state].color}}),(0,h.tZ)(V.xv,{color:"dimmer",variant:"small",children:oF[i.state].text})]})]}),(0,h.BX)(v.G,{css:oM.iconButtons,children:[(0,h.tZ)(eT.hU,{alt:B?"Copied":"Copy link",onClick:function(){(0,ob.Z)(i.domain),P(!0),setTimeout(function(){return P(!1)},1e3)},children:B?(0,h.tZ)(tY.Z,{color:g.TV.accentPositiveStronger}):(0,h.tZ)(oy.Z,{color:g.TV.foregroundDimmer})}),(0,h.tZ)(eT.hU,{alt:"Edit",tooltipHidden:!0,onClick:function(){p(!1),s(function(e){return!e})},css:g.l0.color.foregroundDimmer,children:c?(0,h.tZ)(t2.Z,{}):(0,h.tZ)(tX.Z,{})})]})]}),c?(0,h.tZ)(v.G,{css:oM.expanded,children:d?(0,h.BX)(h.HY,{children:[(0,h.tZ)(V.xv,{children:"Are you sure you want to unlink this domain?"}),(0,h.BX)(v.G,{css:oM.buttons,children:[(0,h.tZ)(I.zx,{size:"small",variant:"outlined",text:"Cancel",onClick:function(){p(!1)}}),(0,h.tZ)(I.zx,{size:"small",disabled:C,text:"Yes, unlink "+i.domain,colorway:"negative",onClick:function(){x({variables:{input:{hostingDeploymentDomainId:i.id}}})}})]})]}):(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:oM.dnsRecords,children:[E?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:oM.warning,children:[(0,h.tZ)(T.Z,{}),(0,h.tZ)(V.xv,{children:"DNS Error"})]}),(0,h.BX)(V.xv,{children:["Failed to link domain. Make sure your domain's DNS settings have these records."," ",(0,h.tZ)("a",{target:"_blank",href:oT,children:"Learn more"})]})]}):(0,h.BX)(V.xv,{color:"dimmer",children:["Add these records to your domain's"," ",(0,h.tZ)("strong",{css:g.l0.color.foregroundDefault,children:"DNS settings"}),". This take up to 48 hours to fully apply."," ",(0,h.tZ)("a",{target:"_blank",href:oT,children:"Learn more"})]}),(0,h.tZ)(oE,{hostname:i.domain,apexProxy:a,deploymentId:o})]}),(0,h.BX)(v.G,{css:oM.buttons,children:[(0,h.tZ)(I.zx,{iconLeft:Z||S?(0,h.tZ)(tv.Z,{}):(0,h.tZ)(oO.Z,{}),size:"small",text:E?"Retry linking":"Check status",onClick:function(){E?k({variables:{input:{hostingDeploymentDomainId:i.id}}}):b()}}),(0,h.tZ)(I.zx,{iconLeft:(0,h.tZ)(r0.Z,{}),size:"small",disabled:C,text:E?"Remove domain":"Unlink domain",colorway:"negative",onClick:function(){p(!0)}})]})]})}):null]})}function oH(){var e=(0,J._)(["\n  mutation HostingDeploymentsUnlinkLegacyReplDomain(\n    $input: UnlinkLegacyReplDomainInput!\n  ) {\n    unlinkLegacyReplDomain(input: $input) {\n      ... on Repl {\n        id\n        hostingDeployment {\n          ... on HostingDeployment {\n            id\n            legacyReplDomains {\n              id\n              ...HostingDeploymentDomainsDomain\n            }\n            domains {\n              id\n              ...HostingDeploymentDomainsDomain\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return oH=function(){return e},e}var oV={},oz=(0,K.Ps)(oH(),oc),oj=(0,C.X)({root:[g.l0.py(12),g.l0.flex.column,(0,H._)({gap:6},g.nC.min("mobileMax"),[g.l0.py(4),g.l0.flex.row,g.l0.align.center,{gap:2,button:{border:"none"}}])],domainLink:[g.l0.flex.growAndShrink(1),g.l0.flex.row,g.l0.fontWeight.medium,{a:[g.l0.truncate,g.l0.flex.shrink(1)]}],confirm:[g.l0.p(8),g.l0.borderRadius(8),g.l0.colWithGap(8),g.l0.justify.spaceBetween],confirmButtons:[g.l0.rowWithGap(8),{button:[g.l0.flex.growAndShrink(1)]}],unlinkButton:[g.l0.color.foregroundDimmer,g.l0.hover(g.l0.backgroundColor.backgroundHighest)]}),oq=function(e){var t=e.domain;return(0,h.tZ)("a",{target:"_bank",href:"https://"+t,children:t})};function oY(e){var t,n=e.deploymentId,r=e.domain,i=e.apexProxy,o=(0,f._)((t=(0,U._)({},oV,void 0),on.D(oz,t)),2),a=o[0],l=o[1].loading,c=(0,f._)((0,m.useState)(!1),2),s=c[0],u=c[1],d=(0,f._)((0,m.useState)(!1),2),p=d[0],g=d[1];return s?(0,h.BX)(G.Tg,{elevated:!0,css:oj.confirm,children:[(0,h.BX)(V.xv,{children:["Are you sure you want to remove ",(0,h.tZ)(oq,{domain:r.domain}),"?"]}),(0,h.BX)(v.G,{css:oj.confirmButtons,children:[(0,h.tZ)(I.zx,{text:"Cancel",onClick:function(){return u(!1)},size:"small"}),(0,h.tZ)(I.zx,{size:"small",disabled:l,colorway:"negative",iconLeft:l?(0,h.tZ)(tv.Z,{}):(0,h.tZ)(r0.Z,{}),text:"Unlink domain",onClick:function(){return a({variables:{input:{replDomainId:r.id}}})}})]})]}):p?(0,h.BX)(G.Tg,{elevated:!0,css:oj.confirm,children:[(0,h.BX)(v.G,{children:[(0,h.tZ)(V.xv,{variant:"small",color:"dimmer",children:"Transfering"}),(0,h.tZ)(v.G,{css:oj.domainLink,children:(0,h.tZ)(oq,{domain:r.domain})})]}),(0,h.tZ)(oB,{deploymentId:n,domain:r.domain,apexProxy:i}),(0,h.BX)(v.G,{css:oj.confirmButtons,children:[(0,h.tZ)(I.zx,{text:"Cancel",onClick:function(){return g(!1)},size:"small"}),(0,h.tZ)(I.zx,{size:"small",disabled:l,colorway:"primary",iconLeft:l?(0,h.tZ)(tv.Z,{}):(0,h.tZ)(oR.Z,{}),text:"Complete transfer",onClick:function(){return a({variables:{input:{replDomainId:r.id,transferToHostingDeploymentId:n}}})}})]})]}):(0,h.BX)(v.G,{css:oj.root,children:[(0,h.tZ)(v.G,{css:oj.domainLink,children:(0,h.tZ)(oq,{domain:r.domain})}),(0,h.tZ)(I.zx,{size:"small",variant:"outlined",text:"Unlink",onClick:function(){return u(!0)},iconLeft:(0,h.tZ)(r0.Z,{}),css:oj.unlinkButton}),(0,h.tZ)(I.zx,{size:"small",variant:"outlined",disabled:l,iconRight:(0,h.tZ)(rV.Z,{}),colorway:"primary",text:"Transfer to deployment",onClick:function(){return g(!0)}})]})}var o$=(0,C.X)({root:[g.l0.colWithGap(4),g.l0.p(12),g.l0.pb(6),g.l0.borderRadius(12),g.l0.backgroundColor.backgroundHigher,g.l0.border({color:g.TV.outlineDimmer})],header:[g.l0.align.center,g.l0.rowWithGap(8)],list:[{"& > div:not(:first-of-type)":g.l0.border({color:g.TV.outlineDimmer,direction:"top"})}]});function oJ(e){var t=e.domains,n=e.deploymentId,r=e.apexProxy,i=1===t.length?"domain":"domains";return(0,h.BX)(G.Tg,{css:o$.root,children:[(0,h.BX)(v.G,{css:g.l0.colWithGap(4),children:[(0,h.BX)(v.G,{css:o$.header,children:[(0,h.tZ)(T.Z,{color:g.TV.yellowStronger}),(0,h.BX)(V.xv,{variant:"subheadDefault",children:["Transfer ",i]})]}),(0,h.BX)(V.xv,{color:"dimmer",children:["You have attached ",t.length," custom ",i," to your development Repl. Please transfer ","domain"===i?"it":"them"," to your deployment for the best user experience."]})]}),(0,h.tZ)(v.G,{css:o$.list,children:t.map(function(e){return(0,h.tZ)(oY,{domain:e,deploymentId:n,apexProxy:r},e.id)})})]})}var oK=(0,C.X)({root:[g.l0.colWithGap(8)],error:[g.l0.center,g.l0.rowWithGap(8)],loading:[g.l0.center],empty:[g.l0.px(16),g.l0.py(32),g.l0.borderRadius(8),g.l0.center,g.l0.colWithGap(8),{border:"1px dashed",borderColor:g.TV.outlineDimmer}],primaryDomain:[g.l0.rowWithGap(4),g.l0.height(32),g.l0.justify.spaceBetween,g.l0.align.center,g.l0.pl(8),g.l0.pr(4),g.l0.borderRadius(8)],primaryDomainLink:[g.l0.flex.shrink(1),g.l0.color.accentPrimaryStronger,{a:g.l0.hover(g.l0.color.accentPrimaryStrongest)}],icons:[g.l0.flex.row,g.l0.align.center],footer:[g.l0.flex.row]});function oQ(e){var t,n,r,i,o=e.deployment,a=(0,f._)((0,m.useState)(!1),2),l=a[0],c=a[1],s=(0,f._)((0,m.useState)(void 0),2),u=s[0],d=s[1];t={variables:{id:o.id},fetchPolicy:"cache-and-network",ssr:!1,pollInterval:u,onCompleted:function(e){var t,n;d((null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"&&(null===(n=e.hostingDeployment.domains)||void 0===n?void 0:n.some(function(e){return e.state===n0.zt.Verifying}))?3e4:void 0)}},n=(0,U._)({},ol,t),Q.a(ou,n);var p=(null==o?void 0:null===(r=o.domains)||void 0===r?void 0:r.length)?o.domains:null,y=(null==o?void 0:o.currentBuild.status)===R.Fe.Success,b=null==o?void 0:o.repl.apexProxy,w=(0,Z.$y)(),C=function(){var e,t,n,r,i,o=(null==w?void 0:null===(e=w.repl.hostingDeployment)||void 0===e?void 0:e.__typename)==="HostingDeployment"?null===(t=w.repl.hostingDeployment)||void 0===t?void 0:t.replitAppSubdomain:void 0;if(!o&&(null==w?void 0:null===(n=w.repl.owner)||void 0===n?void 0:n.username)&&(o="".concat(w.repl.slug,"-").concat(w.repl.owner.username)),o)return"https://".concat(o).concat((null===(i=window)||void 0===i?void 0:null===(r=i.location)||void 0===r?void 0:r.hostname)!=="replit.com"?".staging":"",".replit.app")}(),_=(0,f._)((0,m.useState)(!1),2),k=_[0],S=_[1];return(0,h.BX)(v.G,{css:oK.root,children:[!l&&(null==o?void 0:null===(i=o.legacyReplDomains)||void 0===i?void 0:i.length)&&b?(0,h.tZ)(oJ,{domains:o.legacyReplDomains,deploymentId:o.id,apexProxy:b}):null,(0,h.BX)(G.Tg,{elevated:!0,css:oK.primaryDomain,children:[(0,h.tZ)(V.xv,{multiline:!1,css:oK.primaryDomainLink,children:(0,h.tZ)("a",{href:C,target:"_blank",rel:"noreferrer noopener",children:C})}),(0,h.BX)(v.G,{css:oK.icons,children:[(0,h.tZ)(eT.hU,{alt:k?"Copied":"Copy link",onClick:function(){C&&((0,ob.Z)(C),S(!0),setTimeout(function(){return S(!1)},1e3))},children:k?(0,h.tZ)(tY.Z,{color:g.TV.accentPositiveStronger}):(0,h.tZ)(oy.Z,{color:g.TV.foregroundDimmer})}),(0,h.tZ)(nk.u,{tooltip:o0,children:(0,h.tZ)(tr.Z,{"aria-label":o0,color:g.TV.foregroundDimmer,css:g.l0.m(4)})})]})]}),p&&o?(0,h.tZ)(v.G,{css:g.l0.colWithGap(8),children:p.map(function(e){return(0,h.tZ)(v.G,{children:(0,h.tZ)(oW,{apexProxy:o.repl.apexProxy,deploymentId:o.id,domain:e})},e.domain)})}):null,l&&b?(0,h.tZ)(oG,{apexProxy:b,deploymentId:o.id,onAdd:function(){return c(!1)},onCancel:function(){return c(!1)}}):null,y?null:(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:"You must successfully deploy your project before linking a domain"}),!1===l?(0,h.tZ)(v.G,{css:oK.footer,children:(0,h.tZ)(I.zx,{disabled:!y,iconLeft:(0,h.tZ)(nc.Z,{}),text:"Link a domain",onClick:function(){return c(!0)},variant:"outlined",size:"small"})}):null]})}var o0="Your primary domain cannot be changed";function o1(){var e=(0,J._)(["\n  query AutoscaleUsageSectionCurrentUser {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          startDate\n          endDate\n          resources {\n            autoscaleComputeUnits {\n              usage\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return o1=function(){return e},e}var o2={},o8=(0,K.Ps)(o1()),o4=(0,C.X)({root:[g.l0.colWithGap(4),g.l0.p(8),g.l0.pt(12),g.l0.borderRadius(8),{outline:"1px solid transparent"}],outerRow:[g.l0.rowWithGap(12),g.l0.align.center],typeCol:[g.l0.colWithGap(4),g.l0.flex.growAndShrink(1)],configAndUsageRow:[g.l0.rowWithGap(12),g.l0.align.center,g.l0.flex.growAndShrink(1)],usageRow:[g.l0.rowWithGap(8)]}),o3=function(e){var t,n=e.machineConfiguration,r=(t=(0,U._)({},o2,void 0),Q.a(o8,t)).data,i=m.useMemo(function(){return function(e){var t,n,r=e.data;if((null==r?void 0:null===(t=r.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"){var i=null==r?void 0:null===(n=r.currentUser)||void 0===n?void 0:n.usageInterval;if(i&&"UsageInterval"===i.__typename){var o=i.resources.autoscaleComputeUnits.usage,a=(0,ih.fZ)(o,{resourceUsageType:"ComputeUnits"}),l=new Date(i.endDate).toLocaleString("default",{month:"short",day:"numeric"});return{description:"".concat(a," used this billing period"),renewalInfo:"Renews ".concat(l," ")}}}}({data:r})},[r]),o=m.useMemo(function(){if(null!=n)return"Autoscale (".concat(n.label,")")},[n]);return o&&i?(0,h.BX)(G.Tg,{elevated:!0,css:o4.root,children:[(0,h.BX)(v.G,{css:o4.outerRow,children:[(0,h.tZ)(v.G,{css:o4.typeCol,children:o?(0,h.tZ)(V.xv,{multiline:!1,children:o}):null}),(0,h.tZ)(eT.hU,{alt:"Edit",onClick:e.onEditAutoscaleMachineConfiguration,children:(0,h.tZ)(tX.Z,{})})]}),i?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:o4.outerRow,children:[(0,h.tZ)(V.xv,{multiline:!1,children:i.description}),(0,h.tZ)(V.xv,{color:"dimmer",multiline:!1,children:i.renewalInfo})]}),(0,h.tZ)(v.G,{css:o4.outerRow,children:(0,h.tZ)(te(),{legacyBehavior:!0,passHref:!0,href:"/account#resource-usage",prefetch:!1,children:(0,h.tZ)("a",{role:"button",children:"View account resource limits"})})})]}):null]}):(0,h.tZ)(v.G,{css:[g.l0.justify.center,g.l0.flex.row],children:(0,h.tZ)(tv.Z,{})})},o5=(0,C.X)({sectionContainer:[g.l0.colWithGap(8)]});function o6(e){var t=e.shouldShowDownloadQR,n=(0,f._)((0,m.useState)(t),2),r=n[0],i=n[1];return(0,h.tZ)(v.G,{children:(0,h.BX)(v.G,{css:o5.sectionContainer,children:[(0,h.tZ)(I.zx,{iconLeft:(0,h.tZ)(nF.Z,{}),text:"Install the Replit App",onClick:function(){return i(function(e){var t=!e;return t&&(0,eK.j)(eK.U3.DEPLOYMENT_MOBILE_DOWNLOAD_QR_VIEWED),t})}}),r?(0,h.tZ)(nM,{color:g.TV.foregroundDefault}):null]})})}var o9=function(e){var t=e.deploymentId,n=e.onLifecycleCommand,r=e.onError;return t?(0,h.tZ)(o7,{deploymentId:t,onLifecycleCommand:n,onError:r}):(0,h.tZ)(W,{children:(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:"Deployment not found"})})};function o7(e){var t,n,r,i,o,a,l,c,s,u,d=(0,r6.rv)(),p=(0,f._)((0,m.useState)(!1),2),y=p[0],b=p[1];m.useEffect(function(){eQ({context:B.k.Settings})},[]);var Z=(a=(r={variables:{id:({deploymentId:e.deploymentId}).deploymentId},ssr:!1,fetchPolicy:"cache-and-network"},i=(0,U._)({},oh,r),o=Q.a(op,i)).data,l=o.loading,c=o.error,s=(null==a?void 0:null===(t=a.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?a.hostingDeployment:null,(null==a?void 0:null===(n=a.hostingDeployment)||void 0===n?void 0:n.__typename)==="NotFoundError"?{data:null,error:"Deployment not found",loading:!1}:!s&&l?{deployment:null,erorr:null,loading:!0}:c||!s?{deployment:null,error:"Something went wrong",loading:!1}:{deployment:s,error:null,loading:!1});if(y)return(0,h.tZ)(rj,{onError:e.onError,onConfirm:function(t){e.onLifecycleCommand({command:R.Qc.UpdateMachineConfiguration,machineConfigurationId:t.configurationId,maxMachineInstances:t.maxInstances})},onBack:function(){return b(!1)}});if(Z.loading)return(0,h.tZ)(W,{children:(0,h.tZ)(ty,{loading:!0})});if(Z.error)return(0,h.tZ)(tZ,{text:Z.error});var w=Z.deployment,x=w.currentBuild,C=null!==(u=null==x?void 0:x.machineConfiguration)&&void 0!==u?u:void 0;return(0,h.tZ)(W,{children:(0,h.BX)(v.G,{css:[g.l0.colWithGap(32),X.Qw.maxWidth],children:[x.provider===R.r4.CloudRun?(0,h.BX)(v.G,{children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",css:[g.l0.pb(8)],children:"Resource usage"}),(0,h.tZ)(v.G,{css:[g.l0.colWithGap(16)],children:(0,h.tZ)(o3,{machineConfiguration:C,onEditAutoscaleMachineConfiguration:function(){return b(!0)}})})]}):null,(0,h.BX)(v.G,{children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",css:[g.l0.pb(8)],children:"Domains"}),(0,h.tZ)(oQ,{deployment:w})]}),(0,h.BX)(v.G,{children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",css:[g.l0.pb(12)],children:"Manage deployment"}),(0,h.tZ)(r2,{onLifecycleCommand:e.onLifecycleCommand})]}),d?null:(0,h.BX)(v.G,{children:[(0,h.tZ)(V.xv,{variant:"subheadDefault",css:[g.l0.pb(12)],children:"Deploy on the go"}),(0,h.tZ)(o6,{shouldShowDownloadQR:!1})]})]})})}var ae=(0,C.X)({root:[{height:"100%"},g.l0.overflow("hidden"),g.l0.position.relative],content:[g.l0.overflow("auto"),g.l0.flex.growAndShrink(1),g.l0.position.relative,g.l0.pb(16)]}),at=function(e){var t,n,r,i=e.onViewUpdate,o=e.onError,a=e.refetch,l=e.openFile,c=e.initialView,s=e.error,u=function(e){L({type:B.a.SendDeploymentLifecycleCommand,payload:e})},d=(0,w.Z)(),p=(0,Z.hn)(),g=(0,Z.pn)(),C=(0,Z.$y)(),I="string"==typeof p,D=!(void 0!==g)&&!I,G=(0,f._)(m.useState(function(){return g?B.k.DeploymentInProgress:D?B.k.Intro:B.k.Deployment}),2),P=G[0],A=G[1],U=(0,Z.mF)(),L=(t=(0,y._)(function(e){return(0,b.Jh)(this,function(t){switch(t.label){case 0:switch(i(),e.type){case B.a.SendDeploymentLifecycleCommand:return[3,1];case B.a.ChangeView:return[3,3]}return[3,4];case 1:return[4,U(e.payload)];case 2:if(t.sent(),e.payload.command===R.Qc.Destroy)return A(B.k.Intro),a(),[2];return e.payload.command===R.Qc.UpdateMachineConfiguration&&a(),A(B.k.Deployment),[3,5];case 3:return A(e.payload.view),[3,5];case 4:return[3,5];case 5:return[2]}})}),function(e){return t.apply(this,arguments)});if(P===B.k.Intro)return(0,h.tZ)(i$,{initialSelectedProvider:c===B.k.ReservedVMTierSelection?R.r4.Gce:void 0,onLifecycleCommand:u,onError:o,onDeploy:function(){L({type:B.a.ChangeView,payload:{view:B.k.DeploymentInProgress}})},replId:d});var O=C?(n=C.provider,r=[{view:B.k.Deployment,label:"Overview",icon:(0,h.tZ)(k.Z,{})},{view:B.k.Analytics,label:"Analytics",icon:(0,h.tZ)(_.Z,{})},{view:B.k.Settings,label:"Settings",icon:(0,h.tZ)(E.Z,{})}],n!==R.r4.Static&&r.splice(1,0,{view:B.k.Logs,label:"Logs",icon:(0,h.tZ)(S.Z,{})}),r):null;return(0,h.BX)(v.G,{css:ae.root,children:[O?(0,h.tZ)(N,{onClick:function(e){L({type:B.a.ChangeView,payload:{view:e.view}})},tabs:O,activeView:P===B.k.DeploymentInProgress?B.k.Deployment:P}):null,(0,h.BX)(v.G,{css:ae.content,children:[s?(0,h.tZ)(W,{children:(0,h.tZ)(x.E,{colorway:"warning",icon:(0,h.tZ)(T.Z,{}),text:s})}):null,P===B.k.Analytics?(0,h.tZ)(e3,{replId:d}):null,P===B.k.Logs?(0,h.tZ)(i6,{replId:d,deploymentId:p}):null,P===B.k.Settings?(0,h.tZ)(o9,{onError:o,deploymentId:p,onLifecycleCommand:u}):null,P===B.k.Deployment||P===B.k.DeploymentInProgress?(0,h.tZ)(is,{view:P,refetch:a,onViewAction:L,onError:o,openFile:l,onLifecycleCommand:u}):null]})]})};function an(e){var t=e.initialView,n=e.onViewUpdate,r=e.openFile,i=e.tabsNavRef,o=(0,Z.m8)(),a=(0,Z.kW)(),l=(0,Z.ev)(),c=(0,f._)(m.useState(null),2),s=c[0],u=c[1];return a===e6.z.Loading?(0,h.tZ)(v.G,{css:[g.l0.center,g.l0.my(32)],children:(0,h.tZ)(tv.Z,{size:16})}):(0,h.tZ)(at,{tabsNavRef:i,initialView:t,onViewUpdate:function(){s&&u(null),n()},onError:u,refetch:o,openFile:r,error:s||l})}var ar=n(76568),ai=n(92809),ao=n(36617),aa=ai.Type.Object({type:ai.Type.Literal("deployments"),data:ai.Type.Optional(ai.Type.Object({view:ai.Type.Enum(B.k)}))}),al={Content:function(e){var t=e.pane.data,n=e.options.performPaneOperation,r=(0,m.useRef)(function(e){if(e&&"object"==typeof e&&"view"in e&&e.view===B.k.ReservedVMTierSelection)return B.k.ReservedVMTierSelection}(t)),i=(0,m.useCallback)(function(e){return n({operation:"open",secondary:!0,pane:{type:(0,p.Dp)(e),data:e}})},[n]),o=(0,f._)((0,m.useState)(null),2),a=o[0],l=o[1];return(0,ar.L5)(function(){if(a)return{type:"deployments",getTabs:a.getTabs,setTab:a.setTab}},[a]),(0,h.tZ)(an,{tabsNavRef:l,initialView:r.current,onViewUpdate:function(){r.current&&(r.current=void 0,n({operation:"replace",pane:{type:"deployments"}}))},openFile:i})},Icon:function(e){var t=e.size;return(0,h.tZ)(k.Z,{size:t})},getTitle:function(){return"Deployments"},decode:function(e){return ao.B4.Decode(aa,e)}}},22111:function(e,t,n){n.d(t,{J:function(){return c}});var r=n(92809),i=n(36617),o=n(73524),a=r.Type.Union(Object.values(o.TT).map(function(e){return r.Type.Literal(e)})),l=r.Type.Object({type:r.Type.Literal("docs"),data:r.Type.Optional(r.Type.Object({url:r.Type.Optional(r.Type.Union([a,r.Type.Null()]))}))}),c=function(e){return i.B4.Decode(l,e)}},15001:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(92809),i=n(36617),o=r.Type.Object({type:r.Type.Literal("preferences")}),a=function(e){return i.B4.Decode(o,e)}},11052:function(e,t,n){n.d(t,{G:function(){return w},s:function(){return y}});var r=n(8182),i=n(92809),o=n(36617),a=n(47030),l=n(52682),c=n(54916),s=n(74652),u=n(76568),d=n(43429),f=n(59716),h=n(56596),p=n(74833),m=n(93918),v=n(29287),g=i.Type.Object({type:i.Type.Literal("runnerOutput")}),y={id:"outputs.clear",name:"Clear console history",default:void 0};function b(e){var t=e.runner,n=e.options,i=(0,c.Z)(),o=i.fs,a=i.toolchain,h=i.ports,p=(0,d.useMemo)(function(){return[{type:"action",label:"Clear history",icon:(0,r.tZ)(l.Z,{}),run:function(){return t.clearBlockHistory()}}]},[t]);return(0,u.L5)(function(){return{actions:p,type:"runnerOutput",startBlock:t.startBlock,endBlock:t.endBlock,writeOutputToBlock:t.writeOutputToBlock,writeErrorToBlock:t.writeErrorToBlock}},[t,p]),(0,s.Il)(function(){return[y.id,t.clearBlockHistory]},[t]),(0,r.tZ)(f.y,{runner:t,toolchain:a,ports:h,listFiles:o.listFiles,isActive:n.isActive,performPaneOperation:n.performPaneOperation})}var Z=(0,m.X)({unavailable:[v.l0.p(8)]}),w={Content:function(e){var t=e.options,n=(0,c.Z)().runner;return"outputs"!==n.mode?(0,r.tZ)(h.G,{css:Z.unavailable,children:(0,r.tZ)(p.xv,{children:"Console is not available."})}):(0,r.tZ)(b,{options:t,runner:n})},Icon:function(e){var t=e.size;return(0,r.tZ)(a.Z,{size:t})},getTitle:function(){return"Console"},decode:function(e){return o.B4.Decode(g,e)}}},19403:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(8182);n(43429);var i=n(56596),o=n(20573),a=n(63461),l={Content:function(){return(0,r.tZ)(i.G,{style:{padding:32},children:(0,r.tZ)(a.Z,{children:"Sorry, this feature is not supported."})})},Icon:function(){return(0,r.tZ)(o.Z,{})},getTitle:function(){return"Unsupported"},decode:function(){return{type:"commands",data:{autoFocus:!1}}}}},62393:function(e,t,n){n.d(t,{Jx:function(){return y},Rm:function(){return Z},Sp:function(){return b}});var r=n(34142),i=n(32477),o=n(87682),a=n(8182),l=n(54916),c=n(96239),s=n(51533),u=n(86793),d=n(45495),f=n(55534),h=n(92809),p=n(36617),m=n(43429),v=n(37463),g=h.Type.Object({type:h.Type.Literal("webview"),data:h.Type.Optional(h.Type.Union([h.Type.Object({portType:h.Type.Literal("local"),port:h.Type.Number(),path:h.Type.Optional(h.Type.String())}),h.Type.Object({portType:h.Type.Literal("external"),port:h.Type.Number(),path:h.Type.Optional(h.Type.String())})]))}),y=function(e){return p.B4.Decode(g,e)};function b(e,t){var n=void 0;if((null==e?void 0:e.portType)==="external")n=null==e?void 0:e.port;else if((null==e?void 0:e.portType)==="local"){var r=t.find(function(t){return t.configuration.localPort===e.port});n=null==r?void 0:r.configuration.externalPort}return n}var Z={Content:function(e){var t=e.pane.data,n=e.options.performPaneOperation,c=(0,f.Z)().showError,h=(0,l.Z)(),p=h.container,g=h.runner,y=h.fs,Z=(0,i._)((0,m.useState)(function(){return function(){}}),2),w=Z[0],x=Z[1],C=(0,v.bg)();return(0,u.Z)({container:p,runner:g,refreshWebView:w}),(0,d.Z)({runner:g,refreshWebView:w}),(0,a.tZ)(s.Z,{initialPort:b(t,C),initialPath:null==t?void 0:t.path,openPane:function(e){n({operation:"open",pane:e})},openDotReplit:(0,r._)(function(){return(0,o.Jh)(this,function(e){switch(e.label){case 0:return[4,y.stat(".replit")];case 1:if(!e.sent().exists)return c("Could not find .replit configuration file."),[2];return n({operation:"open",secondary:!0,pane:{type:"codeEditor",data:{path:".replit"}}}),[2]}})}),setRefreshCb:x})},Icon:function(e){var t=e.size;return(0,a.tZ)(c.Z,{size:t})},getTitle:function(){return"Webview"},decode:y}},21960:function(e,t,n){n.d(t,{U:function(){return gb}});var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z,w,x,C,_,k,S,E,T,R,I,D,G,B,P,A,N=n(8182),U=n(39698),L=n(32477),O=n(43429),X=n(78055),M=n(29479),F=n(80339),W=n(71914),H=n(54916),V=n(26508),z=n(72282),j=n.n(z),q=n(36102),Y=n(29287),$=n(56596),J=n(74833),K=n(93918),Q=n(48796),ee=n(67696),et=n(76568),en=n(2158),er=n(30084),ei=(0,O.memo)(q.Z),eo=(0,K.X)({root:[Y.l0.colWithGap(8),Y.l0.height("100%"),Y.l0.width("100%"),Y.l0.overflow("auto"),Y.l0.zIndex(2),Y.l0.align.center,Y.l0.py(16),Y.l0.px(16),Y.l0.borderRadius(8),(0,U._)({margin:"0 auto"},"@media only screen and (min-width: ".concat(M.j.tabletMin,"px)"),Y.l0.px(32))],header:[Y.l0.rowWithGap(4),Y.l0.height(30),Y.l0.width("100%"),Y.l0.align.center],markdownContainer:[Y.l0.width("100%"),{"& .rendered-markdown":[Y.l0.flex.column,Y.l0.center],"& .rendered-markdown > *":[Y.l0.maxWidth(840),Y.l0.width("100%")],"& .rendered-markdown > table":Y.l0.maxWidth("100%")}]});function ea(e){var t,n,r=(0,H.Z)().fs,i=(0,L._)((t=(0,O.useRef)(!1),n=(0,O.useRef)(null),[(0,V.Z)(function(){t.current=!0,n.current&&clearTimeout(n.current),n.current=setTimeout(function(){t.current=!1},150)},{type:"throttle",wait:37.5}),t]),2),o=i[0],a=i[1],l=(0,O.useRef)(null),c=(0,Q.T)(),s=e.path,u=e.performPaneOperation;(0,et.L5)(function(){return{actions:[{label:"Open in Editor",icon:(0,N.tZ)(en.Z,{}),type:"action",run:function(){u({operation:"replace",pane:{type:"codeEditor",data:{path:s}}})}}]}},[u,s]);var d=e.isHidden,f=(0,ee.p5)();(0,O.useEffect)(function(){if(!d){var e=j()(function(e){(0,X.Z)(e,{behavior:c?"auto":"smooth",scrollMode:"if-needed"})},100),t=j()(function(t){if(s===(null==t?void 0:t.path)&&t&&!a.current){var n=l.current?function(e,t){var n=e.querySelectorAll(".rendered-markdown [data-sourcepos]");if(!(null==n?void 0:n.length))return null;var r=Array.from(n).reverse(),i=t.line,o=t.column,a=!0,l=!1,c=void 0;try{for(var s,u=r[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value,f=d.dataset.sourcepos;if(!f)throw Error("Expected data source pos on selected element");var h=(0,L._)(f.split("-"),2),p=h[0],m=h[1],v=(0,L._)(p.split(":").map(Number),2),g=v[0],y=v[1],b=(0,L._)(m.split(":").map(Number),2),Z=b[0],w=b[1];if(i>=g&&o>=y&&(i<Z||i===Z&&o<=w))return d}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}}(l.current,t.position):null;n&&e(n)}},200),n=f.subscribe(t);return function(){t.cancel(),e.cancel(),n()}}},[f,d,c,s]);var h=(0,L._)((0,O.useState)(null),2),p=h[0],m=h[1];return((0,O.useEffect)(function(){return m(null),r.watchTextFile(s,{onReady:function(e){m(e.initialContent.toString())},onChange:function(e){m(e.latestContent)},onMoveOrDelete:function(e){e.eventType===er.kS.Delete&&u({operation:"replace",pane:{type:"commands",data:{autoFocus:!0}}})}})},[s,r,u]),null===p)?(0,N.tZ)(W.Z,{preventHighlightBorder:!0}):(0,N.BX)($.G,{css:eo.root,innerRef:o,children:[(0,N.BX)($.G,{css:eo.header,children:[(0,N.tZ)(F.Z,{}),(0,N.BX)(J.xv,{color:"dimmer",multiline:!1,children:["Preview of ",(0,N.tZ)("a",{href:"#".concat(s),children:s})]})]}),(0,N.tZ)($.G,{innerRef:l,css:eo.markdownContainer,children:(0,N.tZ)(ei,{path:s,source:p,fs:r,sourcePos:!0})})]})}var el=n(74928),ec=n(29559),es=n(92809),eu=n(36617),ed=es.Type.Object({type:es.Type.Literal("markdown"),data:es.Type.Object({path:es.Type.String({minLength:1})})}),ef={Content:function(e){var t=e.pane,n=e.options;return(0,N.tZ)(ea,{path:t.data.path,isHidden:!!n.isHidden,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.size;return(0,N.tZ)(el.Z,{fill:"currentColor",size:t})},getTitle:function(e){return e.data.path?(0,ec.UO)(e.data.path):"Markdown"},decode:function(e){return eu.B4.Decode(ed,e)}},eh=n(43001),ep=n(11052),em=n(52489),ev=n(97411),eg=es.Type.Object({type:es.Type.Literal("envEditor")}),ey={Content:function(){return(0,N.tZ)(eb,{})},Icon:function(e){var t=e.size;return(0,N.tZ)(ev.Z,{size:t})},getTitle:function(){return"Secrets"},decode:function(e){return eu.B4.Decode(eg,e)}};function eb(){var e=(0,H.Z)().fs,t=(0,H.Z)().runner;return(0,N.tZ)(em.ZP,{readRawEnv:function(){return e.readFile(".env")},writeRawEnv:function(t){return e.writeFile(".env",t)},getRunState:t.getRunState})}var eZ=n(31270),ew=n(48272),ex=n(21289),eC=n(73157),e_=n(15146),ek=n(9331),eS=n(31070),eE=n(88936),eT=n(30983),eR=n(59072),eI=n(90234),eD=n(71999),eG=n(28999);(0,eI.cn)({replId:"",packageManagers:{}}),(r=m||(m={})).Initializing="Initializing",r.Installing="Installing",r.Uninstalling="Uninstalling",r.Idle="Idle",(i=v||(v={})).Install="Install",i.Uninstall="Uninstall";var eB=(0,O.createContext)(null);function eP(){var e=(0,O.useContext)(eB);if(!e)throw Error("Expected store in context");return e}var eA=(0,eI.cn)(null);function eN(){return(0,eD.Dv)(eA,{store:eP()})}(0,eI.cn)(null);var eU=n(45903),eL=n(25e3),eO=n(34142),eX=n(87682),eM=n(46801);function eF(e){var t=eN(),n=(0,H.Z)(),r=(0,L._)(O.useState(null),2),i=r[0],o=r[1];return O.useEffect(function(){if((null==t?void 0:t.id)&&e.name){var r,i=(0,eM.C)(t.id),a=!1;return(r=(0,eO._)(function(){var r;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:return[4,i.getPackageInfo({id:t.id,name:e.name,services:n})];case 1:if(r=l.sent(),a)return[2];return o(null!=r?r:null),[2]}})}),function(){return r.apply(this,arguments)})(),function(){a=!0}}},[null==t?void 0:t.id,e.name]),i}var eW=n(1498),eH=n(47030),eV=n(20573),ez=n(8279),ej=n(37951),eq=n(38080),eY=n(71166),e$=n.n(eY),eJ=/(.+)(?:\S+)?<([^>,]+)[>,]/,eK=$.K.span;function eQ(e){var t=e.author,n=eJ.exec(t);if(n){var r=n[1],i=n[2];return(0,N.BX)(N.HY,{children:["By ",r,(0,N.BX)("a",{href:"mailto:".concat(i),children:["<",i,">"]})]})}return(0,N.BX)(eK,{children:["By ",t]})}var e0=n(81764),e1=n(42463),e2=n(52682);function e8(e){var t=e.isInstalled,n=e.isInQueue;return e.isCurrentAction?(0,N.tZ)(eE.Z,{}):n?(0,N.tZ)(e0.Z,{}):t?(0,N.tZ)(e2.Z,{}):(0,N.tZ)(e1.Z,{})}var e4=$.K.span,e3=(0,K.X)({metadata:[Y.l0.colWithGap(2)],metadataSkeleton:[Y.l0.colWithGap(8),Y.l0.pt(4)],metadataSkeletonVersion:[ez.p.foregroundPulse(),Y.l0.height(16),Y.l0.maxWidth(64),Y.l0.borderRadius(4)],metadataSkeletonDescription:[ez.p.foregroundPulse(),Y.l0.height(16),Y.l0.borderRadius(4),Y.l0.maxWidth(425)],root:[Y.l0.borderRadius(8),Y.l0.p(8)],header:[Y.l0.flex.row,Y.l0.justify.spaceBetween],headerTitle:[Y.l0.display.flex,Y.l0.rowWithGap(8),Y.l0.flex.growAndShrink(1)],headerTitleText:[Y.l0.display.inline,Y.l0.flex.growAndShrink(1),Y.l0.overflow("hidden"),Y.l0.truncate],headerTitlePills:[Y.l0.display.inlineFlex,Y.l0.rowWithGap(4),Y.l0.flex.shrink(0)],headerButton:[],content:[Y.l0.colWithGap(4)],error:[Y.l0.mt(4)],actions:[Y.l0.rowWithGap(8),Y.l0.mt(8)],consoleButton:[Y.l0.width("calc(50% - ".concat(Y.TV.space8,")"))],cancelButton:[Y.l0.width("calc(50% - ".concat(Y.TV.space8,")"))],actionButton:[Y.l0.flex.grow(1),Y.l0.flex.shrink(0)]});function e5(e){var t=e.title,n=e.content,r=e.isExpanded;return(0,N.BX)($.G,{css:e3.metadata,children:[t?(0,N.tZ)(J.xv,{color:"dimmer",children:t}):null,n?(0,N.tZ)(J.xv,{maxLines:r?void 0:1,children:n}):null]})}function e6(e){var t=e.title,n=e.content;return(0,N.BX)($.G,{css:e3.metadataSkeleton,children:[void 0===t||t?(0,N.tZ)($.G,{css:e3.metadataSkeletonVersion}):null,void 0===n||n?(0,N.tZ)($.G,{css:e3.metadataSkeletonDescription}):null]})}function e9(e){var t,n=e.name,r=e.pkg,i=e.isMetadataLoading,o=e.openConsole,a=e.pills,l=eN(),c=(0,eR.te)(null==l?void 0:l.id),s=(0,eR.pN)(null==l?void 0:l.id),u=(0,eR.B2)(),d=(0,eR.cW)(),f=(0,eR.wY)(),h=(0,O.useMemo)(function(){return r.license?e$()(r.license,{upgrade:!1})||(r.license.length<40?r.license:"Unknown License"):"Unknown License"},[r.license]),p=(0,O.useMemo)(function(){return!!(null!==u&&u.pkgs.find(function(e){return e.name===r.name}))},[u]),m=(0,O.useMemo)(function(){return d.find(function(e){return e.pkgs.find(function(e){return e.name===r.name})})},[d]),v=!!m,g=(0,O.useMemo)(function(){return!!c.find(function(e){return e.name===r.name})},[c]),y=!!(r.homepageURL||r.license||r.author),b=(0,O.useMemo)(function(){return!!s.find(function(e){return e.name===r.name})},[s]),Z=(0,L._)((0,O.useState)(!1),2),w=Z[0],x=Z[1],C=(0,eR.jh)(),_=(0,eR.Wx)(),k=(0,eR.zi)();return(0,N.BX)(eq.Tg,{css:e3.root,elevated:!0,children:[(0,N.BX)($.G,{css:e3.header,children:[(0,N.BX)(J.h4,{css:e3.headerTitle,level:2,variant:"subheadDefault",multiline:!1,children:[(0,N.BX)(e4,{css:e3.headerTitleText,children:[null!=n?n:r.name,r.version?(0,N.BX)(J.xv,{color:"dimmer",children:["@",r.version]}):null]}),a?(0,N.tZ)($.G,{css:e3.headerTitlePills,children:a}):null]}),y?(0,N.tZ)(e_.hU,{css:e3.headerButton,alt:"Show more info",tooltipHidden:!0,onClick:function(){return x(function(e){return!e})},children:(0,N.tZ)(ek.Z,{rotate:w?90:0})}):null]}),(0,N.tZ)($.G,{css:e3.content,children:void 0!==i&&i?(0,N.tZ)(e6,{title:!1}):(0,N.BX)(N.HY,{children:[(0,N.tZ)(e5,{content:null!==(t=r.description)&&void 0!==t?t:"This package has no description.",isExpanded:w}),r.homepageURL&&w?(0,N.tZ)(e5,{content:(0,N.tZ)("a",{href:r.homepageURL,rel:"noreferrer noopener",target:"_blank",children:r.homepageURL}),isExpanded:w}):null,h&&w?(0,N.tZ)(e5,{content:h,isExpanded:w}):null,r.author&&w?(0,N.tZ)(e5,{content:(0,N.tZ)(eQ,{author:r.author}),isExpanded:w}):null]})}),b?(0,N.tZ)(ej.E,{css:e3.error,colorway:"negative",icon:(0,N.tZ)(eV.Z,{}),text:"Couldn't ".concat(g?"uninstall":"install"," package. See Console for details, or try again.")}):null,(0,N.tZ)($.G,{css:e3.actions,children:b?(0,N.BX)(N.HY,{children:[(0,N.tZ)(eW.zx,{css:e3.consoleButton,text:"Console",onClick:function(){o()},disabled:p||v,colorway:"primary",iconLeft:(0,N.tZ)(eH.Z,{})}),(0,N.tZ)(eW.zx,{css:e3.actionButton,text:"Try Again",onClick:function(){(null==l?void 0:l.id)&&(f(l.id,[r]),g?_({id:l.id,pkg:r}):C({id:l.id,pkg:r}))},loading:p||v,colorway:g?"red":void 0,variant:g?"outlined":void 0,iconLeft:(0,N.tZ)(e8,{isInstalled:g,isInQueue:v,isCurrentAction:p})})]}):(0,N.BX)(N.HY,{children:[(0,N.tZ)(eW.zx,{css:e3.actionButton,text:p?(null==u?void 0:u.kind)===eR.TH.Install?"Installing":"Removing":v?(null==m?void 0:m.kind)===eR.TH.Install?"Waiting to install":"Waiting to remove":g?"Remove":"Install",onClick:function(){(null==l?void 0:l.id)&&(g?_({id:l.id,pkg:r}):C({id:l.id,pkg:r}))},loading:p||v,colorway:g?"red":void 0,variant:g?"outlined":void 0,iconLeft:(0,N.tZ)(e8,{isInstalled:g,isInQueue:v,isCurrentAction:p})}),v?(0,N.tZ)(eW.zx,{css:e3.cancelButton,text:"Cancel",onClick:function(){r.name&&k(r.name)},disabled:p,loading:p}):null]})})]})}function e7(e){var t,n,r=e.pkg,i=e.openConsole,o=eF(r),a=o?(0,eL._)((0,eU._)({},o),{version:null!==(t=r.spec)&&void 0!==t?t:o.version}):r;return(0,N.tZ)(e9,{name:null!==(n=null==o?void 0:o.prettyName)&&void 0!==n?n:void 0,pkg:a,isMetadataLoading:null===o,openConsole:i})}function te(e){return(0,N.tZ)("a",(0,eU._)({href:"https://docs.replit.com/programming-ide/installing-packages",target:"_blank",rel:"noreferrer"},e))}var tt=(0,K.X)({root:[Y.l0.colWithGap(8),{"@container (min-width: 600px)":[Y.l0.colWithGap(0),Y.l0.align.start,{display:"grid",gridTemplate:"auto / 1fr 1fr",gap:Y.TV.space8}],"@container (min-width: 1200px)":[{display:"grid",gridTemplate:"auto / 1fr 1fr 1fr",gap:Y.TV.space8}]}]});function tn(e){return(0,N.tZ)($.G,(0,eL._)((0,eU._)({},e),{css:tt.root}))}var tr=n(23291);function ti(e){var t=e.name,n=e.openConsole,r=eF({name:t});return(0,N.tZ)(e9,{pkg:null!=r?r:{name:t},isMetadataLoading:null===r,openConsole:n,pills:[(0,N.tZ)(tr.D,{text:"Suggested",colorway:"primary"},"suggested")]})}var to=(0,K.X)({packages:[Y.l0.pt(8)],separator:[Y.l0.backgroundColor.backgroundHigher,Y.l0.height(1),Y.l0.borderRadius(1),Y.l0.mt(6),{border:"none",marginLeft:"auto",marginRight:"auto",width:"95%"}]});function ta(e){var t=e.openConsole,n=eN(),r=(0,eR.te)(null==n?void 0:n.id),i=(0,eR.B2)(),o=(0,eR.cW)(),a=[];switch(null==n?void 0:n.language){default:return null;case"nodejs":a=["express","discord.js","axios","moment","node-fetch","chalk"];break;case"python3":a=["replit","requests","pandas","discord","matplotlib","flask"]}var l=function(e){if(r.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e})||(i&&i.kind===eR.TH.Install?i.pkgs.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e}):null))return!0;var t=!0,n=!1,a=void 0;try{for(var l,c=o[Symbol.iterator]();!(t=(l=c.next()).done);t=!0){var s=l.value;if(s.kind===eR.TH.Install&&s.pkgs.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e}))return!0}}catch(e){n=!0,a=e}finally{try{t||null==c.return||c.return()}finally{if(n)throw a}}return!1},c=a.filter(function(e){return!l(e)}).map(function(e){return(0,N.tZ)(ti,{name:e,openConsole:t},e)});return c.length>0?(0,N.BX)(N.HY,{children:[(0,N.tZ)("hr",{css:to.separator}),(0,N.tZ)(tn,{css:to.packages,children:c})]}):null}var tl=(0,K.X)({root:[Y.l0.maxWidth(800),Y.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[Y.l0.maxWidth(1400)]}],header:[Y.l0.flex.row,Y.l0.justify.spaceBetween,Y.l0.py(4)],headerLeft:[Y.l0.rowWithGap(4),Y.l0.align.center],headerLoadingIcon:[Y.l0.px(4)],headerRight:[Y.l0.rowWithGap(4)],headerTitle:[{textTransform:"capitalize"}],packages:[Y.l0.pt(8)],empty:[Y.l0.pt(8),Y.l0.colWithGap(8),Y.l0.width("100%")],packagesWrapper:[Y.l0.colWithGap(8),Y.l0.width("100%")]});function tc(e){var t=e.openFile,n=e.openConsole,r=eN(),i=(0,eR.te)(null==r?void 0:r.id),o=(0,eR.$z)(null==r?void 0:r.id),a=(0,eR.cW)(),l=(0,eR.B2)(),c=(0,L._)((0,O.useState)(!0),2),s=c[0],u=c[1];if(null===r)return null;if(!o||o===eR.C0.Uninitialized||o===eR.C0.Initializing)return(0,N.tZ)($.G,{css:tl.root,children:(0,N.BX)($.G,{css:tl.header,children:[(0,N.BX)($.G,{css:tl.headerLeft,children:[(0,N.tZ)(eT.u,{tooltip:"Loading",children:(0,N.tZ)($.G,{css:tl.headerLoadingIcon,children:(0,N.tZ)(eE.Z,{})})}),(0,N.BX)(J.h4,{css:tl.headerTitle,variant:"subheadDefault",level:2,children:[r.language," Packages"]})]}),(0,N.tZ)($.G,{css:tl.headerRight,children:r.packagerFiles.length>0?(0,N.tZ)(e_.hU,{alt:"Open ".concat(r.packagerFiles[0]),onClick:function(){r&&t(r.packagerFiles[0])},children:(0,N.tZ)(eS.Z,{})}):null})]})});var d=l&&l.id===r.id&&l.kind===eR.TH.Install?l.pkgs:[],f=a.flatMap(function(e){return e.id===r.id&&e.kind===eR.TH.Install?e.pkgs:[]}),h=(0,ex._)(d).concat((0,ex._)(f),(0,ex._)(i));return(0,N.BX)($.G,{css:tl.root,children:[(0,N.BX)($.G,{css:tl.header,children:[(0,N.BX)($.G,{css:tl.headerLeft,children:[h.length>0?(0,N.tZ)(e_.hU,{alt:"Show packages",tooltipHidden:!0,onClick:function(){return u(function(e){return!e})},children:(0,N.tZ)(ek.Z,{rotate:s?90:0})}):null,(0,N.BX)(J.h4,{css:tl.headerTitle,variant:"subheadDefault",level:2,children:[r.language," Packages"]})]}),(0,N.tZ)($.G,{css:tl.headerRight,children:0===h.length?(0,N.tZ)(J.h4,{level:3,children:"No Packages Installed."}):(0,N.BX)(N.HY,{children:[(0,N.BX)(J.h4,{level:3,children:["Installed ",h.length," ",(0,eC.Z)("package",h.length)]}),r.packagerFiles.length>0?(0,N.tZ)(e_.hU,{alt:"Open ".concat(r.packagerFiles[0]),onClick:function(){r&&t(r.packagerFiles[0])},children:(0,N.tZ)(eS.Z,{})}):null]})})]}),s?(0,N.BX)($.G,{css:0===h.length?tl.empty:tl.packagesWrapper,children:[0===h.length?(0,N.BX)(J.xv,{children:["You don't have any packages installed."," ",r.packageSearch?(0,N.BX)(N.HY,{children:["Try searching for a package to install, or"," ",(0,N.tZ)(te,{children:"learn more about packages here"}),"","."]}):(0,N.BX)(J.xv,{children:[(0,N.tZ)(te,{children:"Learn more about packages here"}),"","."]})]}):null,h.length>0?(0,N.tZ)(N.HY,{children:(0,N.tZ)(tn,{css:tl.packages,children:h.sort(function(e,t){return(null==e?void 0:e.name)?(null==t?void 0:t.name)?e.name.localeCompare(t.name):-1:1}).map(function(e){return(0,N.tZ)(e7,{pkg:e,openConsole:n},e.name)})})}):null,(0,N.tZ)(ta,{openConsole:n})]}):null]})}var ts=n(13225),tu=n(54843);function td(e){var t,n,r=e.onResults,i=e.onLoading,o=e.className,a=eN(),l=(0,L._)((0,O.useState)(""),2),c=l[0],s=l[1],u=(0,O.useRef)(0),d=function(){u.current++,null==r||r(null),null==i||i(!1)},f=(t=(0,H.Z)(),n=(0,eG.lV)((0,O.useCallback)(function(e){return e(eA)},[eA]),{store:eP()}),(0,O.useCallback)(function(e){var r=n();return(null==r?void 0:r.id)?(0,eM.C)(r.id).search({id:r.id,query:e,services:t}):[]},[]));(0,ts.Z)(function(){if(""!==c.trim()){var e,t=++u.current;(e=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:return null==i||i(!0),[4,f(c)];case 1:if(e=n.sent(),t!==u.current)return[2];return null==r||r(null!=e?e:[]),null==i||i(!1),[2]}})}),function(){return e.apply(this,arguments)})()}},[c],500);var h=(0,O.useRef)(null);return(0,O.useEffect)(function(){h.current&&h.current.focus()},[]),(0,N.tZ)($.G,{className:o,children:(0,N.tZ)(tu.E,{inputRef:h,value:c,onChange:function(e){""===e.target.value.trim()&&d(),s(e.target.value)},onClear:function(){s(""),d()},placeholder:a?"Search ".concat(a.language," packages"):void 0})})}var tf=(0,K.X)({root:[Y.l0.maxWidth(800),Y.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[Y.l0.maxWidth(1400)]}],skeleton:[Y.l0.borderRadius(8),Y.l0.p(8),ez.p.backgroundPulse(),Y.l0.height(128)]});function th(){return(0,N.tZ)($.G,{css:tf.root,children:(0,N.tZ)(tn,{children:Array.from({length:3},function(e,t){return(0,N.tZ)(eq.Tg,{css:tf.skeleton,elevated:!0},"SearchLoading-".concat(t))})})})}function tp(e){var t,n=e.pkg,r=e.openConsole,i=eN(),o=eF(n),a=o?(0,eL._)((0,eU._)({},o),{version:null!==(t=n.spec)&&void 0!==t?t:o.version}):n,l=(null==i?void 0:i.id)==="nix"?null==o?void 0:o.prettyName:void 0;return(0,N.tZ)(e9,{name:l,pkg:a,isMetadataLoading:null===o,openConsole:r})}function tm(e){var t=e.pkg,n=e.openConsole;return(0,N.tZ)(e9,{pkg:t,openConsole:n})}var tv=(0,K.X)({root:[Y.l0.colWithGap(8),Y.l0.maxWidth(800),Y.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[Y.l0.maxWidth(1400)]}],results:[Y.l0.colWithGap(8)],empty:[Y.l0.flex.row,Y.l0.justify.center]});function tg(e){var t=e.results,n=e.openConsole,r=eN(),i=(null==r?void 0:r.id)==="nix"?tp:tm;return(0,N.tZ)($.G,{css:tv.root,children:(0,N.tZ)($.G,{css:tv.results,children:0===t.length?(0,N.tZ)(J.xv,{color:"dimmer",css:tv.empty,children:"No Packages Found"}):(0,N.tZ)(tn,{children:t.map(function(e){return(0,N.tZ)(i,{pkg:e,openConsole:n},e.name)})})})})}var ty=n(40664),tb=n(58719),tZ=(0,K.X)({root:[Y.l0.p(8),Y.l0.borderRadius(8),Y.l0.colWithGap(16)],header:[Y.l0.flex.row,Y.l0.align.center,Y.l0.justify.spaceBetween],headerLeft:[Y.l0.rowWithGap(4),Y.l0.align.center],headerRight:[],content:[Y.l0.display.block]});function tw(e){var t=e.title,n=e.onClose,r=e.children,i=(0,L._)((0,O.useState)(!0),2),o=i[0],a=i[1];return(0,N.BX)(eq.Tg,{elevated:!0,css:tZ.root,children:[(0,N.BX)($.G,{css:tZ.header,children:[(0,N.BX)($.G,{css:tZ.headerLeft,children:[(0,N.tZ)(J.h4,{level:2,variant:"subheadDefault",children:t}),(0,N.tZ)(e_.hU,{alt:o?"Minimize tip information":"Expand tip information",tooltipHidden:!0,onClick:function(){return a(function(e){return!e})},children:(0,N.tZ)(ek.Z,{rotate:o?90:0})})]}),(0,N.tZ)($.G,{css:tZ.headerRight,children:(0,N.tZ)(e_.hU,{alt:"Dismiss tip",tooltipHidden:!0,onClick:n,children:(0,N.tZ)(tb.Z,{})})})]}),o?(0,N.tZ)($.G,{css:tZ.content,children:r}):null]})}var tx=(0,K.X)({root:[Y.l0.colWithGap(8),Y.l0.pb(24)]});function tC(){var e=(0,ty.Z)("packager","show_packager_about_tooltip"),t=(0,ty.Z)("packager","show_packager_import_tooltip");return((0,O.useEffect)(function(){e.register()},[e]),(0,O.useEffect)(function(){t.register()},[t]),e.shouldDisplay||t.shouldDisplay)?(0,N.BX)($.G,{css:tx.root,children:[e.shouldDisplay?(0,N.BX)(tw,{title:"What are packages?",onClose:e.dismiss,children:["Packages are collections of code that can extend the functionality of your programs. For example, you could add a package to make adding image carousels easier on websites, or a package to manage currency comparisons."," ",(0,N.tZ)(te,{children:"Learn more about packages"}),"","."]}):null,t.shouldDisplay?(0,N.tZ)(tw,{title:"TipAuto Import",onClose:t.dismiss,children:"If you know which packages you want to use, you can just import and use them in your files as if they were already installed, and they will be installed automatically the next time you run the Repl."}):null]}):null}var t_=n(16278),tk=n(50199);function tS(e){var t=e.children,n=e.config,r=(0,eD.b9)(eA,{store:eP()});return(0,O.useEffect)(function(){(null==n?void 0:n.id)&&r(n)},[n]),(0,N.tZ)(N.HY,{children:t})}function tE(e){var t=e.children,n=e.config,r=(0,L._)((0,O.useState)(function(){return(0,eI.MT)()}),1)[0];return(0,N.tZ)(eB.Provider,{value:r,children:n?(0,N.tZ)(tS,{config:n,children:t}):t})}var tT=(0,K.X)({root:[Y.l0.pt(16),Y.l0.p(8),{containerType:"inline-size"}],center:[Y.l0.width("100%"),Y.l0.maxWidth(600),Y.l0.colWithGap(4),{marginLeft:"auto",marginRight:"auto","@container (min-width: 400px)":[Y.l0.maxWidth(800)],"@container (min-width: 1200px)":[Y.l0.maxWidth(1400)]}],title:[],content:[Y.l0.pt(8),Y.l0.colWithGap(16)],search:[Y.l0.rowWithGap(8),Y.l0.width("100%")],searchInput:[Y.l0.flex.grow(1)],configSelect:[],packages:[Y.l0.colWithGap(16)]});function tR(e){var t,n,r,i,o,a=e.openFile,l=e.openConsole,c=(0,t_.I)(),s=(0,tk.Z)(function(){return c.filter(function(e){return"nix"!==e.id})},[c]),u=(0,L._)((t=(0,t_.I)(),n=(0,tk.Z)(function(){return t.filter(function(e){return"nix"!==e.id})},[t]),i=(r=(0,L._)((0,O.useState)(null),2))[0],o=r[1],(0,O.useEffect)(function(){n.length>0&&(null==i||!n.find(function(e){return e&&e.id===i.id}))&&o(n[0])},[i,n]),[i,o]),2),d=u[0],f=u[1],h=(0,L._)((0,O.useState)(null),2),p=h[0],m=h[1],v=(0,L._)((0,O.useState)(!1),2),g=v[0],y=v[1],b=null;return b=null!==p?(0,N.tZ)(tg,{results:p,openConsole:l}):g?(0,N.tZ)(th,{}):(0,N.tZ)(N.HY,{children:s.map(function(e){return e.id===(null==d?void 0:d.id)?(0,N.tZ)(tc,{openFile:a,openConsole:l},e.id):(0,N.tZ)(tE,{config:e,children:(0,N.tZ)(tc,{openFile:a,openConsole:l})},e.id)})}),(0,N.tZ)($.G,{css:tT.root,children:(0,N.tZ)($.G,{css:tT.center,children:0===s.length?(0,N.BX)($.G,{children:[(0,N.tZ)(J.h4,{level:2,variant:"subheadBig",children:"Sorry, packages are not configured for this Repl."}),(0,N.tZ)(J.xv,{variant:"subheadDefault",children:"We are working on making more features configurable and packages available for more languages, check back again in the future."})]}):(0,N.BX)(N.HY,{children:[(0,N.tZ)(tC,{}),(0,N.tZ)(J.h4,{css:tT.title,level:2,variant:"subheadBig",children:"Packages"}),(0,N.tZ)($.G,{css:tT.content,children:(0,N.BX)(tE,{config:d,children:[(0,N.BX)($.G,{css:tT.search,children:[(null==d?void 0:d.packageSearch)?(0,N.tZ)(td,{css:tT.searchInput,onResults:m,onLoading:y}):(0,N.tZ)($.G,{css:tT.searchInput}),s.length>1&&(0,N.tZ)(ew.P,{css:tT.configSelect,items:s,selectedItem:d,onChange:function(e){return f(e)},"aria-label":"Select packager configuration"})]}),(0,N.tZ)($.G,{css:tT.packages,children:b})]})})]})})})}var tI=n(12506),tD=es.Type.Object({type:es.Type.Literal("packager")}),tG={Content:function(e){var t=e.options;return(0,N.tZ)(tR,{openFile:function(e){return t.performPaneOperation({operation:"open",pane:(0,tI.$E)(e),secondary:!0})},openConsole:function(){t.performPaneOperation({operation:"open",pane:{type:"runnerOutput"},secondary:!0})}})},Icon:function(e){var t=e.size;return(0,N.tZ)(eZ.Z,{size:t})},getTitle:function(){return"Packages"},decode:function(e){return eu.B4.Decode(tD,e)}},tB=n(33081),tP=(0,K.X)({root:[Y.l0.pt(16),Y.l0.p(8)],center:[Y.l0.width("100%"),Y.l0.maxWidth(600),Y.l0.colWithGap(4),{marginLeft:"auto",marginRight:"auto","@container (min-width: 400px)":[Y.l0.maxWidth(800)],"@container (min-width: 1200px)":[Y.l0.maxWidth(1400)]}],title:[],content:[Y.l0.pt(8),Y.l0.colWithGap(16)],search:[Y.l0.rowWithGap(8),Y.l0.width("100%")],searchInput:[Y.l0.flex.grow(1)],packages:[Y.l0.colWithGap(16)]}),tA=function(){};function tN(e){var t=e.openConsole,n=(0,t_.I)(),r=(0,tk.Z)(function(){return n.find(function(e){return"nix"===e.id})},[n]),i=(0,L._)((0,O.useState)(null),2),o=i[0],a=i[1],l=(0,L._)((0,O.useState)(!1),2),c=l[0],s=l[1],u=null;return u=null!==o?(0,N.tZ)(tg,{results:o,openConsole:t}):c?(0,N.tZ)(th,{}):(null==r?void 0:r.id)?(0,N.tZ)(tc,{openFile:tA,openConsole:t},r.id):null,(0,N.tZ)(tE,{config:r,children:(0,N.tZ)($.G,{css:tP.root,children:(0,N.BX)($.G,{css:tP.center,children:[(0,N.tZ)(J.h4,{css:tP.title,level:2,variant:"subheadBig",children:"System Dependencies"}),(0,N.BX)($.G,{css:tP.content,children:[(null==r?void 0:r.packageSearch)?(0,N.tZ)($.G,{css:tP.search,children:(0,N.tZ)(td,{css:tP.searchInput,onResults:a,onLoading:s})}):null,(0,N.tZ)($.G,{css:tP.packages,children:u})]})]})})})}var tU=es.Type.Object({type:es.Type.Literal("systemDependencies")}),tL={Content:function(e){var t=e.options;return(0,N.tZ)(tN,{openConsole:function(){t.performPaneOperation({operation:"open",pane:{type:"runnerOutput"},secondary:!0})}})},Icon:function(e){var t=e.size;return(0,N.tZ)(tB.Z,{size:t})},getTitle:function(){return"System Dependencies"},decode:function(e){return eu.B4.Decode(tU,e)}},tO=n(10454),tX=n(52902),tM=n(95025),tF=n(18836),tW=n(88883),tH=n(12874),tV=n(5344),tz=n(10041),tj=(0,K.X)({button:{width:"fit-content"}});function tq(e){var t=e.code,n=e.activeFile,r=(0,tW.Z)(n),i=r?{text:"Insert",iconRight:(0,N.tZ)(tH.Z,{}),onClick:function(){return r({code:t,insertAt:"end"})}}:{text:"Copy",iconLeft:(0,N.tZ)(tV.Z,{}),onClick:function(){return(0,tz.Z)(t)}};return(0,N.tZ)(eq.Tg,{background:"default",children:(0,N.tZ)(eW.zx,(0,eU._)({size:"small",variant:"outlined",css:tj.button},i))})}var tY=(0,K.X)({self:Y.l0.colWithGap(4),content:[Y.l0.rowWithGap(4),Y.l0.backgroundColor.backgroundRoot,Y.l0.borderRadius(4),Y.l0.p(4),Y.l0.align.center,{width:"fit-content"}]});function t$(e){var t=e.method,n=e.content,r=e.activeFile,i=(0,L._)((0,O.useState)(n),2),o=i[0],a=i[1];return(0,N.BX)($.G,{css:tY.self,children:[(0,N.tZ)(t2,{title:t}),(0,N.tZ)($.G,{css:tY.content,children:o.map(function(e,n){var r="".concat(t,"-").concat(n);return"input"===e.type?(0,N.tZ)(tK,{i:n,value:e.value,placeholder:e.placeholder,setContent:a},r):(0,N.tZ)(t0,{value:e.value},r)})}),(0,N.tZ)(tq,{code:o.reduce(function(e,t){return e+(t.value||("input"===t.type?t.placeholder:""))},""),activeFile:r})]})}var tJ=(0,K.X)({self:[Y.l0.width(64),Y.l0.height(24),Y.l0.zIndex(1)]});function tK(e){var t=e.i,n=e.value,r=e.placeholder,i=e.setContent;return(0,N.tZ)(tF.II,{onChange:function(e){i(function(n){return n.map(function(n,r){return t===r?(0,eL._)((0,eU._)({},n),{value:e.target.value}):n})})},placeholder:r,value:n||"",css:tJ.self})}var tQ=(0,K.X)({self:[Y.l0.borderRadius(0),Y.l0.backgroundColor.backgroundRoot],code:[Y.l0.font.code,Y.l0.color.greyStronger,Y.l0.p(4)]});function t0(e){var t=e.value;return(0,N.tZ)($.G,{css:tQ.self,children:(0,N.tZ)(J.xv,{css:tQ.code,multiline:!1,children:t})})}var t1=(0,K.X)({self:Y.l0.rowWithGap(4),bold:{fontWeight:Y.TV.fontWeightMedium}});function t2(e){var t=e.title,n=(0,L._)((0,tk.Z)(function(){var e=(0,tM._)(t.split(" "));return[e[0],e.slice(1).join(" ")]},[t]),2),r=n[0],i=n[1];return(0,N.BX)($.G,{css:t1.self,children:[(0,N.tZ)(J.xv,{css:t1.bold,multiline:!1,children:r}),(0,N.tZ)(J.xv,{color:"dimmer",multiline:!1,children:i})]})}(o=g||(g={})).IMPORT="Import the database",o.CREATE="Create a new database",o.SET="Set a key to a value",o.GET="Get a key's value",o.DELETE="Delete a key",o.LIST="List all keys",o.LIST_PREFIX="List keys with a prefix";var t8={language:"Bash",methods:[t6("Set a key to a value","curl $REPLIT_DB_URL -d '{{key}} = {{value}}'"),t6("Get a key's value","curl $REPLIT_DB_URL/{{key}}"),t6("Delete a key","curl -XDELETE $REPLIT_DB_URL/{{key}}"),t6("List all keys",'curl "$REPLIT_DB_URL?prefix={{key}}"')]},t4={language:"Node",methods:[t6("Import the database",'const Database = require("@replit/database")'),t6("Create a new database","const db = new Database()"),t6("Set a key to a value",'db.set("{{key}}", "{{value}}").then(() => {})'),t6("Get a key's value",'db.get("{{key}}").then(value => {})'),t6("Delete a key",'db.delete("{{key}}").then(() => {})'),t6("List all keys","db.list().then(keys => {})"),t6("List keys with a prefix",'db.list("{{prefix}}").then(matches => {})')]},t3={language:"Go",methods:[t6("Import the database",'import "github.com/replit/database-go"'),t6("Set a key to a value",'db.Set("{{key}}", "{{value}}")'),t6("Get a key's value",'value, _ := database.Get("{{key}}")'),t6("Delete a key",'database.Delete("{{key}}")'),t6("List all keys",'keys, _ := database.ListKeys("")'),t6("List keys with a prefix",'matches, _ := database.ListKeys("{{prefix}}")')]},t5={language:"Python",methods:[t6("Import the database","from replit import db"),t6("Set a key to a value",'db["{{key}}"] = "{{value}}"'),t6("Get a key's value",'db["{{key}}"]'),t6("Delete a key",'del db["{{key}}"]'),t6("List all keys","keys = db.keys()"),t6("List keys with a prefix",'matches = db.prefix("{{prefix}}")')]};function t6(e,t){return{method:e,content:function(e){for(var t=[],n=0;n<e.length;){var r=e.indexOf("{{",n),i=e.indexOf("}}",n);if(-1===r||-1===i){t.push({type:"code",value:e.substring(n)});break}t.push({type:"code",value:e.substring(n,r)}),t.push({type:"input",placeholder:e.substring(r+2,i)}),n=i+2}return t}(t)}}var t9=(0,K.X)({self:Y.l0.colWithGap(24),code:[Y.l0.font.code,Y.l0.color.greyStronger,Y.l0.backgroundColor.backgroundRoot,Y.l0.p(4),Y.l0.borderRadius(4)]});function t7(e){var t=e.activeFile,n=(0,tk.Z)(function(){return function(e){switch(e?(0,ec.r6)(e):"bash"){case"js":case"ts":case"tsx":case"jsx":case"mjs":return t4;case"go":return t3;case"py":return t5;default:return t8}}(t)},[t]);return(0,N.BX)($.G,{css:t9.self,children:[(0,N.BX)(J.xv,{color:"dimmer",children:["You can use the Database from any Repl by making HTTP requests or a client library as outlined below. Weve set an environment variable called ",(0,N.tZ)("code",{css:t9.code,children:"REPLIT_DB_URL"})," in your Repl if you'd like to interact with the database directly."]}),n.methods.map(function(e){return(0,N.tZ)(t$,{method:e.method,content:e.content,activeFile:t},"".concat(n.language).concat(e.method))})]})}var ne=n(75246),nt=(0,K.X)({children:[Y.l0.p(12),Y.l0.colWithGap(8)]});function nn(e){var t=e.title,n=e.defaultExpanded,r=e.children;return(0,N.tZ)(ne.Q,{defaultExpanded:n,headerContent:(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:t}),children:(0,N.tZ)($.G,{css:nt.children,children:r})})}var nr=n(51384),ni=n(3630),no=(0,nr.F4)("from{opacity:0}to{opacity:1}"),na=(0,K.X)({self:[Y.l0.colWithGap(8),{animation:"".concat(no," 100ms forwards ease-in-out alternate")}],selfLoadingText:[Y.l0.height(16),Y.l0.width(48),Y.l0.borderRadius(4),ez.p.backgroundPulse()],selfLoading:[Y.l0.height(12),Y.l0.borderRadius(16),ez.p.backgroundPulse()],text:[Y.l0.rowWithGap(4)],textSpan:[Y.l0.width("fit-content"),Y.l0.display.inlineFlex]});function nl(e){var t,n,r=e.database,i=e.loading,o=(null==r?void 0:r.sizeMB)||0,a=(t=1e6*(t=o)/1048576,"".concat(t.toFixed(),"/50 MiB")),l=i||!r;return(0,N.tZ)($.G,{css:na.self,children:l?(0,N.BX)(N.HY,{children:[(0,N.tZ)($.G,{css:na.selfLoadingText}),(0,N.tZ)($.G,{css:na.selfLoading})]}):(0,N.BX)(N.HY,{children:[(0,N.BX)(J.xv,{color:"dimmer",css:na.text,multiline:!1,children:[(0,N.tZ)($.K.span,{css:na.textSpan,children:a}),(0,N.tZ)($.K.span,{css:na.textSpan,children:"|"}),(0,N.tZ)($.K.span,{css:na.textSpan,children:(n=(n=null==r?void 0:r.keysCount)||0,"".concat(n," ").concat((0,eC.Z)("key",n)))})]}),(0,N.tZ)(ni.J,{current:o,total:50,tooltip:a})]})},l?"databaseLoadingStats":"databaseLoadedStats")}var nc=n(50782),ns=n(93295),nu=n(23982),nd=n(66039);function nf(){var e=(0,ns._)(["\n  fragment DatabaseUsage on Database {\n    id\n    keysCount\n    sizeMB\n  }\n"]);return nf=function(){return e},e}function nh(){var e=(0,ns._)(["\n  query Database($replID: String!) {\n    repl(id: $replID) {\n      ... on Repl {\n        id\n        database {\n          id\n          ...DatabaseUsage\n        }\n      }\n    }\n    currentUser {\n      id\n      isLoggedIn\n    }\n  }\n  ","\n"]);return nh=function(){return e},e}var np={},nm=(0,nu.Ps)(nf()),nv=(0,nu.Ps)(nh(),nm),ng=n(73524),ny=n(58091),nb=(0,K.X)({self:[Y.l0.colWithGap(16),Y.l0.p(8),Y.l0.backgroundColor.backgroundDefault,tX.F3],link:[Y.l0.color.accentPrimaryStronger,Y.l0.pr(4)],sectionWrapper:[Y.l0.colWithGap(16),Y.l0.overflowY("auto"),Y.l0.width("100%"),{flex:"1"}]});function nZ(e){var t,n,r,i,o,a,l,c,s,u=e.performPaneOperation,d=(l=(i={variables:{replID:(0,nc.Z)()},pollInterval:1e4},o=(0,eU._)({},np,i),a=nd.a(nv,o)).data,c=a.error,s=a.loading,l&&("Repl"===l.repl.__typename?n=null==l?void 0:null===(r=l.repl)||void 0===r?void 0:r.database:t="Could not fetch Database info"),c&&("GraphQL error: You don't have access to this database"===c.message?n=null:t=c.message),{db:n,loading:s,error:t}),f=d.db,h=d.error,p=d.loading,m=(0,ny.R3)();return(0,N.BX)($.G,{css:nb.self,children:[(0,N.tZ)(J.h4,{level:2,variant:"subheadBig",children:"Database"}),(0,N.BX)($.G,{css:nb.sectionWrapper,children:[(0,N.BX)($.G,{children:[(0,N.BX)(J.xv,{children:[(0,N.tZ)("a",{href:ng.TT.REPL_DATABASE,target:"_blank",rel:"noopener",onClick:function(e){e.preventDefault(),u({operation:"open",pane:{type:"docs",data:{url:ng.TT.REPL_DATABASE}}})},children:"Replit Database"})," ","is a free, easy to use key-value store. No configuration is necessary, so you can start using it right away."]}),h?(0,N.tZ)(J.xv,{css:[Y.l0.color.accentNegativeStronger],children:h}):null]}),(0,N.tZ)(nn,{title:"Database Info",defaultExpanded:!0,children:(0,N.tZ)(nl,{database:f,loading:p})}),(0,N.tZ)(nn,{title:"Using the database",defaultExpanded:!0,children:(0,N.tZ)(t7,{activeFile:m})})]})]})}var nw=es.Type.Object({type:es.Type.Literal("database")}),nx={Content:function(e){var t=e.options.performPaneOperation;return(0,N.tZ)(nZ,{performPaneOperation:t})},Icon:function(e){var t=e.size;return(0,N.tZ)(tO.Z,{size:t})},getTitle:function(){return"Database"},decode:function(e){return eu.B4.Decode(nw,e)}},nC=n(13440);function n_(){var e=(0,ns._)(["\n  mutation CreateNeonDatabase($input: CreateNeonDatabaseInput!) {\n    createNeonDatabase(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on CreateNeonDatabaseResult {\n        databaseId\n        databaseName\n        projectId\n        connectionString\n        isFrozen\n        isBackedByCycles\n      }\n    }\n  }\n"]);return n_=function(){return e},e}function nk(){var e=(0,ns._)(["\n  mutation DeleteNeonDatabase($input: DeleteNeonDatabaseInput!) {\n    deleteNeonDatabase(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on DeleteNeonDatabaseResult {\n        success\n      }\n    }\n  }\n"]);return nk=function(){return e},e}function nS(){var e=(0,ns._)(["\n  query GetNeonDatabases($input: GetNeonDatabasesInput!) {\n    getNeonDatabases(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on GetNeonDatabasesResult {\n        databases {\n          databaseId\n          databaseName\n          projectId\n          connectionString\n          isFrozen\n          isBackedByCycles\n        }\n      }\n    }\n  }\n"]);return nS=function(){return e},e}function nE(){var e=(0,ns._)(["\n  mutation UnfreezeNeonDatabase($input: UnfreezeNeonDatabaseInput!) {\n    unfreezeNeonDatabase(input: $input) {\n      ... on UnfreezeNeonDatabaseResult {\n        success\n      }\n    }\n  }\n"]);return nE=function(){return e},e}var nT={},nR=(0,nu.Ps)(n_());function nI(e){var t=(0,eU._)({},nT,e);return nC.D(nR,t)}var nD=(0,nu.Ps)(nk());function nG(e){var t=(0,eU._)({},nT,e);return nC.D(nD,t)}var nB=(0,nu.Ps)(nS()),nP=(0,nu.Ps)(nE());function nA(e){var t=(0,eU._)({},nT,e);return nC.D(nP,t)}var nN=n(55534),nU=n(32377),nL=n(38265),nO=n(56917),nX=n(84357),nM=n(69414),nF=n(79530),nW=n(42267),nH=n(32665),nV={"td,th":{border:"1px solid "+Y.TV.outlineDefault}},nz={"td,th":{paddingLeft:8,paddingTop:8,paddingBottom:8,paddingRight:8,whiteSpace:"nowrap"},"td:first-of-type,th:first-of-type":{paddingLeft:8}},nj={outline:"2px solid ".concat(Y.TV.accentPrimaryDefault),outlineOffset:"-2px"},nq=(0,nr.iv)({":focus:focus-visible":nj}),nY=(0,nr.iv)(nj),n$=(0,nr.iv)([nz,nV,nq]),nJ=(0,nr.iv)([Y.l0.fontWeight.medium,nz,nV,nq]),nK=(0,nr.iv)({"tbody > tr:hover":{backgroundColor:Y.TV.backgroundHigher,cursor:"pointer"}});function nQ(e){var t=e.type,n=e.style,r=e.children,i=(0,nM.LA)().rowGroupProps;return(0,N.tZ)(t,(0,eL._)((0,eU._)({},i),{style:n,children:r}))}function n0(e){var t=e.item,n=e.state,r=e.children,i=(0,O.useRef)(null),o=(0,nM.Qm)({node:t},n,i).rowProps;return(0,N.tZ)("tr",(0,eL._)((0,eU._)({css:nJ},o),{ref:i,children:r}))}function n1(e){var t,n=e.column,r=e.state,i=(0,O.useRef)(null),o=(0,nM.WY)({node:n},r,i).columnHeaderProps,a=(0,nF.Fx)(),l=a.isFocusVisible,c=a.focusProps;return(0,N.tZ)("th",(0,eL._)((0,eU._)({},(0,nW.dG)(o,c)),{css:[l&&nY,nq],colSpan:n.colspan,style:{textAlign:(null!==(t=n.colspan)&&void 0!==t?t:1)>1?"center":"left"},ref:i,children:n.rendered}))}function n2(e){var t=e.item,n=e.children,r=e.state,i=(0,O.useRef)(null),o=(0,nM.U)({node:t},r,i).rowProps,a=(0,nF.Fx)(),l=a.isFocusVisible,c=a.focusProps;return(0,N.tZ)("tr",(0,eL._)((0,eU._)({css:[l&&nY,n$]},(0,nW.dG)(o,c)),{ref:i,children:n}))}function n8(e){var t=e.cell,n=e.state,r=(0,O.useRef)(null),i=(0,nM.fs)({node:t},n,r).gridCellProps,o=(0,nF.Fx)(),a=o.isFocusVisible,l=o.focusProps;return(0,N.tZ)("td",(0,eL._)((0,eU._)({},(0,nW.dG)(i,l)),{css:[a&&nY,nq],ref:r,children:t.rendered}))}function n4(e){var t=e.selectionMode,n=e.selectionBehavior,r=(0,nH.oy)((0,eL._)((0,eU._)({},e),{showSelectionCheckboxes:"multiple"===t&&"replace"!==n})),i=(0,O.useRef)(null),o=r.collection,a=(0,nM.x6)(e,r,i).gridProps;return(0,N.BX)("table",(0,eL._)((0,eU._)({},a),{ref:i,css:[(null==e?void 0:e.onRowAction)&&nK],style:{borderCollapse:"collapse"},children:[(0,N.tZ)(nQ,{type:"thead",children:o.headerRows.map(function(e){return(0,N.tZ)(n0,{item:e,state:r,children:(0,ex._)(e.childNodes).map(function(e){return(0,N.tZ)(n1,{column:e,state:r},e.key)})},e.key)})}),(0,N.tZ)(nQ,{type:"tbody",children:(0,ex._)(o.body.childNodes).map(function(e){return(0,N.tZ)(n2,{item:e,state:r,children:(0,ex._)(e.childNodes).map(function(e){return(0,N.tZ)(n8,{cell:e,state:r},e.key)})},e.key)})})]}))}var n3=function(e){var t=e.ariaTableProps,n=e.rows,r=e.columns;return(0,N.BX)(n4,(0,eL._)((0,eU._)({},t),{children:[(0,N.tZ)(nH.xD,{columns:r,children:function(e){return(0,N.tZ)(nH.sg,{children:e.value})}}),(0,N.tZ)(nH.RM,{items:n,children:function(e){return(0,N.tZ)(nH.X2,{children:function(t){return(0,N.tZ)(nH.bL,{children:e[t]})}})}})]}))};function n5(e){var t=e.headerColumns,n=e.bodyData,r=e.ariaLabel,i=e.scrollRef,o=e.onRowAction,a=t.map(function(e,t){return{key:"string"==typeof e?e:"".concat(t),value:e}}),l=n.map(function(e,n){for(var r={id:n},i=0;i<e.length;i++){var o=t[i];r["string"==typeof o?o:"".concat(i)]=e[i]}return r});return(0,N.tZ)(n3,{ariaTableProps:{selectionMode:"none","aria-label":void 0===r?"Database Table":r,onRowAction:o,scrollRef:i},columns:a,rows:l})}var n6=function(e,t){var n,r=(0,H.Z)().psql,i=(0,L._)(O.useState(),2),o=i[0],a=i[1],l=(0,L._)(O.useState(!1),2),c=l[0],s=l[1],u=O.useCallback((n=(0,eO._)(function(){return(0,eX.Jh)(this,function(n){switch(n.label){case 0:if(!e)return[2];n.label=1;case 1:return n.trys.push([1,,3,4]),s(!0),[4,r.run({query:e,connectionString:t})];case 2:return a(n.sent()),[3,4];case 3:return s(!1),[7];case 4:return[2]}})}),function(){return n.apply(this,arguments)}),[t,r,e]);return O.useEffect(function(){u()},[t,r,e,u]),{data:o,loading:c,refetch:u}},n9=function(e){var t=e.rows,n=e.columns;return!Array.isArray(t)||t.length<1?null:{headerColumns:null!=n?n:[],bodyData:t.map(function(e){return Object.values(e)})}},n7=function(e){return n6("SELECT n.nspname as \"Schema\",\n  c.relname as \"Name\",\n  CASE c.relkind WHEN 'r' THEN 'table' WHEN 'v' THEN 'view' WHEN 'm' THEN 'materialized view' WHEN 'i' THEN 'index' WHEN 'S' THEN 'sequence' WHEN 's' THEN 'special' WHEN 'f' THEN 'foreign table' WHEN 'p' THEN 'partitioned table' WHEN 'I' THEN 'partitioned index' END as \"Type\",\n  pg_catalog.pg_get_userbyid(c.relowner) as \"Owner\",\n  pg_catalog.pg_size_pretty(pg_catalog.pg_total_relation_size(c.oid)) as \"Size\",\n  pg_catalog.obj_description(c.oid, 'pg_class') as \"Description\"\nFROM pg_catalog.pg_class c\n     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace\nWHERE c.relkind IN ('r','p','v','m','S','f','')\n      AND n.nspname <> 'pg_catalog'\n      AND n.nspname <> 'information_schema'\n      AND n.nspname !~ '^pg_toast'\n  AND pg_catalog.pg_table_is_visible(c.oid)\nORDER BY 1,2;",e.connectionString)},re=(0,eI.cn)(void 0),rt=(0,eI.cn)(function(e){var t=e(re);return null==t?void 0:t.rows.reduce(function(e,t){var n=t.table_name,r=t.column_name;return e[n]||(e[n]=[]),e[n].push(r),e},{})}),rn=function(e){var t=n6("SELECT table_name, column_name, data_type FROM information_schema.columns WHERE table_schema = 'public';",e.connectionString).data,n=(0,eD.b9)(re);O.useEffect(function(){n(t)},[t,n])},rr=function(e){var t=e.tableName,n=e.connectionString;return n6("SELECT table_name, column_name, data_type FROM information_schema.columns WHERE table_schema = 'public' AND table_name = '".concat(t.replace(/"/g,'""'),"';"),n).data},ri=n(80711),ro=n(40102),ra=function(e){var t=e.headerTitle,n=e.onGoBack,r=e.children;return(0,N.BX)($.G,{css:[Y.l0.flex.column,Y.l0.height("100%")],children:[(0,N.BX)($.G,{css:[Y.l0.flex.row,Y.l0.py(16),Y.l0.px(8),Y.l0.align.center],children:[(0,N.tZ)(e_.hU,{alt:"Go back",size:28,type:"button",onClick:n,children:(0,N.tZ)(ro.Z,{})}),(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(16),Y.l0.ml(8)],multiline:!1,children:t})]}),(0,N.tZ)($.G,{css:[Y.l0.overflow("auto"),Y.l0.height("calc(100% - 60px)")],children:r})]})},rl=n(59868),rc=function(e){(0,rl.j)(rl.U3.DATABASE_USED,(0,eU._)({type:"PostgreSQL",provider:"neon"},e))},rs=(0,eI.cn)(["databaseManager"]),ru=(0,eI.cn)(null,function(e,t,n){var r=e(rs);t(rs,(0,ex._)(r).concat([n])),rc({action:"pageNav",databasePage:n})}),rd=(0,eI.cn)(null,function(e,t){var n=e(rs);t(rs,n.slice(0,n.length-1))}),rf=(0,eI.cn)(function(e){var t=e(rs);return t[t.length-1]}),rh=function(){return(0,eD.Dv)(rf)},rp=function(){return(0,eD.b9)(ru)},rm=function(){return(0,eD.b9)(rd)},rv=n(18561),rg=n(40688),ry=(0,eI.cn)(""),rb=(0,eI.cn)(null),rZ=(0,eI.cn)(null,function(e,t,n){var r=n.query;r&&t(ry,r);var i=e(rb);i&&i.dispatch({changes:{from:0,to:i.state.doc.length,insert:r}})}),rw=n(30911),rx=n.n(rw),rC=n(92153),r_=(0,n(15859).O4)("replDatabasesQueryHistory",[]),rk=function(e,t){return!e.isPinned&&t.isPinned?1:e.isPinned&&!t.isPinned?-1:"number"==typeof e.pinnedTimestamp&&"number"==typeof t.pinnedTimestamp?e.pinnedTimestamp-t.pinnedTimestamp:t.timestamp-e.timestamp},rS=function(e,t){var n=e.findIndex(function(e){return!e.isPinned&&e.data===t.data});-1!==n?e.splice(n,1,t):e.push(t),e.sort(rk);var r=e.filter(function(e){return!e.isPinned}).length;if(r>=5){var i=r-5;e.splice(e.length-i,i)}},rE=n(62299),rT=n(50639),rR=n(20142),rI=n(81013),rD=n(54472),rG=n(75023),rB=n(29457),rP=function(e){var t=e.id,n=e.data,r=e.isPinned,i=(0,eG.lV)(O.useCallback(function(e,n){var r=e(r_).find(function(e){return e.id===t}),i=(null==r?void 0:r.data)||"";i&&(n(rZ,{query:i}),rc({action:"queryHistoryItemSelected"}))},[t])),o=(0,eG.lV)(O.useCallback(function(e,n){var r=e(r_);n(r_,(0,rC.ZP)(r,function(e){var n=e.find(function(e){return e.id===t});n&&(n.isPinned=!n.isPinned,n.isPinned?n.pinnedTimestamp=Date.now():n.pinnedTimestamp=void 0),e.sort(rk)})),rc({action:"queryHistoryItemPinned"})},[t]));return(0,N.BX)($.G,{css:[{borderTop:"1px solid ".concat(Y.TV.outlineDefault),":hover":{background:Y.TV.backgroundHigher}},Y.l0.flex.row,Y.l0.p(8),Y.l0.color.foregroundDimmer,Y.l0.align.center,Y.l0.cursor.pointer],onClick:i,children:[(0,N.tZ)(J.xv,{css:[Y.l0.flex.growAndShrink(1)],multiline:!1,children:n}),(0,N.tZ)(e_.hU,{alt:"Pin query",onClick:o,children:r?(0,N.tZ)(rT.Z,{fill:Y.TV.accentPrimaryDefault}):(0,N.tZ)(rg.Z,{})})]})},rA=function(e){var t=e.onExpand,n=(0,eD.Dv)(r_);return(0,N.tZ)(ne.Q,{onClick:t,headerContent:(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.p(2)],children:[(0,N.tZ)(ri.Z,{}),(0,N.tZ)(J.xv,{css:[Y.l0.color.foregroundDimmest],multiline:!1,children:"Query History"})]}),children:(0,N.tZ)($.G,{css:[Y.l0.colWithGap(8),Y.l0.height("100%")],children:0===n.length?(0,N.tZ)($.G,{css:[Y.l0.p(8)],children:(0,N.tZ)(J.xv,{css:[Y.l0.color.foregroundDimmer],multiline:!1,children:"No query history"})}):(0,N.tZ)($.G,{children:n.map(function(e){return(0,N.tZ)(rP,(0,eU._)({},e),e.id)})})})})},rN=new rB.R(function(){return(0,nL.W$)((0,rD.VV)((0,N.tZ)("div",{css:[{fontFamily:Y.TV.fontFamilyCode},Y.l0.color.foregroundDimmest],children:"Type PostgreSQL queries here to use the database."})))}),rU=new rG.j(function(e){return nX.Wl.high((0,nO.sql)((0,eU._)({dialect:nO.PostgreSQL},e)))}),rL=function(e){var t=e.queryResult,n=e.scrollRef;if(null==t?void 0:t.error)return(0,N.tZ)($.G,{css:Y.l0.px(8),children:(0,N.tZ)(J.xv,{css:[Y.l0.color.accentNegativeDefault],children:null==t?void 0:t.error})});if(!(null==t?void 0:t.rows))return null;var r=n9(t);if(!r)return(0,N.tZ)($.G,{css:Y.l0.px(8),children:(0,N.tZ)(J.xv,{css:[Y.l0.color.accentPositiveDefault],children:"Query successful, no rows returned"})});var i=r.headerColumns,o=r.bodyData;return(0,N.tZ)($.G,{css:Y.l0.px(8),children:(0,N.tZ)(n5,{headerColumns:i,bodyData:o,scrollRef:n})})},rO=(0,nr.iv)([Y.l0.height("100%"),Y.l0.position.relative,Y.l0.overflow("auto")]),rX=(0,nr.iv)([Y.l0.position.sticky,Y.l0.top(0),Y.l0.left(0),Y.l0.zIndex(1),Y.l0.backgroundColor.backgroundDefault]),rM=function(e){var t=e.connectionString,n=(0,L._)((0,eD.KO)(ry),2),r=n[0],i=n[1],o=(0,rI.Z)(),a=o.ref,l=o.view,c=(0,L._)(O.useState(!1),2),s=c[0],u=c[1];O.useEffect(function(){return function(){var e;i(null!==(e=null==l?void 0:l.state.doc.toString())&&void 0!==e?e:"")}},[i,null==l?void 0:l.state.doc]);var d=(0,eD.b9)(rb);O.useEffect(function(){d(l)},[d,l]),rn({connectionString:t});var f=(0,eD.Dv)(rt);(0,rE.Z)({view:l,filePath:"mark.sql"});var h=(0,H.Z)().psql,p=(0,L._)(O.useState(),2),m=p[0],v=p[1],g=(0,L._)(O.useState(!1),2),y=g[0],b=g[1],Z=(0,eG.lV)(O.useCallback(function(e,t,n){if(n){var r={id:rx()(),data:n,timestamp:Date.now()},i=e(r_);t(r_,(0,rC.ZP)(i,function(e){rS(e,r)}))}},[])),w=O.useCallback(function(){function e(){return(e=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:if(!l)return[2];n.label=1;case 1:return n.trys.push([1,,3,4]),b(!0),Z(e=null==l?void 0:l.state.doc.toString()),[4,h.run({query:e,connectionString:t})];case 2:return v(n.sent()),rc({action:"queryRan"}),[3,4];case 3:return b(!1),[7];case 4:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[t,h,Z,l]),x=rp(),C=O.useCallback(function(){x("databaseManager")},[x]),_=O.useCallback(function(){x("tableSchemas")},[x]),k=O.useRef(null),S=rU.use({schema:f});return(0,N.tZ)(ra,{headerTitle:"Database Contents",onGoBack:C,children:(0,N.BX)($.G,{css:[Y.l0.colWithGap(8),rO],innerRef:k,children:[(0,N.BX)($.G,{css:[Y.l0.colWithGap(8),Y.l0.px(8),Y.l0.pb(8),s?null:rX],children:[(0,N.BX)($.G,{css:[{border:"1px solid ".concat(Y.TV.outlineDefault)},Y.l0.borderRadius(2)],children:[(0,N.tZ)(rR.ZP,{ref:a,css:[Y.l0.viewStyle,Y.l0.backgroundColor.backgroundDefault,Y.l0.borderRadius(8),Y.l0.overflow("auto"),Y.l0.maxHeight(300),{".cm-panel":{zIndex:1}}],initialDoc:r,extensions:[rN,S]}),(0,N.tZ)(rA,{expanded:s,onExpand:function(){u(function(e){return!e})}})]}),(0,N.tZ)(eW.zx,{text:"Run Query",iconLeft:y?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(nU.Z,{}),onClick:w,disabled:y})]}),(0,N.tZ)(rL,{queryResult:m,scrollRef:k}),(0,N.tZ)($.G,{css:[Y.l0.colWithGap(8),Y.l0.px(8),Y.l0.py(8)],children:(0,N.tZ)(eW.zx,{css:Y.l0.backgroundColor.backgroundDefault,text:"Show All Contents",iconLeft:(0,N.tZ)(rv.Z,{}),onClick:_})})]})})},rF=n(48728),rW=n(28268),rH=n(41500),rV=n(10981),rz="DATABASE_URL",rj="PGDATABASE",rq="PGHOST",rY="PGPORT",r$="5432",rJ="PGUSER",rK="PGPASSWORD",rQ=function(e){var t=e.envVarKey,n=e.envVarValue,r=e.isSecret,i=(0,rV.U)()("db-env-var-".concat(t)),o=(0,L._)(O.useState(!1),2),a=o[0],l=o[1];return(0,N.BX)($.G,{css:[Y.l0.flex.row,Y.l0.flex.wrap,Y.l0.align.end,Y.l0.pb(8),{gap:Y.TV.space8}],children:[(0,N.BX)($.G,{css:[Y.l0.colWithGap(8),{flexBasis:250},Y.l0.flex.grow(0),Y.l0.flex.shrink(1)],children:[(0,N.tZ)("label",{css:Y.l0.color.foregroundDimmer,htmlFor:i,children:t}),(0,N.tZ)(tF.II,{id:i,type:!r||a?"text":"password",readOnly:!0,value:n})]}),(0,N.tZ)(eW.zx,{text:"Copy",iconLeft:(0,N.tZ)(rF.Z,{}),onClick:function(){(0,tz.Z)(n),rc({action:"envVarCopied",envVarKey:t,envVarType:"value"})}}),r?(0,N.tZ)(eW.zx,{text:"View",iconLeft:(0,N.tZ)(F.Z,{}),onClick:function(){return l(function(e){return!e})}}):null]})},r0=function(e){var t,n=e.connectionString,r=e.databaseName,i=new URL(n.replace("postgres://","https://")),o=i.host,a=i.username,l=i.password;return t={},(0,U._)(t,rz,n),(0,U._)(t,rj,r),(0,U._)(t,rq,o),(0,U._)(t,rY,r$),(0,U._)(t,rJ,a),(0,U._)(t,rK,l),t},r1=function(){var e=(0,H.Z)().fs;return O.useCallback(function(t){var n=r0({connectionString:t.connectionString,databaseName:t.databaseName});function r(){return(r=(0,eO._)(function(){var t,r,i,o,a,l,c,s,u,d,f,h,p,m;return(0,eX.Jh)(this,function(v){switch(v.label){case 0:return[4,e.readFile(".env")];case 1:if(t=v.sent(),r="",t.error){if(t.error===er.Df.NotFound)r="";else throw Error("Error getting .env")}else r=t.content;i=rW.Z.parse(r.toString()),o=!1,a=(0,eU._)({},i),l=!0,c=!1,s=void 0;try{for(u=Object.entries(n)[Symbol.iterator]();!(l=(d=u.next()).done);l=!0)h=(f=(0,L._)(d.value,2))[0],p=f[1],a[h]!==p&&(o=!0,a[h]=p)}catch(e){c=!0,s=e}finally{try{l||null==u.return||u.return()}finally{if(c)throw s}}if(!o)return[2];return m=rW.Z.serialize(a),[4,e.writeFile(".env",rH.Z.from(m))];case 2:return v.sent(),[2]}})})).apply(this,arguments)}!function(){r.apply(this,arguments)}()},[e])},r2=function(e){var t=e.connectionString,n=e.databaseName,r=(0,tk.Z)(function(){return r0({connectionString:t,databaseName:n})},[t,n]),i=r[rq],o=r[rJ],a=r[rK],l=r1();return O.useEffect(function(){l({connectionString:t,databaseName:n})},[t,n,l]),(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[(0,N.tZ)(rQ,{envVarKey:rz,envVarValue:t,isSecret:!0}),(0,N.tZ)(rQ,{envVarKey:rj,envVarValue:n}),(0,N.tZ)(rQ,{envVarKey:rq,envVarValue:i}),(0,N.tZ)(rQ,{envVarKey:rY,envVarValue:r$}),(0,N.tZ)(rQ,{envVarKey:rJ,envVarValue:o}),(0,N.tZ)(rQ,{envVarKey:rK,envVarValue:a,isSecret:!0})]})},r8=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r4=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];function r3(e,t){var n,r=t||{},i=r.signed,o=r.digitsNumber,a=r.isKib,l=r.isKibNotation;if(n=void 0!==i&&i?e<0?"-":"+":"",0===e)return"".concat(n,"0B");var c=void 0===a||a?1024:1e3,s=Math.floor(Math.log(Math.abs(e))/Math.log(c));return"".concat(n).concat(parseFloat(Math.abs(e/Math.pow(c,s)).toFixed(void 0===o?2:o))).concat((void 0!==l&&l?r8:r4)[s])}var r5=n(97615);function r6(e){var t=e.title,n=e.doWarnAtom,r=e.inactive,i=(0,eD.Dv)(n);return(0,N.BX)($.G,{css:[Y.l0.rowWithGap(4),Y.l0.align.center],children:[(0,N.tZ)(J.xv,{variant:"small",css:Y.l0.color.foregroundDimmer,multiline:!1,children:void 0!==r&&r?t+" last run":t}),i?(0,N.tZ)(eV.Z,{color:Y.TV.orangeStronger}):null]})}function r9(e){var t=e.title,n=e.totalAtom,r=e.currentAtom,i=e.countAtom,o=e.measure,a=e.limitText,l=e.inactive,c=void 0!==l&&l,s=(0,tk.Z)(function(){return(0,eI.cn)(function(e){return ie(e(r),e(n))})},[r,n]),u=(0,tk.Z)(function(){return(0,eI.cn)(function(e){var t,l,c,u;return a||(t=e(s),l=e(r),c=e(n),u=i&&e(i),"empty"===t||void 0===l?void 0:"vCPU"===o?it(100*Math.min(1,l/c))+"% of "+u+" vCPUs":it(l).toLocaleString()+"/"+it(c).toLocaleString()+" "+o)})},[a,s,r,n,i,o]),d=(0,tk.Z)(function(){return(0,eI.cn)(function(e){var t=e(s);return"At limit"===t||"Close to limit"===t})},[s]);return(0,N.BX)($.G,{css:[Y.l0.colWithGap(4),Y.l0.flex.growAndShrink(2),{flexBasis:32}],children:[t?(0,N.tZ)(r6,{title:t,doWarnAtom:d,inactive:c}):null,(0,N.tZ)(r7,{currentAtom:r,totalAtom:n,inactive:c,limitTextAtom:u,mini:!0})]})}function r7(e){var t=e.currentAtom,n=e.totalAtom,r=e.limitTextAtom,i=e.inactive,o=e.mini,a=(0,eD.Dv)(n),l=(0,eD.Dv)(t),c=(0,eD.Dv)(r),s=function(e){switch(e){case"empty":case"fine":default:return;case"At limit":return Y.TV.accentNegativeDefault;case"Close to limit":return Y.TV.orangeDefault}}(ie(l,a));return(0,N.tZ)(ni.J,{css:o&&Y.l0.height(8),total:a,current:l,color:s,disabled:i,tooltip:c})}function ie(e,t){if(void 0===e)return"empty";var n=e/t;return n>=1?"At limit":n>=.9?"Close to limit":"fine"}function it(e){return Math.round((e+Number.EPSILON)*100)/100}var ir=n(73722),ii=function(e){var t=e.tableData,n=e.scrollRef,r=t.headerColumns,i=t.bodyData,o=rp(),a=O.useCallback(function(e){var t=parseInt(String(e),10);if(!isNaN(t)){var n=i[t][r.indexOf("Name")];o("table/".concat(n))}},[o,r,i]);return(0,N.tZ)(n5,{headerColumns:r,bodyData:i,onRowAction:a,scrollRef:n})},io=function(e){var t=e.psqlQueryResult,n=e.scrollRef,r=t.data;if(t.loading)return(0,N.tZ)($.G,{css:[Y.l0.flex.row,Y.l0.justify.center,Y.l0.p(32)],children:(0,N.tZ)(eE.Z,{})});if(null==r?void 0:r.error)return(0,N.tZ)($.G,{css:[Y.l0.flex.row,Y.l0.justify.center,Y.l0.p(32)],children:(0,N.tZ)(J.xv,{css:[Y.l0.color.accentNegativeDefault,Y.l0.maxWidth("100%")],children:null==r?void 0:r.error})});var i=r?n9(r):null;return i?(0,N.tZ)(ii,{tableData:i,scrollRef:n}):(0,N.tZ)($.G,{css:[Y.l0.flex.row,Y.l0.justify.center,Y.l0.p(32)],children:(0,N.tZ)(J.xv,{css:[Y.l0.color.accentPositiveDefault,Y.l0.maxWidth("100%")],children:"No tables found"})})},ia=function(e){var t=e.connectionString,n=rm(),r=O.useRef(null),i=n7({connectionString:t}),o=i.refetch;return(0,N.BX)($.G,{css:[Y.l0.flex.column,Y.l0.height("100%")],children:[(0,N.BX)($.G,{css:[Y.l0.flex.row,Y.l0.py(16),Y.l0.px(8),Y.l0.align.center],children:[(0,N.tZ)(e_.hU,{alt:"Go back",size:28,type:"button",onClick:n,children:(0,N.tZ)(ro.Z,{})}),(0,N.tZ)($.G,{css:[Y.l0.flex.growAndShrink(1)],children:(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(16),Y.l0.ml(8)],multiline:!1,children:"All tables"})}),(0,N.tZ)(e_.hU,{alt:"Refresh",size:24,type:"button",onClick:o,children:(0,N.tZ)(ir.Z,{})})]}),(0,N.tZ)($.G,{css:[Y.l0.flex.growAndShrink(1),Y.l0.overflow("auto"),Y.l0.px(8)],innerRef:r,children:(0,N.tZ)(io,{psqlQueryResult:i,scrollRef:r})})]})},il="1px solid "+Y.TV.outlineDefault,ic=(0,nr.iv)([Y.l0.p(8),Y.l0.backgroundColor.backgroundDefault,Y.l0.align.center,Y.l0.borderRadius(0),{borderLeft:il,borderRight:il,borderBottom:il},{":not([disabled])":{":focus":{boxShadow:"none",outline:"2px solid ".concat(Y.TV.accentPrimaryDefault),outlineOffset:"-2px"},":hover":{backgroundColor:Y.TV.backgroundHigher}}}]),is=function(e){var t=n7({connectionString:e.connectionString}),n=t.data,r=t.loading,i=(0,L._)(O.useState(!1),2),o=i[0],a=i[1],l=O.useCallback(function(){a(!0)},[]),c=n?n9(n):null,s=O.useRef(null);if(!c||r)return null;var u=c.bodyData.length,d=c.headerColumns,f=c.bodyData;return(0,N.tZ)(N.HY,{children:(0,N.BX)($.G,{css:[Y.l0.overflow("auto"),Y.l0.display.grid],innerRef:s,children:[(0,N.tZ)(ii,{tableData:{headerColumns:d,bodyData:o?f:f.slice(0,5)},scrollRef:s}),u-5>0&&!o?(0,N.tZ)(eW.zx,{text:"".concat(u-5," more"),css:ic,onClick:l}):null]})})},iu=n(40699),id=iu.z4["neon-database-preview"],ih=(0,iu.qJ)(id),ip="".concat(id.toLocaleString()," Cycles (").concat(ih,") / day"),im="https://docs.replit.com/hosting/databases/postgresql-on-replit",iv="https://docs.replit.com/hosting/about-usage-based-billing#1-postgresql-usage-metrics",ig=n(36010),iy=n.n(ig),ib=function(e){var t=e.dbSize,n=e.totalSize,r=r3(t),i=r3(n),o=(0,tk.Z)(function(){return(0,eI.cn)(t)},[t]),a=(0,tk.Z)(function(){return(0,eI.cn)(n)},[n]);return(0,N.BX)(N.HY,{children:[(0,N.BX)(J.xv,{css:Y.l0.color.foregroundDimmer,multiline:!1,children:[r,"/",i]}),(0,N.tZ)(r9,{totalAtom:a,currentAtom:o,limitText:"".concat(r," / ").concat(i),inactive:!1,measure:"MB"})]})},iZ=function(e){var t,n,r=e.connectionString,i=n6("SELECT sum(pg_database_size(datname)) FROM pg_database;",r),o=i.data,a=i.loading,l=n6("SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' ORDER BY table_name;",r),c=l.data,s=l.loading,u=parseInt(null!==(n=null==o?void 0:null===(t=o.rows[0])||void 0===t?void 0:t.sum)&&void 0!==n?n:"0",10),d=null==c?void 0:c.rows.length;return(0,N.BX)($.G,{css:Y.l0.rowWithGap(8),children:[s?null:(0,N.BX)(J.xv,{multiline:!1,children:[d," ",1===d?"table":"tables"]}),a?null:(0,N.tZ)(ib,{dbSize:u,totalSize:10737418240})]})},iw=function(e){var t=e.connectionString,n=e.onOpenDatabaseViewerClick,r=e.showUsageLink;return(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[(0,N.BX)($.G,{children:[(0,N.tZ)(iZ,{connectionString:t}),r?(0,N.tZ)(iy(),{legacyBehavior:!0,href:"/account#resource-usage",passHref:!0,children:(0,N.tZ)("a",{css:Y.l0.hover(Y.l0.color.accentPrimaryStrongest),children:(0,N.tZ)(J.xv,{children:"See all usage"})})}):null]}),(0,N.tZ)(is,{connectionString:t}),(0,N.tZ)(eW.zx,{text:"See Database Contents",iconLeft:(0,N.tZ)(rv.Z,{}),onClick:n})]})};n(26);var ix=function(e){var t=e.size;return(0,N.BX)("svg",{viewBox:"0 0 128 36",preserveAspectRatio:"xMidYMin",height:void 0===t?16:t,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,N.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"#12FFF7"}),(0,N.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"url(#a)"}),(0,N.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"url(#b)"}),(0,N.tZ)("path",{d:"M29.793 0A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36a.62.62 0 0 0 .62-.62v-19.2c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V1.241C31.035.556 30.479 0 29.793 0Z",fill:"#B9FFB3"}),(0,N.tZ)("path",{d:"M60.686 10.6v9.416l-9.13-9.416h-4.752V26h4.334V15.88L61.082 26h3.938V10.6h-4.334ZM73.054 22.568V19.84h9.702v-3.278h-9.702v-2.53h11.77V10.6H68.632V26h16.434v-3.432H73.054ZM96.583 26.506c6.094 0 10.054-2.992 10.054-8.206 0-5.214-3.96-8.206-10.054-8.206S86.551 13.086 86.551 18.3c0 5.214 3.938 8.206 10.032 8.206Zm0-3.652c-3.388 0-5.478-1.65-5.478-4.554 0-2.904 2.112-4.554 5.478-4.554 3.388 0 5.478 1.65 5.478 4.554 0 2.904-2.09 4.554-5.478 4.554ZM123.249 10.6v9.416l-9.13-9.416h-4.752V26h4.334V15.88L123.645 26h3.938V10.6h-4.334Z",fill:"currentColor"}),(0,N.BX)("defs",{children:[(0,N.BX)("linearGradient",{id:"a",x1:"36",y1:"36",x2:"4.345",y2:"0",gradientUnits:"userSpaceOnUse",children:[(0,N.tZ)("stop",{stopColor:"#B9FFB3"}),(0,N.tZ)("stop",{offset:"1",stopColor:"#B9FFB3",stopOpacity:"0"})]}),(0,N.BX)("linearGradient",{id:"b",x1:"36",y1:"36",x2:"14.617",y2:"27.683",gradientUnits:"userSpaceOnUse",children:[(0,N.tZ)("stop",{stopColor:"#1A1A1A",stopOpacity:".9"}),(0,N.tZ)("stop",{offset:"1",stopColor:"#1A1A1A",stopOpacity:"0"})]})]})]})},iC=(0,nr.iv)([Y.l0.color.foregroundDimmest,{textDecoration:"underline"}]),i_=function(){return(0,N.tZ)($.G,{css:[Y.l0.colWithGap(8),Y.l0.py(8),Y.l0.width("100%")],children:(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.justify.spaceBetween],children:[(0,N.tZ)("a",{target:"_blank",href:im,css:iC,children:"Docs"}),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:[(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(14)],multiline:!1,children:"Powered by"}),(0,N.tZ)(ix,{})]})]})})},ik=function(e){var t=e.psqlQueryResult,n=e.tableName,r=e.connectionString,i=e.scrollRef,o=t.data,a=t.loading,l=rr({tableName:n,connectionString:r});if(a)return(0,N.tZ)($.G,{css:[Y.l0.flex.row,Y.l0.justify.center,Y.l0.p(32)],children:(0,N.tZ)(eE.Z,{})});if(null==o?void 0:o.error)return(0,N.tZ)($.G,{css:[Y.l0.flex.row,Y.l0.justify.center,Y.l0.p(32)],children:(0,N.tZ)(J.xv,{css:[Y.l0.color.accentNegativeDefault,Y.l0.maxWidth("100%")],children:null==o?void 0:o.error})});var c=o?n9(o):null;if(!c)return(0,N.tZ)($.G,{css:[Y.l0.flex.row,Y.l0.justify.center,Y.l0.p(32)],children:(0,N.tZ)(J.xv,{css:[Y.l0.color.accentPositiveDefault,Y.l0.maxWidth("100%")],children:"No rows"})});var s=c.headerColumns,u=c.bodyData;return(0,N.tZ)(n5,{headerColumns:s.map(function(e,t){var n,r=null==l?void 0:null===(n=l.rows)||void 0===n?void 0:n.find(function(t){return t.column_name===e}),i=null==r?void 0:r.data_type,o=i?(0,N.tZ)(tr.D,{text:i}):null;return(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:[(0,N.tZ)(J.xv,{multiline:!1,children:e}),o]},t)}),bodyData:u,scrollRef:i})},iS=function(e){var t=e.tableName,n=e.connectionString,r=rm(),i=O.useRef(null),o=n6('SELECT * FROM "'.concat(t.replace(/"/g,'""'),'" LIMIT ').concat(500),n),a=o.refetch;return(0,N.BX)($.G,{css:[Y.l0.flex.column,Y.l0.height("100%")],children:[(0,N.BX)($.G,{css:[Y.l0.flex.row,Y.l0.py(16),Y.l0.px(8),Y.l0.align.center],children:[(0,N.tZ)(e_.hU,{alt:"Go back",size:28,type:"button",onClick:r,children:(0,N.tZ)(ro.Z,{})}),(0,N.tZ)($.G,{css:[Y.l0.flex.growAndShrink(1)],children:(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(16),Y.l0.ml(8)],multiline:!1,children:t})}),(0,N.tZ)(e_.hU,{alt:"Refresh",size:24,type:"button",onClick:a,children:(0,N.tZ)(ir.Z,{})})]}),(0,N.tZ)($.G,{css:[Y.l0.flex.growAndShrink(1),Y.l0.overflow("auto"),Y.l0.px(8)],innerRef:i,children:(0,N.tZ)(ik,{psqlQueryResult:o,tableName:t,connectionString:n,scrollRef:i})})]})},iE=n(63999),iT=n(68333),iR="\nPostgreSQL is a powerful open source relational database system that is widely used in web applications and other software development projects. You can easily create a production-ready PostgreSQL database directly within Replit. For more information on PostgreSQL, visit the [official documentation](https://www.postgresql.org/docs/). Repls use PostgreSQL version 15.\n\nHere is some information to help you get started:\n\n1. Replit databases are backed by [Neon](https://neon.tech/). The [Neon documentation](https://neon.tech/docs/connect/connect-from-any-app#connection-examples) provides guides on how to connect various frameworks, such as Django, to your PostgreSQL database.\n\n1. Environment Variables: We provided environment variables `DATABASE_URL`, `PGDATABASE`, `PGHOST`, `PGHOST`, `PGPORT`, `PGUSER`, `PGPASSWORD`. Provide these values to your framework of choice to connect to your database.\n\n1. Connection pooling: If you need to enable connection pooling for any reason, contact us at support@repl.it.\n\n1. Compute lifecycle: Neon databases go to sleep after 5 minutes of inactivity. You may experience disconnects or reconnects depending on your client.\n",iI=(0,eI.cn)(null),iD=(0,eI.cn)(null),iG=function(){return(0,eD.Dv)(iD)},iB=function(){var e=(0,eD.b9)(iI),t=(0,eD.b9)(iD);return(0,O.useCallback)(function(n){if(!n){e(null),t(null);return}e({connectionString:n,databaseId:-1,databaseName:"Admin Override",isFrozen:!1,projectId:"mock-project-id-does-not-exist",__typename:"NeonDatabase",isBackedByCycles:!0}),t(n)},[t,e])},iP=function(e){var t=e.title,n=e.children,r=e.isAccordion,i=e.sectionStyles;return(0,N.tZ)($.G,{css:[Y.l0.colWithGap(8),Y.l0.pt(8),{borderTopWidth:1,borderTopStyle:"solid",borderTopColor:Y.TV.outlineDefault},i],children:r?(0,N.tZ)(ne.Q,{headerContent:(0,N.tZ)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:t})}),children:(0,N.tZ)($.G,{css:[Y.l0.p(12),Y.l0.colWithGap(8),Y.l0.height("100%")],children:n})}):(0,N.BX)(N.HY,{children:[(0,N.tZ)(J.xv,{multiline:!1,css:[Y.l0.fontSize(Y.TV.fontSizeSubheadDefault),Y.l0.fontWeight.medium],children:t}),n]})})},iA=n(25425),iN=n(66587),iU=n(55330),iL=n(2038),iO=n(81340),iX=n(49344),iM=n(76566),iF=n(50946),iW=n(4773),iH=n(63623);function iV(){var e=(0,ns._)(["\n  query DatabaseFrozen {\n    currentUser {\n      id\n      userSubscriptionType\n      ...CurrentUserUsageBasedBillingSummary\n    }\n  }\n  ","\n"]);return iV=function(){return e},e}var iz={},ij=(0,nu.Ps)(iV(),iH.eD),iq=n(75582),iY=n(49932),i$=(0,K.X)({self:[],title:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.color.foregroundDimmest],status:[Y.l0.width(8),Y.l0.height(8),Y.l0.backgroundColor.foregroundDimmer,Y.l0.borderRadius("full")],main:[Y.l0.colWithGap(8),Y.l0.align.center],icon:Y.l0.mt(32),subTitle:Y.l0.my(16),cta:[Y.l0.width("100%"),Y.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[Y.l0.colWithGap(8),Y.l0.align.center],ctaStatusBanner:[Y.l0.textAlign.left],budgetContainer:[Y.l0.colWithGap(8),Y.l0.border(),Y.l0.borderRadius(8),Y.l0.p(8)]});function iJ(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnUnpause,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,l=e.showPaymentMethodForm,c=e.setShowSupportForm,s=(0,iL.rv)();return n===iq.Fp.NeedsSubscription||n===iq.Fp.NeedsSubscriptionOrPaymentMethod?s?(0,N.tZ)(ej.E,{text:"You need a subscription to use PostgreSQL databases. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:i$.ctaStatusBanner}):(0,N.BX)($.G,{css:i$.ctaContainer,children:[(0,N.tZ)(iW.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to unpause database",css:i$.cta,colorway:"primary",variant:"outlined",disabled:l,onPlanCheckoutComplete:o}),(0,N.tZ)(eW.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:i$.cta,disabled:l,loading:t,iconLeft:(0,N.tZ)(iF.Z,{}),onClick:function(){return a()}})]}):n===iq.Fp.NeedsSmsVerification?(0,N.tZ)(iN.Z,{context:iq.jv.Neon,onSuccess:o}):n===iq.Fp.NeedsPaymentMethod?s?(0,N.tZ)(ej.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:i$.ctaStatusBanner}):(0,N.tZ)(eW.zx,{colorway:"primary",text:"Add a payment method",css:i$.cta,disabled:l,loading:t,iconLeft:(0,N.tZ)(iF.Z,{}),onClick:function(){return a()}}):n===iq.Fp.NeedsUnbanning?(0,N.tZ)(iM.u,{text:"Your account currently has restrictions on use PostgreSQL databases. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:i$.ctaStatusBanner,onClick:function(){return c()}}):n===iq.Fp.InsufficientBudget?(0,N.BX)(N.HY,{children:[(0,N.tZ)(ej.E,{text:"You've reached your monthly usage budget. Increase your budget to unpause your database.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:i$.ctaStatusBanner}),(0,N.tZ)($.G,{css:i$.budgetContainer,children:(0,N.tZ)(iO.L,{onUpdateSuccess:o})})]}):(0,N.BX)(N.HY,{children:[(0,N.tZ)(eW.zx,{colorway:"primary",onClick:i,text:"Unpause database",loading:t,css:i$.cta}),!1===r?(0,N.tZ)(iM.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:i$.ctaStatusBanner,onClick:function(){return s?null:a()}}):null]})}function iK(e){var t,n,r=e.replId,i=e.neonProjectId,o=e.onDatabaseUnfreezed,a=(0,L._)(O.useState(!1),2),l=a[0],c=a[1],s=(0,L._)(O.useState(!1),2),u=s[0],d=s[1],f=(0,nN.Z)().showError,h=(t=(0,eU._)({},iz,{notifyOnNetworkStatusChange:!0,onError:function(e){f(e.message)}}),nd.a(ij,t)),p=h.loading,m=h.data,v=h.refetch,g=(0,L._)(nA({onError:function(e){f("Error when unfreezing Neon database: ".concat(e.message)),rc({action:"unfreeze",success:!1})},onCompleted:function(e){if((null==e?void 0:e.unfreezeNeonDatabase.__typename)!=="UnfreezeNeonDatabaseResult"){f("Error: Unfreezes Neon Database failed."),rc({action:"unfreeze",success:!1});return}(null==e?void 0:e.unfreezeNeonDatabase.success)?(o(),rc({action:"unfreeze",success:!0})):(f("Error: Unfreezes Neon Database failed."),rc({action:"unfreeze",success:!1}))}}),2),y=g[0],b=g[1].loading,Z=(null==m?void 0:null===(n=m.currentUser)||void 0===n?void 0:n.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?m.currentUser.usageBasedBilling.capabilities:null;return(0,N.BX)($.G,{css:i$.self,children:[(0,N.tZ)(iX.u,{isOpen:u,onRequestClose:function(){return d(!1)},children:(0,N.tZ)(iU.Z,{onRequestClose:function(){return d(!1)}})}),(0,N.BX)($.G,{css:i$.title,children:[(0,N.tZ)($.G,{css:i$.status}),(0,N.tZ)(J.xv,{css:[Y.l0.color.foregroundDimmest],multiline:!1,children:"Database paused"})]}),(0,N.BX)($.G,{css:i$.main,children:[(0,N.tZ)(ev.Z,{size:32,fill:iY.TV.foregroundDimmest,css:i$.icon}),(0,N.tZ)(J.xv,{variant:"subheadDefault",css:i$.subTitle,multiline:!1,children:"Your Database is paused."}),(0,N.tZ)(iJ,{loading:p||b,ubbExplanation:null==Z?void 0:Z.explanation,hasPaymentMethod:null==Z?void 0:Z.hasPaymentMethod,handleOnUnpause:function(){y({variables:{input:{replId:r,neonProjectId:i}}})},refetchUbbCapabilitiesQueryData:v,setShowPaymentMethodForm:function(){return c(!0)},showPaymentMethodForm:l,setShowSupportForm:function(){return d(!0)}})]})]})}var iQ=function(e){var t=e.cyclesLow;return(0,N.BX)(N.HY,{children:[(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(12),Y.l0.color.foregroundDimmest],children:"Youre paying ".concat(ip)}),t?(0,N.tZ)($.G,{children:(0,N.tZ)(ej.E,{icon:(0,N.tZ)(eV.Z,{}),colorway:"warning",text:"If your database use continues, you will be out of\n Cycles in [X] days and access to your database will be paused. \n Buy more Cycles or add a recurring Cycles subscription to prevent that from happening."})}):null]})},i0=n(99656),i1=n(51965),i2=n(47648),i8=n(60814),i4=n(15250),i3=n(22894);function i5(){var e=(0,ns._)(["\n  query DatabaseMigrator {\n    currentUser {\n      id\n      userSubscriptionType\n      ...CurrentUserUsageBasedBillingSummary\n    }\n  }\n  ","\n"]);return i5=function(){return e},e}function i6(){var e=(0,ns._)(["\n  mutation MigrateNeonDatabase($input: MigrateNeonDatabaseInput!) {\n    migrateNeonDatabase(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on MigrateNeonDatabaseResult {\n        databaseId\n        databaseName\n        projectId\n        connectionString\n        isFrozen\n        isBackedByCycles\n      }\n    }\n  }\n"]);return i6=function(){return e},e}var i9={},i7=(0,nu.Ps)(i5(),iH.eD),oe=(0,nu.Ps)(i6()),ot=n(97764),on=(0,K.X)({self:[Y.l0.mb(12)],container:[Y.l0.colWithGap(8)],message:[{"> div":[Y.l0.align.start,Y.l0.py(4)],span:[Y.l0.colWithGap(6)]}],messageBold:[Y.l0.fontWeight.bold],cta:[Y.l0.width("100%"),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[Y.l0.colWithGap(8),Y.l0.align.center],ctaStatusBanner:[Y.l0.textAlign.left],payment:[Y.l0.p(16),Y.l0.borderRadius(12),Y.l0.textAlign.left,Y.l0.shadow(2)],budgetContainer:[Y.l0.colWithGap(8),Y.l0.border(),Y.l0.borderRadius(8),Y.l0.p(8)],details:[Y.l0.colWithGap(12),Y.l0.maxWidth(400),{marginLeft:"auto",marginRight:"auto"}]});function or(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnMigrate,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,l=e.showPaymentMethodForm,c=e.setShowSupportForm,s=(0,iL.rv)();return n===iq.Fp.NeedsSubscription||n===iq.Fp.NeedsSubscriptionOrPaymentMethod?s?(0,N.tZ)(ej.E,{text:"You need a subscription to migrate a database. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:on.ctaStatusBanner}):(0,N.BX)($.G,{css:on.ctaContainer,children:[(0,N.tZ)(iW.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to migrate your database",css:on.cta,colorway:"primary",variant:"outlined",disabled:l,onPlanCheckoutComplete:o}),(0,N.tZ)(eW.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:on.cta,disabled:l,loading:t,iconLeft:(0,N.tZ)(iF.Z,{}),onClick:function(){return a()}})]}):n===iq.Fp.NeedsSmsVerification?(0,N.tZ)(iN.Z,{context:iq.jv.Neon,onSuccess:o}):n===iq.Fp.NeedsPaymentMethod?s?(0,N.tZ)(ej.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:on.ctaStatusBanner}):(0,N.tZ)(eW.zx,{colorway:"primary",text:"Add a payment method",css:on.cta,disabled:l,loading:t,iconLeft:(0,N.tZ)(iF.Z,{}),onClick:function(){return a()}}):n===iq.Fp.NeedsUnbanning?(0,N.tZ)(iM.u,{text:"Your account currently has restrictions on migrating a database. We're here to help! Please reach out to our support team for assistance.",colorway:"primary",icon:(0,N.tZ)(r5.Z,{}),css:on.ctaStatusBanner,onClick:function(){return c()}}):n===iq.Fp.InsufficientBudget?(0,N.BX)(N.HY,{children:[(0,N.tZ)(ej.E,{text:"You've reached your monthly usage budget. Increase your budget to migrate your database.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:on.ctaStatusBanner}),(0,N.tZ)($.G,{css:on.budgetContainer,children:(0,N.tZ)(iO.L,{onUpdateSuccess:o})})]}):(0,N.BX)(N.HY,{children:[(0,N.tZ)(eW.zx,{colorway:"primary",onClick:i,text:"Migrate database",loading:t,css:on.cta}),!1===r?(0,N.tZ)(iM.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:on.ctaStatusBanner,onClick:function(){return s?null:a()}}):null]})}var oi=function(e){var t,n,r,i=e.onDatabaseMigrated,o=(0,L._)(O.useState(!1),2),a=o[0],l=o[1],c=(0,L._)((0,O.useState)(!1),2),s=c[0],u=c[1],d=(0,nc.Z)(),f=(0,nN.Z)().showError,h=(t=(0,eU._)({},i9,{notifyOnNetworkStatusChange:!0,onError:function(e){f(e.message)}}),nd.a(i7,t)),p=h.loading,m=h.data,v=h.refetch,g=(0,L._)((n=(0,eU._)({},i9,{onError:function(e){f("Error when migrating Neon database: ".concat(e.message)),rc({action:"migrated",success:!1})},onCompleted:function(e){if("MigrateNeonDatabaseResult"===e.migrateNeonDatabase.__typename){var t=e.migrateNeonDatabase;i({__typename:"NeonDatabase",databaseId:t.databaseId,databaseName:t.databaseName,connectionString:t.connectionString,projectId:t.projectId,isFrozen:t.isFrozen,isBackedByCycles:t.isBackedByCycles}),rc({action:"migrated",success:!0})}else{f("Error: ".concat(e.migrateNeonDatabase.message)),rc({action:"migrated",success:!1});return}}}),nC.D(oe,n)),2),y=g[0],b=g[1].loading,Z=(null==m?void 0:null===(r=m.currentUser)||void 0===r?void 0:r.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?m.currentUser.usageBasedBilling.capabilities:null;return(0,N.BX)($.G,{css:on.self,children:[(0,N.tZ)(iX.u,{isOpen:s,onRequestClose:function(){return u(!1)},children:(0,N.tZ)(iU.Z,{onRequestClose:function(){return u(!1)}})}),(0,N.BX)($.G,{css:on.container,children:[(0,N.tZ)(ej.E,{css:on.message,icon:(0,N.tZ)(eV.Z,{}),text:(0,N.BX)(N.HY,{children:[(0,N.BX)("p",{children:[(0,N.tZ)("span",{css:on.messageBold,children:"Postgres databases are now included in plans!"})," ","Instead of paying $30/mo for a single database, our plans now have a base allotment for no extra cost. The base allotment is enough resources for most use cases. Users will only be charged for the resources they use beyond their allotment. Learn more."]}),(0,N.tZ)("p",{children:(0,N.tZ)("span",{css:on.messageBold,children:"On January 1st, 2024, all PostgreSQL databases that have not been migrated will be shut down."})}),(0,N.tZ)("p",{children:"To migrate, select one of the options below."})]}),colorway:"warning"}),(0,N.tZ)(or,{loading:p||b,ubbExplanation:null==Z?void 0:Z.explanation,hasPaymentMethod:null==Z?void 0:Z.hasPaymentMethod,handleOnMigrate:function(){y({variables:{input:{replId:d}}})},refetchUbbCapabilitiesQueryData:v,setShowPaymentMethodForm:function(){return l(!0)},showPaymentMethodForm:a,setShowSupportForm:function(){return u(!0)}}),a?(0,N.tZ)(eq.Tg,{elevated:!0,css:on.payment,children:(0,N.tZ)(ot.q,{onSuccess:(0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:return l(!1),[4,v()];case 1:return e.sent(),[2]}})}),context:"workspace_hosting_pane"})}):null]})]})},oo=n(57118),oa=n(23211),ol=function(e){var t,n=e.neonDatabases,r=e.onDatabaseDeleted,i=e.onDatabaseUnfreezed,o=e.onDatabaseMigrated,a=n[0],l=(0,nN.Z)().showError,c=(0,nc.Z)(),s=function(){var e=O.useContext(i3.Z);if(!e)throw Error("Expected Repl info to be in context");return e.slug}(),u=(0,iA.P5)({controlName:oa.uZ,logFlagToAnalytics:!0}),d=rh(),f=rp(),h=O.useCallback(function(){f("queryEditor")},[f]),p=(0,L._)(nG(),2),m=p[0],v=p[1].loading,g=O.useCallback(function(){k(!0)},[]),y=(0,i8.Z)({forceFetch:!1}),b=y.cycles,Z=y.formattedBalanceValue,w="number"==typeof b&&b>id,x=O.useCallback((0,eO._)(function(){var e,t,n;return(0,eX.Jh)(this,function(i){switch(i.label){case 0:return[4,m({variables:{input:{replId:c,databaseId:a.databaseId}}})];case 1:if(t=(e=i.sent()).data,n=e.errors,k(!1),n&&n.length>0)return l("Error when deleting Neon database: ".concat(null==n?void 0:n.join())),rc({action:"removed",success:!1}),[2];if((null==t?void 0:t.deleteNeonDatabase.__typename)!=="DeleteNeonDatabaseResult")return l("Error: ".concat(null==t?void 0:t.deleteNeonDatabase.message)),rc({action:"removed",success:!1}),[2];return(null==t?void 0:t.deleteNeonDatabase.success)?(r(),rc({action:"removed",success:!0})):(l("Error: Delete Neon Database failed."),rc({action:"removed",success:!1})),[2]}})}),[m,a.databaseId,r,c,l]),C=(0,L._)(O.useState(!1),2),_=C[0],k=C[1],S=O.useCallback(function(){k(!1)},[]),E=(0,L._)(O.useState(!1),2),T=E[0],R=E[1],I=O.useCallback(function(){R(!0)},[]),D=(0,L._)(nA(),2),G=D[0],B=D[1].loading,P=O.useCallback((0,eO._)(function(){var e,t,n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:return[4,G({variables:{input:{neonProjectId:a.projectId,replId:c}}})];case 1:if(t=(e=r.sent()).data,(n=e.errors)&&n.length>0)return l("Error when unfreezing Neon database: ".concat(null==n?void 0:n.join())),rc({action:"unfreeze",success:!1}),[2];if((null==t?void 0:t.unfreezeNeonDatabase.__typename)!=="UnfreezeNeonDatabaseResult")return l("Error: Unfreezes Neon Database failed."),rc({action:"unfreeze",success:!1}),[2];return(null==t?void 0:t.unfreezeNeonDatabase.success)?(i(),rc({action:"unfreeze",success:!0})):(l("Error: Unfreezes Neon Database failed."),rc({action:"unfreeze",success:!1})),[2]}})}),[a.projectId,i,c,l,G]),A=iG(),U=r0({connectionString:a.connectionString,databaseName:a.databaseName})[rq].split(".")[0],X=A||"".concat(a.connectionString,"/").concat(a.databaseName,"?sslmode=require&options=project%3D").concat(U);if("queryEditor"===d)return(0,N.tZ)(rM,{connectionString:X});if("tableSchemas"===d)return(0,N.tZ)(ia,{connectionString:X});if(d.startsWith("table/")){var M=d.slice(d.indexOf("/")+1);return(0,N.tZ)(iS,{tableName:M,connectionString:X})}return t=a.isFrozen?(0,N.BX)(N.HY,{children:[(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:[(0,N.tZ)($.G,{css:[Y.l0.width(8),Y.l0.height(8),Y.l0.backgroundColor.foregroundDimmer,Y.l0.borderRadius("full")]}),(0,N.tZ)(J.xv,{css:[Y.l0.color.foregroundDimmest],multiline:!1,children:"Database paused"})]}),(0,N.BX)(J.xv,{css:[Y.l0.fontSize(12),Y.l0.color.foregroundDimmest],children:["Databases cost ",ip]}),(0,N.BX)($.G,{css:[Y.l0.colWithGap(8),Y.l0.align.center],children:[(0,N.tZ)(ev.Z,{size:32,fill:Y.TV.foregroundDimmest,css:Y.l0.mt(32)}),(0,N.BX)(J.xv,{variant:"subheadDefault",css:[Y.l0.my(16)],multiline:!1,children:["Your Database is paused. You have ",Z," cycles."]}),(0,N.BX)(J.xv,{children:["Access to your databases will be paused until you"," ",w?"use cycles to resume database":"refill your Cycles balance","."]}),w?(0,N.tZ)(eW.zx,{css:Y.l0.pt(8),iconLeft:(0,N.tZ)(i4.Z,{}),onClick:P,disabled:B,text:"Unpause Database",colorway:"primary"}):null,(0,N.tZ)(eW.zx,{css:Y.l0.pt(8),iconLeft:(0,N.tZ)(i0.Z,{}),onClick:I,text:w?"Buy more cycles":"Buy Cycles"})]}),(0,N.tZ)(i2.Z,{noPadding:!0,isOpen:T,maxWidth:i1.W,onRequestClose:function(){return R(!1)},fitContent:!0,replTitle:s,uponPurchaseGoTo:"workspace",context:"workspace_postgresql_pane",initialTab:"cycles",allowCyclesPage:!0})]}):(0,N.BX)(N.HY,{children:[(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:[(0,N.tZ)($.G,{css:[Y.l0.width(8),Y.l0.height(8),Y.l0.backgroundColor.accentPositiveStronger,Y.l0.borderRadius("full"),{filter:"drop-shadow(0 0 6px ".concat(Y.TV.accentPositiveStronger,")")}]}),(0,N.tZ)(J.xv,{css:[Y.l0.color.accentPositiveStronger],multiline:!1,children:"Database connected"})]}),(0,N.tZ)(iQ,{}),(0,N.tZ)(iP,{title:"Database Info",children:(0,N.tZ)(iw,{connectionString:X,onOpenDatabaseViewerClick:h})}),(0,N.tZ)(iP,{title:"Using the database",isAccordion:!0,children:(0,N.tZ)(iT.ZP,{css:[iE.Z,Y.l0.maxWidth("100%")],children:iR})}),(0,N.tZ)(iP,{title:"Environment variables",isAccordion:!0,children:(0,N.tZ)(r2,{connectionString:X,databaseName:a.databaseName})})]}),(0,N.BX)($.G,{css:[Y.l0.colWithGap(0),Y.l0.height("100%"),Y.l0.p(8)],children:[u?(0,N.BX)($.G,{css:[Y.l0.mb(16)],children:[(0,N.tZ)(oi,{onDatabaseMigrated:o}),(0,N.tZ)(oo.iz,{})]}):null,(0,N.tZ)($.G,{css:[Y.l0.colWithGap(16),Y.l0.flex.grow(1),Y.l0.flex.shrink(0)],children:t}),(0,N.tZ)($.G,{css:[Y.l0.pt(16)],children:_||v?(0,N.BX)(eq.Tg,{css:[Y.l0.p(8),Y.l0.colWithGap(8)],elevated:!0,children:[(0,N.tZ)(J.xv,{children:"Removing this database will remove access to the data for this Repl, and remove the daily Cycles subscription of ".concat(ip,".")}),(0,N.tZ)(ej.E,{icon:(0,N.tZ)(eV.Z,{}),colorway:"warning",text:"This action cannot be undone."}),(0,N.tZ)(eW.zx,{text:"Yes, Remove Database",colorway:"negative",disabled:v,iconLeft:(0,N.tZ)(e2.Z,{}),onClick:x}),(0,N.tZ)(eW.zx,{text:"Cancel",disabled:v,onClick:S})]}):(0,N.tZ)(eW.zx,{css:[Y.l0.py(8)],text:"Remove Database",disabled:v,iconLeft:(0,N.tZ)(e2.Z,{}),onClick:g})}),(0,N.tZ)(i_,{})]})},oc=(0,K.X)({self:[Y.l0.colWithGap(0),Y.l0.height("100%"),Y.l0.p(8)],main:[Y.l0.colWithGap(16),Y.l0.flex.grow(1),Y.l0.flex.shrink(0)],header:[Y.l0.rowWithGap(8),Y.l0.align.center],status:[Y.l0.width(8),Y.l0.height(8),Y.l0.backgroundColor.accentPositiveStronger,Y.l0.borderRadius("full"),{filter:"drop-shadow(0 0 6px ".concat(Y.TV.accentPositiveStronger,")")}],title:[Y.l0.color.accentPositiveStronger],docs:[iE.Z,Y.l0.maxWidth("100%")],footer:[Y.l0.pt(16)],remove:[Y.l0.py(8)],removeConfirm:[Y.l0.p(8),Y.l0.colWithGap(8)]}),os=function(e){var t=e.neonDatabases,n=e.onDatabaseDeleted,r=e.onDatabaseUnfreezed,i=t[0],o=(0,nN.Z)().showError,a=(0,nc.Z)(),l=rh(),c=rp(),s=O.useCallback(function(){c("queryEditor")},[c]),u=(0,L._)(nG(),2),d=u[0],f=u[1].loading,h=O.useCallback(function(){g(!0)},[]),p=O.useCallback((0,eO._)(function(){var e,t,r;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:return[4,d({variables:{input:{replId:a,databaseId:i.databaseId}}})];case 1:if(t=(e=l.sent()).data,r=e.errors,g(!1),r&&r.length>0)return o("Error when deleting Neon database: ".concat(null==r?void 0:r.join())),rc({action:"removed",success:!1}),[2];if((null==t?void 0:t.deleteNeonDatabase.__typename)!=="DeleteNeonDatabaseResult")return o("Error: ".concat(null==t?void 0:t.deleteNeonDatabase.message)),rc({action:"removed",success:!1}),[2];return(null==t?void 0:t.deleteNeonDatabase.success)?(n(),rc({action:"removed",success:!0})):(o("Error: Delete Neon Database failed."),rc({action:"removed",success:!1})),[2]}})}),[d,i.databaseId,n,a,o]),m=(0,L._)(O.useState(!1),2),v=m[0],g=m[1],y=O.useCallback(function(){g(!1)},[]),b=iG(),Z=r0({connectionString:i.connectionString,databaseName:i.databaseName})[rq].split(".")[0],w=b||"".concat(i.connectionString,"/").concat(i.databaseName,"?sslmode=require&options=project%3D").concat(Z);if("queryEditor"===l)return(0,N.tZ)(rM,{connectionString:w});if("tableSchemas"===l)return(0,N.tZ)(ia,{connectionString:w});if(l.startsWith("table/")){var x=l.slice(l.indexOf("/")+1);return(0,N.tZ)(iS,{tableName:x,connectionString:w})}return(0,N.BX)($.G,{css:oc.self,children:[(0,N.tZ)($.G,{css:oc.main,children:i.isFrozen?(0,N.tZ)(iK,{replId:a,neonProjectId:i.projectId,onDatabaseUnfreezed:r}):(0,N.BX)(N.HY,{children:[(0,N.BX)($.G,{css:oc.header,children:[(0,N.tZ)($.G,{css:oc.status}),(0,N.tZ)(J.xv,{css:oc.title,multiline:!1,children:"Database connected"})]}),(0,N.tZ)(iP,{title:"Database Info",children:(0,N.tZ)(iw,{connectionString:w,onOpenDatabaseViewerClick:s,showUsageLink:!0})}),(0,N.tZ)(iP,{title:"Using the database",isAccordion:!0,children:(0,N.tZ)(iT.ZP,{css:oc.docs,children:iR})}),(0,N.tZ)(iP,{title:"Environment variables",isAccordion:!0,children:(0,N.tZ)(r2,{connectionString:w,databaseName:i.databaseName})})]})}),(0,N.tZ)($.G,{css:oc.footer,children:v||f?(0,N.BX)(eq.Tg,{css:oc.removeConfirm,elevated:!0,children:[(0,N.tZ)(J.xv,{children:"Removing this database will remove access to the data for this Repl."}),(0,N.tZ)(ej.E,{icon:(0,N.tZ)(eV.Z,{}),colorway:"warning",text:"This action cannot be undone."}),(0,N.tZ)(eW.zx,{text:"Yes, Remove Database",colorway:"negative",disabled:f,iconLeft:(0,N.tZ)(e2.Z,{}),onClick:p}),(0,N.tZ)(eW.zx,{text:"Cancel",disabled:f,onClick:y})]}):(0,N.tZ)(eW.zx,{css:oc.remove,text:"Remove Database",disabled:f,iconLeft:(0,N.tZ)(e2.Z,{}),onClick:h})}),(0,N.tZ)(i_,{})]})},ou=function(e){var t=e.neonDatabases,n=e.onDatabaseDeleted,r=e.onDatabaseUnfreezed,i=e.onDatabaseMigrated,o=t[0].isBackedByCycles;return(0,iA.P5)({controlName:oa.uZ,logFlagToAnalytics:!0})&&!o?(0,N.tZ)(os,{neonDatabases:t,onDatabaseDeleted:n,onDatabaseUnfreezed:r}):(0,N.tZ)(ol,{neonDatabases:t,onDatabaseDeleted:n,onDatabaseUnfreezed:r,onDatabaseMigrated:i})},od=n(76588),of=n(93302),oh=n(4513),op=n(92977);function om(){var e=(0,ns._)(["\n  query NeonStartPage {\n    currentUser {\n      id\n      userSubscriptionType\n      usageBasedBilling(input: { capabilitiesOnly: true }) {\n        __typename\n        ... on UserUsageBasedBillingSummary {\n          capabilities {\n            canUseUsageBasedBilling\n            explanation\n            hasPaymentMethod\n          }\n        }\n      }\n      usageInterval {\n        ... on UsageInterval {\n          resources {\n            neonComputeTime {\n              allotment\n              usage\n            }\n            neonDataStorage {\n              allotment\n              usage\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return om=function(){return e},e}var ov={},og=(0,nu.Ps)(om()),oy=n(70002),ob=n(25491),oZ=n(44620),ow="Buy Cycles & Create a DB",ox="Use Cycles to create a DB",oC='Press "'.concat(ow,'" to initiate a daily Cycles subscription and activate a Neon Database. You will be redirected to our payment processor.\n'),o_='Press "'.concat(ox,'" to initiate a daily Cycles subscription and activate a Neon Database.'),ok=function(e){var t=e.onDatabaseCreated,n=(0,nc.Z)(),r=(0,nN.Z)().showError,i=(0,L._)(nI(),2),o=i[0],a=i[1].loading,l=(0,i8.Z)({forceFetch:!0}),c=l.cycles,s=l.loading,u=null!=c&&c>=id,d=u?o_:oC,f=O.useCallback((0,eO._)(function(){var e,i,a,l,c,s,u;return(0,eX.Jh)(this,function(d){switch(d.label){case 0:return[4,o({variables:{input:{replId:n}}})];case 1:if(i=(e=d.sent()).data,(a=e.errors)&&a.length>0)return r("Error when creating Neon database: ".concat(null==a?void 0:a.join())),rc({action:"created",success:!1}),[2];return(null==i?void 0:i.createNeonDatabase.__typename)==="CreateNeonDatabaseResult"?(c=(l=i.createNeonDatabase).databaseId,s=l.databaseName,u=l.connectionString,t({__typename:"NeonDatabase",databaseId:c,databaseName:s,connectionString:u,projectId:l.projectId,isFrozen:l.isFrozen,isBackedByCycles:l.isBackedByCycles}),rc({action:"created",success:!0})):(r("Error: ".concat(null==i?void 0:i.createNeonDatabase.message)),rc({action:"created",success:!1})),[2]}})}),[o,n,r,t]),h=(0,L._)(O.useState(!1),2),p=h[0],m=h[1],v=O.useCallback((0,eO._)(function(){return(0,eX.Jh)(this,function(e){return m(!0),[2]})}),[]),g=O.useCallback((0,eO._)(function(){return(0,eX.Jh)(this,function(e){return m(!1),[2]})}),[]),y=O.useCallback((0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:return[4,f()];case 1:return e.sent(),m(!1),[2]}})}),[f]);return(0,N.BX)($.G,{css:[Y.l0.colWithGap(0),Y.l0.height("100%"),Y.l0.align.center,Y.l0.p(8)],children:[(0,N.BX)($.G,{css:[Y.l0.colWithGap(16),Y.l0.flex.grow(1),Y.l0.flex.shrink(0),Y.l0.maxWidth(600)],children:[(0,N.BX)($.G,{css:[Y.l0.colWithGap(8),Y.l0.align.center],children:[(0,N.tZ)($.G,{css:[Y.l0.p(16)],children:(0,N.tZ)(od.Z,{src:"/public/images/db_illustration.png",width:144,height:144,alt:"FPO visual"})}),(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(16),Y.l0.fontWeight.bold],multiline:!1,children:"Fully-managed PostgreSQL database"}),(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(14)],multiline:!1,children:"10GB of fast read/write storage"}),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:[(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(14)],multiline:!1,children:ip}),(0,N.tZ)(e_.hU,{alt:d,size:24,children:(0,N.tZ)(r5.Z,{})})]})]}),(0,N.BX)(eq.Tg,{css:[Y.l0.colWithGap(8),Y.l0.mb(8)],background:"default",children:[(0,N.tZ)(eW.zx,{text:s?"Loading Cycles Balance":u?ox:ow,colorway:"primary",iconLeft:(0,N.tZ)(tO.Z,{}),disabled:s||a,onClick:v}),(0,N.tZ)(oy.Z,{href:im,target:"_blank",text:"Learn More",iconRight:(0,N.tZ)(oZ.Z,{}),variant:"outlined"})]}),(0,N.tZ)("hr",{css:[Y.l0.my(16),{borderColor:Y.TV.outlineDefault}]}),(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(12),Y.l0.color.foregroundDimmest],children:d}),(0,N.tZ)(ob.Z,{isOpen:p,onRequestClose:g,onRequestPowerUp:y,uponPurchaseGoTo:"workspace",context:"workspace_postgresql_pane",powerUp:"neon-database-preview"})]}),(0,N.tZ)(i_,{})]})},oS=(0,K.X)({self:[Y.l0.px(8),Y.l0.pt(16)],container:[Y.l0.colWithGap(32),Y.l0.py(32),Y.l0.textAlign.center,op.Qw.maxWidth],title:[Y.l0.colWithGap(4),Y.l0.width("100%"),Y.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],usage:[Y.l0.colWithGap(4),Y.l0.width("100%"),Y.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],cta:[Y.l0.width("100%"),Y.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[Y.l0.colWithGap(8),Y.l0.align.center],ctaStatusBanner:[Y.l0.textAlign.left],payment:[Y.l0.p(16),Y.l0.borderRadius(12),Y.l0.textAlign.left,Y.l0.shadow(2)],budgetContainer:[Y.l0.colWithGap(8),Y.l0.border(),Y.l0.borderRadius(8),Y.l0.p(8)],disabledBanner:[Y.l0.py(6),{alignSelf:"center"}],details:[Y.l0.colWithGap(12),Y.l0.maxWidth(400),{marginLeft:"auto",marginRight:"auto"}],detailsItem:{display:"grid",gridTemplateColumns:"56px auto",gap:20},detailsText:[Y.l0.flex.growAndShrink(1),Y.l0.textAlign.left]});function oE(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnCreate,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,l=e.showPaymentMethodForm,c=e.setShowSupportForm,s=(0,iL.rv)();return n===iq.Fp.NeedsSubscription||n===iq.Fp.NeedsSubscriptionOrPaymentMethod?s?(0,N.tZ)(ej.E,{text:"You need a subscription to create a database. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:oS.ctaStatusBanner}):(0,N.BX)($.G,{css:oS.ctaContainer,children:[(0,N.tZ)(iW.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to create a database",css:oS.cta,colorway:"primary",variant:"outlined",disabled:l,onPlanCheckoutComplete:o}),(0,N.tZ)(eW.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:oS.cta,disabled:l,loading:t,iconLeft:(0,N.tZ)(iF.Z,{}),onClick:function(){return a()}})]}):n===iq.Fp.NeedsSmsVerification?(0,N.tZ)(iN.Z,{context:iq.jv.Neon,onSuccess:o}):n===iq.Fp.NeedsPaymentMethod?s?(0,N.tZ)(ej.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:oS.ctaStatusBanner}):(0,N.tZ)(eW.zx,{colorway:"primary",text:"Add a payment method",css:oS.cta,disabled:l,loading:t,iconLeft:(0,N.tZ)(iF.Z,{}),onClick:function(){return a()}}):n===iq.Fp.NeedsUnbanning?(0,N.tZ)(iM.u,{text:"Your account currently has restrictions on creating a database. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:oS.ctaStatusBanner,onClick:function(){return c()}}):n===iq.Fp.InsufficientBudget?(0,N.BX)(N.HY,{children:[(0,N.tZ)(ej.E,{text:"You've reached your monthly usage budget. Increase your budget to create a database.",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:oS.ctaStatusBanner}),(0,N.tZ)($.G,{css:oS.budgetContainer,children:(0,N.tZ)(iO.L,{onUpdateSuccess:o})})]}):(0,N.BX)(N.HY,{children:[(0,N.tZ)(eW.zx,{colorway:"primary",onClick:i,text:"Create a database",loading:t,css:oS.cta}),!1===r?(0,N.tZ)(iM.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),css:oS.ctaStatusBanner,onClick:function(){return s?null:a()}}):null]})}var oT=function(e){var t,n,r=e.onDatabaseCreated,i=(0,L._)(O.useState(!1),2),o=i[0],a=i[1],l=(0,L._)(O.useState(!1),2),c=l[0],s=l[1],u=(0,nc.Z)(),d=(0,nN.Z)().showError,f=(t=(0,eU._)({},ov,{notifyOnNetworkStatusChange:!0,onError:function(e){d(e.message)}}),nd.a(og,t)),h=f.loading,p=f.data,m=f.refetch,v=(0,L._)(nI({onError:function(e){d("Error when creating Neon database: ".concat(e.message)),rc({action:"created",success:!1})},onCompleted:function(e){if((null==e?void 0:e.createNeonDatabase.__typename)==="CreateNeonDatabaseResult"){var t=e.createNeonDatabase;r({__typename:"NeonDatabase",databaseId:t.databaseId,databaseName:t.databaseName,connectionString:t.connectionString,projectId:t.projectId,isFrozen:t.isFrozen,isBackedByCycles:t.isBackedByCycles}),rc({action:"created",success:!0})}else{d("Error: ".concat(null==e?void 0:e.createNeonDatabase.message)),rc({action:"created",success:!1});return}}}),2),g=v[0],y=v[1].loading,b=(null==p?void 0:null===(n=p.currentUser)||void 0===n?void 0:n.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?p.currentUser.usageBasedBilling.capabilities:null,Z=O.useMemo(function(){return function(e){var t=e.data,n=null==t?void 0:t.usageInterval;if(n&&"UsageInterval"===n.__typename){var r=Math.max(0,n.resources.neonComputeTime.allotment-n.resources.neonComputeTime.usage),i=(0,of.fZ)(r,{resourceUsageType:"ComputeHours"}),o=Math.max(0,n.resources.neonDataStorage.allotment-n.resources.neonDataStorage.usage);return{formattedComputeTimeAmount:i,formattedDataStorageAmount:(0,of.fZ)(o,{precision:1,resourceUsageType:"GiB"})}}}({data:null==p?void 0:p.currentUser})},[p]);return(0,N.BX)($.G,{css:oS.self,children:[(0,N.tZ)(iX.u,{isOpen:c,onRequestClose:function(){return s(!1)},children:(0,N.tZ)(iU.Z,{onRequestClose:function(){return s(!1)}})}),(0,N.BX)($.G,{css:oS.container,children:[(0,N.BX)($.G,{css:oS.title,children:[(0,N.tZ)(J.xv,{variant:"subheadBig",children:"PostgreSQL Database"}),(0,N.tZ)(J.xv,{color:"dimmer",children:"Fully-managed, usage based PostgreSQL database with 10GB of fast read/write storage."}),(0,N.tZ)(J.xv,{css:Y.l0.textAlign.center,children:(0,N.tZ)("a",{href:im,target:"_blank",rel:"noopener",children:"Learn more"})})]}),(0,N.BX)($.G,{css:Y.l0.colWithGap(16),children:[(0,N.tZ)($.G,{css:[Y.l0.rowWithGap(0),Y.l0.justify.center],children:(0,N.tZ)(od.Z,{src:"/public/images/db_illustration.png",width:120,height:120,alt:"FPO visual"})}),null!=Z?(0,N.BX)(J.xv,{css:oS.usage,color:"dimmer",children:["You have ",Z.formattedComputeTimeAmount," left this month and ",Z.formattedDataStorageAmount," of storage left in total."]}):null,(0,N.BX)($.G,{css:Y.l0.colWithGap(8),children:[(0,N.tZ)(oE,{loading:h||y,ubbExplanation:null==b?void 0:b.explanation,hasPaymentMethod:null==b?void 0:b.hasPaymentMethod,handleOnCreate:function(){g({variables:{input:{replId:u}}})},refetchUbbCapabilitiesQueryData:m,setShowPaymentMethodForm:function(){return a(!0)},showPaymentMethodForm:o,setShowSupportForm:function(){return s(!0)}}),o?(0,N.tZ)(eq.Tg,{elevated:!0,css:oS.payment,children:(0,N.tZ)(ot.q,{onSuccess:(0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:return a(!1),[4,m()];case 1:return e.sent(),[2]}})}),context:"workspace_hosting_pane"})}):null]})]}),(0,N.BX)($.G,{css:oS.details,children:[(0,N.BX)($.G,{css:oS.detailsItem,children:[(0,N.tZ)(oh.lt,{}),(0,N.BX)(J.xv,{css:oS.detailsText,children:["Get charged for what you use across compute time, storage, written data and data transfer,"," ",(0,N.tZ)("a",{href:iv,target:"_blank",rel:"noopener",children:"see pricing"})]})]}),(0,N.BX)($.G,{css:oS.detailsItem,children:[(0,N.tZ)(oh.fG,{}),(0,N.BX)(J.xv,{css:oS.detailsText,children:["Free usage allocations are included in Replit plans, and then billed at a per unit price,"," ",(0,N.tZ)("a",{href:iv,target:"_blank",rel:"noopener",children:"see allocations"})]})]})]})]})]})},oR=function(e){var t=e.onDatabaseCreated;return(0,iA.P5)({controlName:oa.uZ,logFlagToAnalytics:!0})?(0,N.tZ)(oT,{onDatabaseCreated:t}):(0,N.tZ)(ok,{onDatabaseCreated:t})},oI=function(){var e,t,n=(0,nc.Z)(),r=(0,nN.Z)().showError,i=(0,H.Z)().psql,o=(0,L._)(O.useState([]),2),a=o[0],l=o[1],c=(e=(0,eU._)({},nT,{variables:{input:{replId:n}},fetchPolicy:"no-cache",onCompleted:function(e){if("GetNeonDatabasesResult"===e.getNeonDatabases.__typename){l(e.getNeonDatabases.databases);return}r("Error: ".concat(e.getNeonDatabases.message))}}),nd.a(nB,e)),s=c.loading,u=c.refetch,d=r1(),f=O.useCallback((t=(0,eO._)(function(e){var t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),l([e]),[4,i.ensureNixPsqlPackageInstalled(!0)];case 1:return n.sent(),d({connectionString:e.connectionString,databaseName:e.databaseName}),[3,3];case 2:return t=n.sent(),r("Error: ".concat(t.message)),[3,3];case 3:return[2]}})}),function(e){return t.apply(this,arguments)}),[i,d,r]),h=(0,eD.Dv)(iI);return h?(0,N.tZ)(ou,{neonDatabases:[h],onDatabaseDeleted:u,onDatabaseUnfreezed:u,onDatabaseMigrated:f}):s?(0,N.tZ)($.G,{css:[Y.l0.flex.row,Y.l0.justify.center,Y.l0.p(32)],children:(0,N.tZ)(eE.Z,{})}):a.length?(0,N.tZ)(ou,{neonDatabases:a,onDatabaseDeleted:u,onDatabaseUnfreezed:u,onDatabaseMigrated:f}):(0,N.tZ)(oR,{onDatabaseCreated:f})},oD=n(26544),oG=es.Type.Object({type:es.Type.Literal("neon")}),oB={Content:function(){return(0,N.tZ)(oI,{})},Icon:function(e){var t=e.size;return(0,N.tZ)(oD.Z,{size:t})},getTitle:function(){return"PostgreSQL"},decode:function(e){return eu.B4.Decode(oG,e)}},oP=n(62393),oA=n(96239),oN=n(75834),oU=es.Type.Object({type:es.Type.Literal("vnc")}),oL={Content:function(){return(0,N.tZ)(oO,{})},Icon:function(e){var t=e.size;return(0,N.tZ)(oA.Z,{size:t})},getTitle:function(){return"Output"},decode:function(e){return eu.B4.Decode(oU,e)}};function oO(){var e=(0,H.Z)(),t=e.fs,n=e.container;return(0,N.tZ)($.G,{css:[Y.l0.flex.growAndShrink(1)],children:(0,N.tZ)(oN.Z,{fs:t,container:n})})}var oX=n(14675),oM=n(82723),oF=(0,nr.iv)([Y.l0.focusRing,Y.l0.display.flex,Y.l0.center,Y.l0.borderRadius(4),Y.l0.backgroundColor.backgroundRoot,Y.l0.color.foregroundDefault,Y.l0.cursor.pointer,Y.l0.p(4),(y={transition:"background-color 0.2s",border:"none"},(0,U._)(y,Y.wl.hover,[Y.l0.backgroundColor.backgroundHigher]),(0,U._)(y,":focus",{outline:"none"}),y)]),oW=function(e){var t=e.onClick;return(0,N.tZ)(eT.u,{tooltip:"Search",placement:"bottom-start",children:(0,N.tZ)("button",{"aria-label":"Search",onClick:t,css:oF,children:(0,N.tZ)(oM.Z,{size:16})})})},oH=n(71984),oV=n(95571),oz=n(89019),oj=n(92920),oq=n(31384),oY=n(19562),o$=n(32911);function oJ(e){var t=e.portsOpenedByThisShell,n=e.performPaneOperation,r=e.onClose;return(0,N.tZ)(o$.ms,{configurations:t.map(function(e){return e.configuration}),openWebview:function(){n({operation:"open",secondary:!0,pane:{type:"webview",data:t.length>0?{portType:"local",port:t[0].configuration.localPort}:void 0}})},openNetworkingTool:function(){n({operation:"open",secondary:!0,pane:{type:"networking"}})},onClose:function(){null==r||r()}})}var oK=n(37463),oQ=n(75159),o0=n(72067),o1=n(80502),o2="\x1b[200~",o8="\x1b[201~",o4=n(94106),o3=n(9669),o5=n(77589),o6=n(40028),o9=n(26851),o7=(0,nr.iv)([Y.l0.height("100%"),Y.l0.overflow("hidden"),{"& .xterm":[Y.l0.pl(8),Y.l0.pt(8),Y.l0.pb(4),Y.l0.height("100%")]}]),ae=(0,K.X)({container:[{"&:focus-within .controls":{opacity:1}}],xterm:o7,xtermWithBorderRadius:[o7,{"& .xterm-viewport":[Y.l0.borderRadius(0,0,8,8)]}]});function at(e){var t,n=e.shell,r=e.shellMetadata,i=e.shellRef,o=e.className,a=e.openSearchAndReplace,l=e.openAIWithMessage,c=e.performPaneOperation,s=(0,oj.Z)().preferences.accessibleTerminal,u=(0,L._)((0,O.useState)(!1),2),d=u[0],f=u[1],h=(0,L._)((0,O.useState)(""),2),p=h[0],m=h[1],v=(0,oK.dF)(null!==(t=null==r?void 0:r.cgroup)&&void 0!==t?t:void 0),g=d&&n?(0,N.tZ)(oX.R,{searchValue:p,setSearchValue:m,findPrevious:n.findPrevious,findNext:n.findNext,exit:function(){return f(!1)}}):(0,N.tZ)(oW,{onClick:function(){return f(!0)}}),y=(0,iL.T3)(),b=(0,oq.av)().onContextMenu,Z=(0,oY.j)({xterm:n,isOutputsTerminal:!1,openAIWithMessage:l,openShellSearch:function(e){f(!0),m(e)},openSearchAndReplace:a});return(0,O.useEffect)(function(){null==n||n.fit()},[n,v]),(0,N.BX)($.G,{className:o,css:ae.container,onKeyDown:function(e){"f"===e.key&&(0,oV.j)(e)&&(f(!0),e.preventDefault())},children:[!s&&(0,N.tZ)(oz.T,{children:'Enable "Accessible Terminal" in Workspace Settings to use a screen reader with the shell.'}),(0,N.BX)($.G,{css:[Y.l0.coverContainer,Y.l0.flex.column],children:[(0,N.tZ)($.G,{css:[y?ae.xterm:ae.xtermWithBorderRadius,Y.l0.flex.growAndShrink(1)],innerRef:i,onContextMenu:function(e){return b(e,{command:Z})}}),(0,N.tZ)(oJ,{portsOpenedByThisShell:v,performPaneOperation:c,onClose:function(){null==n||n.focus(),null==n||n.fit()}})]}),n?(0,N.BX)($.G,{className:"controls",css:[Y.l0.position.absolute,Y.l0.flex.row,Y.l0.top(8),Y.l0.right(8),Y.l0.height(30),Y.l0.align.center,{opacity:0,zIndex:4}],children:[g,(0,N.tZ)(oH.Z,{onClick:n.clear})]}):(0,N.tZ)("code",{css:[Y.l0.color.foregroundDimmest,Y.l0.coverContainer,Y.l0.p(8)],children:"Loading..."})]})}var an=n(41140),ar=n(83898),ai=es.Type.Object({type:es.Type.Literal("shell"),data:es.Type.Optional(es.Type.Object({initialPwd:es.Type.Optional(es.Type.String())}))}),ao={Content:function(e){var t,n=e.pane,r=e.options;return(0,N.tZ)(aa,{initialPwd:null===(t=n.data)||void 0===t?void 0:t.initialPwd,performPaneOperation:r.performPaneOperation})},Icon:function(e){var t=e.size;return(0,N.tZ)(an.Z,{size:t})},getTitle:function(){return"Shell"},decode:function(e){return eu.B4.Decode(ai,e)}};function aa(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z,w,x,C,_,k,S=e.initialPwd,E=e.performPaneOperation,T=(0,H.Z)(),R=T.container,I=T.fs,D=(0,L._)(O.useState(!1),2),G=D[0],B=D[1],P=(0,ar.ql)(),A=(0,L._)(O.useState(void 0),2),U=A[0],X=A[1],M=(0,O.useCallback)(function(e){E({operation:"open",secondary:!0,pane:{type:(0,tX.Dp)(e),data:e}})},[E]),F=(0,O.useCallback)(function(e){E({operation:"open",secondary:!0,pane:{type:"searchReplace",data:{initialQuery:e}}})},[E]),W=(0,O.useCallback)(function(e){P({chatMessage:e}),E({operation:"open",secondary:!0,pane:{type:"ghostwriterChat"}})},[E,P]),V=(0,O.useCallback)(function(e,t){E({operation:"open",secondary:!0,pane:{type:"webview",data:{portType:"local",path:e,port:t}}})},[E]),z=(0,L._)((r=(t={container:R,initialPwd:S,onOutput:(0,O.useCallback)(function(){B(!0)},[B]),onShellMetadata:X,openFile:M,listFiles:I.listFiles,openWebview:V}).onShellKey,i=t.onOutput,o=t.onShellMetadata,a=t.container,l=t.initialPwd,c=t.openFile,s=t.listFiles,u=t.openWebview,f=(d=(0,L._)((0,o1.Z)({openFile:c,listFiles:s,openWebview:u}),2))[0],h=d[1],p=(0,o0.Z)({service:"shell",container:a}),m=(0,o9.K)({channelId:null==p?void 0:null===(n=p.channel)||void 0===n?void 0:n.id}),v=O.useRef(!1),g="",y="",b="",x=(w={sendInput:Z=O.useCallback(function(e){if(!p.channel||!f)return!1;var t=a.client();if(!p.channel||"open"!==p.channel.status||t.getConnectionState()!==oQ.em.CONNECTED)return!1;var n=e.startsWith(o2)&&e.endsWith(o8)?e.slice(o2.length,e.length-o8.length):e;return p.channel.send({input:n}),!0},[f,p,a]),paste:function(e){return!!f&&(f.paste(e),!0)}}).sendInput,C=w.paste,_=(0,o4.useRouter)(),k=(0,iL.Vg)(_),(0,O.useEffect)(function(){if(k){var e=function(e,t){x(t)?(0,o5.gU)(e):(0,o5.pl)(e)},t=function(e){"unknown"===e||(0,o6.Z)(e)},n=function(n){(0,o5.gN)(n,function(n){var r=n.type;switch(r){case o3.cF.SHELL_INSERT_INPUT:e(n.id,n.input);break;case o3.cF.SHELL_COMMAND:t(n.command);break;case o3.cF.SHELL_PASTE_TEXT:C(n.text)?(0,o5.gU)(n.id):(0,o5.pl)(n.id);break;default:(0,o6.Z)(r)}})};return window.addEventListener("message",n),function(){window.removeEventListener("message",n)}}},[k,x,C]),O.useEffect(function(){if(p.channel&&"open"===p.channel.status)return p.channel.onCommand(function(e){e.shellMetadata&&(null==o||o(e.shellMetadata))})},[p.channel,o]),O.useEffect(function(){if(p.channel&&"open"===p.channel.status&&f){var e=f.onKey(function(e){var t=e.key,n=e.domEvent;if("\r"===t){(0,rl.j)(rl.U3.SHELL_COMMAND_EVALED,{context:g});var i=y;y.endsWith(g)&&g.length>0&&(i=y.slice(0,-g.length)),m("user:shell:output:clean",{output:i,command:b}),m("user:shell:exec",{command:g}),m("user:shell:output",{output:y}),b=g,g="",y=""}else g+=t;r&&r(n)}),t=a.client(),n=f.onData(function(e){Z(e)});p.channel.onCommand(function(e){e.hint?f.write("\x1b[0m\x1b[33m".concat(e.hint.text,"\x1b[0m\r\n")):e.output&&(f.write(e.output),null==i||i(e.output),y+=e.output)});var o=function(){p.channel&&"open"===p.channel.status&&t.getConnectionState()===oQ.em.CONNECTED&&p.channel.send({resizeTerm:f.getSize()})};if(l&&!v.current){var c=l.replace(/"/g,'\\"');p.channel.send({input:'cd "'.concat(c,'"\n')}),v.current=!0}var s=f.onResize(o);return o(),function(){e.dispose(),n.dispose(),s.dispose()}}},[p.channel,f,r,i,o,a,Z,l]),[f,h,Z]),3),j=z[0],q=z[1],Y=z[2];return(0,et.Wk)(function(){return j},[j]),(0,et.L5)(function(){if(j&&G)return{type:"shell",exec:function(e){Y(e+"\n")}}},[j,Y,G]),(0,N.tZ)(at,{shell:j,shellMetadata:U,shellRef:q,performPaneOperation:E,openSearchAndReplace:F,openAIWithMessage:W})}var al=n(69451),ac=n.n(al),as=n(70671);function au(){var e=(0,ns._)(["\n  query WorkspaceDrawCurrentUser {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return au=function(){return e},e}var ad={},af=(0,nu.Ps)(au()),ah=n(73660),ap=function(e,t,n){if(!e)return[];var r,i=t(e.getSceneElementsIncludingDeleted()),o=e.getAppState();return(r=n.reduce(function(e,t){var n,r,a;return t.id===(null===(n=o.editingElement)||void 0===n?void 0:n.id)||t.id===(null===(r=o.resizingElement)||void 0===r?void 0:r.id)||t.id===(null===(a=o.draggingElement)||void 0===a?void 0:a.id)||(i[t.id]&&i[t.id].version>t.version?e.push(i[t.id]):i[t.id]&&i[t.id].version===t.version&&i[t.id].versionNonce!==t.versionNonce&&i[t.id].versionNonce<t.versionNonce?e.push(i[t.id]):e.push(t),delete i[t.id]),e},[])).concat.apply(r,(0,ex._)(Object.values(i)))},am=function(){var e,t,n=new Promise(function(n,r){e=n,t=r});return n.resolve=e,n.reject=t,n},av=function(e){return e.reduce(function(e,t){return e[t.id]=t,e},{})},ag=n(73926),ay=n.n(ag),ab=n(56337),aZ=n(98655),aw=n(61405),ax=(0,nr.iv)(".excalidraw.excalidraw-modal-container.excalidraw--mobile{margin-top:",aZ.Mz-1,"px;}");function aC(e){var t,r,i,o,a=e.fs,l=e.broadcast,c=e.filePath,s=(0,L._)((0,O.useState)(void 0),2),u=s[0],d=s[1],f=(0,ab.Z)(),h=(0,O.useRef)(function(e){return(0,ex._)(e)}),p=(0,O.useRef)(function(e){return -1}),m=(0,O.useRef)({readyPromise:am()}),v=(0,O.useRef)({promise:null});(0,O.useEffect)(function(){Promise.all([n.e(6655),n.e(7070)]).then(n.t.bind(n,17070,23)).then(function(e){h.current=function(t){return t.filter(function(t){return t.isDeleted||!e.isInvisiblySmallElement(t)})},p.current=e.getSceneVersion,d(e.Excalidraw)})},[]);var g=function(){return m.current},y=(t=(0,eU._)({},ad,{ssr:!1}),nd.a(af,t)),b=y.data,Z=y.loading,w=(null==b?void 0:null===(o=b.currentUser)||void 0===o?void 0:o.username)||"",x=(0,as.F)().isDarkColorScheme,C=(0,aw.aG)(),_=(0,ah.Z)(),k=null==_?void 0:_.color,S=(0,L._)((0,O.useState)(new Map),2),E=S[0],T=S[1],R=(0,L._)((0,O.useState)(-1),2),I=R[0],D=R[1],G=(0,O.useRef)(ay()()).current;(0,O.useEffect)(function(){function e(){return(e=(0,eO._)(function(){var e,t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:if(!b||!b.currentUser)return[2];return[4,m.current.readyPromise];case 1:return n.sent(),e=g().getAppState().collaborators,t=new Map,C.forEach(function(n){if(n.username!==(null==b?void 0:null===(r=b.currentUser)||void 0===r?void 0:r.username)){var r,i=e.get(n.username)||{};t.set(n.username,(0,eL._)((0,eU._)({},i),{username:n.username,color:{background:n.color,foreground:n.color}}))}}),g().updateScene({collaborators:t}),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[b,C]);var B=(r=(0,eO._)(function(e,t){var n,r,i,o,a,s;return(0,eX.Jh)(this,function(u){t||(e=e.filter(function(e){return!E.has(e.id)||e.version>E.get(e.id)})),n=!0,r=!1,i=void 0;try{for(o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)s=a.value,E.set(s.id,s.version),T(new Map(E))}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return l.broadcastMessage(G,{text:JSON.stringify({elements:e,path:c})}),[2]})}),function(e,t){return r.apply(this,arguments)});(0,O.useEffect)(function(){if(l)return l.onBroadcastReceived(G,function(e){var t=e.username,n=JSON.parse(e.text);if(n.path===c){if(n.collaborator&&m.current){var r=g().getAppState().collaborators;r.set(t,(0,eL._)((0,eU._)({},r.get(t),n.collaborator),{username:t})),g().updateScene({collaborators:r})}else if(n.elements){var i=ap(g(),av,n.elements);D(p.current(i)),g().updateScene({elements:i})}else if(n.removePresence){var o=g().getAppState().collaborators;o.delete(n.removePresence),g().updateScene({collaborators:o})}}})},[l,c,G]),(0,O.useEffect)(function(){function e(){return(e=(0,eO._)(function(){return(0,eX.Jh)(this,function(e){var t;return c&&a&&(v.current.promise=new Promise((t=(0,eO._)(function(e){var t,n,r;return(0,eX.Jh)(this,function(i){switch(i.label){case 0:return[4,Promise.all([a.readFile(c),m.current.readyPromise])];case 1:return"content"in(t=L._.apply(void 0,[i.sent(),1])[0])&&(n=JSON.parse(t.content.toString()||"{}"),r=g().getAppState(),n.appState=(0,eU._)({},r),n.scrollToContent=!0,e(n)),[2]}})}),function(e){return t.apply(this,arguments)}))),[2]})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[c,a]);var P=(0,O.useCallback)(ac()((i=(0,eO._)(function(e,t){var n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:if(n=e.filter(function(e){return!e.isDeleted}),!c)return[3,2];return[4,a.writeFile(c,rH.Z.from(JSON.stringify({elements:n,files:t})))];case 1:r.sent(),r.label=2;case 2:return[2]}})}),function(e,t){return i.apply(this,arguments)}),350),[c]),A=function(e){p.current(e)>I&&(I>-1&&B(h.current(e),!1),D(p.current(e)))};return(0,N.BX)($.G,{css:{position:"relative",height:"100%",width:"100%",flex:1,boxShadow:k?"0 3px 0 3px ".concat(k):"none",backgroundColor:Y.TV.backgroundDefault,"& .excalidraw [title~=Library]":{display:"none"}},onMouseLeave:function(){l.broadcastMessage(G,{text:JSON.stringify({removePresence:w,path:c})})},children:[u&&!Z?(0,N.tZ)(u,{ref:m,UIOptions:{canvasActions:{loadScene:!1}},isCollaborating:!0,theme:x?"dark":"light",initialData:v.current.promise,onPointerUpdate:function(e){var t=e.pointer,n=g().getAppState().selectedElementIds||{};l.broadcastMessage(G,{text:JSON.stringify({collaborator:{pointer:t,selectedElementIds:n},path:c})})},onChange:function(e,t,n){A(e),D(p.current(e)),p.current(e)>I&&P(e,n)},user:{name:w}}):null,f?(0,N.tZ)(nr.xB,{styles:[ax]}):null]})}function a_(e){var t=e.fs,n=e.broadcast,r=e.filePath;return(0,N.tZ)(aC,{fs:t,broadcast:n,filePath:r},r)}var ak=n(97168),aS=es.Type.Object({type:es.Type.Literal("draw"),data:es.Type.Object({path:es.Type.String()})}),aE={Content:function(e){var t=e.pane,n=e.options.performPaneOperation;return(0,N.tZ)(aT,{path:t.data.path,performPaneOperation:n})},Icon:function(e){var t=e.size;return(0,N.tZ)(ak.Z,{size:t})},getTitle:function(e){return(0,ec.UO)(e.data.path)},decode:function(e){return eu.B4.Decode(aS,e)}};function aT(e){var t=e.path,n=e.performPaneOperation,r=(0,H.Z)(),i=r.fs,o=r.broadcast,a=(0,tI.Mp)({path:t,performPaneOperation:n});return(0,et.L5)(function(){if(a)return{commands:a}},[a]),(0,N.BX)(N.HY,{children:[(0,N.tZ)(tI.HK,{path:t,performPaneOperation:n}),(0,N.tZ)(tI.VY,{children:(0,N.tZ)(a_,{fs:i,broadcast:o,filePath:t})})]})}var aR=n(61601),aI=n(57468),aD=n(80259),aG=es.Type.Object({type:es.Type.Literal("media"),data:es.Type.Object({path:es.Type.String()})}),aB={Content:function(e){var t=e.pane,n=e.options;return(0,N.tZ)(aP,{path:t.data.path,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.pane,n=e.size;return(0,N.tZ)(aI.Z,{path:t.data.path,size:n})},getTitle:function(e){return(0,ec.UO)(e.data.path)},decode:function(e){return eu.B4.Decode(aG,e)}};function aP(e){var t=e.path,n=e.performPaneOperation,r=(0,H.Z)().fs,i=(0,tI.Mp)({path:t,performPaneOperation:n}),o=i?(0,ex._)(i):[],a={match:aD.pl,data:{label:"Open in Editor",icon:(0,N.tZ)(en.Z,{}),type:"action",run:function(){n({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})}}};return(0,ec.B4)(t)&&o.push(a),(0,et.L5)(function(){if(i)return{commands:o}},[i]),(0,N.BX)(N.HY,{children:[(0,N.tZ)(tI.HK,{path:t,performPaneOperation:n}),(0,N.tZ)(tI.VY,{centered:!0,children:(0,N.tZ)(aR.Z,{filePath:t,fs:r})})]})}var aA=n(86309),aN=n(99741),aU=n(67313),aL=n(55103),aO=(0,K.X)({container:[Y.l0.width(60),Y.l0.height(24),Y.l0.display.flex,Y.l0.center,Y.l0.borderRadius(4),Y.l0.fontSize(Y.TV.fontSizeSmall)]});function aX(e){var t,n,r;switch(e.type){case aL.h.ADDED:case aL.h.UNTRACKED:t="Added",n=Y.TV.greenDimmest,r=Y.TV.greenStrongest;break;case aL.h.MODIFIED:t="Modified",n=Y.TV.yellowDimmest,r=Y.TV.yellowStrongest;break;case aL.h.DELETED:t="Deleted",n=Y.TV.redDimmest,r=Y.TV.redStrongest;break;case aL.h.RENAMED:t="Renamed",n=Y.TV.tealDimmest,r=Y.TV.tealStrongest;break;case aL.h.COPIED:t="Copy",n=Y.TV.limeDimmest,r=Y.TV.limeStrongest;break;default:return null}return(0,N.tZ)($.G,{style:{backgroundColor:n,color:r},css:aO.container,children:(0,N.tZ)("span",{children:t})})}function aM(e){var t,n,r;switch(e.type){case"ADDED":t="Added",n=Y.TV.greenDimmest,r=Y.TV.greenStrongest;break;case"MODIFIED":t="Modified",n=Y.TV.yellowDimmest,r=Y.TV.yellowStrongest;break;case"DELETED":t="Deleted",n=Y.TV.redDimmest,r=Y.TV.redStrongest;break;case"RENAMED":t="Renamed",n=Y.TV.tealDimmest,r=Y.TV.tealStrongest;break;case"COPIED":t="Copy",n=Y.TV.limeDimmest,r=Y.TV.limeStrongest;break;default:return null}return(0,N.tZ)($.G,{style:{backgroundColor:n,color:r},css:aO.container,children:(0,N.tZ)("span",{children:t})})}var aF=n(48528),aW=n(10814),aH=n(70322),aV=n(19237),az="rgba(180, 0, 0, 0.125)",aj="rgba(0, 180, 0, 0.125)",aq=nL.tk.theme({"&.cm-merge-b .cm-changedLine":{background:"rgba(0, 180, 0, 0.075)"},"&.cm-merge-a .cm-changedLine":{background:"rgba(180, 0, 0, 0.075)"},"&.cm-merge-b .cm-changedLineGutter":{background:aj},"&.cm-merge-a .cm-changedLineGutter":{background:az},"&.cm-merge-b .cm-changedText":{background:aj,outline:"solid 1px ".concat(aj),borderRadius:"2px"},"&.cm-merge-a .cm-changedText":{background:az,outline:"solid 1px ".concat(az),borderRadius:"2px"},".cm-collapsedLines":{color:iY.TV.accentPrimaryStrongest,background:iY.TV.accentPrimaryDimmest,transition:"background 250ms ease","&:hover":{background:iY.TV.accentPrimaryDimmer}}}),aY=[nL.tk.baseTheme({".cm-scroller":{height:"100% !important",overflowY:"auto !important"}}),nL.tk.theme({".cm-scroller":{height:"auto !important",overflowY:"visible !important"}})],a$=[nX.Wl.highest(aY),aq],aJ=n(17542),aK=n(84054),aQ=n(7444);function a0(e){var t,n,r,i=e.a,o=e.b,a=e.style,l=e.className,c=(0,aH._)(e,["a","b","style","className"]),s=(0,L._)((0,O.useState)(null),2),u=s[0],d=s[1],f=(0,L._)((0,O.useState)(null),2),h=f[0],p=f[1],m=(0,O.useRef)(!1),v=(0,aQ.Z)(c),g=(0,aQ.Z)(i.doc),y=(0,aQ.Z)(o.doc),b=(0,rR.Xl)((0,eL._)((0,eU._)({},i),{readOnly:!0})),Z=(0,rR.Xl)((0,eL._)((0,eU._)({},o),{readOnly:!0})),w=(t=(0,L._)((0,O.useState)(),2)[1],(0,O.useCallback)(function(e){t(function(){throw e})},[])),x=c.orientation,C=c.revertControls,_=c.renderRevertControl,k=c.collapseUnchanged,S=c.gutter,E=c.highlightChanges,T=void 0!==k,R=null==k?void 0:k.margin,I=null==k?void 0:k.minSize,D=null!==(n=null==h?void 0:h.a)&&void 0!==n?n:null,G=null!==(r=null==h?void 0:h.b)&&void 0!==r?r:null;return(0,rR.uF)(),(0,O.useEffect)(function(){var e=function(e){w(e)};if(u){var t=null;try{t=new aV.QK((0,eL._)((0,eU._)({},v.current),{parent:u,a:{doc:g.current,extensions:[nL.tk.exceptionSink.of(e),a$].concat((0,ex._)(b))},b:{doc:y.current,extensions:[nL.tk.exceptionSink.of(e),a$].concat((0,ex._)(Z))}}))}catch(t){e(t)}return t&&(p(t),m.current=!0),function(){if(t){p(null);try{t.destroy()}catch(t){e(t)}}}}},[u]),(0,O.useEffect)(function(){D&&!m.current&&D.dispatch({changes:{from:0,to:D.state.doc.length,insert:i.doc}})},[D,i.doc]),(0,O.useEffect)(function(){G&&!m.current&&G.dispatch({changes:{from:0,to:G.state.doc.length,insert:o.doc}})},[G,o.doc]),(0,O.useEffect)(function(){h&&!m.current&&a1(h,v.current.collapseUnchanged)},[h,v,i.doc,o.doc]),(0,O.useEffect)(function(){if(h&&!m.current){var e=T?{margin:R,minSize:I}:void 0;h.reconfigure({orientation:x,revertControls:C,renderRevertControl:_,collapseUnchanged:e,gutter:S,highlightChanges:E}),e&&a1(h,e)}},[h,x,C,_,T,R,I,S,E]),(0,aJ.H)(D),(0,aJ.H)(G),(0,O.useEffect)(function(){m.current=!1}),(0,N.BX)(N.HY,{children:[(0,N.tZ)("div",{ref:d,className:l,style:a}),(0,N.tZ)(aK.N1,{view:D}),(0,N.tZ)(aK.N1,{view:G})]})}function a1(e,t){e&&t&&(e.reconfigure({collapseUnchanged:void 0}),e.reconfigure({collapseUnchanged:(0,eU._)({},t)}))}var a2=n(59639),a8=[{"& > span:first-child-of-type":[Y.l0.flex.grow(1),Y.l0.textAlign.left]},{"& > span":[Y.l0.flex.shrink(1)]},Y.l0.height("auto"),Y.l0.p(8),Y.l0.fontWeight.medium,Y.l0.backgroundColor.backgroundHigher,Y.l0.flex.row,Y.l0.align.center,Y.l0.justify.spaceBetween,Y.l0.overflow("hidden"),Y.l0.cursor.pointer],a4=(0,K.X)({buttonFolded:[a8,Y.l0.borderRadius(8)],buttonUnfolded:[a8,Y.l0.borderRadius(8,8,0,0)],rowContainer:[Y.l0.align.center,Y.l0.rowWithGap(8),Y.l0.position.relative,Y.l0.zIndex(1),Y.l0.overflow("hidden")],diffContainer:[Y.l0.flex.grow(1),Y.l0.borderRadius(8)],bodyContainer:[Y.l0.borderRadius(0,0,8,8),Y.l0.p(8),Y.l0.display.flex,Y.l0.flex.row,Y.l0.flex.wrap,Y.l0.align.center,Y.l0.justify.center,Y.l0.backgroundColor.backgroundDefault,Y.l0.border({color:Y.TV.outlineDimmer,direction:"bottom"}),Y.l0.border({color:Y.TV.outlineDimmer,direction:"left"}),Y.l0.border({color:Y.TV.outlineDimmer,direction:"right"})],noChangesContainer:[Y.l0.py(8),Y.l0.px(8),Y.l0.center],buttonGroupItem:[Y.l0.width(64),Y.l0.height(32)]}),a3=function(e){var t=e.value,n=e.onChange;return(0,N.BX)(a2.hE,{name:"SplitOrUnifiedDiff",value:t,onChange:n,row:!0,children:[(0,N.tZ)($.G,{css:a4.buttonGroupItem,children:(0,N.tZ)(a2.rK,{value:"Unified",text:"Unified",id:"SplitOrUnifiedDiffUnified"})}),(0,N.tZ)($.G,{css:a4.buttonGroupItem,children:(0,N.tZ)(a2.rK,{value:"Split",text:"Split",id:"SplitOrUnifiedDiffSplit"})})]})},a5=function(e){var t=e.folded,n=void 0!==t&&t,r=e.setFolded,i=e.diff,o="".concat(i.initial.path,"/").concat(i.initial.filename),a="".concat(i.final.path,"/").concat(i.final.filename);return(0,N.BX)($.G,{css:n?a4.buttonFolded:a4.buttonUnfolded,onClick:function(){return r(!n)},children:[(0,N.BX)($.G,{css:[a4.rowContainer,Y.l0.flex.shrink(1)],children:["RENAMED"===i.status||"COPIED"===i.status?(0,N.BX)(N.HY,{children:[(0,N.tZ)(aI.Z,{path:o}),(0,N.tZ)(J.xv,{multiline:!1,children:i.initial.filename}),""===i.initial.path?null:(0,N.tZ)(J.xv,{multiline:!1,color:"dimmest",css:[Y.l0.fontWeight.normal],maxLines:1,children:i.initial.path}),(0,N.tZ)(tH.Z,{}),(0,N.tZ)(aI.Z,{path:a}),(0,N.tZ)(J.xv,{multiline:!1,children:i.final.filename}),""===i.final.path?null:(0,N.tZ)(J.xv,{multiline:!1,color:"dimmest",css:[Y.l0.fontWeight.normal],children:i.final.path})]}):(0,N.BX)(N.HY,{children:[(0,N.tZ)(aI.Z,{path:a}),(0,N.tZ)(J.xv,{multiline:!1,children:i.final.filename}),""===i.final.path?null:(0,N.tZ)(J.xv,{multiline:!1,color:"dimmest",css:[Y.l0.fontWeight.normal],children:i.final.path})]}),(0,N.tZ)(aF.j,{textToCopy:a,alt:"Copy Full Path",tooltip:"Copied!",tooltipPlacement:"bottom-end",timeout:2e3,children:(0,N.tZ)(tV.Z,{})})]}),(0,N.BX)($.G,{css:a4.rowContainer,children:[(0,N.tZ)(aM,{type:i.status}),(0,N.tZ)(e_.hU,{alt:n?"Collapse diff":"Expand diff",onClick:function(){return r(!n)},children:n?(0,N.tZ)(aN.Z,{}):(0,N.tZ)(aU.Z,{})})]})]})},a6=function(e){var t=e.diff;return"Split"===e.splitOrUnified?(0,N.tZ)(a0,{a:{filePath:t.initial.filename,doc:t.initial.content},b:{filePath:t.final.filename,doc:t.final.content},collapseUnchanged:{},style:{width:"100%"}}):(0,N.tZ)(rR.ZP,{filePath:t.final.filename,initialDoc:t.final.content,extensions:[aW.p.of(nX.xv.of(t.initial.content.split("\n")))],readOnly:!0,style:{width:"100%"}})},a9=function(e){var t=e.diff,n=e.splitOrUnified;return t.loading?(0,N.tZ)($.G,{css:a4.noChangesContainer,children:(0,N.tZ)(eE.Z,{size:20})}):t.initial.content===t.final.content?(0,N.tZ)($.G,{css:a4.noChangesContainer,children:(0,N.tZ)(J.xv,{color:"dimmest",multiline:!1,children:"There are no changes to show."})}):(0,N.tZ)(a6,{diff:t,splitOrUnified:n})},a7=function(e){var t=e.diff,n=e.folded,r=e.setFolded,i=e.splitOrUnified;return(0,N.BX)($.G,{css:a4.diffContainer,children:[(0,N.tZ)(a5,{folded:n,setFolded:r,diff:t}),n?null:(0,N.tZ)(eq.Tg,{css:a4.bodyContainer,elevated:!0,children:(0,N.tZ)(a9,{diff:t,splitOrUnified:i})})]},t.id)},le=n(19858),lt=n(48900),ln=function(e){var t=e.context,n=e.gitService,r=e.result,i=e.data;lt.$e(function(e){e.setTag("service","git"),e.setTag("context",t),e.setExtra("env",n.getEnv()),i&&lt.sU("data",i),lt.Tb(r.error)})},lr=(a=(0,eO._)(function(e,t,n){var r;return(0,eX.Jh)(this,function(i){switch(i.label){case 0:return[4,e.getFileContents({path:t,revision:n})];case 1:if((r=i.sent()).error)throw ln({context:"use-file-at-revision-fetch-content",gitService:e,result:r,data:{path:t,revision:n}}),r.error;return[2,r.content||""]}})}),function(e,t,n){return a.apply(this,arguments)}),li=function(e,t){var n,r=(0,L._)((0,O.useState)(null),2),i=r[0],o=r[1],a=(0,L._)((0,O.useState)(!0),2),l=a[0],c=a[1],s=(0,le.Z)((n=(0,eO._)(function(n){var r,i;return(0,eX.Jh)(this,function(o){switch(o.label){case 0:c(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,lr(n,e,t)];case 2:return r=o.sent(),c(!1),[2,{content:r,error:null}];case 3:return i=o.sent(),c(!1),[2,{content:null,error:i}];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),[e,t]);return(0,O.useEffect)(function(){s&&(s.error?o(null):o(s.content))},[s]),{fileContent:i,loading:l}},lo=es.Type.Object({type:es.Type.Literal("diff"),data:es.Type.Object({left:es.Type.Object({path:es.Type.String(),revision:es.Type.String()}),right:es.Type.Object({path:es.Type.String(),revision:es.Type.String()})})}),la=(0,K.X)({container:[Y.l0.colWithGap(16),Y.l0.p(8)],header:[Y.l0.mt(0),Y.l0.mb(8)],emphasizedText:[Y.l0.fontWeight.bold],bodyContainer:[Y.l0.borderRadius(8),Y.l0.p(8),Y.l0.display.flex,Y.l0.flex.row,Y.l0.flex.wrap,Y.l0.align.center,Y.l0.justify.center,Y.l0.backgroundColor.backgroundDefault,Y.l0.border({color:Y.TV.outlineDimmest,direction:"full"})],tooltipContainer:[Y.l0.display.inlineBlock]}),ll=function(e){var t=e.filename,n=e.onFileClick;return(0,N.tZ)("span",{css:la.tooltipContainer,children:(0,N.tZ)(eT.u,{tooltip:"View file",children:(0,N.tZ)("button",{css:[Y.l0.reset.button,Y.l0.linkStyle,Y.l0.fontWeight.medium],onClick:n,children:t})})})},lc=function(e){return""===e?"working directory":"".concat(e)},ls=function(e){var t=e.left,n=e.right,r=e.onFileClick,i=t.path===n.path,o=t.revision===n.revision;return i?o?(0,N.BX)(J.h4,{level:1,variant:"text",css:la.header,children:["Comparing"," ",(0,N.BX)("span",{css:la.emphasizedText,children:[(0,N.tZ)(ll,{filename:t.path,onFileClick:r})," ",lc(t.revision)]})," ","to itself"]}):(0,N.BX)(J.h4,{level:1,variant:"text",css:la.header,children:["Comparing"," ",(0,N.BX)("span",{css:la.emphasizedText,children:[(0,N.tZ)(ll,{filename:t.path,onFileClick:r})," ",lc(t.revision)]})," ","to"," ",(0,N.tZ)("span",{css:la.emphasizedText,children:lc(n.revision)})]}):o?(0,N.BX)(J.h4,{level:1,variant:"text",css:la.header,children:["Comparing ",(0,N.tZ)("span",{css:la.emphasizedText,children:t.path})," to"," ",(0,N.BX)("span",{css:la.emphasizedText,children:[(0,N.tZ)(ll,{filename:n.path,onFileClick:r})," ",lc(t.revision)]})]}):(0,N.BX)(J.h4,{level:1,variant:"text",css:la.header,children:["Comparing"," ",(0,N.BX)("span",{css:la.emphasizedText,children:[t.path," ",lc(t.revision)]})," ","to"," ",(0,N.BX)("span",{css:la.emphasizedText,children:[(0,N.tZ)(ll,{filename:n.path,onFileClick:r})," ",lc(n.revision)]})]})},lu=(b={},(0,U._)(b,"Content",function(e){var t=e.pane.data,n=t.left,r=t.right,i=e.options.performPaneOperation,o=(0,L._)((0,O.useState)("Split"),2),a=o[0],l=o[1],c=li(n.path,n.revision),s=c.fileContent,u=c.loading,d=li(r.path,r.revision),f=d.fileContent,h=d.loading;return(0,N.BX)($.G,{css:la.container,children:[(0,N.tZ)(ls,{left:n,right:r,onFileClick:function(){i({operation:"open",pane:{type:(0,tX.Dp)({path:r.path}),data:{path:r.path}}})}}),(0,N.tZ)(a3,{value:a,onChange:l}),(0,N.tZ)(eq.Tg,{css:la.bodyContainer,children:(0,N.tZ)(a9,{diff:{loading:u||h,initial:{filename:(0,ec.UO)(n.path),path:(0,ec.Il)(n.path),content:null!=s?s:""},final:{filename:(0,ec.UO)(r.path),path:(0,ec.Il)(r.path),content:null!=f?f:""}},splitOrUnified:a})})]})}),(0,U._)(b,"Icon",function(){return(0,N.tZ)(aA.Z,{})}),(0,U._)(b,"getTitle",function(){return"Diff"}),(0,U._)(b,"decode",function(e){return eu.B4.Decode(lo,e)}),b),ld=n(8271),lf=n(57369),lh=n(75647),lp=n(75813),lm=n(50431),lv=n(95597);function lg(e){return!!e&&("string"==typeof e?e.includes(lv.Kd):e.fetch.includes(lv.Kd))}function ly(e){return e.endsWith(".git")?e.slice(0,-4):e}function lb(e){if(!e)return null;var t="string"==typeof e?e:e.fetch;return lg(t)?ly(t):null}function lZ(){var e,t=(0,le.Z)((e=(0,eO._)(function(e){return(0,eX.Jh)(this,function(t){return[2,{connectedToGithub:lw(e),error:null}]})}),function(t){return e.apply(this,arguments)}));return null==t||t.error?null:t.connectedToGithub}function lw(e){return e.hasProfile(lp.rG.GITHUB)}var lx=n(85340),lC=n(4391),l_=n(67795);function lk(e,t){(0,rl.j)(l_.U3.GIT_FEATURE_USED,(0,eU._)({action:e,source:"git-pane"},t))}var lS=n(89106);function lE(e){var t=e.label,n=e.allowReconnect,r=e.callback,i=(0,L._)((0,O.useState)(!1),2),o=i[0],a=i[1],l=(0,H.Z)().git,c=lZ(),s=(0,ab.Z)(),u=(0,lx.v)({onAuth:function(){lk("github-user-connected"),a(!1),l.refreshProfiles({preferredProvider:lp.rG.GITHUB}),null==r||r()},onClose:function(){return a(!1)}});return c&&!(void 0!==n&&n)?(0,N.tZ)(eW.zx,{text:"Connected to GitHub",colorway:"primary",iconLeft:(0,N.tZ)(nU.Z,{}),disabled:!0}):(0,N.tZ)(eW.zx,{text:o||null===c?"Connecting...":s?"Visit account page to connect to GitHub":void 0===t?"Connect to GitHub":t,colorway:"primary",iconLeft:o?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(lC.Z,{}),loading:o,onClick:function(){if(s){lS.X.openExternalUrl("/account#connected-services");return}a(!0),u()}})}var lT=(0,K.X)({body:[Y.l0.p(4),Y.l0.colWithGap(8),Y.l0.borderRadius(0,0,8,8)],remedies:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.justify.end]});function lR(e){var t=e.description,n=e.remedies,r=e.error;return(0,N.BX)(eq.Tg,{css:lT.body,elevated:!0,children:[(0,N.tZ)(J.xv,{children:t}),(0,N.BX)($.G,{css:lT.remedies,children:[n,(0,N.tZ)(eW.zx,{text:"Dismiss",iconLeft:(0,N.tZ)(tb.Z,{}),onClick:r.dismiss})]})]})}function lI(e){var t,n=e.error,r=(0,le.Z)((t=(0,eO._)(function(e){var t,r,i,o,a,l,c,s,u,d;return(0,eX.Jh)(this,function(f){switch(f.label){case 0:switch(n.type){case lp.aq.UNKNOWN_NOT_GIT:return[3,1];case lp.aq.UNKNOWN:return[3,2];case lp.aq.CHANNEL_CLOSED:return[3,3];case lp.aq.NOT_INITIALIZED:return[3,4];case lp.aq.UNAUTHENTICATED:return[3,5];case lp.aq.INDEX_FILE_CORRUPT:return[3,7];case lp.aq.UNKNOWN_REMOTE:return[3,8];case lp.aq.INDEX_LOCKED:return[3,9];case lp.aq.NO_COMMITS:return[3,10];case lp.aq.PATH_MATCHED_NO_FILES:return[3,11];case lp.aq.USER_NOT_CONFIGURED:return[3,12];case lp.aq.INVALID_REFERENCE:return[3,13];case lp.aq.BRANCH_ALREADY_EXISTS:return[3,14];case lp.aq.MERGE_CONFLICT:return[3,15];case lp.aq.UPSTREAM_NOT_SET:return[3,16];case lp.aq.HEAD_DETACHED:return[3,17];case lp.aq.DIRTY_WORKTREE:return[3,18];case lp.aq.PROTECTED_BRANCH:return[3,19];case lp.aq.PUSH_REJECTED:return[3,20];case lp.aq.REMOTE_ALREADY_EXISTS:return[3,21];case lp.aq.TIMEOUT:return[3,22];case lp.aq.ALREADY_INITIALIZED:return[3,23]}return[3,24];case 1:return t="Unknown error from the Git service. This is probably a bug in the app.",r=null,[3,25];case 2:return t="There was an unrecognized fatal error with Git. This is probably a bug in the app.",r=null,[3,25];case 3:return t="The command was interrupted. Please try again.",r=null,[3,25];case 4:return t="There isn't a Git repository in the Repl's root directory.",r=null,[3,25];case 5:return[4,e.getRemotes()];case 6:if((i=f.sent()).error)return[2,i];if(0!==i.remotes.size){o=!1,a=!0,l=!1,c=void 0;try{for(s=i.remotes.values()[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)if(d=u.value,lg(d)){o=!0;break}}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}if(o){if(lw(e))return t="Failed to authenticate with the remote. Please ensure that Replit has access to this repository on GitHub.",r=(0,N.tZ)(lE,{label:"Update GitHub Repository Access",callback:n.dismiss,allowReconnect:!0}),[3,25];return t="Failed to authenticate with the remote. You have not connected your Replit account to GitHub, so Replit may not have access to the remote repository. Please connect your account to GitHub and try again.",r=(0,N.tZ)(lE,{label:"Connect to GitHub",callback:n.dismiss,allowReconnect:!0}),[3,25]}}return t="Failed to authenticate with the remote.",r=null,[3,25];case 7:return t="The Git index file is corrupt. This can happen if the index file is manually edited, or if the Git repository is corrupted.",r=null,[3,25];case 8:return t="The remote specified isn't configured.",r=null,[3,25];case 9:return t="Git tried to perform an action but the index lockfile still exists. This means Git either crashed previously or is still running an action.",r=null,[3,25];case 10:return t="There are no commits in the repository.",r=null,[3,25];case 11:return t="The path specified didn't match any files.",r=null,[3,25];case 12:return t="There isn't any user information configured for Git.",r=null,[3,25];case 13:return t="An unknown/invalid reference was specified. This is usually a branch, but it could be something else, such as a tag.",r=null,[3,25];case 14:return t="The branch specified already exists.",r=null,[3,25];case 15:return t="There was an unexpected merge conflict.",r=null,[3,25];case 16:return t="The upstream branch isn't set.",r=null,[3,25];case 17:return t="The HEAD is detached. You have a commit checked out, not a branch.",r=null,[3,25];case 18:return t="There are uncommitted changes.",r=null,[3,25];case 19:return t="This operation cannot be performed on a protected branch.",r=null,[3,25];case 20:return t="The push was rejected by the remote. This is usually because the remote has commits that aren't in the local repository.",r=null,[3,25];case 21:return t="The remote specified already exists.",r=null,[3,25];case 22:return t="The remote operation timed out.",r=null,[3,25];case 23:return t="There is already a Git repository in the Repl's root directory.",r=null,[3,25];case 24:return t="We ran into an unknown error that we don't have a description for. This is probably a bug with the app.",r=null,[3,25];case 25:return[2,{description:t,remedies:r,error:null}]}})}),function(e){return t.apply(this,arguments)}),[n],{refresh:!1});if(!r)return(0,N.tZ)(lR,{description:null,remedies:null,error:n});if(r.error)return(0,N.tZ)(lR,{description:"Unknown error from the Git service. This is probably a bug in the app.",remedies:null,error:n});var i=r.description,o=r.remedies;return(0,N.tZ)(lR,{description:i,remedies:o,error:n})}var lD=(0,K.X)({errorNotification:[{pointerEvents:"all"},Y.l0.p(1),Y.l0.backgroundColor.accentNegativeDimmer,Y.l0.borderRadius(8),Y.l0.shadow(3)],header:[Y.l0.py(4),Y.l0.px(8),Y.l0.display.flex,Y.l0.flex.row,Y.l0.align.center,Y.l0.justify.spaceBetween,Y.l0.color.accentNegativeStrongest],headerText:[Y.l0.rowWithGap(4),Y.l0.align.center],errorType:[Y.l0.font.code,{opacity:.75}],body:[Y.l0.pt(4),Y.l0.pb(8),Y.l0.px(8),Y.l0.colWithGap(8),Y.l0.backgroundColor.backgroundHigher,Y.l0.borderRadius(0,0,8,8)]});function lG(e){var t=e.error;return(0,N.BX)($.G,{css:lD.errorNotification,children:[(0,N.BX)($.G,{css:lD.header,children:[(0,N.BX)($.G,{css:lD.headerText,children:[(0,N.tZ)(eV.Z,{}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:function(e){switch(e.type){case lp.aq.UNKNOWN_NOT_GIT:return"Unknown Error";case lp.aq.UNKNOWN:return"Unknown Git Error";case lp.aq.NOT_INITIALIZED:case lp.aq.UNAUTHENTICATED:case lp.aq.INDEX_FILE_CORRUPT:case lp.aq.UNKNOWN_REMOTE:case lp.aq.INDEX_LOCKED:case lp.aq.NO_COMMITS:case lp.aq.PATH_MATCHED_NO_FILES:case lp.aq.USER_NOT_CONFIGURED:case lp.aq.INVALID_REFERENCE:case lp.aq.BRANCH_ALREADY_EXISTS:case lp.aq.MERGE_CONFLICT:case lp.aq.HEAD_DETACHED:case lp.aq.DIRTY_WORKTREE:case lp.aq.PUSH_REJECTED:case lp.aq.PROTECTED_BRANCH:case lp.aq.REMOTE_ALREADY_EXISTS:case lp.aq.ALREADY_INITIALIZED:case lp.aq.TIMEOUT:return"Git Error";default:return"Unknown Error"}}(t)})]}),(0,N.tZ)(J.xv,{css:lD.errorType,multiline:!1,children:t.type})]}),(0,N.tZ)($.G,{css:lD.body,children:(0,N.tZ)(lI,{error:t})})]})}var lB=(0,O.createContext)(null);function lP(){var e=(0,O.useContext)(lB);if(!e)throw Error("Expected store in context");return e}var lA=(0,eI.cn)([]),lN=(0,eI.cn)(function(e){return e(lA)},function(e,t,n){var r=e(lA),i=Math.random().toString(36).substring(7);t(lA,[{id:i,type:n,dismiss:function(){var n=e(lA).filter(function(e){return e.id!==i});t(lA,n)}}].concat((0,ex._)(r)))});function lU(){return(0,eD.b9)(lN,{store:lP()})}var lL=(0,K.X)({errorList:[{pointerEvents:"none"},{transition:"background-color 100ms"},Y.l0.position.absolute,Y.l0.top(0),Y.l0.bottom(0),Y.l0.left(0),Y.l0.right(0),Y.l0.p(8),Y.l0.colWithGap(16),Y.l0.zIndex(10)]});function lO(){var e=(0,eD.Dv)(lN,{store:lP()});return(0,N.tZ)($.G,{style:{backgroundColor:e.length>0?"rgba(0, 0, 0, 0.25)":"transparent"},css:lL.errorList,children:e.map(function(e){return(0,N.tZ)(lG,{error:e},e.id)})})}var lX=n(4995),lM=n(66663),lF=n(58003);function lW(){var e,t,n,r,i,o=(0,L._)((0,O.useState)(!1),2),a=o[0],l=o[1],c=(0,H.Z)().git,s=(t=(e=(0,L._)((0,O.useState)(!1),2))[0],n=e[1],r=(0,H.Z)().git,(0,O.useEffect)(function(){return r.onBusyChange(n)},[r]),t),u=lU(),d=(0,le.Z)((i=(0,eO._)(function(e){var t,n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:return[4,e.isInitialized()];case 1:if((t=r.sent()).error)return u(t.error),[2,t];if(!t.initialized)return[2,{hasRemotes:!1,error:null}];return[4,e.getRemotes()];case 2:if((n=r.sent()).error)return u(n.error),[2,n];return[2,{hasRemotes:n.remotes.size>0,error:null}]}})}),function(e){return i.apply(this,arguments)}),[u]);if(null==d?void 0:d.error)return null;var f=!!d&&d.hasRemotes,h=s||a||null===d;function p(){return(p=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(c.isBusy()||h)return[2];if(l(!0),!f)return[3,2];return[4,c.fetch()];case 1:(e=t.sent()).error?u(e.error):lk("remote-fetched"),t.label=2;case 2:return[4,c.refreshProfiles()];case 3:return t.sent(),c.forceRefresh(),setTimeout(function(){return l(!1)},500),[2]}})})).apply(this,arguments)}return(0,N.tZ)(e_.hU,{alt:f?"Refresh and Fetch":"Refresh",size:24,onClick:function(){return p.apply(this,arguments)},disabled:h,children:h?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(ir.Z,{})})}(l=Z||(Z={})).DASHBOARD="DASHBOARD",l.BRANCH="BRANCH",l.CURRENT_BRANCH="CURRENT_BRANCH",l.SETTINGS="SETTINGS",l.COMMIT="COMMIT";var lH=n(68514),lV=n(30815),lz=n(93496),lj=n(40227),lq=n(87959);(c=w||(w={})).SUCCESS="SUCCESS",c.WARNING="WARNING",c.FAILED="FAILED",c.OFF="OFF";var lY=(0,K.X)({root:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.py(4)],circle:[Y.l0.width(8),Y.l0.height(8),Y.l0.borderRadius("full")]}),l$=function(e){var t,n,r,i=e.display,o=void 0===i?"inline":i,a=(0,aH._)(e,["display"]);switch(a.status){case"SUCCESS":t=Y.TV.accentPositiveStronger,n=Y.TV.accentPositiveStronger;break;case"WARNING":t=Y.TV.yellowStronger,n=Y.TV.yellowStronger;break;case"FAILED":t=Y.TV.accentNegativeStronger,n=Y.TV.accentNegativeStronger;break;case"OFF":t=Y.TV.greyStronger,n=Y.TV.greyStronger}var l=(0,N.BX)($.G,{onClick:null!==(r=a.onClick)&&void 0!==r?r:function(){},css:[lY.root,a.onClick?{cursor:"pointer"}:{}],children:[(0,N.tZ)("div",{css:lY.circle,style:{backgroundColor:t,boxShadow:"0px 0px 6px ".concat(n)}}),"inline"===o?(0,N.tZ)(J.xv,{color:"dimmer",multiline:!1,children:a.content}):null]});return"tooltip"===o&&(l=(0,N.tZ)(eT.u,{tooltip:a.content,children:l})),l},lJ=(0,K.X)({revertText:[Y.l0.color.orangeStronger,Y.l0.fontWeight.medium],mergeText:[Y.l0.color.purpleStronger,Y.l0.fontWeight.medium],pullRequestId:[Y.l0.fontWeight.medium],hash:[Y.l0.fontWeight.medium],filePathPrefix:[Y.l0.color.foregroundDimmest],commitBody:[Y.l0.font.code,{whiteSpace:"pre-wrap"},{fontSize:Y.TV.fontSizeSmall}],clickableName:[Y.l0.cursor.pointer,{"&:hover":{textDecoration:"underline"}}],tooltip:[Y.l0.display.inlineFlex,Y.l0.rowWithGap(4),Y.l0.align.center],path:[{fontSize:Y.TV.fontSizeSmall},Y.l0.font.code],fixTooltipDisplay:{"& > span":{display:"inline-block"}},headingWrapper:[Y.l0.display.inlineFlex,Y.l0.rowWithGap(4),Y.l0.align.center,Y.l0.flex.shrink(1),Y.l0.overflow("hidden")],headingRemote:[{verticalAlign:"text-bottom"},Y.l0.mr(4),Y.l0.color.foregroundDimmest],headingCurrent:[Y.l0.px(4)],text:[Y.l0.fontWeight.medium],remote:[{verticalAlign:"center"},{fontSize:Y.TV.fontSizeSmall},Y.l0.mr(4),Y.l0.color.foregroundDimmest],current:[Y.l0.position.relative,Y.l0.top("-1px"),Y.l0.display.inlineFlex,Y.l0.pl(2),Y.l0.pr(8)],icon:[{verticalAlign:"baseline !important"},Y.l0.mr(4)]});function lK(e){var t=e.text,n=e.className;return(0,N.tZ)("span",{className:n,css:lJ.revertText,children:t})}function lQ(e){var t=e.text,n=e.className;return(0,N.tZ)("span",{className:n,css:lJ.mergeText,children:t})}function l0(e){var t,n=e.id,r=e.hash,i=e.className;return t=void 0===r||r?"string"==typeof n&&n.startsWith("#")?n:"#".concat(n):"string"==typeof n&&n.startsWith("#")?n.slice(1):"".concat(n),(0,N.tZ)("span",{className:i,css:lJ.pullRequestId,children:t})}function l1(e){var t=e.hash,n=e.length,r=e.className;return(0,N.tZ)("span",{className:r,css:lJ.hash,children:t.slice(0,(void 0===n?8:n)+1)})}function l2(e){var t=e.subject,n=e.quoted,r=e.className;return(0,N.tZ)("span",{className:r,children:void 0!==n&&n?'"'.concat(t,'"'):t})}function l8(e){var t=e.body,n=e.className;return(0,N.tZ)("pre",{className:n,css:lJ.commitBody,children:t})}function l4(e){var t=e.name,n=e.remote,r=e.current,i=void 0!==r&&r,o=e.heading,a=void 0!==o&&o,l=e.icon,c=void 0!==l&&l,s=e.onClick,u=e.className,d=null;return(!0===c||!c&&i?d=i?(0,N.tZ)("span",{css:a?lJ.headingCurrent:lJ.current,children:(0,N.tZ)(l$,{display:"tooltip",content:"This is your current branch.",status:w.SUCCESS})}):a?(0,N.tZ)(lq.Z,{size:16}):(0,N.tZ)(lq.Z,{css:lJ.icon,size:12}):c&&(d=c),a)?(0,N.BX)("div",{css:lJ.headingWrapper,children:[d,(0,N.BX)(J.xv,{variant:"subheadDefault",multiline:!1,children:[n?(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{css:lJ.headingRemote,children:n}),(0,N.tZ)("span",{css:lJ.headingRemote,children:"/"})]}):null,s?(0,N.tZ)(l6,{label:"View branch",onClick:s,children:t}):(0,N.tZ)("span",{children:t})]})]}):(0,N.BX)("span",{className:u,css:lJ.text,children:[d,n?(0,N.tZ)("span",{css:lJ.remote,children:n}):null,s?(0,N.tZ)(l6,{label:"View branch",onClick:s,children:t}):(0,N.tZ)("span",{children:t})]})}function l3(e){var t=e.path,n=e.prefix,r=e.onClick,i=e.className,o=(0,ec.UO)(t),a=!r&&(o===t||null!==n&&n+o===t);return(0,N.tZ)("span",{css:lJ.fixTooltipDisplay,children:(0,N.tZ)(eT.u,{maxWidth:"auto",tooltip:(0,N.tZ)(l5,{path:t,openable:!!r}),isDisabled:a,children:r?(0,N.BX)(l6,{label:"Open ".concat(o),onClick:r,className:i,children:[n?(0,N.tZ)("span",{css:lJ.filePathPrefix,children:n}):null,(0,N.tZ)("span",{children:o})]}):(0,N.BX)("span",{className:i,children:[n?(0,N.tZ)("span",{css:lJ.filePathPrefix,children:n}):null,(0,N.tZ)("span",{children:o})]})})})}function l5(e){var t=e.path,n=e.openable;return(0,N.BX)("span",{css:lJ.tooltip,children:[void 0===n||n?(0,N.tZ)("span",{children:"Open"}):null,(0,N.tZ)("span",{css:lJ.path,children:t})]})}function l6(e){var t=e.label,n=e.onClick,r=e.className,i=e.children;return(0,N.tZ)("span",{className:r,css:lJ.clickableName,role:"button",tabIndex:-1,"aria-label":t,onClick:n,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(null==n||n())},children:i})}var l9=n(21076),l7=n(79378),ce=n(79032),ct=n(63043),cn=n(13051),cr=n(43910);function ci(){var e=(0,ns._)(["\n  query GitUserImageByUsername($username: String!) {\n    userByUsername(username: $username) {\n      id\n      image\n    }\n  }\n"]);return ci=function(){return e},e}var co={},ca=(0,nu.Ps)(ci()),cl=n(16405),cc=(0,K.X)({gitUserContainer:[Y.l0.flex.row],gitUserText:[Y.l0.fontWeight.medium],gitUserInnerContainer:[Y.l0.align.center,Y.l0.flex.row,{"& > :not(:first-child)":{marginLeft:Y.TV.space4}}],gitUserInnerContainerFlipped:[Y.l0.align.center,Y.l0.flex.rowReverse,{"& > :not(:last-child)":{marginLeft:Y.TV.space4}}],alignCenter:[Y.l0.align.center]});function cs(e){var t=e.name,n=e.email,r=e.allowPlaceholderAvatar,i=void 0!==r&&r,o=e.color,a=void 0===o?"default":o,l=e.small,c=void 0!==l&&l,s=e.flip,u=void 0!==s&&s,d=e.placement,f=e.showTooltip;return void 0===f||f?(0,N.tZ)($.G,{css:cc.gitUserContainer,children:(0,N.tZ)(eT.u,{placement:void 0===d?"bottom":d,tooltip:(0,N.tZ)(J.xv,{children:n}),children:(0,N.BX)($.G,{css:u?cc.gitUserInnerContainerFlipped:cc.gitUserInnerContainer,children:[(0,N.tZ)(cu,{email:n,name:t,enablePlaceholder:i,small:c}),(0,N.tZ)(J.xv,{multiline:!1,css:cc.gitUserText,color:a,variant:c?"small":"text",children:t})]})})}):(0,N.tZ)($.G,{css:cc.gitUserContainer,children:(0,N.BX)($.G,{css:u?cc.gitUserInnerContainerFlipped:cc.gitUserInnerContainer,children:[(0,N.tZ)(cu,{email:n,name:t,enablePlaceholder:i,small:c}),(0,N.tZ)(J.xv,{multiline:!1,css:cc.gitUserText,color:a,variant:c?"small":"text",children:t})]})})}function cu(e){var t,n=e.name,r=e.email,i=e.enablePlaceholder,o=void 0!==i&&i,a=e.small,l=void 0!==a&&a,c=(0,L._)((t=(0,eU._)({},co,{initialFetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",ssr:!1}),cr.t(ca,t)),1)[0],s=(0,L._)((0,O.useState)(null),2),u=s[0],d=s[1];return(0,O.useEffect)(function(){var e;(e=(0,eO._)(function(){var e,t,n,i,o,a,l,s,u,f;return(0,eX.Jh)(this,function(h){switch(h.label){case 0:if(!r.endsWith("@".concat(ct.O)))return[3,1];return e=r.split("@")[0],(t=(0,L._)(e.split("+"),2))[0],n=t[1],d((0,cl.vt)("https://github.com/".concat(n,".png"))),[3,4];case 1:if(!r.endsWith("@".concat(ct.J)))return[3,3];return a=r.split("@")[0],(l=(0,L._)(a.split("-"),2))[0],[4,c({variables:{username:l[1]}})];case 2:return(s=null===(o=h.sent().data)||void 0===o?void 0:null===(i=o.userByUsername)||void 0===i?void 0:i.image)&&d(s),[3,4];case 3:u=(0,ce.FB)(r),(f=new URL("https://gravatar.com/avatar/".concat(u))).searchParams.append("d","404"),d(f.toString()),h.label=4;case 4:return[2]}})}),function(){return e.apply(this,arguments)})()},[r,c]),(0,O.useMemo)(function(){var e=l?12:16;return null===u?o?(0,N.tZ)(cn.Z,{css:cc.alignCenter,size:e}):null:(0,N.tZ)(l7.q,{css:cc.alignCenter,username:n,src:u,onError:function(){return d(null)},size:e})},[u,o,l,n])}var cd=n(57624),cf=n(47357),ch=$.K.button,cp=(0,K.X)({container:[Y.l0.display.flex,Y.l0.flex.growAndShrink(1),Y.l0.overflow("hidden")],cursorOverlay:{cursor:"pointer"},fullWidth:[Y.l0.width("100%")],searchContainer:[Y.l0.p(8)],paddedX:[Y.l0.px(8)],loadingContainer:[Y.l0.display.flex,Y.l0.align.center,Y.l0.justify.center,Y.l0.py(48)],menu:[Y.l0.maxWidth(390),Y.l0.width(280),Y.l0.display.flex,Y.l0.maxHeight(300),Y.l0.borderRadius(8),Y.l0.overflow("hidden")],form:[Y.l0.display.flex,Y.l0.flex.growAndShrink(1),Y.l0.flex.column,Y.l0.overflow("hidden")],body:[Y.l0.py(8),Y.l0.colWithGap(8),Y.l0.flex.growAndShrink(1),Y.l0.overflow("auto")],branchMetadata:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.flex.shrink(1)],section:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.justify.spaceBetween],selector:[Y.l0.display.flex,Y.l0.align.center,Y.l0.rowWithGap(4)],header:[Y.l0.colWithGap(2),Y.l0.width("100%")],menuItem:[{backgroundColor:"inherit"},lz.gU.listItem,Y.l0.px(8),Y.l0.py(6),Y.l0.borderRadius(0),Y.l0.colWithGap(8),Y.l0.align.start],inputDisabled:[{opacity:.75}],padded:[Y.l0.p(8)],virtualItem:[Y.l0.position.absolute,Y.l0.top(0),Y.l0.left(0),Y.l0.width("100%"),Y.l0.overflow("hidden")],virtualList:[Y.l0.position.relative],divider:[Y.l0.mt(8),Y.l0.mb(8),Y.l0.ml(0),Y.l0.mr(0)],errorText:[Y.l0.color.accentNegativeStronger,Y.l0.mt(4)],createBranchButton:[Y.l0.height(32),Y.l0.overflow("hidden"),{whiteSpace:"nowrap",textOverflow:"ellipsis"}]}),cm=function(e,t){var n,r,i,o=lU(),a=(0,H.Z)().git,l=(0,L._)((0,O.useState)(null),2),c=l[0],s=l[1],u=(0,L._)((0,O.useState)(!1),2),d=u[0],f=u[1],h=(0,le.Z)((n=(0,eO._)(function(e){var t,n,r,i,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z,w;return(0,eX.Jh)(this,function(x){switch(x.label){case 0:return[4,e.isInitialized()];case 1:if((t=x.sent()).error)return o(t.error),[2,t];if(!t.initialized)return[2,{active:[],stale:[],important:[],error:null}];return[4,e.listBranches()];case 2:if((n=x.sent()).error)return o(n.error),[2,n];return[4,e.findDefaultBranches()];case 3:if((r=x.sent()).error)return o(r.error),[2,r];i=n.branches,a=new Set,l=!0,c=!1,s=void 0;try{for(u=function(){var e=f.value,t=i.find(function(t){return(0,l9.Pi)(t,e)});t&&a.add(t)},d=r.refs[Symbol.iterator]();!(l=(f=d.next()).done);l=!0)u()}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}h=Date.now()-72e6,p=[],m=[],v=!0,g=!1,y=void 0;try{for(b=i[Symbol.iterator]();!(v=(Z=b.next()).done);v=!0)w=Z.value,a.has(w)||(w.commit.author.date>h?p.push(w):m.push(w))}catch(e){g=!0,y=e}finally{try{v||null==b.return||b.return()}finally{if(g)throw y}}return[2,{active:p,stale:m,important:Array.from(a),error:null}]}})}),function(e){return n.apply(this,arguments)}),[o]),p=(r=(0,eO._)(function(t){var n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:if(null!==c||(0,l9.Pi)(e,t))return[2];return s(t),[4,a.switchBranch(t)];case 1:return(n=r.sent()).error?(o(n.error),s(null)):(a.forceRefresh(),lk("branch-switched")),[2]}})}),function(e){return r.apply(this,arguments)}),m=(i=(0,eO._)(function(e){var t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:if(d||""===e)return[2];return f(!0),[4,a.createBranch({name:e,checkout:!0})];case 1:return(t=n.sent()).error?(o(t.error),f(!1)):(a.forceRefresh(),f(!1),lk("branch-created")),[2]}})}),function(e){return i.apply(this,arguments)});(0,O.useEffect)(function(){null!==c&&(0,l9.Pi)(e,c)&&(s(null),t({mode:Z.CURRENT_BRANCH}))},[e,c,t]);var v=(0,O.useMemo)(function(){return null!==c},[c]);if(null===h||v)return{loading:v,active:[],stale:[],important:[],handleSwitchBranch:p,handleCreateBranch:m,error:null};if(h.error)return{loading:v,active:[],stale:[],important:[],handleSwitchBranch:p,handleCreateBranch:m,error:h.error};var g=h.active,y=h.stale,b=h.important;return{loading:v,active:null!=g?g:[],stale:null!=y?y:[],important:null!=b?b:[],handleSwitchBranch:p,handleCreateBranch:m,error:null}},cv=function(e){var t=e.branch,n=cm(t,e.switchMode),r=n.loading,i=n.active,o=n.important,a=n.stale,l=n.handleSwitchBranch,c=n.handleCreateBranch,s=(0,L._)((0,O.useState)(!1),2),u=s[0],d=s[1],f=(0,L._)((0,O.useState)(""),2),h=f[0],p=f[1],m=(0,L._)((0,O.useState)(!1),2),v=m[0],g=m[1];return(0,N.tZ)(c_,{isOpen:u,setIsOpen:d,important:o,active:i,stale:a,current:t,query:h,setQuery:p,onSwitchBranch:l,createBranchLoading:v,createBranch:(0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:return g(!0),[4,c(h)];case 1:return e.sent(),p(""),g(!1),[2]}})}),switchingBranch:r})},cg=function(e){var t=e.onClick,n=e.children,r=(0,O.useRef)(null),i=(0,L._)((0,lV.XZ)(r,!1),4),o=i[0],a=i[1],l=i[2],c=i[3];return(0,lV.Ym)(a,r),(0,N.tZ)(ch,{ref:r,role:"menuitem",css:cp.menuItem,onClick:function(e){c(),t(e)},onKeyDown:l,tabIndex:o,children:n})},cy=function(e){var t=e.branch;return(0,N.BX)($.G,{css:cp.branchMetadata,children:[(0,N.tZ)(cs,{name:t.commit.author.name,email:t.commit.author.email,color:"dimmest",allowPlaceholderAvatar:!0,placement:"top",showTooltip:!1}),(0,N.tZ)(J.xv,{color:"dimmer",variant:"small",children:(0,cd.lb)(t.commit.author.date)})]})},cb=function(e){var t=e.branch,n=e.current,r=e.onSwitchBranch,i=(0,O.useMemo)(function(){return(0,lh.p3)(t,n)},[t,n]);return(0,N.BX)(cg,{onClick:function(){return r(t)},children:[(0,N.tZ)(J.xv,{multiline:!1,variant:"small",children:(0,N.tZ)(l4,{name:t.name,remote:t.type===lh.HO.REMOTE?t.remote:null,current:i,icon:!0})}),(0,N.tZ)(cy,{branch:t})]})},cZ=function(e,t){return t.filter(function(t){return(0,l9.Qj)(t).toLowerCase().includes(e.toLowerCase())})},cw=function(e,t,n){var r=0,i=[];if(e.length+t.length+n.length===0)return i;if(i.push({key:"heading-important-".concat(r++),type:"heading",title:"Important"}),0===e.length)i.push({key:"empty-important-".concat(r++),type:"empty",title:"No important branches to show"});else for(var o=0;o<e.length;++o)i.push({key:"branch-important-".concat(r++),type:"branch",branch:e[o]});if(i.push({key:"divider-important-".concat(r++),type:"divider"}),i.push({key:"heading-active-".concat(r++),type:"heading",title:"Active"}),0===t.length)i.push({key:"empty-active-".concat(r++),type:"empty",title:"No active branches to show"});else for(var a=0;a<t.length;++a)i.push({key:"branch-active-".concat(r++),type:"branch",branch:t[a]});if(i.push({key:"divider-active-".concat(r++),type:"divider"}),i.push({key:"heading-stale-".concat(r++),type:"heading",title:"Stale"}),0===n.length)i.push({key:"empty-stale-".concat(r++),type:"empty",title:"No stale branches to show"});else for(var l=0;l<n.length;++l)i.push({key:"branch-stale-".concat(r++),type:"branch",branch:n[l]});return i},cx=function(e){var t=e.item,n=e.current,r=e.onSwitchBranch;return"heading"===t.type?(0,N.tZ)($.G,{css:cp.paddedX,children:(0,N.tZ)(J.xv,{multiline:!1,children:t.title})}):"empty"===t.type?(0,N.tZ)($.G,{css:cp.paddedX,children:(0,N.tZ)(J.xv,{variant:"small",color:"dimmer",children:t.title})}):"divider"===t.type?(0,N.tZ)($.G,{css:cp.divider,children:(0,N.tZ)(lH.R,{})}):(0,N.tZ)($.G,{children:(0,N.tZ)(cb,{branch:t.branch,current:n,onSwitchBranch:r})})},cC=function(e){var t=e.query,n=e.setQuery,r=e.filteredImportant,i=e.filteredActive,o=e.filteredStale,a=e.current,l=e.onSwitchBranch,c=e.createBranchLoading,s=e.createBranch,u=e.switchingBranch,d=(0,O.useRef)(null),f=(0,O.useMemo)(function(){return cw(r,i,o)},[r,i,o]),h=(0,cf.MG)({overscan:10,count:f.length,getScrollElement:function(){return d.current},estimateSize:function(e){var t,n;return null!==(t=void 0===(n=f[e])?0:"heading"===n.type?30:"branch"===n.type?65:"empty"===n.type?30:"divider"===n.type?20:void 0)&&void 0!==t?t:0}}),p='Create Branch "'.concat(t,'"');return(0,N.tZ)($.G,{css:cp.menu,children:(0,N.tZ)("form",{onSubmit:function(e){e.preventDefault(),s()},css:cp.form,children:u?(0,N.tZ)($.G,{css:cp.loadingContainer,children:(0,N.tZ)(eE.Z,{})}):(0,N.BX)(N.HY,{children:[(0,N.tZ)($.G,{css:cp.searchContainer,children:(0,N.tZ)(tu.E,{value:t,onChange:function(e){n(e.target.value)},onClear:function(){n("")},loading:!1,placeholder:"Find or create a branch..."})}),(0,N.tZ)($.G,{css:cp.paddedX,children:(0,N.tZ)(lH.R,{})}),0===f.length&&""!==t?(0,N.BX)($.G,{css:cp.padded,children:[(0,N.tZ)(eW.zx,{text:p,size:"small",iconLeft:c?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(i0.Z,{}),stretch:!0,css:cp.createBranchButton,disabled:c||!(0,l9.Dc)(t),type:"submit"}),(0,l9.Dc)(t)?null:(0,N.tZ)(J.xv,{variant:"small",css:cp.errorText,multiline:!1,children:"Invalid branch name"})]}):(0,N.tZ)(lV.uP,{options:{direction:"vertical"},children:(0,N.tZ)("div",{css:cp.body,ref:d,children:(0,N.tZ)("ul",{css:cp.virtualList,style:{height:"".concat(h.getTotalSize(),"px")},children:h.getVirtualItems().map(function(e){return(0,N.tZ)("div",{css:cp.virtualItem,style:{transform:"translateY(".concat(e.start,"px)")},"data-index":e.index,ref:h.measureElement,children:(0,N.tZ)(cx,{item:f[e.index],current:a,onSwitchBranch:l})},e.key)})})})})]})})})},c_=function(e){var t=e.isOpen,n=e.setIsOpen,r=e.important,i=e.active,o=e.stale,a=e.current,l=e.query,c=e.setQuery,s=e.onSwitchBranch,u=e.createBranchLoading,d=e.createBranch,f=e.switchingBranch,h=(0,O.useMemo)(function(){return cZ(l,r)},[l,r]),p=(0,O.useMemo)(function(){return cZ(l,i)},[l,i]),m=(0,O.useMemo)(function(){return cZ(l,o)},[l,o]);return(0,N.BX)(lj.xo,{label:"View Branches",placement:"bottom",isOpen:t,onOpenChange:function(e){n(e)},offset:16,children:[function(e){var n=e.onClick,r=(0,aH._)(e,["onClick"]);return(0,N.tZ)(eW.zx,{variant:"nofill",text:(0,N.BX)(J.xv,(0,eL._)((0,eU._)({multiline:!1,variant:"small",css:cp.selector},r),{children:[(0,N.tZ)(l4,{name:a.name,remote:a.type===lh.HO.REMOTE?a.remote:null,current:!0,icon:!0}),t?(0,N.tZ)(aU.Z,{}):(0,N.tZ)(aN.Z,{})]})),size:"small",stretch:!0,alignment:"start",css:cp.fullWidth,onClick:n})},(0,N.tZ)(cC,{query:l,setQuery:c,filteredImportant:h,filteredActive:p,filteredStale:m,current:a,onSwitchBranch:s,createBranchLoading:u,createBranch:d,switchingBranch:f})]})},ck=(0,K.X)({container:[Y.l0.height(36),Y.l0.px(8),Y.l0.py(4),Y.l0.rowWithGap(8),Y.l0.backgroundColor.backgroundDefault,Y.l0.align.center,Y.l0.justify.spaceBetween,Y.l0.zIndex(1),{borderBottom:"1px solid ".concat(Y.TV.outlineDimmer)}],left:[Y.l0.rowWithGap(4),Y.l0.align.center,Y.l0.flex.growAndShrink(1)],right:[Y.l0.rowWithGap(8),Y.l0.align.center],back:{marginLeft:-4}}),cS=function(e){var t=e.openSettings;return(0,N.BX)($.G,{css:ck.container,children:[(0,N.BX)($.G,{css:ck.left,children:[(0,N.tZ)(lM.Z,{size:16}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Repository"})]}),(0,N.BX)($.G,{css:ck.right,children:[(0,N.tZ)(cB,{openSettings:t}),(0,N.tZ)(lW,{})]})]})},cE=function(e){var t=e.branch,n=e.switchMode,r=e.openSettings;return(0,N.BX)($.G,{css:ck.container,children:[(0,N.tZ)($.G,{css:ck.left,children:(0,N.tZ)(cv,{branch:t,switchMode:n})}),(0,N.BX)($.G,{css:ck.right,children:[(0,N.tZ)(cB,{openSettings:r}),(0,N.tZ)(lW,{})]})]})},cT=function(e){var t=e.onBack;return(0,N.BX)($.G,{css:ck.container,children:[(0,N.BX)($.G,{css:ck.left,children:[(0,N.tZ)(cD,{onBack:t,alt:"Back"}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Settings"})]}),(0,N.tZ)($.G,{css:ck.right})]})},cR=function(e){var t=e.switchMode,n=e.openSettings;return(0,N.BX)($.G,{css:ck.container,children:[(0,N.BX)($.G,{css:ck.left,children:[(0,N.tZ)(cG,{switchMode:t}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Commit"})]}),(0,N.BX)($.G,{css:ck.right,children:[(0,N.tZ)(cB,{openSettings:n}),(0,N.tZ)(lW,{})]})]})};function cI(e){var t=e.mode,n=e.branch,r=e.switchMode,i=e.onBack,o=function(){return r({mode:Z.SETTINGS})};switch(t){case Z.DASHBOARD:return(0,N.tZ)(cS,{openSettings:o});case Z.BRANCH:case Z.CURRENT_BRANCH:if(null===n)throw Error("Tried to show branch in header, but branch is null");return(0,N.tZ)(cE,{branch:n,switchMode:r,openSettings:o});case Z.SETTINGS:return(0,N.tZ)(cT,{onBack:i});case Z.COMMIT:return(0,N.tZ)(cR,{switchMode:r,openSettings:o});default:return(0,N.BX)($.G,{css:ck.container,children:[(0,N.tZ)($.G,{css:ck.left}),(0,N.tZ)($.G,{css:ck.right})]})}}function cD(e){var t=e.onBack,n=e.alt;return(0,N.tZ)(e_.hU,{css:ck.back,alt:n,size:28,onClick:t,children:(0,N.tZ)(lX.Z,{})})}function cG(e){var t=e.switchMode;return(0,N.tZ)(cD,{css:ck.back,onBack:function(){return t({mode:Z.CURRENT_BRANCH})},alt:"Back to current branch"})}function cB(e){var t=e.openSettings;return(0,N.tZ)(e_.hU,{alt:"Settings",size:24,onClick:t,children:(0,N.tZ)(lF.Z,{})})}function cP(){return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Unsupported state: you are applying a mailbox patch."}),(0,N.tZ)(J.xv,{multiline:!1,children:"Please finish the patch manually."})]})}function cA(){return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a bisect."}),(0,N.tZ)(J.xv,{multiline:!1,children:"Please finish the bisect manually."})]})}var cN=/\s\(#(\d+)\)$/,cU=/^Revert "(.+)"/,cL=/^This reverts commit ([a-f0-9]+)(?:, reversing changes made to ([a-f0-9]+))?\./;function cO(e){var t=cU.exec(e.subject),n=cL.exec(e.body);if(t&&n){var r,i=n[1],o=t[1],a=cN.exec(o);return a&&(r=parseInt(a[1],10)),{hash:i,subject:o,pr:r}}return null}var cX=/\B#\d+\b/g,cM=/^Merged? pull request (#\d+\b)/,cF=/^Merge branch '(.+)'/,cW=/into (.+)$/;function cH(e){if("GitHub"===e.committer.name&&"noreply@github.com"===e.committer.email){var t=e.subject.match(cX);if(t){var n,r=parseInt(t[t.length-1].slice(1),10);if(r)return cN.test(e.subject)&&(n=e.subject.replace(cN,"").trim()),!n&&cM.test(e.subject)&&e.body&&-1===e.body.indexOf("\n")&&(n=e.body),{type:"pull-request",id:r,subject:n,reverts:cO(e)}}}if(cM.test(e.subject)){var i,o=cM.exec(e.subject);if(o)return e.body&&-1===e.body.indexOf("\n")&&(i=e.body),{type:"pull-request",id:parseInt(o[1].slice(1),10),subject:i,reverts:cO(e)}}if(cF.test(e.subject)){var a=cF.exec(e.subject);if(a){var l=cW.exec(e.subject);return{type:"branch",source:a[1],target:l?l[1]:null}}}return e.parents&&e.parents.length>2?{type:"octopus",parents:e.parents}:e.parents&&e.parents.length>1?{type:"simple",a:e.parents[0],b:e.parents[1]}:null}var cV=n(77615),cz=n(64992),cj={position:"absolute",top:0,height:9,width:9,border:"1px solid ".concat(Y.TV.purpleStrongest),borderRadius:"50%"},cq=(0,K.X)({markerContainer:[Y.l0.display.flex,Y.l0.align.center,Y.l0.justify.center,Y.l0.minHeight(20),Y.l0.minWidth(20)],commitMarker:[Y.l0.height(4),Y.l0.width(4),Y.l0.backgroundColor.foregroundDefault,Y.l0.borderRadius("full")],collapsedMarkerIconDot:[Y.l0.height(3),Y.l0.width(3),Y.l0.backgroundColor.foregroundDimmer,Y.l0.borderRadius("full")],collapsedMarkerIconContainer:[Y.l0.display.flex,Y.l0.align.center,Y.l0.justify.center,{"div + div":{marginLeft:1}}],collapsedMarker:[Y.l0.display.flex,Y.l0.align.center,Y.l0.justify.center,Y.l0.height(20),Y.l0.width(20),Y.l0.backgroundColor.backgroundHighest,Y.l0.borderRadius("full")],revertMarker:[Y.l0.display.flex,Y.l0.height(20),Y.l0.width(20),Y.l0.backgroundColor.orangeDimmest,Y.l0.borderRadius("full"),Y.l0.align.center,Y.l0.justify.center],mergeMarker:[Y.l0.display.flex,Y.l0.height(20),Y.l0.width(20),Y.l0.backgroundColor.purpleDimmest,Y.l0.borderRadius("full"),Y.l0.align.center,Y.l0.justify.center],mergeMarkerIconContainer:[Y.l0.position.relative,Y.l0.height(9),Y.l0.width(13)],mergeMarkerIconLeft:[(0,eU._)({},cj),Y.l0.left(0)],mergeMarkerIconRight:[(0,eU._)({},cj),Y.l0.right(0)],boundaryMarker:[Y.l0.height(6),Y.l0.width(6),Y.l0.backgroundColor.backgroundDefault,Y.l0.borderRadius("full"),{border:"1px solid ".concat(Y.TV.backgroundHighest)}]});function cY(e){var t=function(e){switch(e){case"none":default:return null;case"commit":return(0,N.tZ)(c$,{});case"revert":return(0,N.tZ)(cJ,{});case"merge":return(0,N.tZ)(cK,{});case"boundary":return(0,N.tZ)(cQ,{});case"collapsed":return(0,N.tZ)(c0,{})}}(e.type);return t?(0,N.tZ)("div",{css:cq.markerContainer,children:t}):null}function c$(){return(0,N.tZ)("div",{css:cq.commitMarker})}function cJ(){return(0,N.tZ)("div",{css:cq.revertMarker,children:(0,N.tZ)(cz.Z,{size:12,color:Y.TV.orangeStrongest})})}function cK(){return(0,N.tZ)("div",{css:cq.mergeMarker,children:(0,N.BX)("div",{css:cq.mergeMarkerIconContainer,children:[(0,N.tZ)("div",{css:cq.mergeMarkerIconLeft}),(0,N.tZ)("div",{css:cq.mergeMarkerIconRight})]})})}function cQ(){return(0,N.tZ)("div",{css:cq.boundaryMarker})}function c0(){return(0,N.tZ)("div",{css:cq.collapsedMarker,children:(0,N.BX)("div",{css:cq.collapsedMarkerIconContainer,children:[(0,N.tZ)("div",{css:cq.collapsedMarkerIconDot}),(0,N.tZ)("div",{css:cq.collapsedMarkerIconDot}),(0,N.tZ)("div",{css:cq.collapsedMarkerIconDot})]})})}var c1=[Y.l0.position.absolute,Y.l0.left(0),Y.l0.width(18)],c2=(0,K.X)({connectorSegmentBorderSolid:[c1,{borderRight:"1px solid ".concat(Y.TV.outlineDimmest)}],connectorSegmentBorderDashed:[c1,{borderRight:"1px dashed ".concat(Y.TV.outlineDimmest)}]});function c8(e){var t=e.boundaryTop,n=void 0!==t&&t,r=e.boundaryBottom,i=void 0!==r&&r,o=e.joint,a=void 0===o?"top":o,l=e.hideTop,c=void 0!==l&&l,s=e.hideBottom,u=void 0!==s&&s;if(c&&u)return null;if(n===i&&!c&&!u)return(0,N.tZ)(c3,{top:0,bottom:0,dashed:n&&i});var d=c?null:(0,N.tZ)(c4,{start:"top",joint:a,dashed:n}),f=u?null:(0,N.tZ)(c4,{start:"bottom",joint:a,dashed:i});return(0,N.BX)(N.HY,{children:[d,f]})}function c4(e){var t,n,r=e.start,i=e.joint,o=e.dashed,a="center"===i?(t={},(0,U._)(t,r,0),(0,U._)(t,"height","50%"),t):(n={},(0,U._)(n,r,0),(0,U._)(n,r===i?"height":i,8),n);return(0,N.tZ)(c3,(0,eL._)((0,eU._)({},a),{dashed:void 0!==o&&o}))}function c3(e){var t=e.top,n=e.bottom,r=e.height,i=e.dashed;return(0,N.tZ)("div",{css:void 0!==i&&i?c2.connectorSegmentBorderDashed:c2.connectorSegmentBorderSolid,style:{top:t,bottom:n,height:r}})}var c5=(0,K.X)({container:{position:"relative",marginLeft:30,marginRight:4,paddingLeft:6,userSelect:"none"},containerInteractive:[lz.gU.nofill,{position:"relative",marginLeft:30,marginRight:4,paddingLeft:6,userSelect:"none"}],nodeFoldedIconContainer:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:8,zIndex:1,opacity:0,"div:hover > &":{transition:"opacity 120ms ease-out",opacity:1}},nodeUnFoldedIconContainer:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:8,zIndex:1},nodeContentContainer:[Y.l0.colWithGap(4),{position:"relative",paddingTop:8,paddingBottom:8,paddingRight:8}],nodeHeader:{display:"block",height:20},nodeUnfoldedContentSurface:[Y.l0.mt(4),Y.l0.mb(8),Y.l0.p(8),Y.l0.borderRadius(8),{marginLeft:36,marginRight:8,overflowX:"hidden"}],unfoldedContentContainer:[Y.l0.position.relative]});function c6(e){var t=e.boundaryTop,n=e.boundaryBottom,r=void 0!==n&&n,i=e.hideConnectorTop,o=e.hideConnectorBottom,a=void 0!==o&&o,l=e.joint,c=void 0===l?"top":l,s=e.marker,u=e.header,d=e.unfoldedContent,f=e.children,h=e.className,p=(0,L._)((0,O.useState)(!0),2),m=p[0],v=p[1];return(0,N.BX)($.G,{className:h,css:Y.l0.position.relative,children:[(0,N.tZ)(c8,{boundaryTop:void 0!==t&&t,boundaryBottom:r,joint:c,hideTop:void 0!==i&&i,hideBottom:a}),s?(0,N.tZ)(c7,{joint:c,children:s}):null,d?(0,N.BX)($.G,{css:c5.containerInteractive,role:"button",tabIndex:0,onClick:function(){v(!m)},onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&v(!m)},children:[m?(0,N.tZ)("div",{css:c5.nodeFoldedIconContainer,children:(0,N.tZ)(aN.Z,{})}):(0,N.tZ)("div",{css:c5.nodeUnFoldedIconContainer,children:(0,N.tZ)(aU.Z,{})}),(0,N.BX)($.G,{css:c5.nodeContentContainer,children:[u?(0,N.tZ)($.G,{css:c5.nodeHeader,children:u}):null,f?(0,N.tZ)($.G,{children:f}):null]})]}):(0,N.tZ)($.G,{css:c5.container,children:(0,N.BX)($.G,{css:c5.nodeContentContainer,children:[u?(0,N.tZ)($.G,{css:c5.nodeHeader,children:u}):null,f?(0,N.tZ)($.G,{children:f}):null]})}),!d||m?null:(0,N.BX)($.G,{css:c5.unfoldedContentContainer,children:[a?null:(0,N.tZ)(c3,{top:0,bottom:0,dashed:r}),(0,N.tZ)(eq.Tg,{css:c5.nodeUnfoldedContentSurface,elevated:!0,children:d})]})]})}var c9=(0,K.X)({top:{position:"absolute",top:8,left:18,transform:"translateX(-50%)"},bottom:{position:"absolute",bottom:8,left:18,transform:"translateX(-50%)"},center:{position:"absolute",top:"50%",left:18,transform:"translateX(-50%) translateY(-50%)"}});function c7(e){var t=e.joint,n=e.children;return(0,N.tZ)("div",{css:c9[void 0===t?"top":t],children:n})}var se=(0,K.X)({container:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.justify.spaceBetween,Y.l0.height("100%")],textContainer:[Y.l0.rowWithGap(4),Y.l0.center],text:[Y.l0.flex.shrink(0)]});function st(e){var t=e.text,n=(0,aH._)(e,["text"]);return(0,N.tZ)(c6,(0,eU._)({marker:(0,N.tZ)(cY,{type:"boundary"}),joint:"center",header:(0,N.BX)($.G,{css:se.container,children:[(0,N.tZ)(lH.R,{}),(0,N.BX)($.G,{css:se.textContainer,children:[(0,N.tZ)(cV.Z,{size:12,color:Y.TV.foregroundDimmest}),(0,N.tZ)(J.xv,{css:se.text,variant:"small",color:"dimmest",multiline:!1,children:t})]}),(0,N.tZ)(lH.R,{})]})},n))}var sn=(0,K.X)({definitionList:{display:"grid",gridTemplateColumns:"auto 1fr",paddingLeft:Y.TV.space4,"> dt":{display:"flex",alignItems:"center",paddingBottom:Y.TV.space2},"> dd":{marginLeft:Y.TV.space12,paddingBottom:Y.TV.space2}},listHeader:[Y.l0.fontWeight.medium],content:[Y.l0.colWithGap(8)],description:[Y.l0.colWithGap(8)],commitList:[Y.l0.colWithGap(2),Y.l0.pl(4)]}),sr=function(e,t){var n=!e.body,r=null,i=null;return t&&"type"in t?(r=t,"pull-request"===t.type&&(t.reverts&&(i=t.reverts),t.subject&&(n=!0))):t&&(i=t),{hideBody:n,merge:r,revert:i}},si=function(e){var t=e.hash;return(0,N.tZ)(aF.m,{size:"small",iconLeft:(0,N.tZ)(tV.Z,{}),textToCopy:t,text:t.slice(0,7),tooltip:"Hash copied!"})},so=function(e){var t=e.onClick,n=e.text,r=e.loading;return(0,N.tZ)(eT.u,{tooltip:"Discard current changes and restore files to time of commit",children:(0,N.tZ)(eW.zx,{text:n,onClick:t,size:"small",iconLeft:void 0!==r&&r?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(cz.Z,{})})})},sa=function(e,t){return!(e.name===t.name&&e.email===t.email)},sl=function(e,t){return!(6e4>Math.abs(e-t))};function sc(e){var t=e.commit,n=e.info,r=sa(t.committer,t.author),i=sl(t.author.date,t.committer.date),o=sr(t,void 0===n?null:n),a=o.hideBody,l=o.merge,c=o.revert;return(0,N.BX)($.G,{css:sn.content,children:[a?null:(0,N.BX)($.G,{css:sn.description,children:[(0,N.tZ)(J.xv,{children:(0,N.tZ)(l8,{body:t.body})}),(0,N.tZ)(lH.R,{css:Y.l0.backgroundColor.outlineDimmer})]}),(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{css:sn.listHeader,multiline:!1,children:"Author"}),(0,N.BX)("dl",{css:sn.definitionList,children:[(0,N.tZ)("dt",{children:"Name:"}),(0,N.tZ)("dd",{children:t.author.name}),(0,N.tZ)("dt",{children:"Email:"}),(0,N.tZ)("dd",{children:t.author.email})]})]}),r?(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{css:sn.listHeader,multiline:!1,children:"Committer"}),(0,N.BX)("dl",{css:sn.definitionList,children:[(0,N.tZ)("dt",{children:"Name:"}),(0,N.tZ)("dd",{children:t.committer.name}),(0,N.tZ)("dt",{children:"Email:"}),(0,N.tZ)("dd",{children:t.committer.email})]})]}):null,(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{css:sn.listHeader,multiline:!1,children:"Commit"}),(0,N.BX)("dl",{css:sn.definitionList,children:[i?(0,N.BX)(N.HY,{children:[(0,N.tZ)("dt",{children:"Authored:"}),(0,N.tZ)("dd",{children:(0,N.tZ)(cd.EK,{date:t.author.date,dateFormat:"absolute"})}),(0,N.tZ)("dt",{children:"Committed:"}),(0,N.tZ)("dd",{children:(0,N.tZ)(cd.EK,{date:t.committer.date,dateFormat:"absolute"})})]}):(0,N.BX)(N.HY,{children:[(0,N.tZ)("dt",{children:"Date:"}),(0,N.tZ)("dd",{children:(0,N.tZ)(cd.EK,{date:t.author.date,dateFormat:"absolute"})})]}),(0,N.tZ)("dt",{children:"Hash:"}),(0,N.tZ)("dd",{children:(0,N.tZ)(si,{hash:t.hash})}),l&&"pull-request"===l.type?(0,N.BX)(N.HY,{children:[(0,N.tZ)("dt",{children:"PR:"}),(0,N.BX)("dd",{children:["#",l.id]})]}):null,l&&"branch"===l.type?(0,N.BX)(N.HY,{children:[(0,N.tZ)("dt",{children:"Merged:"}),(0,N.tZ)("dd",{children:l.source}),l.target?(0,N.BX)(N.HY,{children:[(0,N.tZ)("dt",{children:"Into:"}),(0,N.tZ)("dd",{children:l.target})]}):null]}):null,c?(0,N.BX)(N.HY,{children:[(0,N.tZ)("dt",{children:"Reverted:"}),(0,N.tZ)("dd",{children:c.hash})]}):null]})]}),l&&"simple"===l.type?(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{css:sn.listHeader,multiline:!1,children:"Merged"}),(0,N.BX)($.G,{css:sn.commitList,children:[(0,N.tZ)(J.xv,{multiline:!1,children:l.a}),(0,N.tZ)(J.xv,{multiline:!1,children:l.b})]})]}):null,l&&"octopus"===l.type?(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{css:sn.listHeader,multiline:!1,children:"Merged"}),(0,N.tZ)($.G,{css:sn.commitList,children:l.parents.map(function(e,t){return(0,N.tZ)(J.xv,{multiline:!1,children:e},t)})})]}):null]})}var ss=(0,K.X)({authorContainer:[Y.l0.rowWithGap(8),Y.l0.align.center],headerText:[Y.l0.rowWithGap(4),Y.l0.align.center,Y.l0.fontWeight.medium],headerContainer:[Y.l0.colWithGap(4),Y.l0.align.start,Y.l0.justify.start],button:[Y.l0.reset.button,Y.l0.linkStyle,Y.l0.color.foregroundDefault,Y.l0.fontWeight.medium,{display:"block",width:"100%",textAlign:"left"}]}),su=function(e){var t=e.author;return(0,N.BX)($.G,{css:ss.authorContainer,children:[(0,N.tZ)(cs,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,N.tZ)(cd.EK,{date:t.date,textColor:"dimmest",textVariant:"small"})]})},sd=function(e){var t=e.children;return(0,N.tZ)(J.xv,{css:ss.headerText,multiline:!1,maxLines:1,children:t})},sf=function(e){var t=e.commit,n=e.onViewCommitClick,r=e.children;return(0,N.tZ)($.G,{css:ss.headerContainer,children:(0,N.tZ)(eT.u,{tooltip:"View ".concat(t.hash.slice(0,7)),children:(0,N.tZ)("button",{css:ss.button,onClick:function(){return n(t.hash)},children:r})})})};function sh(e){var t=e.commit,n=(0,aH._)(e,["commit"]);return(0,N.tZ)(c6,(0,eL._)((0,eU._)({marker:(0,N.tZ)(cY,{type:"commit"}),header:(0,N.tZ)(sd,{children:(0,N.tZ)(l2,{subject:t.subject})}),unfoldedContent:(0,N.tZ)(sc,{commit:t})},n),{children:(0,N.tZ)(su,{author:t.author})}))}var sp=function(e){var t=e.commit,n=e.onViewCommitClick,r=(0,aH._)(e,["commit","onViewCommitClick"]);return(0,N.tZ)(c6,(0,eL._)((0,eU._)({marker:(0,N.tZ)(cY,{type:"commit"}),header:(0,N.tZ)(sf,{commit:t,onViewCommitClick:function(){return n(t.hash)},children:(0,N.tZ)(sd,{children:(0,N.tZ)(l2,{subject:t.subject})})})},r),{children:(0,N.tZ)(su,{author:t.author})}))},sm=n(65260);function sv(e){var t,n=e.commit,r=e.info,i=(0,aH._)(e,["commit","info"]);return"branch"!==r.type&&(t="pull-request"===r.type&&r.subject?r.subject:n.subject),(0,N.tZ)(c6,(0,eL._)((0,eU._)({marker:(0,N.tZ)(cY,{type:"merge"}),header:(0,N.BX)(sd,{children:[(0,N.tZ)(lQ,{text:"merged"}),(0,N.tZ)(sy,{info:r,hash:n.hash,subject:n.subject})]}),unfoldedContent:(0,N.tZ)(sc,{commit:n,info:r})},i),{children:(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[t?(0,N.tZ)(J.xv,{color:"dimmer",variant:"small",multiline:!1,children:(0,N.tZ)(l2,{subject:t})}):null,(0,N.tZ)(su,{author:n.author})]})}))}var sg=function(e){var t,n=e.commit,r=e.info,i=e.onViewCommitClick,o=(0,aH._)(e,["commit","info","onViewCommitClick"]);return"branch"!==r.type&&(t="pull-request"===r.type&&r.subject?r.subject:n.subject),(0,N.tZ)(c6,(0,eL._)((0,eU._)({marker:(0,N.tZ)(cY,{type:"merge"}),header:(0,N.tZ)(sf,{commit:n,onViewCommitClick:function(){return i(n.hash)},children:(0,N.BX)(sd,{children:[(0,N.tZ)(lQ,{text:"merged"}),(0,N.tZ)(sy,{info:r,hash:n.hash,subject:n.subject})]})})},o),{children:(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[t?(0,N.tZ)(J.xv,{color:"dimmer",variant:"small",multiline:!1,children:(0,N.tZ)(l2,{subject:t})}):null,(0,N.tZ)(su,{author:n.author})]})}))};function sy(e){var t=e.info,n=e.hash,r=e.subject,i=(0,N.tZ)("span",{css:Y.l0.fontWeight.medium,children:r});switch(t.type){case"pull-request":return(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{children:"pull request"}),(0,N.tZ)(l0,{id:t.id}),t.reverts&&t.reverts.pr?(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{children:"-"}),(0,N.tZ)(lK,{text:"reverts"}),(0,N.tZ)(l0,{id:t.reverts.pr})]}):null]});case"branch":if(!t.target)return(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{children:"branch"}),(0,N.tZ)(l4,{name:t.source})]});return(0,N.BX)(N.HY,{children:[(0,N.tZ)(l4,{name:t.source}),(0,N.tZ)("span",{children:"into"}),(0,N.tZ)(l4,{name:t.target})]});case"simple":return(0,N.BX)(N.HY,{children:[(0,N.tZ)(l1,{hash:t.a}),(0,N.tZ)(sm.Z,{css:{alignSelf:"center"},size:12}),(0,N.tZ)(l1,{hash:t.b})]});case"octopus":return(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{children:"commit"}),(0,N.tZ)(l1,{hash:n}),(0,N.BX)("span",{children:["(",t.parents.length," parents)"]})]});default:return i}}function sb(e){var t=e.commit,n=e.info,r=(0,aH._)(e,["commit","info"]);return(0,N.tZ)(c6,(0,eL._)((0,eU._)({marker:(0,N.tZ)(cY,{type:"revert"}),header:(0,N.BX)(sd,{children:[(0,N.tZ)(lK,{text:"reverted"}),(0,N.tZ)(l1,{hash:n.hash}),(0,N.tZ)(l2,{subject:n.subject,quoted:!0})]}),unfoldedContent:(0,N.tZ)(sc,{commit:t,info:n})},r),{children:(0,N.tZ)(su,{author:t.author})}))}var sZ=function(e){var t=e.commit,n=e.info,r=e.onViewCommitClick,i=(0,aH._)(e,["commit","info","onViewCommitClick"]);return(0,N.tZ)(c6,(0,eL._)((0,eU._)({marker:(0,N.tZ)(cY,{type:"revert"}),header:(0,N.tZ)(sf,{commit:t,onViewCommitClick:function(){return r(t.hash)},children:(0,N.BX)(sd,{children:[(0,N.tZ)(lK,{text:"reverted"}),(0,N.tZ)(l1,{hash:n.hash}),(0,N.tZ)(l2,{subject:n.subject,quoted:!0})]})})},i),{children:(0,N.tZ)(su,{author:t.author})}))};function sw(e){var t=e.button,n=(0,aH._)(e,["button"]);return(0,N.tZ)(c6,(0,eL._)((0,eU._)({marker:(0,N.tZ)(cY,{type:"boundary"}),joint:"center"},n),{children:(0,N.tZ)($.G,{children:t})}))}var sx=(0,K.X)({body:[Y.l0.flex.growAndShrink(1)],virtualItem:[Y.l0.position.absolute,Y.l0.top(0),Y.l0.left(0),Y.l0.width("100%"),Y.l0.overflow("hidden")],virtualList:[Y.l0.position.relative]}),sC=function(){return 60};function s_(e){var t=e.items,n=(0,O.useRef)(null),r=(0,cf.MG)({overscan:10,count:t.length,getScrollElement:function(){return n.current},estimateSize:sC});return(0,N.tZ)("div",{ref:n,css:sx.body,children:(0,N.tZ)("div",{css:sx.virtualList,style:{height:"".concat(r.getTotalSize(),"px")},children:r.getVirtualItems().map(function(e){return(0,N.tZ)("div",{css:sx.virtualItem,style:{transform:"translateY(".concat(e.start,"px)")},"data-index":e.index,ref:r.measureElement,children:(0,N.tZ)(sk,{items:t,index:e.index})},e.key)})})})}function sk(e){var t=e.items,n=e.index,r=t[n],i=0===n,o=n===t.length-1;if("boundary"===r.type)return(0,N.tZ)(st,{text:r.text,hideConnectorTop:i,hideConnectorBottom:o,boundaryTop:!0,boundaryBottom:!0},r.text);if("button"===r.type)return(0,N.tZ)(sw,{button:r.button,hideConnectorTop:i,hideConnectorBottom:o,boundaryTop:!0,boundaryBottom:!0},r.key);var a=t[n-1]?t[n-1].type:null,l=t[n+1]?t[n+1].type:null;return(0,N.tZ)(sS,{commit:r.commit,hideConnectorTop:i,hideConnectorBottom:o,boundaryTop:"commit"!==a,boundaryBottom:"commit"!==l,onViewCommitClick:r.onViewCommitClick},r.commit.hash)}function sS(e){var t=e.commit,n=e.onViewCommitClick,r=(0,aH._)(e,["commit","onViewCommitClick"]),i=cH(t);if(i)return n?(0,N.tZ)(sg,(0,eU._)({info:i,commit:t,onViewCommitClick:n},r)):(0,N.tZ)(sv,(0,eU._)({info:i,commit:t},r));var o=cO(t);return o?n?(0,N.tZ)(sZ,(0,eU._)({info:o,commit:t,onViewCommitClick:n},r)):(0,N.tZ)(sb,(0,eU._)({info:o,commit:t},r)):n?(0,N.tZ)(sp,(0,eU._)({commit:t,onViewCommitClick:n},r)):(0,N.tZ)(sh,(0,eU._)({commit:t},r))}var sE=(0,nr.F4)({from:{opacity:0},to:{opacity:1}}),sT=(0,K.X)({loadingView:[{animation:"".concat(sE," 0.125s 0.25s linear backwards")},Y.l0.flex.grow(1),Y.l0.display.flex,Y.l0.center]});function sR(){return(0,N.tZ)($.G,{css:sT.loadingView,children:(0,N.tZ)(eE.Z,{size:48})})}var sI=n(91075);function sD(e){var t,n,r,i,o,a,l,c,s,u,d=e.status,f=e.gotoPendingState,h=(0,L._)((0,O.useState)(!1),2),p=h[0],m=h[1],v=lU(),g=(0,H.Z)().git,y=d.branch,b=null!==(o=null===(n=d.upstream)||void 0===n?void 0:n.branch)&&void 0!==o?o:null,Z=null!==(a=null===(r=d.upstream)||void 0===r?void 0:r.behind)&&void 0!==a?a:0,w=null!==(l=null===(i=d.upstream)||void 0===i?void 0:i.ahead)&&void 0!==l?l:0,x=d.changes.length>0,C=(0,le.Z)((t=(0,eO._)(function(e){var t,n,r;return(0,eX.Jh)(this,function(i){switch(i.label){case 0:if(!y||!b||!Z||x)return[2,{canPull:!1,mode:sI.T.FF_ONLY,error:null}];return[4,e.isInitialized()];case 1:if((t=i.sent()).error)return v(t.error),[2,t];if(!t.initialized)return[2,{canPull:!1,mode:sI.T.FF_ONLY,error:null}];return[4,e.canMergeBranches(y,b)];case 2:if((n=i.sent()).error)return v(n.error),[2,n];return r=sI.T.FF_ONLY,w>0&&(r=n.canMerge?sI.T.REBASE:sI.T.MERGE),[2,{canPull:!0,mode:r,error:null}]}})}),function(e){return t.apply(this,arguments)}),[v,y,b,Z,w,x],{keepStaleResult:!1});if(null==C?void 0:C.error)return null;var _=null===C,k=null!==(c=null==C?void 0:C.canPull)&&void 0!==c&&c,S=null!==(s=null==C?void 0:C.mode)&&void 0!==s?s:sI.T.FF_ONLY;function E(){return(E=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(p)return[2];return m(!0),[4,g.pull({mode:S,allowConflicts:!0})];case 1:return e=t.sent(),g.forceRefresh(),e.error?(v(e.error),m(!1)):(e.hasConflicts&&f(),lk("upstream-pulled")),[2]}})})).apply(this,arguments)}return p?u="Pulling...":y?x?u="Cannot pull with uncommitted changes":0===Z?u="Nothing to pull":_?u="Checking for merge conflicts":k?(u="Pull ".concat(Z," ").concat((0,eC.Z)("commit",Z)),S===sI.T.REBASE?u+=" with rebase":S===sI.T.MERGE&&(u+=" with merge")):u="Cannot pull due to merge conflict":u="Cannot pull - the HEAD is detached",(0,N.tZ)(eW.zx,{text:u,iconLeft:_||p?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(e1.Z,{}),onClick:function(){return E.apply(this,arguments)},loading:_||p,disabled:!k})}var sG=n(6620);function sB(e){var t,n,r,i,o,a=e.status,l=(0,L._)((0,O.useState)(!1),2),c=l[0],s=l[1],u=lU(),d=(0,H.Z)().git,f=null===a.branch,h=null!==(r=null===(t=a.upstream)||void 0===t?void 0:t.behind)&&void 0!==r?r:0,p=null!==(i=null===(n=a.upstream)||void 0===n?void 0:n.ahead)&&void 0!==i?i:0,m=f||h>0||0===p;function v(){return(v=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(m||c)return[2];return s(!0),[4,d.push()];case 1:return e=t.sent(),d.forceRefresh(),e.error?(u(e.error),s(!1)):lk("upstream-pushed"),[2]}})})).apply(this,arguments)}return o=c?"Pushing...":f?"Cannot push - the HEAD is detached":0===p?"Nothing to push":h>0?"Cannot push due to unpulled changes":"Push ".concat(p," ").concat((0,eC.Z)("commit",p)),(0,N.tZ)(eW.zx,{text:o,iconLeft:c?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(sG.Z,{}),onClick:function(){return v.apply(this,arguments)},disabled:m,loading:c})}function sP(e){if(0===e.length)return new Map;if(1===e.length)return new Map([[e[0],null]]);var t=new Map,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=(0,ec.UO)(l),s=t.get(c);s||(s=[],t.set(c,s)),s.push(l)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}var u=new Map,d=!0,f=!1,h=void 0;try{for(var p,m=t[Symbol.iterator]();!(d=(p=m.next()).done);d=!0)!function(){var e=(0,L._)(p.value,2)[1];if(1===e.length)return u.set(e[0],null);var t=new Map,n=new Set,r=0,i=!0,o=!1,a=void 0;try{for(var l,c=e[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;if(-1===s.indexOf("/")){u.set(s,null),n.add(s);continue}var d=function(e){for(var t=e.split("/").slice(0,-1),n=[],r=0;r<t.length;r++){var i=t.slice(r).join("/")+"/";0!==r&&(i="/"+i),n.push(i)}return n.reverse()}(s);t.set(s,d),d.length>r&&(r=d.length)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}for(var f=0;f<=r;f++){var h=function(e){var r=[],i=new Map,o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var d=(0,L._)(c.value,2),f=d[0],h=d[1];if(!n.has(f)){var p=h[e];p||(p=h[h.length-1]),r.push(p),i.set(p,f)}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}if(0===r.length)return"break";var m=!0,v=!1,g=void 0;try{for(var y,b=r[Symbol.iterator]();!(m=(y=b.next()).done);m=!0)!function(){var e=y.value,t=i.get(e);if(void 0===t)throw Error("Unpopulated segment map");1===r.filter(function(t){return t===e}).length&&(n.add(t),u.set(t,e))}()}catch(e){v=!0,g=e}finally{try{m||null==b.return||b.return()}finally{if(v)throw g}}}(f);if("break"===h)break}if(n.size!==e.length){var m=!0,v=!1,g=void 0;try{for(var y,b=e[Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var Z=y.value;if(!n.has(Z)){var w=Z.split("/").slice(0,-1).join("/");u.set(Z,w)}}}catch(e){v=!0,g=e}finally{try{m||null==b.return||b.return()}finally{if(v)throw g}}}}()}catch(e){f=!0,h=e}finally{try{d||null==m.return||m.return()}finally{if(f)throw h}}return u}var sA=n(31498),sN=(0,K.X)({actionsIndex:[Y.l0.height(24),Y.l0.align.center,Y.l0.borderRadius(4)],actionsWorktree:[Y.l0.height(24),Y.l0.flex.row,Y.l0.align.center,Y.l0.borderRadius(4)],unstage:[Y.l0.height(24),Y.l0.width(24),Y.l0.borderRadius(2)],stage:[Y.l0.px(12),Y.l0.height(24),Y.l0.width(24),Y.l0.borderRadius(2)],reset:[Y.l0.pl(16),Y.l0.pr(12),Y.l0.height(24),Y.l0.width(24),Y.l0.borderRadius(2)],resetIcon:{transform:"scale(0.85)"},divider:[Y.l0.height("75%"),Y.l0.width(1),Y.l0.backgroundColor.outlineStronger]});function sU(e){var t=e.file,n=e.list,r=e.stageFiles,i=e.restoreFiles,o=e.disabled,a=void 0!==o&&o,l=(0,L._)((0,O.useState)(!1),2),c=l[0],s=l[1],u=(0,L._)((0,O.useState)(!1),2),d=u[0],f=u[1];function h(){return(h=(0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:if(a)return[2];return s(!0),[4,r({reset:[t.path]})];case 1:return e.sent(),s(!1),[2]}})})).apply(this,arguments)}function p(){return(p=(0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:if(a)return[2];return s(!0),[4,r({add:[t.path]})];case 1:return e.sent(),s(!1),[2]}})})).apply(this,arguments)}function m(){return(m=(0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:if(a||"worktree"!==n)return[2];return f(!0),[4,i(t.path)];case 1:return e.sent(),f(!1),[2]}})})).apply(this,arguments)}return a=a||d||c,"index"===n?(0,N.tZ)(eq.Tg,{elevated:!0,css:sN.actionsIndex,children:(0,N.tZ)(e_.hU,{css:sN.unstage,alt:"Unstage changes",size:18,tooltipDelay:"long",onClick:function(){return h.apply(this,arguments)},disabled:a,children:c?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(sA.Z,{})})}):(0,N.BX)(eq.Tg,{elevated:!0,css:sN.actionsWorktree,children:[(0,N.tZ)(e_.hU,{css:sN.reset,alt:"Reset changes",size:18,tooltipDelay:"long",onClick:function(){return m.apply(this,arguments)},disabled:a,children:d?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(cz.Z,{css:sN.resetIcon})}),(0,N.tZ)("div",{css:sN.divider}),(0,N.tZ)(e_.hU,{css:sN.stage,alt:"Stage changes",size:18,tooltipDelay:"long",onClick:function(){return p.apply(this,arguments)},disabled:a,children:c?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(i0.Z,{})})]})}var sL=(0,K.X)({path:[Y.l0.rowWithGap(8),Y.l0.flex.growAndShrink(1),Y.l0.align.center],source:[Y.l0.color.foregroundDimmest],sourceArrow:[Y.l0.mx(8)]});function sO(e){var t=e.path,n=e.prefix,r=e.source,i=e.onClick;return(0,N.BX)($.G,{css:sL.path,children:[(0,N.tZ)(aI.Z,{path:t}),(0,N.BX)(J.xv,{multiline:!1,children:[(0,N.tZ)(l3,{path:t,prefix:n,onClick:i}),r?(0,N.BX)("span",{css:sL.source,children:[(0,N.tZ)("span",{css:sL.sourceArrow,children:""}),(0,N.tZ)(l3,{path:r})]}):null]})]})}var sX=(0,K.X)({modifiedFile:[Y.l0.py(2),Y.l0.rowWithGap(4),Y.l0.align.center]});function sM(e){var t,n=e.file,r=e.list,i=e.stageFiles,o=e.restoreFiles,a=e.pathMap,l=e.disabled,c=e.onFilePathClick,s=null==a?void 0:a.get(n.path),u=null===(t=n.source)||void 0===t?void 0:t.path,d="index"===r?n.type.index:n.type.worktree,f=(0,tk.Z)(function(){if(d!==aL.h.DELETED)return function(){return c(n.path)}},[n.path,c,d]);return(0,N.BX)($.G,{css:sX.modifiedFile,children:[(0,N.tZ)(sO,{path:n.path,prefix:s,source:u,onClick:f}),(0,N.tZ)(aX,{type:d}),(0,N.tZ)(sU,{file:n,list:r,stageFiles:i,restoreFiles:o,disabled:void 0!==l&&l})]})}var sF=(0,K.X)({actions:[Y.l0.rowWithGap(2),Y.l0.backgroundColor.backgroundHighest,Y.l0.borderRadius(8)],buttonReset:[Y.l0.borderRadius(8,0,0,8)],buttonStage:[Y.l0.borderRadius(0,8,8,0)],divider:[Y.l0.my(8),Y.l0.width(1),Y.l0.backgroundColor.outlineStronger]});function sW(e){var t=e.type,n=e.stageFiles,r=e.restoreFiles,i=e.disabled,o=void 0!==i&&i,a=(0,L._)((0,O.useState)(!1),2),l=a[0],c=a[1],s=(0,L._)((0,O.useState)(!1),2),u=s[0],d=s[1];function f(){return h.apply(this,arguments)}function h(){return(h=(0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:if(o)return[2];return c(!0),[4,n({all:"index"!==t})];case 1:return e.sent(),c(!1),[2]}})})).apply(this,arguments)}function p(){return(p=(0,eO._)(function(){return(0,eX.Jh)(this,function(e){switch(e.label){case 0:if(o||"worktree"!==t)return[2];return d(!0),[4,r(!0)];case 1:return e.sent(),d(!1),[2]}})})).apply(this,arguments)}return o=o||u||l,"index"===t?(0,N.tZ)(eW.zx,{text:"Unstage All",iconLeft:l?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(sA.Z,{}),onClick:f,disabled:o,loading:l,size:"small"}):(0,N.BX)($.G,{css:sF.actions,children:[(0,N.tZ)(eW.zx,{css:sF.buttonReset,text:"Reset All",iconLeft:u?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(cz.Z,{}),onClick:function(){return p.apply(this,arguments)},disabled:o,loading:u,size:"small"}),(0,N.tZ)("div",{css:sF.divider}),(0,N.tZ)(eW.zx,{css:sF.buttonStage,text:"Stage All",iconLeft:l?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(i0.Z,{}),onClick:f,disabled:o,loading:l,size:"small"})]})}var sH=(0,K.X)({list:[Y.l0.pt(4),Y.l0.pb(8),Y.l0.colWithGap(4)],listFolded:[Y.l0.py(4)],header:[Y.l0.px(8),Y.l0.rowWithGap(4),Y.l0.align.center],headerFoldable:[Y.l0.py(4),Y.l0.pl(4),Y.l0.pr(8),Y.l0.rowWithGap(4),Y.l0.align.center],headerText:[Y.l0.flex.grow(1)],body:[Y.l0.px(8),Y.l0.maxHeight("25vh"),Y.l0.overflowY("auto")]});function sV(e){var t,n=e.files,r=e.type,i=e.stageFiles,o=e.restoreFiles,a=e.onFilePathClick,l=e.pathMap,c=e.foldable,s=void 0!==c&&c,u=e.disabled,d=void 0!==u&&u,f=(0,L._)((0,O.useState)(!1),2),h=f[0],p=f[1],m=(0,O.useRef)(null),v=(0,O.useRef)(null),g=(0,cf.MG)({count:n.length,getScrollElement:function(){return v.current},getItemKey:function(e){return n[e].path},estimateSize:function(){return 28},overscan:20}),y=g.getVirtualItems();return s&&h?(0,N.tZ)($.G,{css:sH.listFolded,children:(0,N.BX)($.G,{css:s?sH.headerFoldable:sH.header,children:[(0,N.tZ)(sz,{files:n,type:r,setFolded:p,foldable:!0,folded:!0}),(0,N.tZ)(sW,{type:r,stageFiles:i,restoreFiles:o,disabled:d})]})}):(0,N.BX)($.G,{innerRef:m,css:sH.list,children:[(0,N.BX)($.G,{css:s?sH.headerFoldable:sH.header,children:[(0,N.tZ)(sz,{files:n,type:r,setFolded:p,foldable:s}),(0,N.tZ)(sW,{type:r,stageFiles:i,restoreFiles:o,disabled:d})]}),(0,N.tZ)($.K.div,{ref:v,css:sH.body,children:(0,N.tZ)("div",{style:{minHeight:g.getTotalSize()},children:(0,N.tZ)("div",{style:{transform:"translateY(".concat(null===(t=y[0])||void 0===t?void 0:t.start,"px)"),willChange:"transform"},children:y.map(function(e){var t=n[e.index];return(0,N.tZ)("div",{"data-index":e.index,children:(0,N.tZ)(sM,{file:t,list:r,stageFiles:i,restoreFiles:o,onFilePathClick:a,pathMap:l,disabled:d},t.path)},e.key)})})})})]})}function sz(e){var t=e.files,n=e.type,r=e.setFolded,i=e.foldable,o=void 0!==i&&i,a=e.folded,l=(0,eC.Z)("file",t.length),c="".concat(t.length," ").concat("index"===n?"staged":"changed"," ").concat(l);return o&&void 0!==a&&a?(0,N.BX)(N.HY,{children:[(0,N.tZ)(e_.hU,{alt:"Show list",onClick:function(){return r(!1)},children:(0,N.tZ)(aN.Z,{})}),(0,N.tZ)(J.xv,{css:sH.headerText,multiline:!1,children:c})]}):(0,N.BX)(N.HY,{children:[o?(0,N.tZ)(e_.hU,{alt:"Hide list",onClick:function(){return r(!0)},children:(0,N.tZ)(aU.Z,{color:Y.TV.foregroundDimmest})}):null,(0,N.tZ)(J.xv,{css:sH.headerText,color:"dimmest",multiline:!1,children:c})]})}var sj=n(24890),sq=(0,K.X)({container:[Y.l0.colWithGap(8)],buttons:[Y.l0.rowWithGap(8),Y.l0.justify.end],restoringBoth:[Y.l0.colWithGap(12)],listContainer:[Y.l0.colWithGap(4)],list:[Y.l0.px(4),Y.l0.colWithGap(2)]});function sY(e){var t=e.show,n=e.files,r=e.pathMap,i=e.callback,o=(0,aQ.Z)(i),a=(0,O.useCallback)(function(){var e;null===(e=o.current)||void 0===e||e.call(o,!0)},[o]),l=(0,O.useCallback)(function(){var e;null===(e=o.current)||void 0===e||e.call(o,!1)},[o]);return(0,N.tZ)(iX.u,{isOpen:t,onRequestClose:l,children:t?(0,N.BX)($.G,{css:sq.container,children:[(0,N.BX)(J.h4,{level:2,children:["Discard ",(0,eC.Z)("Change",n.length)]}),(0,N.tZ)(s$,{files:n,pathMap:r}),(0,N.BX)($.G,{css:sq.buttons,children:[(0,N.tZ)(eW.zx,{text:"Cancel",iconLeft:(0,N.tZ)(sj.Z,{}),onClick:l}),(0,N.tZ)(eW.zx,{text:"Discard ".concat((0,eC.Z)("Change",n.length)),iconLeft:(0,N.tZ)(cz.Z,{}),colorway:"negative",onClick:a})]})]}):null})}function s$(e){var t=e.files,n=e.pathMap,r=[],i=[],o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;u.type.worktree===aL.h.UNTRACKED?i.push(u):r.push(u)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return!r.length&&i.length?(0,N.BX)($.G,{css:sq.listContainer,children:[(0,N.tZ)(J.xv,{children:1===i.length?"Do you want to permanently delete this file?":"Do you want to permanently delete these files?"}),(0,N.tZ)(sJ,{files:i,pathMap:n})]}):r.length&&!i.length?(0,N.BX)($.G,{css:sq.listContainer,children:[(0,N.tZ)(J.xv,{children:1===r.length?"Do you want to undo the changes to this file?":"Do you want to undo the changes to these files?"}),(0,N.tZ)(sJ,{files:r,pathMap:n})]}):(0,N.BX)($.G,{css:sq.restoringBoth,children:[r.length?(0,N.BX)($.G,{css:sq.listContainer,children:[(0,N.BX)(J.h4,{level:3,children:["Tracked ",(0,eC.Z)("File",r.length)]}),(0,N.tZ)(J.xv,{multiline:!1,children:1===r.length?"This file will have its changes undone.":"These files will have their changes undone."}),(0,N.tZ)(sJ,{files:r,pathMap:n})]}):null,i.length?(0,N.BX)($.G,{css:sq.listContainer,children:[(0,N.BX)(J.h4,{level:3,children:["Untracked ",(0,eC.Z)("File",i.length)]}),(0,N.tZ)(J.xv,{multiline:!1,children:1===i.length?"This file will be permanently deleted.":"These files will be permanently deleted."}),(0,N.tZ)(sJ,{files:i,pathMap:n})]}):null]})}function sJ(e){var t=e.files,n=e.pathMap,r=(0,O.useMemo)(function(){return t.length>20?t.slice(0,20):t},[t]);return(0,N.tZ)($.G,{children:(0,N.BX)("ul",{css:sq.list,children:[r.map(function(e){var t;return(0,N.tZ)("li",{children:(0,N.tZ)(sO,{path:e.path,prefix:n.get(e.path),source:null===(t=e.source)||void 0===t?void 0:t.path})},e.path)}),t.length<=20?null:(0,N.tZ)("li",{children:(0,N.BX)(J.xv,{color:"dimmer",children:["... ",t.length-20," more"," ",(0,eC.Z)("file",t.length-20)]})})]})})}function sK(e){var t=(0,L._)((0,O.useState)(function(){return{show:!1,files:[]}}),2),n=t[0],r=t[1];return{openRestoreConfirmationModal:(0,O.useCallback)(function(e){return new Promise(function(t){0===e.length&&t(!1),r({show:!0,files:e,callback:function(e){r({show:!1,files:[],callback:void 0}),t(e)}})})},[]),restoreConfirmationModal:(0,O.useMemo)(function(){return(0,N.tZ)(sY,(0,eL._)((0,eU._)({},n),{pathMap:e}))},[n,e])}}var sQ=[{"& > span:first-child":[Y.l0.flex.grow(1),Y.l0.textAlign.left]},{"& > span":[Y.l0.flex.shrink(1)]}],s0=(0,K.X)({buttonFolded:[sQ,Y.l0.height("auto"),Y.l0.py(8),Y.l0.fontWeight.medium],buttonUnfolded:[sQ,Y.l0.height("auto"),Y.l0.py(8),Y.l0.fontWeight.medium,Y.l0.border({color:Y.TV.outlineDimmer,direction:"bottom"}),Y.l0.borderRadius(8,8,0,0)],container:[Y.l0.flex.grow(1),Y.l0.borderRadius(8)],lists:[Y.l0.borderRadius(0,0,8,8)],divider:[Y.l0.height(1),Y.l0.minHeight(1),Y.l0.width("100%"),Y.l0.backgroundColor.outlineDimmer],autoStageMessage:[Y.l0.pt(4),Y.l0.pb(8),Y.l0.px(4),Y.l0.center],noChangesMessage:[Y.l0.py(16),Y.l0.px(4),Y.l0.center],buttonText:[Y.l0.flex.grow(1)],details:[Y.l0.rowWithGap(4),Y.l0.fontWeight.normal,Y.l0.color.foregroundDimmest]});function s1(e){var t,n,r=e.status,i=e.stageFiles,o=e.restoreFiles,a=e.onStagedFileClick,l=e.disabled,c=void 0!==l&&l,s=(0,L._)((0,O.useState)(!1),2),u=s[0],d=s[1],f=(0,L._)((0,O.useState)(!1),2),h=f[0],p=f[1],m=(0,L._)((0,O.useState)(!1),2),v=m[0],g=m[1],y=(0,O.useMemo)(function(){return sP(r.changes.map(function(e){return e.path}))},[r]),b=(0,L._)((0,O.useMemo)(function(){var e=[],t=[],n=!0,i=!1,o=void 0;try{for(var a,l=r.changes[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;c.staged&&e.push(c),c.type.worktree!==aL.h.UNMODIFIED&&t.push(c)}}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}return[e,t]},[r.changes]),2),Z=b[0],w=b[1],x=Z.length>0&&w.length>0,C=sK(y),_=C.openRestoreConfirmationModal,k=C.restoreConfirmationModal,S=(0,O.useCallback)((t=(0,eO._)(function(e){return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(!("all"in e))return[3,2];return p(!0),[4,i(e)];case 1:return t.sent(),p(!1),[3,4];case 2:return[4,i(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),[i]),E=(0,O.useCallback)((n=(0,eO._)(function(e){var t,n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:if(!0!==e)return[3,4];return g(!0),[4,_(w)];case 1:if(!r.sent())return[3,3];return[4,o(e)];case 2:r.sent(),r.label=3;case 3:return g(!1),[3,8];case 4:if("string"==typeof e){if(!(n=w.find(function(t){return t.path===e})))throw g(!1),Error("Could not find file in worktree list");t=[n]}else t=w.filter(function(t){return e.includes(t.path)});return[4,_(t)];case 5:if(!r.sent())return[3,7];return[4,o(e)];case 6:r.sent(),r.label=7;case 7:g(!1),r.label=8;case 8:return[2]}})}),function(e){return n.apply(this,arguments)}),[_,o,w]);return u?(0,N.tZ)(s2,{setFolded:d,changeCount:w.length,stagedCount:Z.length,disabled:c,folded:!0}):0===Z.length&&0===w.length?(0,N.BX)($.G,{style:{opacity:c?.725:void 0},css:s0.container,children:[(0,N.tZ)(s2,{setFolded:d,changeCount:w.length,stagedCount:Z.length,disabled:c}),(0,N.tZ)(eq.Tg,{css:s0.lists,elevated:!0,children:(0,N.tZ)($.G,{css:s0.noChangesMessage,children:(0,N.tZ)(J.xv,{color:"dimmest",multiline:!1,children:"No changed or staged files."})})})]}):(0,N.BX)(N.HY,{children:[(0,N.BX)($.G,{style:{opacity:c?.725:void 0},css:s0.container,children:[(0,N.tZ)(s2,{setFolded:d,changeCount:w.length,stagedCount:Z.length,disabled:c}),(0,N.BX)(eq.Tg,{css:s0.lists,elevated:!0,children:[0===Z.length?null:(0,N.tZ)(sV,{type:"index",files:Z,stageFiles:S,restoreFiles:E,onFilePathClick:a,pathMap:y,foldable:x,disabled:c||h||v}),x?(0,N.tZ)("div",{css:s0.divider}):null,0===w.length?null:(0,N.BX)(N.HY,{children:[(0,N.tZ)(sV,{type:"worktree",files:w,stageFiles:S,restoreFiles:E,onFilePathClick:a,pathMap:y,foldable:x,disabled:c||h||v}),x?null:(0,N.tZ)($.G,{css:s0.autoStageMessage,children:(0,N.tZ)(J.xv,{variant:"small",color:"dimmest",multiline:!1,children:"Committing will automatically stage your changes."})})]})]})]}),k]})}function s2(e){var t=e.folded,n=void 0!==t&&t,r=e.setFolded,i=e.changeCount,o=e.stagedCount,a=e.disabled;return(0,N.tZ)(eW.zx,{css:n?s0.buttonFolded:s0.buttonUnfolded,text:"Review Changes",secondaryText:(0,N.tZ)(s8,{folded:n,changeCount:i,stagedCount:o}),onClick:function(){return r(!n)},iconRight:n?(0,N.tZ)(aN.Z,{}):(0,N.tZ)(aU.Z,{}),disabled:void 0!==a&&a,size:"small"})}function s8(e){var t=e.folded,n=e.changeCount,r=e.stagedCount;if(!t)return null;var i=n>0,o=r>0;return i||o?(0,N.BX)("span",{css:s0.details,children:[i?(0,N.BX)("span",{children:[n," ",(0,eC.Z)("change",n)]}):null,i&&o?(0,N.tZ)("span",{children:"/"}):null,o?(0,N.BX)("span",{children:[r," staged"]}):null]}):(0,N.tZ)("span",{css:s0.details,children:(0,N.tZ)("span",{children:"no changes"})})}var s4=n(43704),s3=n(93049),s5=n(74652),s6=n(96003),s9=n(46868),s7=n(62340),ue={height:32,width:"100%",resize:"none",border:"none"},ut={width:"100%",resize:"none",border:"none"},un=(0,K.X)({surface:[Y.l0.p(8),Y.l0.colWithGap(12),Y.l0.borderRadius(0,0,8,8)],button:[Y.l0.height("auto"),Y.l0.py(8),Y.l0.fontWeight.medium,Y.l0.borderRadius(8,8,0,0),Y.l0.justify.start,Y.l0.border({color:Y.TV.outlineDimmer,direction:"bottom"}),{"> span:first-child":{flexGrow:1,textAlign:"start"}}],requiredText:[Y.l0.display.inlineFlex,Y.l0.rowWithGap(4)],subjectField:[Y.l0.colWithGap(8)],bodyField:[Y.l0.colWithGap(8)],subjectInput:ue,bodyInput:ut,subjectInputDisabled:[ue,{opacity:.5}],bodyInputDisabled:[ut,{opacity:.5}],required:[Y.l0.color.accentNegativeStronger],keyCombo:[Y.l0.display.inlineFlex,Y.l0.rowWithGap(4),Y.l0.flex.grow(1),Y.l0.align.center],keyComboText:[Y.l0.fontWeight.normal,Y.l0.color.foregroundDimmest]});function ur(e){var t=e.message,n=e.disabled,r=void 0!==n&&n,i=e.onMessageChange,o=e.onCommitShortcut,a=(0,L._)((0,O.useState)(!0),2),l=a[0],c=a[1],s=(0,L._)((0,O.useState)(!1),2),u=s[0],d=s[1],f=(0,L._)((0,O.useState)(!1),2),h=f[0],p=f[1],m=(0,O.useRef)(null),v=(0,O.useRef)(null),g=(0,tM._)(t.split("\n\n")),y=g[0],b=void 0===y?"":y,Z=g.slice(1).join("\n\n"),w=(0,s7.d)();function x(e,t){i((e=e.replaceAll("\n"," "))+(t?"\n\n"+t:""))}var C=(0,s5.gf)(s9.CN.gitCommit.id);return(0,s6.ow)(s9.CT,h),(0,s5.Il)(function(){return[s9.CN.gitCommit.id,{run:function(){null==o||o()},scope:s9.CT,bubble:!1}]},[o]),(0,N.BX)($.G,{children:[(0,N.tZ)(eW.zx,{css:un.button,text:(0,N.BX)("span",{css:un.requiredText,children:[(0,N.tZ)("span",{children:"Message"}),l?(0,N.tZ)(ua,{}):null]}),secondaryText:w||!C?void 0:(0,N.BX)("span",{css:un.keyCombo,children:[(0,N.tZ)("span",{css:un.keyComboText,children:"Commit:"}),(0,N.tZ)(s5.bM,{keyCombo:C,small:!0})]}),iconRight:l?(0,N.tZ)(aN.Z,{}):(0,N.tZ)(aU.Z,{}),onClick:function(){return c(function(e){return!e})},size:"small"}),(0,N.BX)(eq.Tg,{css:un.surface,elevated:!0,children:[(0,N.tZ)(ui,{ref:m,value:b,compact:l,disabled:r,onChange:function(e){x(e,Z)},onNewline:function(){if(l)c(!1),d(!0);else{if(!v.current)return;v.current.focus(),v.current.setSelectionRange(0,0)}},onFocus:function(){p(!0)},onBlur:function(){p(!1)}}),l&&!Z?null:(0,N.tZ)(uo,{ref:v,value:Z,compact:l,disabled:r,onChange:function(e){if(x(b,e),l&&!e){var t;null===(t=m.current)||void 0===t||t.focus()}else l&&c(!1)},onBackspaceWhenEmpty:function(){m.current&&m.current.focus()},onFocus:function(){u&&d(!1),p(!0)},onBlur:function(){p(!1)},autoFocus:u})]})]})}var ui=(0,O.forwardRef)(function(e,t){var n=e.value,r=e.compact,i=e.disabled,o=void 0!==i&&i,a=e.onChange,l=e.onNewline,c=e.onFocus,s=e.onBlur;return(0,N.BX)($.G,{css:un.subjectField,children:[void 0!==r&&r?null:(0,N.tZ)(J.xv,{variant:"small",color:"dimmer",multiline:!1,children:(0,N.BX)("span",{css:un.requiredText,children:[(0,N.tZ)("span",{children:"Summary"}),(0,N.tZ)(ua,{})]})}),(0,N.tZ)(tF.B,{ref:t,css:o?un.subjectInputDisabled:un.subjectInput,placeholder:"Summary of your commit...",value:n,disabled:o,onChange:function(e){return null==a?void 0:a(e.currentTarget.value)},onKeyDown:function(e){"Enter"!==e.key||e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),null==l||l())},onFocus:c,onBlur:s})]})}),uo=(0,O.forwardRef)(function(e,t){var n=e.value,r=e.compact,i=void 0!==r&&r,o=e.disabled,a=void 0!==o&&o,l=e.autoFocus,c=e.onChange,s=e.onBackspaceWhenEmpty,u=e.onFocus,d=e.onBlur,f=(0,s4.Z)().ref;return(0,N.BX)($.G,{css:un.bodyField,children:[i?null:(0,N.tZ)(J.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Description"}),(0,N.tZ)(tF.B,{ref:i?t:(0,s3.l)(t,f),css:a?un.bodyInputDisabled:un.bodyInput,placeholder:"Description of your commit...",value:n,disabled:a,onChange:function(e){return null==c?void 0:c(e.currentTarget.value)},onKeyDown:function(e){"Backspace"===e.key&&""===n&&(e.preventDefault(),e.stopPropagation(),null==s||s())},onFocus:u,onBlur:d,autoFocus:void 0!==l&&l})]})});function ua(){return(0,N.tZ)(eT.u,{tooltip:"This field is required.",placement:"top",children:(0,N.tZ)("span",{css:un.required,children:"*"})})}var ul=(0,K.X)({commitArea:[Y.l0.colWithGap(8)]});function uc(e){var t=e.status,n=e.onStagedFileClick,r=e.defaultMessage,i=(0,L._)((0,O.useState)(t),2),o=i[0],a=i[1],l=(0,L._)((0,O.useState)(null!=r?r:""),2),c=l[0],s=l[1],u=(0,L._)((0,O.useState)(0),2),d=u[0],f=u[1],h=(0,L._)((0,O.useState)(!1),2),p=h[0],m=h[1],v=lU();(0,O.useEffect)(function(){return a(t)},[t]);var g=(0,H.Z)().git;if(!o||!o.changes.length)return(0,N.tZ)($.G,{css:ul.commitArea,children:(0,N.tZ)(J.xv,{color:"dimmest",multiline:!1,children:"There are no changes to commit."})});var y=o.changes.length,b=o.changes.filter(function(e){return e.staged}).length;function Z(){return(Z=(0,eO._)(function(e){var t,n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:if(p)return[2];return f(function(e){return e+1}),[4,g.stageFiles(e)];case 1:if((t=r.sent()).error)return[3,3];return[4,g.status()];case 2:return(n=r.sent()).error?(ln({context:"commit-area-status",gitService:g,result:n,data:{opts:e}}),v(n.error)):a(n),g.forceRefresh(),[3,4];case 3:v(t.error),ln({context:"commit-area-stage-files",gitService:g,result:t,data:{opts:e}}),r.label=4;case 4:return f(function(e){return e-1}),[2]}})})).apply(this,arguments)}function w(){return(w=(0,eO._)(function(e){var t,n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:if(p)return[2];return f(function(e){return e+1}),[4,g.restoreFiles(e)];case 1:if((t=r.sent()).error)return[3,3];return[4,g.status()];case 2:return(n=r.sent()).error?(ln({context:"commit-area-status",gitService:g,result:n,data:{files:e}}),v(n.error)):a(n),g.forceRefresh(),[3,4];case 3:ln({context:"commit-area-restore-files",gitService:g,result:t,data:{files:e}}),v(t.error),r.label=4;case 4:return f(function(e){return e-1}),[2]}})})).apply(this,arguments)}function x(){return C.apply(this,arguments)}function C(){return(C=(0,eO._)(function(){var e,t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:if(""===c||p||0===y||d>0)return[2];if(m(!0),0!==b)return[3,2];return[4,g.stageFiles({all:!0})];case 1:n.sent(),n.label=2;case 2:return[4,g.commit({message:c})];case 3:if(!(e=n.sent()).error)return[3,4];return m(!1),v(e.error),ln({context:"commit-area-commit",gitService:g,result:e,data:{message:c}}),[3,6];case 4:return lk("commit-created",{hasDescription:-1!==c.trim().indexOf("\n\n")}),[4,g.status()];case 5:t=n.sent(),m(!1),t.error?(v(t.error),ln({context:"commit-area-status",gitService:g,result:t,data:{message:c}})):(s(""),a(t)),g.forceRefresh(),n.label=6;case 6:return[2]}})})).apply(this,arguments)}var _="Nothing to commit";if(p)_="Committing...";else if(b>0&&b<y){var k=(0,eC.Z)("change",b);_="Commit ".concat(b," staged ").concat(k)}else y>0&&(_="Stage and commit all changes");var S=!c||0===y||d>0||p;return(0,N.BX)($.G,{css:ul.commitArea,children:[(0,N.tZ)(ur,{message:c,disabled:p,onMessageChange:s,onCommitShortcut:x}),(0,N.tZ)(s1,{status:o,stageFiles:function(e){return Z.apply(this,arguments)},restoreFiles:function(e){return w.apply(this,arguments)},onStagedFileClick:n,disabled:p}),S?(0,N.tZ)(eT.u,{tooltip:d>0?"Changes in progress":0===y?"There are no changes to commit.":"You must enter a commit message before you can commit.",children:(0,N.tZ)(eW.zx,{text:_,onClick:x,disabled:S,loading:p,colorway:"primary",iconLeft:(0,N.tZ)(nU.Z,{}),stretch:!0})}):(0,N.tZ)(eW.zx,{text:_,onClick:x,disabled:S,loading:p,colorway:"primary",iconLeft:(0,N.tZ)(nU.Z,{}),stretch:!0})]})}var us=(0,K.X)({warning:[Y.l0.align.start],header:[Y.l0.fontWeight.bold]});function uu(){return(0,N.BX)(N.HY,{children:[(0,N.tZ)(ej.E,{css:us.warning,icon:(0,N.tZ)(eV.Z,{}),colorway:"warning",text:(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{css:us.header,children:"Can't push or pull from GitHub"}),(0,N.tZ)("br",{}),(0,N.tZ)("span",{children:"This Repl has a GitHub repository as a remote, but you are not connected to GitHub."})]})}),(0,N.tZ)(lE,{})]})}var ud=n(35816),uf=(0,K.X)({text:[Y.l0.flex.shrink(1)]});function uh(e){var t=e.date,n=(0,L._)((0,O.useState)(null),2),r=n[0],i=n[1];return((0,O.useEffect)(function(){if(t){var e=function(){var e=new Date,n="just now";e.getTime()-t.getTime()>6e4&&(n=(0,ud.Z)(t,e,{addSuffix:!0})),i(n=n.replace(/minutes?/,"min"))};e();var n=setInterval(e,6e4);return function(){clearInterval(n),i(null)}}},[t]),r)?(0,N.BX)(J.xv,{css:uf.text,color:"dimmest",variant:"small",multiline:!1,children:["last fetched ",r]}):null}function up(e){var t=e.hasRemoteMergeConflict,n=e.hasUnpulledCommits,r=e.hasUnpushedCommits,i=e.workTreeDirty,o=[];return i&&n&&o.push("Can't pull: you have uncommitted changes"),t&&(n||r)&&(n&&r?(i||o.push("Warning: pulling will start a merge with conflicts"),o.push("Can't push: unpulled changes must be merged first")):n?i||o.push("Warning: pulling will start a merge with conflicts"):r&&o.push("Can't push: merge conflict with remote")),(0,N.tZ)(N.HY,{children:o.map(function(e){return(0,N.tZ)(ej.E,{text:e,colorway:"warning",icon:(0,N.tZ)(eV.Z,{})},e)})})}var um=(0,K.X)({divider:[Y.l0.mx(8)]});function uv(e){var t=e.ahead,n=e.behind;if(!t&&!n)return(0,N.tZ)(J.xv,{color:"dimmest",multiline:!1,children:"Nothing to pull or push"});var r=null,i=null;if(n){var o=(0,eC.Z)("commit",n);r="".concat(n," ").concat(o," to pull")}if(t){var a=(0,eC.Z)("commit",t);i="".concat(t," ").concat(a," to push")}return(0,N.BX)(J.xv,{color:"dimmer",variant:"small",multiline:!1,children:[r?(0,N.tZ)("span",{children:r}):null,r&&i?(0,N.tZ)("span",{css:um.divider,children:""}):null,i?(0,N.tZ)("span",{children:i}):null]})}var ug=(0,K.X)({container:[Y.l0.flex.grow(1)],branch:[Y.l0.mr(4),Y.l0.color.foregroundDefault,Y.l0.fontWeight.medium,{"&:hover":{textDecoration:"underline"}}],divider:[Y.l0.color.foregroundDimmest],text:[Y.l0.ml(4),Y.l0.color.foregroundDimmest]});function uy(e){var t=e.upstream,n=e.remotes,r=(0,O.useMemo)(function(){return function(e,t){var n=null,r=null;if(e instanceof Map){var i=(0,lm.Tg)(t),o=i[0];if(n=i[1],!o||!n)return null;var a=e.get(o);if(!a)return null;r=lb(a)}else n=t,r=lb(e);return r&&lg(r)?"".concat(r,"/tree/").concat(n):null}(n,t)},[t,n]);return(0,N.BX)(J.xv,{css:ug.container,variant:"small",multiline:!1,children:[r?(0,N.tZ)("a",{css:ug.branch,href:r,target:"_blank",children:t}):(0,N.tZ)("span",{css:ug.branch,children:t}),(0,N.tZ)("span",{css:ug.divider,children:""}),(0,N.tZ)("span",{css:ug.text,children:"upstream"})]})}var ub=(0,K.X)({container:[Y.l0.borderRadius(8)],loading:[Y.l0.height(64),ez.p.backgroundPulse(),Y.l0.borderRadius(8)],header:[Y.l0.py(4),Y.l0.px(8),Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.flex.shrink(1),Y.l0.border({color:Y.TV.outlineDimmer,direction:"bottom"})],fetch:{border:"none"},body:[Y.l0.px(8),Y.l0.pt(8),Y.l0.pb(12),Y.l0.colWithGap(8)],buttons:[Y.l0.rowWithGap(8),Y.l0.flex.grow(1)],sync:[Y.l0.flex.grow(1)],pullPush:[Y.l0.flex.row],pull:[Y.l0.pr(12),Y.l0.borderRadius(8,0,0,8),Y.l0.border({color:Y.TV.outlineDefault,direction:"right"})],push:[Y.l0.borderRadius(0,8,8,0)]});function uZ(e){return uw.apply(this,arguments)}function uw(){return(uw=(0,eO._)(function(e){var t,n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:return t=null,[4,Promise.race([e,new Promise(function(e){return t=setTimeout(function(){lt.$e(function(e){e.setTag("gitPane",!0),lt.Tb(Error("Remote update operation timed out"))}),e({error:lp.aq.TIMEOUT})},9e4)})])];case 1:return n=r.sent(),t&&clearTimeout(t),[2,n]}})})).apply(this,arguments)}function ux(e){var t,n=e.remotes,r=e.gotoPendingState,i=(0,L._)((0,O.useState)(!1),2),o=i[0],a=i[1],l=(0,L._)((0,O.useState)(!1),2),c=l[0],s=l[1],u=(0,L._)((0,O.useState)(!1),2),d=u[0],f=u[1],h=(0,L._)((0,O.useState)(!1),2),p=h[0],m=h[1],v=(0,H.Z)().git,g=(0,le.Z)((t=(0,eO._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y;return(0,eX.Jh)(this,function(b){switch(b.label){case 0:return i={upstream:null,hasUnpulledCommits:!1,hasUnpushedCommits:!1,hasRemoteMergeConflict:!1,pullMode:sI.T.FF_ONLY,canPull:!1,canPush:!1,workTreeDirty:!1,needGitHubConnection:!1,ahead:0,behind:0,lastFetched:null},[4,e.getRepositoryState()];case 1:if((o=b.sent()).error)return[2,o];if(a=o.state,o.type!==lf.y5.NORMAL)return[2,{error:lp.aq.INVALID_STATE}];return(a===lf.yG.DIRTY_WORKTREE||a===lf.yG.DIRTY_INDEX)&&(i.workTreeDirty=!0),[4,e.status()];case 2:if((l=b.sent()).error)return[2,l];if(c=l.branch,s=null===(t=l.upstream)||void 0===t?void 0:t.branch,d=null!==(u=null===(n=l.upstream)||void 0===n?void 0:n.ahead)&&void 0!==u?u:0,h=null!==(f=null===(r=l.upstream)||void 0===r?void 0:r.behind)&&void 0!==f?f:0,!c)return[2,{error:lp.aq.HEAD_DETACHED}];if(i.ahead=d,i.behind=h,!s)return[3,7];return i.upstream=s,i.hasUnpulledCommits=h>0,i.hasUnpushedCommits=d>0,[4,e.lastFetched()];case 3:if((p=b.sent()).error)return[2,p];return i.lastFetched=p.lastFetched,[4,e.canMergeBranches(c,s)];case 4:if((m=b.sent()).error)return[2,m];if(m.canMerge||(i.hasRemoteMergeConflict=!0),e.hasProfile(lp.rG.GITHUB))return[3,6];if(!(v=(0,l9.CH)(s)))return[2,{error:lp.aq.INVALID_REFERENCE}];return[4,e.getRemotes()];case 5:if((g=b.sent()).error)return[2,g];if(!(y=g.remotes.get(v)))return[2,{error:lp.aq.INVALID_REFERENCE}];lg(y)&&(i.needGitHubConnection=!0),b.label=6;case 6:i.workTreeDirty||i.needGitHubConnection||(i.canPull=!0),!i.hasUnpushedCommits||i.hasUnpulledCommits||i.needGitHubConnection||(i.canPush=!0),d>0&&(i.pullMode=i.hasRemoteMergeConflict?sI.T.MERGE:sI.T.REBASE),b.label=7;case 7:return[2,(0,eL._)((0,eU._)({},i),{error:null})]}})}),function(e){return t.apply(this,arguments)})),y=lU();if((0,O.useEffect)(function(){(null==g?void 0:g.error)&&y(g.error)},[null==g?void 0:g.error,y]),!g)return(0,N.tZ)(eq.Tg,{css:ub.loading,elevated:!0});if(g.error||!g.upstream)return null;var b=g.upstream,Z=g.hasUnpulledCommits,w=g.hasUnpushedCommits,x=g.hasRemoteMergeConflict,C=g.pullMode,_=g.canPull,k=g.canPush,S=g.workTreeDirty,E=g.needGitHubConnection,T=g.ahead,R=g.behind,I=g.lastFetched;if(E)return(0,N.BX)(eq.Tg,{css:ub.container,elevated:!0,children:[(0,N.BX)($.G,{css:ub.header,children:[(0,N.tZ)(uy,{upstream:b,remotes:n}),(0,N.tZ)(eW.zx,{css:ub.fetch,text:"Fetch",iconLeft:(0,N.tZ)(ir.Z,{}),disabled:!0,variant:"outlined",size:"small"})]}),(0,N.tZ)($.G,{css:ub.body,children:(0,N.tZ)(uu,{})})]});var D=o||c||d||p,G=!b||E||D,B=!_||D,P=!k||D,A=!_&&!k||x||D;function U(){return(U=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(G)return[2];return a(!0),[4,uZ(v.fetch())];case 1:return e=t.sent(),v.forceRefresh(),a(!1),e.error?y(e.error):lk("remote-fetched"),[2]}})})).apply(this,arguments)}function X(){return(X=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(B)return[2];return s(!0),[4,uZ(v.pull({mode:C,allowConflicts:!0}))];case 1:return e=t.sent(),s(!1),e.error?y(e.error):(e.hasConflicts&&r(),v.forceRefresh(),lk("upstream-pulled")),[2]}})})).apply(this,arguments)}function M(){return(M=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(P)return[2];return f(!0),[4,uZ(v.push())];case 1:return e=t.sent(),v.forceRefresh(),f(!1),e.error?y(e.error):lk("upstream-pushed"),[2]}})})).apply(this,arguments)}function F(){return(F=(0,eO._)(function(){var e,t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:if(A)return[2];if(m(!0),!_)return[3,2];return[4,uZ(v.pull({mode:C}))];case 1:if((e=n.sent()).error)return y(e.error),m(!1),[2];lk("upstream-pulled"),n.label=2;case 2:if(!k)return[3,4];return[4,v.push()];case 3:if((t=n.sent()).error)return y(t.error),m(!1),[2];lk("upstream-pushed"),n.label=4;case 4:return v.forceRefresh(),m(!1),[2]}})})).apply(this,arguments)}return(0,N.BX)(eq.Tg,{css:ub.container,elevated:!0,children:[(0,N.BX)($.G,{css:ub.header,children:[(0,N.tZ)(uy,{upstream:b,remotes:n}),(0,N.tZ)(uh,{date:I}),(0,N.tZ)(eW.zx,{css:ub.fetch,text:"Fetch",iconLeft:o?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(ir.Z,{}),onClick:function(){return U.apply(this,arguments)},loading:o,disabled:G,variant:"outlined",size:"small"})]}),(0,N.BX)($.G,{css:ub.body,children:[(0,N.tZ)(up,{hasRemoteMergeConflict:x,hasUnpulledCommits:Z,hasUnpushedCommits:w,workTreeDirty:S}),(0,N.tZ)(uv,{ahead:T,behind:R}),(0,N.BX)($.G,{css:ub.buttons,children:[(0,N.tZ)("div",{css:ub.sync,children:(0,N.tZ)(eT.u,{tooltip:"Pull & push the latest changes",children:(0,N.tZ)(eW.zx,{css:ub.sync,text:"Sync with Remote",iconLeft:p?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(sm.Z,{rotate:90}),onClick:function(){return F.apply(this,arguments)},loading:p,disabled:A,size:"small"})})}),(0,N.BX)($.G,{css:ub.pullPush,children:[(0,N.tZ)(eW.zx,{css:ub.pull,text:"Pull",iconLeft:c?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(e1.Z,{}),onClick:function(){return X.apply(this,arguments)},loading:c,disabled:B,size:"small"}),(0,N.tZ)(eW.zx,{css:ub.push,text:"Push",iconLeft:d?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(sG.Z,{}),onClick:function(){return M.apply(this,arguments)},loading:d,disabled:P,size:"small"})]})]})]})]})}var uC=n(59811),u_=n(12834),uk=(0,K.X)({modalContainer:[Y.l0.colWithGap(24)]});function uS(e){var t,n,r=e.branch,i=(0,L._)((0,O.useState)(!1),2),o=i[0],a=i[1],l=(0,L._)((0,O.useState)(!1),2),c=l[0],s=l[1],u=(0,L._)((0,O.useState)(null),2),d=u[0],f=u[1],h=(0,L._)((0,O.useState)(!1),2),p=h[0],m=h[1],v=(0,u_.Z)(),g=lU(),y=(0,H.Z)().git,b=(0,le.Z)((t=(0,eO._)(function(e){var t,n,r,i,o,a,l,c;return(0,eX.Jh)(this,function(s){switch(s.label){case 0:return[4,e.isInitialized()];case 1:if((t=s.sent()).error)return g(t.error),ln({context:"publish-branch-button-initialized",gitService:e,result:t}),[2,{remote:null,error:t.error}];if(!t.initialized)return[2,{remote:null,error:null}];return[4,e.getRemotes()];case 2:if((n=s.sent()).error)return ln({context:"publish-branch-button-get-remotes",gitService:e,result:n}),g(n.error),[2,n];return r=n.remotes,i="",(null==r?void 0:r.size)&&(i=r.has("origin")?"origin":r.keys().next().value),[4,e.status()];case 3:if((o=s.sent()).error)return g(o.error),ln({context:"publish-branch-button-status",gitService:e,result:o}),[2,o];if(!(o.branch&&i))return[3,5];return a=(0,lm.C)(o.branch),l="refs/remotes/".concat(i,"/").concat(a),[4,e.branchExists(l)];case 4:(c=s.sent()).error?(ln({context:"publish-branch-button-branch-exists",gitService:e,result:c,data:{upstream:a,fullRemoteRef:l}}),g(c.error)):c.exists&&f("".concat(i,"/").concat(a)),s.label=5;case 5:return[2,{remote:i,error:null}]}})}),function(e){return t.apply(this,arguments)}),[g],{keepStaleResult:!1});if((0,O.useEffect)(function(){function e(){return(e=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(!(p&&d))return[3,2];return[4,y.setBranchUpstream({upstream:d})];case 1:(e=t.sent()).error&&(ln({context:"publish-branch-button-set-branch-upstream",gitService:y,result:e,data:{upstream:d}}),g(e.error)),v.current&&(m(!1),f(null)),t.label=2;case 2:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[y,g,p,d,v]),null==b?void 0:b.error)return null;var Z=b?b.remote:null,w=null===Z,x=r.type!==lh.HO.LOCAL||!Z||p;function C(){return(C=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(!Z||o)return[2];if(d)return s(!0),[2];return a(!0),[4,y.push({publish:{remote:Z}})];case 1:return(e=t.sent()).error?(a(!1),g(e.error),ln({context:"publish-branch-button-push",gitService:y,result:e,data:{remote:Z}})):(y.forceRefresh(),lk("branch-published-to-remote")),[2]}})})).apply(this,arguments)}return n=o?"Publishing...":r.type!==lh.HO.LOCAL?"Branch has already been published":w?"Checking if branch can be published...":Z?"Publish branch as '".concat(Z,"/").concat(r.name,"'"):"No remotes to publish to",(0,N.BX)(N.HY,{children:[d?(0,N.tZ)(iX.u,{isOpen:c,onRequestClose:function(){return s(!1)},children:(0,N.BX)($.G,{css:uk.modalContainer,children:[(0,N.tZ)(J.xv,{variant:"headerDefault",children:"Branch already exists"}),(0,N.tZ)(J.xv,{children:"Upstream branch '".concat(d,"' already exists.\n          To publish the branch, please confirm you would like to set upstream branch to it.")}),(0,N.tZ)(eW.zx,{text:"Set upstream to '".concat(d,"'"),onClick:function(){d&&(m(!0),s(!1))}})]})}):null,(0,N.tZ)(eW.zx,{text:n,iconLeft:w||o?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(uC.Z,{}),onClick:function(){return C.apply(this,arguments)},loading:w||o,disabled:x})]})}var uE=(0,K.X)({remoteUrl:[{border:"none"},Y.l0.height("auto"),Y.l0.py(4),Y.l0.px(8)]});function uT(e){var t=e.branch,n=e.remotes,r=(0,L._)((0,O.useMemo)(function(){if(t.type===lh.HO.LOCAL)return[null,null,null];var e=n.get(t.remote);if(!e)return[null,null,null];var r=lb(e),i=function(e){var t="string"==typeof e?e:e.fetch;if(lg(t)){var n=(t=ly(t)).split("/");if(n.length<2)return null;var r=n[n.length-2],i=n[n.length-1];return"".concat(r,"/").concat(i)}return null}(e),o=lg(r);return[r,i,o]},[t,n]),3),i=r[0],o=r[1],a=r[2];return i&&o?(0,N.tZ)(oy.Z,{css:uE.remoteUrl,text:o,href:i,target:"_blank",iconLeft:a?(0,N.tZ)(lC.Z,{}):void 0,iconRight:(0,N.tZ)(oZ.Z,{}),variant:"outlined",size:"small"}):null}var uR=(0,K.X)({view:[Y.l0.pt(4),Y.l0.pb(8),Y.l0.px(4),Y.l0.colWithGap(8),Y.l0.flex.grow(1)],sectionContainer:[Y.l0.colWithGap(8)],section:[Y.l0.pt(8),Y.l0.pb(16),Y.l0.px(8),Y.l0.colWithGap(8),Y.l0.border({color:Y.TV.outlineDimmest,direction:"bottom"})],remoteUpdatesHeader:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.justify.spaceBetween],reviewChangesHeader:[Y.l0.rowWithGap(8),Y.l0.align.center],headerText:[Y.l0.fontWeight.medium],switchToBranch:[Y.l0.p(4),Y.l0.flex.row,Y.l0.align.center,Y.l0.justify.spaceBetween,Y.l0.mt(0),Y.l0.mb(0)]});function uI(e){var t,n,r,i,o,a=e.status,l=e.remotes,c=e.branch,s=e.onStagedFileClick,u=e.onViewCommitClick,d=e.gotoPendingState,f=e.current,h=void 0!==f&&f,p=h?null==a?void 0:null===(i=a.upstream)||void 0===i?void 0:i.behind:void 0,m=h?null==a?void 0:null===(o=a.upstream)||void 0===o?void 0:o.ahead:void 0,v=(t=lU(),r=(0,le.Z)((n=(0,eO._)(function(e){var t,n,r,i,o,a,l,s,u;return(0,eX.Jh)(this,function(d){switch(d.label){case 0:return[4,e.isInitialized()];case 1:if((t=d.sent()).error)return ln({context:"use-branch-commits",gitService:e,result:t}),[2,{error:t.error}];if(!t.initialized)return[2,{log:[],onlyRemote:[],onlyLocal:[],error:null}];if(!c)return[2,{error:null}];if(!(!c.tracking||0===p&&0===m))return[3,3];return n=(0,l9.bF)(c,!0),[4,e.log({max:100,revRange:n})];case 2:if((r=d.sent()).error)return ln({context:"use-branch-commits",gitService:e,result:r,data:{branch:c,behind:p,ahead:m,revision:n}}),[2,r];return[2,{log:r.commits,error:null}];case 3:return i=(0,l9.bF)(c),[4,Promise.all([e.log({max:100,revRange:c.name}),e.log({max:100,revRange:"".concat(c.name,"..").concat(i)}),e.log({max:100,revRange:"".concat(i,"..").concat(c.name)})])];case 4:if(o=d.sent(),l=(a=(0,L._)(o,3))[0],s=a[1],u=a[2],l.error)return ln({context:"use-branch-commits-log",gitService:e,result:l,data:{branch:c,behind:p,ahead:m,remoteBranch:i}}),[2,{error:l.error}];if(s.error)return ln({context:"use-branch-commits-only-remote",gitService:e,result:s,data:{branch:c,behind:p,ahead:m,remoteBranch:i}}),[2,{error:s.error}];if(u.error)return ln({context:"use-branch-commits-only-local",gitService:e,result:u,data:{branch:c,behind:p,ahead:m,remoteBranch:i}}),[2,{error:u.error}];return[2,{log:l.commits,onlyRemote:s.commits,onlyLocal:u.commits,error:null}]}})}),function(e){return n.apply(this,arguments)}),[c,p,m]),(0,O.useMemo)(function(){if(!r)return null;if(r.error)return t(r.error),{error:r.error};var e=r.log,n=r.onlyRemote,i=r.onlyLocal;if(!n&&!i)return{log:e,error:null};if(e){var o=new Set;if(n){var a=!0,l=!1,c=void 0;try{for(var s,u=n[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value;o.add(d.hash)}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}}if(i){var f=!0,h=!1,p=void 0;try{for(var m,v=i[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;o.add(g.hash)}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}}e=e.filter(function(e){return!o.has(e.hash)})}return{log:e,onlyRemote:n,onlyLocal:i,error:null}},[t,r])),g=!!l&&l.size>0,y=(null==c?void 0:c.type)===lh.HO.LOCAL,b=(0,O.useMemo)(function(){if(!v||v.error)return[];var e=[],t=v.log,n=void 0===t?[]:t,r=v.onlyRemote,i=void 0===r?[]:r,o=v.onlyLocal,l=void 0===o?[]:o,c=n.length>0,s=i.length>0,f=l.length>0;return s&&(e.push({type:"boundary",text:"Not pulled from remote"}),h&&a&&e.push({type:"button",key:"pull-button",button:(0,N.tZ)(sD,{status:a,gotoPendingState:d})}),e.push.apply(e,(0,ex._)(uD(i,u)))),f&&(e.push({type:"boundary",text:"Not pushed to remote"}),h&&a&&e.push({type:"button",key:"push-button",button:(0,N.tZ)(sB,{status:a})}),e.push.apply(e,(0,ex._)(uD(l,u)))),c&&((s||f)&&e.push({type:"boundary",text:"Up to date with remote"}),e.push.apply(e,(0,ex._)(uD(n,u)))),e},[v,a,h,d,u]);return c?(0,N.BX)($.G,{css:uR.view,children:[(0,N.BX)($.G,{css:uR.sectionContainer,children:[y?(0,N.tZ)($.G,{css:uR.section,children:(0,N.tZ)(uS,{branch:c})}):null,h&&!y&&l&&g?(0,N.BX)($.G,{css:uR.section,children:[(0,N.BX)($.G,{css:uR.remoteUpdatesHeader,children:[(0,N.tZ)(J.xv,{css:uR.headerText,multiline:!1,children:"Remote Updates"}),(0,N.tZ)(uT,{branch:c,remotes:l})]}),(0,N.tZ)(ux,{remotes:l,gotoPendingState:d})]}):null,h&&a?(0,N.BX)($.G,{css:uR.section,children:[(0,N.tZ)($.G,{css:uR.reviewChangesHeader,children:(0,N.tZ)(J.xv,{css:uR.headerText,multiline:!1,children:"Commit"})}),(0,N.tZ)(uc,{status:a,onStagedFileClick:s})]}):null]}),v?(0,N.tZ)(s_,{items:b}):(0,N.tZ)(sR,{})]}):(0,N.tZ)("div",{children:"No branch"})}function uD(e,t){return e.map(function(e){return{type:"commit",commit:e,onViewCommitClick:t}})}function uG(){return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a cherry-pick."}),(0,N.tZ)(J.xv,{multiline:!1,children:"Please finish the cherry-pick manually."})]})}var uB=(0,K.X)({branch:[lz.gU.nofill,Y.l0.py(12),Y.l0.px(8),Y.l0.colWithGap(2),Y.l0.justify.center,Y.l0.borderRadius(8),Y.l0.flex.shrink(1)],branchMetadata:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.flex.shrink(1)]});function uP(e){var t=e.branch,n=e.current,r=e.onClick;return(0,N.BX)($.G,{css:uB.branch,tabIndex:0,role:"button","aria-label":"Switch to branch ".concat((0,l9.bF)(t,!0)),onClick:r,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(null==r||r())},children:[(0,N.tZ)(J.xv,{multiline:!1,children:(0,N.tZ)(l4,{name:t.name,remote:t.type===lh.HO.REMOTE?t.remote:null,current:void 0!==n&&n,onClick:r,icon:!0})}),(0,N.tZ)(uA,{branch:t})]})}function uA(e){var t=e.branch;return(0,N.BX)($.G,{css:uB.branchMetadata,children:[(0,N.tZ)(cs,{name:t.commit.author.name,email:t.commit.author.email,color:"dimmest",allowPlaceholderAvatar:!0}),(0,N.tZ)(cd.EK,{date:t.commit.author.date,textColor:"dimmest",textVariant:"small"})]})}var uN=(0,K.X)({expandButton:[{verticalAlign:"middle"},Y.l0.justify.spaceBetween],branchListContainer:[Y.l0.display.flex],topRow:[Y.l0.p(4),Y.l0.flex.row,Y.l0.align.center,Y.l0.justify.spaceBetween],topRowInteractive:[{verticalAlign:"middle"},Y.l0.justify.spaceBetween,Y.l0.borderRadius(8,8,0,0)],branchList:[Y.l0.borderRadius(8)],branchListFoldable:[Y.l0.borderRadius(0,0,8,8)]});function uU(e){var t=e.name,n=e.branches,r=e.current,i=void 0===r?null:r,o=e.foldable,a=void 0!==o&&o,l=e.folded,c=e.switchBranch,s=(0,L._)((0,O.useState)(!!a&&void 0!==l&&l),2),u=s[0],d=s[1],f=(0,O.useMemo)(function(){return n.map(function(e){return(0,N.tZ)(uP,{branch:e,current:(0,lh.p3)(e,i),onClick:function(){return c(e)}},(0,l9.Qj)(e))})},[n,i,c]);return u?(0,N.tZ)(eW.zx,{css:uN.expandButton,text:t,iconRight:(0,N.tZ)(aN.Z,{}),onClick:function(){return d(!1)},size:"big"}):a?(0,N.BX)($.G,{css:uN.branchListContainer,children:[(0,N.tZ)(eW.zx,{css:uN.topRowInteractive,text:t,iconRight:(0,N.tZ)(aU.Z,{}),onClick:function(){return d(!0)},size:"big"}),(0,N.tZ)(eq.Tg,{css:uN.branchListFoldable,elevated:!0,children:f})]}):(0,N.BX)($.G,{css:uN.branchListContainer,children:[(0,N.tZ)($.G,{css:uN.topRow,children:(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:t})}),(0,N.tZ)(eq.Tg,{css:uN.branchList,elevated:!0,children:f})]})}var uL=(0,K.X)({container:[Y.l0.p(8),Y.l0.colWithGap(8),Y.l0.borderRadius(8)],buttonContainer:[Y.l0.rowWithGap(4)],button:[Y.l0.flex.grow(1)],inputDisabled:[{opacity:.75}]});function uO(){var e=(0,L._)((0,O.useState)(!0),2),t=e[0],n=e[1],r=(0,L._)((0,O.useState)(""),2),i=r[0],o=r[1],a=(0,L._)((0,O.useState)(!1),2),l=a[0],c=a[1],s=lU(),u=(0,H.Z)().git;function d(){n(!0),o("")}function f(){return h.apply(this,arguments)}function h(){return(h=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:if(t||!i||l)return[2];return c(!0),[4,u.createBranch({name:i,checkout:!0})];case 1:return(e=r.sent()).error?(s(e.error),c(!1)):(u.forceRefresh(),c(!1),o(""),n(!0),lk("branch-created")),[2]}})})).apply(this,arguments)}if(t)return(0,N.tZ)(eW.zx,{text:"Create Branch",iconLeft:(0,N.tZ)(i0.Z,{}),onClick:function(){return n(!1)}});var p=!i||!(0,l9.Dc)(i);return(0,N.BX)(eq.Tg,{css:uL.container,elevated:!0,children:[(0,N.tZ)(uX,{value:i,onChange:o,onSubmit:f,onCancel:d,disabled:l}),(0,N.BX)($.G,{css:uL.buttonContainer,children:[(0,N.tZ)(eW.zx,{css:uL.button,text:"Cancel",onClick:d,disabled:l}),(0,N.tZ)(eW.zx,{css:uL.button,text:"Create Branch",colorway:"primary",iconLeft:(0,N.tZ)(i0.Z,{}),onClick:f,loading:l,disabled:p})]})]})}function uX(e){var t=e.value,n=e.disabled,r=e.onChange,i=e.onSubmit,o=e.onCancel;function a(e){(0,l9.dC)(e)&&(null==r||r(e))}return(0,N.tZ)(tF.II,{value:t,css:n?uL.inputDisabled:void 0,disabled:n,placeholder:"Enter a name for your new branch",onChange:function(e){return a(e.currentTarget.value)},onKeyDown:function(e){return function(e,n){switch(e){case"Enter":null==i||i(),n();break;case"Escape":null==o||o(),n();break;case" ":if(""===t){n();break}a(t+"-"),n()}}(e.key,function(){return e.preventDefault()})},onBlur:function(){""===t&&(null==o||o())},autoFocus:!0})}function uM(e){var t,n,r=e.currentBranch,i=e.switchMode,o=lU(),a=(0,H.Z)().git,l=(0,L._)((0,O.useState)(null),2),c=l[0],s=l[1],u=(0,le.Z)((t=(0,eO._)(function(e){var t,n,r,i,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z;return(0,eX.Jh)(this,function(w){switch(w.label){case 0:return[4,e.listBranches()];case 1:if((t=w.sent()).error)return o(t.error),ln({context:"dashboard-view",gitService:e,result:t}),[2,t];return[4,e.findDefaultBranches()];case 2:if((n=w.sent()).error)return o(n.error),[2,n];r=t.branches,i=new Set,a=!0,l=!1,c=void 0;try{for(s=function(){var e=d.value,t=r.find(function(t){return(0,l9.Pi)(t,e)});t&&i.add(t)},u=n.refs[Symbol.iterator]();!(a=(d=u.next()).done);a=!0)s()}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}f=Date.now()-5184e6,h=[],p=[],m=!0,v=!1,g=void 0;try{for(y=r[Symbol.iterator]();!(m=(b=y.next()).done);m=!0)Z=b.value,i.has(Z)||(Z.commit.author.date>f?h.push(Z):p.push(Z))}catch(e){v=!0,g=e}finally{try{m||null==y.return||y.return()}finally{if(v)throw g}}return[2,{active:h,stale:p,important:Array.from(i),error:null}]}})}),function(e){return t.apply(this,arguments)}),[o]),d=(n=(0,eO._)(function(e){var t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:if(null!==c)return[2];return(0,l9.Pi)(r,e)&&i({mode:Z.CURRENT_BRANCH}),s(e),[4,a.switchBranch(e)];case 1:return(t=n.sent()).error?(o(t.error),ln({context:"dashboard-view",gitService:a,result:t,data:{branch:e.name}}),s(null)):(a.forceRefresh(),lk("branch-switched")),[2]}})}),function(e){return n.apply(this,arguments)});if((0,O.useEffect)(function(){null!==c&&(0,l9.Pi)(r,c)&&(s(null),i({mode:Z.CURRENT_BRANCH}))},[r,c,i]),!u||null!==c)return(0,N.tZ)(sR,{});if(u.error)return(0,N.tZ)("div",{children:u.error});var f=u.active,h=u.stale,p=u.important;return(0,N.tZ)($.G,{css:[Y.l0.colWithGap(8)],children:(0,N.BX)($.G,{css:[Y.l0.pb(8),Y.l0.px(8),Y.l0.colWithGap(16)],children:[r?(0,N.BX)($.G,{css:Y.l0.colWithGap(8),children:[(0,N.tZ)(uU,{branches:[r],current:r,name:"Current Branch",switchBranch:d}),(0,N.tZ)(uO,{})]}):null,(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,css:uR.switchToBranch,children:"Switch Branch"}),0===p.length?null:(0,N.tZ)(uU,{branches:p,current:r,name:"Important",switchBranch:d,foldable:!0}),0===f.length?null:(0,N.tZ)(uU,{branches:f,current:r,name:"Active",switchBranch:d,foldable:!0}),0===h.length?null:(0,N.tZ)(uU,{branches:h,current:r,name:"Stale",switchBranch:d,foldable:!0,folded:!0})]})})}function uF(){return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Unsupported state: your HEAD is currently detached."}),(0,N.tZ)(J.xv,{multiline:!1,children:"Please checkout a branch."})]})}var uW=n(60769),uH=n(42960),uV=(0,K.X)({container:[Y.l0.colWithGap(4)],file:[Y.l0.rowWithGap(8),Y.l0.align.center],fileLeft:[Y.l0.rowWithGap(8),Y.l0.flex.grow(1),Y.l0.align.center],filePrefix:[Y.l0.color.foregroundDimmest]});function uz(e){var t=e.files,n=e.uniquePathMap,r=e.onFileClick,i=[];if(t instanceof Map){var o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=(0,L._)(c.value,2),d=u[0],f=u[1],h=n.get(d);i.push({path:d,prefix:h,resolved:f})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}}else{var p=!0,m=!1,v=void 0;try{for(var g,y=t[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var b=g.value,Z=n.get(b);i.push({path:b,prefix:Z,resolved:!0})}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}}return(0,N.tZ)($.G,{css:uV.container,children:i.map(function(e){var t=e.path,n=e.prefix,i=e.resolved;return(0,N.BX)($.G,{css:uV.file,children:[(0,N.BX)($.G,{css:uV.fileLeft,children:[(0,N.tZ)(aI.Z,{path:t}),(0,N.tZ)(J.xv,{multiline:!1,children:(0,N.tZ)(l3,{path:t,prefix:n,onClick:function(){return r(t)}})})]}),i?(0,N.tZ)(nU.Z,{color:Y.TV.greenStronger}):(0,N.tZ)(eV.Z,{color:Y.TV.orangeStronger})]},t)})})}function uj(e){var t=e.hasConflicts?(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{css:Y.l0.fontWeight.medium,children:"Resolve all conflicts to complete merge."}),(0,N.tZ)("br",{}),(0,N.tZ)("span",{children:"You can't do anything else until the merge has been completed or aborted."})]}):(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{css:Y.l0.fontWeight.medium,children:"You are in the middle of a merge."}),(0,N.tZ)("br",{}),(0,N.tZ)("span",{children:"You can't do anything else until the merge has been completed or aborted. You have no conflicts to resolve, so the merge can be completed without any further action."})]});return(0,N.tZ)(ej.E,{colorway:"warning",icon:(0,N.tZ)(eV.Z,{}),text:t})}var uq=(0,K.X)({container:[Y.l0.rowWithGap(4),Y.l0.align.center,Y.l0.justify.spaceBetween],left:[{flexBasis:0,flexGrow:1},Y.l0.colWithGap(8)],right:{flexBasis:0,flexGrow:1},branch:[Y.l0.p(8),Y.l0.rowWithGap(4),Y.l0.flex.grow(1),Y.l0.center,Y.l0.borderRadius(8)]});function uY(e){var t,n=e.branch,r=e.refs,i=e.refsAreBranches,o=e.isUpstreamPull;if(!r.length)return null;if(o){var a=(0,L._)((0,lm.Tg)(r[0]),2),l=a[0],c=a[1];l&&c&&(t=(0,N.tZ)(eq.Tg,{css:uq.branch,elevated:!0,children:(0,N.tZ)(l4,{remote:l,name:c,icon:!0,heading:!0})}))}return t||(t=r.map(function(e){return(0,N.tZ)(eq.Tg,{css:uq.branch,elevated:!0,children:(0,N.tZ)(l4,{name:e,icon:!!i||(0,N.tZ)(aA.Z,{size:16}),heading:!0})},e)})),(0,N.BX)($.G,{css:uq.container,children:[(0,N.tZ)($.G,{css:uq.left,children:t}),(0,N.tZ)(tH.Z,{size:24,color:Y.TV.foregroundDimmest}),(0,N.tZ)($.G,{css:uq.right,children:(0,N.tZ)(eq.Tg,{css:uq.branch,elevated:!0,children:(0,N.tZ)(l4,{name:n,icon:!0,current:!0,heading:!0})})})]})}var u$=(0,K.X)({container:[Y.l0.colWithGap(12),Y.l0.pt(16),Y.l0.pb(8),Y.l0.px(8)],fakePaneHeader:[Y.l0.p(8),Y.l0.rowWithGap(8),Y.l0.backgroundColor.backgroundDefault,Y.l0.align.center,{borderBottom:"1px solid ".concat(Y.TV.outlineDimmer)}],conflictResolution:[Y.l0.colWithGap(16)],listContainer:[Y.l0.p(8),Y.l0.colWithGap(8),Y.l0.borderRadius(8)],list:[Y.l0.pb(8),Y.l0.colWithGap(8)],listDisabled:[{opacity:.5},Y.l0.pb(8),Y.l0.colWithGap(8)],listHeader:[Y.l0.pb(4),Y.l0.flex.grow(1),Y.l0.border({color:Y.TV.outlineDimmer,direction:"bottom"})],listFiles:[Y.l0.px(8)],includeOtherFiles:[{cursor:"pointer",maxWidth:"max-content",userSelect:"none"},Y.l0.rowWithGap(8)],buttons:[Y.l0.colWithGap(8)]});function uJ(e){var t,n=e.onFileClick,r=e.gotoPendingState,i=(0,L._)((0,O.useState)(!0),2),o=i[0],a=i[1],l=(0,L._)((0,O.useState)(!1),2),c=l[0],s=l[1],u=(0,L._)((0,O.useState)(!1),2),d=u[0],f=u[1],h=c||d,p=lU(),m=(0,H.Z)().git,v=O.useId(),g=(0,le.Z)((t=(0,eO._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z;return(0,eX.Jh)(this,function(w){switch(w.label){case 0:return[4,e.status()];case 1:if((t=w.sent()).error)return ln({context:"use-merging-view-state-status",gitService:e,result:t}),[2,t];if(!(n=t.branch))return[2,{error:lp.aq.HEAD_DETACHED}];return[4,e.getConflictingFiles()];case 2:if((r=w.sent()).error)return[2,r];return i=r.files,[4,e.getMergingRefs()];case 3:if((o=w.sent()).error)return ln({context:"use-merging-view-state-merging-refs",gitService:e,result:o,data:{status:t,conflictingFiles:i}}),[2,o];a=o.commits,s=(c=(l=o.branches).length>0)?l:a,u=t.changes.filter(function(e){return!e.unmerged}).map(function(e){return e.path}),d=!0,f=!0,h=!1,p=void 0;try{for(m=i[Symbol.iterator]();!(f=(v=m.next()).done);f=!0)if(!(0,L._)(v.value,2)[1]){d=!1;break}}catch(e){h=!0,p=e}finally{try{f||null==m.return||m.return()}finally{if(h)throw p}}return g=sP(t.changes.map(function(e){return e.path})),y=i.size>0,b=u.length>0,Z=null!==t.upstream&&1===l.length&&l[0]===t.upstream.branch,[2,{refs:s,branch:n,conflictingFiles:i,otherChangedFiles:u,refsAreBranches:c,allIsResolved:d,uniquePathMap:g,hasConflicts:y,hasOtherChanges:b,isUpstreamPull:Z,error:null}]}})}),function(e){return t.apply(this,arguments)}));if((0,O.useEffect)(function(){(null==g?void 0:g.error)&&p(g.error)},[null==g?void 0:g.error,p]),!g)return(0,N.tZ)(sR,{});if(g.error)return null;var y=g.refs,b=g.branch,Z=g.conflictingFiles,w=g.otherChangedFiles,x=g.refsAreBranches,C=g.allIsResolved,_=g.uniquePathMap,k=g.hasConflicts,S=g.hasOtherChanges,E=g.isUpstreamPull;function T(){return(T=(0,eO._)(function(){var e,t,n,i,a,l,c,u,d,f,v;return(0,eX.Jh)(this,function(g){switch(g.label){case 0:if(!C||h)return[2];s(!0),e=[],t=!0,n=!1,i=void 0;try{for(a=Z.keys()[Symbol.iterator]();!(t=(l=a.next()).done);t=!0)c=l.value,e.push(c)}catch(e){n=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return o&&(u=e).push.apply(u,(0,ex._)(w)),[4,m.stageFiles({all:!1})];case 1:if((d=g.sent()).error)return p(d.error),s(!1),[2];return[4,m.stageFiles({add:e})];case 2:if((f=g.sent()).error)return p(f.error),s(!1),[2];return[4,m.mergeContinue()];case 3:if(!(v=g.sent()).error)return[3,5];return[4,m.stageFiles({all:!1})];case 4:return g.sent(),p(v.error),s(!1),[3,6];case 5:r(),m.forceRefresh(),g.label=6;case 6:return[2]}})})).apply(this,arguments)}function R(){return(R=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(h)return[2];return f(!0),[4,m.mergeAbort()];case 1:return(e=t.sent()).error?(p(e.error),f(!1),ln({context:"merging-view-abort",gitService:m,result:e,data:{branch:b}})):(r(),m.forceRefresh()),[2]}})})).apply(this,arguments)}var I=E?"Complete in-progress pull":"Complete in-progress merge";return k&&(I=E?"Resolve pull conflicts":"Resolve merge conflicts"),(0,N.BX)($.G,{children:[(0,N.BX)($.G,{css:u$.fakePaneHeader,children:[(0,N.tZ)(uH.Z,{}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:I})]}),(0,N.BX)($.G,{css:u$.container,children:[(0,N.tZ)(uY,{branch:b,refs:y,refsAreBranches:x,isUpstreamPull:E}),(0,N.tZ)(uj,{hasConflicts:k}),(0,N.BX)(eq.Tg,{css:u$.listContainer,elevated:!0,children:[(0,N.BX)($.G,{css:u$.list,children:[(0,N.tZ)($.G,{css:u$.listHeader,children:(0,N.tZ)(J.xv,{css:Y.l0.fontWeight.medium,multiline:!1,children:"Conflicting Files"})}),(0,N.tZ)($.G,{css:u$.listFiles,children:k?(0,N.tZ)(uz,{files:Z,uniquePathMap:_,onFileClick:n}):(0,N.tZ)(J.xv,{variant:"small",color:"dimmest",multiline:!1,children:"There are no conflicting files in this merge."})})]}),S?(0,N.BX)($.G,{css:o?u$.list:u$.listDisabled,children:[(0,N.tZ)($.G,{css:u$.listHeader,children:(0,N.tZ)(J.xv,{css:Y.l0.fontWeight.medium,multiline:!1,children:"Other Changed Files"})}),(0,N.tZ)($.G,{css:u$.listFiles,children:(0,N.tZ)(uz,{files:w,uniquePathMap:_,onFileClick:n})})]}):null]}),(0,N.BX)($.G,{css:u$.includeOtherFiles,tag:"label",children:[(0,N.tZ)(uW.X,{id:v,checked:o,onChange:function(e){return a(e.target.checked)}}),(0,N.tZ)(J.xv,{multiline:!1,children:"Include other changed files in commit"})]}),(0,N.BX)($.G,{css:u$.buttons,children:[(0,N.tZ)(eW.zx,{text:E?"Complete pull":"Complete merge and commit",colorway:"primary",iconLeft:c?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(uH.Z,{}),disabled:!C||h,loading:c,onClick:function(){return T.apply(this,arguments)}}),(0,N.tZ)(eW.zx,{text:E?"Abort pull":"Abort merge",colorway:"negative",iconLeft:d?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(sj.Z,{}),disabled:h,loading:d,onClick:function(){return R.apply(this,arguments)}})]})]})]})}var uK=(0,K.X)({checkboxLabel:Y.l0.rowWithGap(8)});function uQ(){var e=(0,O.useId)(),t=(0,L._)((0,O.useState)(!0),2),n=t[0],r=t[1],i=(0,L._)((0,O.useState)(!1),2),o=i[0],a=i[1],l=lU(),c=(0,H.Z)().git;function s(){return(s=(0,eO._)(function(){var e;return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(o)return[2];return a(!0),[4,c.init({initialCommit:n,includeAllInitialFiles:!0})];case 1:return(e=t.sent()).error?(a(!1),l(e.error)):(c.forceRefresh(),lk("repository-initialized")),[2]}})})).apply(this,arguments)}return(0,N.BX)(N.HY,{children:[(0,N.BX)($.G,{css:uK.checkboxLabel,tag:"label",children:[(0,N.tZ)(uW.X,{id:e,checked:n,onChange:function(e){return r(e.target.checked)}}),(0,N.tZ)(J.xv,{multiline:!1,children:"Create initial commit with all changes"})]}),(0,N.tZ)(eW.zx,{text:o?"Initializing...":"Initialize Git Repository",iconLeft:o?(0,N.tZ)(eE.Z,{}):(0,N.tZ)(ld.Z,{}),colorway:"primary",loading:o,onClick:function(){return s.apply(this,arguments)}})]})}var u0=(0,K.X)({container:[Y.l0.height("100%"),Y.l0.p(16),Y.l0.colWithGap(16),Y.l0.center],imageTagline:[Y.l0.colWithGap(16),Y.l0.center,Y.l0.flex.shrink(1)]});function u1(){return(0,N.BX)($.G,{css:u0.container,children:[(0,N.BX)($.G,{css:u0.imageTagline,children:[(0,N.tZ)(od.Z,{alt:"A potted plant morphing into a branching graph like structure",src:"/public/images/git/git_uninitialized_art.svg",height:300,width:280,objectFit:"contain",priority:!0}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Version control for your Repl."})]}),(0,N.tZ)(uQ,{})]})}function u2(){return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a rebase."}),(0,N.tZ)(J.xv,{multiline:!1,children:"Please finish the rebase manually."})]})}function u8(){return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a revert."}),(0,N.tZ)(J.xv,{multiline:!1,children:"Please finish the revert manually."})]})}var u4=n(56050),u3=n(85195),u5=(0,K.X)({gitProfileTitle:[Y.l0.rowWithGap(8),Y.l0.align.center]});function u6(e){var t=e.username,n=e.avatar;return(0,N.BX)($.G,{css:u5.gitProfileTitle,children:[(0,N.tZ)(l7.q,{src:null!=n?n:"/images/evalbot/evalbot_24",username:t}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:t})]})}var u9=(0,K.X)({list:{"> div:first-child":Y.l0.borderRadius(8,8,0,0),"> div:last-child":[Y.l0.borderRadius(0,0,8,8),{border:"none"}]},profile:[lz.gU.filled,Y.l0.flex.row,Y.l0.justify.spaceBetween,Y.l0.p(12),Y.l0.borderRadius(0),Y.l0.border({color:Y.TV.outlineDefault,direction:"bottom"})],information:[Y.l0.colWithGap(4),Y.l0.flex.shrink(1)],informationRow:[Y.l0.rowWithGap(8),Y.l0.align.center],email:[Y.l0.flex.shrink(1)],connectToGithubContainer:[Y.l0.colWithGap(4),Y.l0.p(12),Y.l0.backgroundColor.backgroundHigher],divider:[Y.l0.backgroundColor.outlineDefault],connectToGitHubTitle:[Y.l0.rowWithGap(4),Y.l0.align.center],notConnectedText:[Y.l0.pb(4)],settingsButton:{background:"transparent",border:"none","&:hover":{textDecoration:"underline"}},radio:{pointerEvents:"none"}});function u7(e){var t=e.profiles,n=e.current,r=e.showConnectToGithub,i=e.onSelectProvider,o=(0,o4.useRouter)(),a=(0,iL.Vg)(o),l=O.useId();return(0,N.BX)(u3.E,{name:l,css:u9.list,value:null!=n?n:"",children:[t.map(function(e){t=e.provider===lp.rG.GITHUB?"GitHub":"Default Profile";var t,r=void 0;return e.provider===lp.rG.GITHUB&&(r=a?"/mobile/auth/github/app_permissions":"/auth/github/app_permissions?close=1"),(0,N.tZ)(de,{profile:e,providerName:t,current:e.provider===n,onSelectProvider:i,settingsURL:r},e.provider)}),r?(0,N.BX)($.G,{css:u9.connectToGithubContainer,children:[(0,N.tZ)($.G,{css:u9.connectToGitHubTitle,children:(0,N.tZ)(u6,{username:"GitHub Account"})}),(0,N.tZ)(J.xv,{color:"dimmest",css:u9.notConnectedText,multiline:!1,children:"Your GitHub account is not connected."}),(0,N.tZ)(lE,{})]}):null]})}function de(e){var t=e.profile,n=e.current,r=e.providerName,i=e.settingsURL,o=e.onSelectProvider,a=t.provider,l=t.username,c=t.email,s=t.avatar,u=O.useId();return(0,N.BX)($.G,{onClick:function(){return o(a)},css:u9.profile,children:[(0,N.BX)($.G,{css:u9.information,children:[(0,N.BX)($.G,{css:u9.informationRow,children:[(0,N.tZ)(u6,{username:l,avatar:s}),i?(0,N.tZ)(oy.Z,{css:u9.settingsButton,text:"".concat(r," Settings"),iconRight:(0,N.tZ)(oZ.Z,{}),href:i,target:"_blank",variant:"outlined",size:"small"}):(0,N.tZ)(J.xv,{color:"dimmest",variant:"small",multiline:!1,children:r})]}),(0,N.tZ)(J.xv,{color:"dimmest",css:u9.email,multiline:!1,children:c})]}),(0,N.tZ)(u3.Y,{css:u9.radio,id:u,checked:n,value:a})]})}var dt=(0,K.X)({profileContainer:[Y.l0.flex.column]});function dn(){var e,t=(0,H.Z)().git,n=(0,le.Z)((e=(0,eO._)(function(e){var t,n;return(0,eX.Jh)(this,function(r){return t=e.getCurrentProfile(),[2,{profiles:e.getProfiles(),current:null!==(n=null==t?void 0:t.provider)&&void 0!==n?n:null,hasGitHub:!e.hasProfile(lp.rG.GITHUB),error:null}]})}),function(t){return e.apply(this,arguments)}));if(!n)return null;if(null!==n.error)return ln({context:"git-profiles",gitService:t,result:{error:n.error}}),null;var r=n.profiles,i=n.current,o=n.hasGitHub;return(0,N.tZ)($.G,{css:dt.profileContainer,children:(0,N.tZ)(u7,{profiles:r,current:i,showConnectToGithub:o,onSelectProvider:function(e){t.setCurrentProfile(e),e===lp.rG.REPLIT_DEFAULT?lk("profile-changed",{profile:"replit"}):e===lp.rG.GITHUB&&lk("profile-changed",{profile:"github"})}})})}var dr=n(39390);function di(){var e=(0,ns._)(["\n  query GithubRemoteConfigRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        description\n        isPrivate\n        slug\n        url\n      }\n    }\n  }\n"]);return di=function(){return e},e}function da(){var e=(0,ns._)(['\n  query GithubRemoteConfigUser {\n    currentUser {\n      ... on CurrentUser {\n        id\n        gitHubInfo {\n          accessToken\n        }\n        repositories(count: 1, after: "0") {\n          ... on RepositoryConnection {\n            items {\n              id\n            }\n          }\n        }\n      }\n    }\n  }\n']);return da=function(){return e},e}function dl(){var e=(0,ns._)(["\n  mutation GithubRemoteConfigCreateGithubRepo($input: CreateGithubRepoInput!) {\n    createGithubRepo(input: $input) {\n      ... on CreateGithubRepoResult {\n        remoteUrl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return dl=function(){return e},e}var dc={},ds=(0,nu.Ps)(di());da();var du=(0,nu.Ps)(dl()),dd=(0,K.X)({errorText:[Y.l0.color.accentNegativeStronger,Y.l0.pl(4)]});function df(e){var t,n,r,i,o=e.remoteName,a=e.updateRemote,l=(0,nN.Z)().showConfirm,c=(0,H.Z)().git,s=(0,ab.Z)(),u=lZ(),d=(0,rV.U)(),f=(0,nc.Z)(),h=(0,O.useRef)(null),p=(0,O.useRef)(null),m=(0,L._)((0,O.useState)(),2),v=m[0],g=m[1],y=(t=(0,eU._)({},dc,{variables:{replId:f}}),nd.a(ds,t)).data,b=(null==y?void 0:y.repl.__typename)==="Repl"?y.repl:{slug:void 0,description:void 0,isPrivate:void 0,url:void 0},Z=b.slug,w=b.description,x=b.isPrivate,C=b.url,_=(0,L._)((n=(0,eU._)({},dc,void 0),nC.D(du,n)),2),k=_[0],S=_[1].loading,E=(0,lx.v)({onAuth:function(){lk("github-user-connected")}}),T=(0,L._)((0,O.useState)(null==x||x),2),R=T[0],I=T[1],D=(0,L._)((0,O.useState)(Z),2),G=D[0],B=D[1],P=(0,L._)((0,O.useState)(),2),A=P[0],U=P[1],X=(0,L._)((0,O.useState)(null!=w?w:C&&"Repository for https://replit.com".concat(C)),2),M=X[0],F=X[1],W=(0,L._)((0,O.useState)(),2),V=W[0],z=W[1],j=function(){U(void 0),z(void 0),g(void 0)},q=(r=(0,eO._)(function(e){var t,n,r;return(0,eX.Jh)(this,function(i){switch(i.label){case 0:return[4,c.getRemotes()];case 1:if((t=i.sent()).error)return g("Error finding current remotes, ".concat(t.error)),[2];if(!t.remotes.has(o))return[3,3];return[4,c.setRemoteURL({remote:o,url:e})];case 2:if((n=i.sent()).error)return g("Error (".concat(n.error,") setting ").concat(o," to use ").concat(e," as a remote.")),[2];return a(e),lk("remote-edited"),[2];case 3:return[4,c.addRemote({name:o,url:e})];case 4:if((r=i.sent()).error)return g("Error (".concat(r.error,") adding ").concat(o," ").concat(e," as a remote.")),[2];return a(e),lk("remote-added"),[2]}})}),function(e){return r.apply(this,arguments)}),K=(i=(0,eO._)(function(){var e,t,n,r;return(0,eX.Jh)(this,function(i){switch(i.label){case 0:if(j(),!G)return[2];if(!(0,l9.GE)(G))return U("Invalid remote name."),[2];return[4,k({variables:{input:{name:G,description:null!=w?w:null,homepage:"replit.com".concat(C),isPrivate:R,ownerType:iq.xJ.User}}})];case 1:if((null===(e=(r=i.sent()).data)||void 0===e?void 0:e.createGithubRepo.__typename)==="UnauthorizedError"||(null===(t=r.data)||void 0===t?void 0:t.createGithubRepo.__typename)==="UserError")return g(r.data.createGithubRepo.message),[2];return(null===(n=r.data)||void 0===n?void 0:n.createGithubRepo.__typename)==="CreateGithubRepoResult"&&(q(r.data.createGithubRepo.remoteUrl),lk("github-repository-published"),l("Created repository on Github")),[2]}})}),function(){return i.apply(this,arguments)});return u?(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{color:"dimmest",multiline:!1,children:"Repository name"}),(0,N.tZ)(tF.II,{ref:h,placeholder:"Enter repository name",value:G,onChange:function(e){U(void 0),B(e.target.value)},onKeyDown:function(e){if("Enter"===e.key){var t;e.preventDefault(),null===(t=p.current)||void 0===t||t.focus()}}}),(0,N.tZ)(J.xv,{css:dd.errorText,multiline:!1,children:A}),(0,N.tZ)(u4.Z,{height:1}),(0,N.tZ)(J.xv,{color:"dimmest",multiline:!1,children:"Repository description"}),(0,N.tZ)(tF.B,{ref:p,maxLength:350,name:"Repository description",placeholder:"Enter repository description",value:null!=M?M:void 0,onChange:function(e){z(void 0),F(e.target.value)}}),(0,N.tZ)(J.xv,{css:dd.errorText,multiline:!1,children:V}),(0,N.tZ)(u4.Z,{height:1}),(0,N.tZ)(J.xv,{color:"dimmest",multiline:!1,children:"Privacy"}),(0,N.BX)(a2.hE,{tag:"fieldset",id:d("privacy"),name:d("privacy"),value:R,onChange:function(e){return I(e)},row:!0,css:[Y.l0.width("100%")],children:[(0,N.tZ)(a2.rK,{id:d("false"),value:!1,text:"Public",icon:(0,N.tZ)(dr.Z,{})}),(0,N.tZ)(a2.rK,{id:d("true"),value:!0,text:"Private",icon:(0,N.tZ)(ev.Z,{})})]}),(0,N.tZ)(u4.Z,{height:2}),(0,N.tZ)(eW.zx,{text:S?"Creating Repository on GitHub":"Create Repository on GitHub",colorway:"primary",iconLeft:(0,N.tZ)(lC.Z,{}),onClick:K,loading:S}),v?(0,N.tZ)(J.xv,{css:dd.errorText,maxLines:2,multiline:!1,children:v}):null]}):s?(0,N.tZ)($.G,{children:(0,N.tZ)(eW.zx,{colorway:"primary",iconLeft:(0,N.tZ)(lC.Z,{}),text:"Open Account page to connect to GitHub",onClick:function(){lS.X.openExternalUrl("/account#connected-services")}})}):(0,N.tZ)($.G,{children:(0,N.tZ)(eW.zx,{colorway:"primary",iconLeft:(0,N.tZ)(lC.Z,{}),text:"Connect to GitHub",onClick:E})})}var dh=(0,nr.iv)(Y.l0.rowWithGap(4)),dp=(0,nr.iv)(Y.l0.flex.growAndShrink(1)),dm=(0,nr.iv)(Y.l0.color.accentNegativeStronger,Y.l0.pl(4));function dv(e){var t,n=e.initialRemoteUrl,r=e.remoteName,i=e.updateRemote,o=(0,H.Z)().git,a=(0,L._)((0,O.useState)(),2),l=a[0],c=a[1];(0,O.useEffect)(function(){c(void 0)},[n]);var s=(0,L._)((0,O.useState)(),2),u=s[0],d=s[1],f=(0,L._)((0,O.useState)(!1),2),h=f[0],p=f[1],m=(t=(0,eO._)(function(){var e,t,n;return(0,eX.Jh)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,5,6,7]),!l)return[2];if(p(!0),!(0,l9.LY)(l))throw Error("Invalid remote url.");return[4,o.getRemotes()];case 1:if((e=a.sent()).error)throw Error("Error finding current remotes, ".concat(e.error));if(!e.remotes.has(r))return[3,3];return[4,o.setRemoteURL({remote:r,url:l})];case 2:if((t=a.sent()).error)throw ln({context:"remote-input",gitService:o,result:t,data:{remote:r,url:l}}),Error("Error (".concat(t.error,") setting ").concat(r," to use ").concat(l," as a remote."));return lk("remote-edited"),i(l),[2];case 3:return[4,o.addRemote({name:r,url:l})];case 4:if((n=a.sent()).error)throw ln({context:"remote-input",gitService:o,result:n,data:{remote:r,url:l}}),Error("Error (".concat(n.error,") adding ").concat(r," ").concat(l," as a remote."));return lk("remote-added"),[3,7];case 5:return d(a.sent().message),[3,7];case 6:return p(!1),[7];case 7:return[2]}})}),function(){return t.apply(this,arguments)});return(0,N.BX)($.G,{children:[(0,N.tZ)(tF.II,{name:"Remote URL",placeholder:"Enter Remote URL",value:null!=l?l:n,autoComplete:"off",autoCorrect:"off",onChange:function(e){d(void 0),c(e.target.value)},inputMode:"url","aria-label":"Remote URL",onKeyDown:function(e){"Enter"===e.key&&m()}}),u?(0,N.tZ)(J.xv,{variant:"small",css:dm,multiline:!1,children:u}):null,l&&l!==n?(0,N.BX)(N.HY,{children:[(0,N.tZ)(u4.Z,{height:1}),(0,N.BX)($.G,{css:dh,children:[(0,N.tZ)(eW.zx,{css:dp,text:"Cancel",iconLeft:(0,N.tZ)(tb.Z,{}),onClick:function(){return c(void 0)}}),(0,N.tZ)(eW.zx,{css:dp,text:h?"Saving":"Save",loading:h,colorway:"primary",iconLeft:(0,N.tZ)(nU.Z,{}),onClick:m})]})]}):null]})}var dg=(0,nr.iv)(Y.l0.border({width:1,color:Y.TV.outlineDimmer}),Y.l0.borderRadius(8)),dy=(0,nr.iv)(lz.gU.filled,Y.l0.flex.row,Y.l0.justify.spaceBetween,Y.l0.align.center,Y.l0.px(8),Y.l0.py(4),Y.l0.borderRadius(8,8,0,0)),db=(0,nr.iv)(Y.l0.borderRadius(8,8,0,0)),dZ=(0,nr.iv)(Y.l0.borderRadius(8)),dw=(0,nr.iv)(Y.l0.p(8)),dx=(0,nr.iv)(Y.l0.flex.growAndShrink(1));function dC(e){var t=e.title,n=e.expanded,r=e.content,i=e.onClick;return(0,N.BX)($.G,{css:dg,children:[(0,N.BX)($.G,{css:[dy,n?db:dZ],onClick:i,children:[(0,N.tZ)($.G,{css:dx,children:(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:t})}),n?(0,N.tZ)(aU.Z,{size:20}):(0,N.tZ)(aN.Z,{size:20})]}),n?(0,N.tZ)($.G,{css:dw,children:r}):null]})}var d_="origin";function dk(){var e,t=(0,le.Z)((e=(0,eO._)(function(e){var t,n,r,i;return(0,eX.Jh)(this,function(o){switch(o.label){case 0:return[4,e.getRemotes()];case 1:if((t=o.sent()).error)return ln({context:"remote-config",gitService:e,result:t}),[2,{url:void 0,name:d_,error:t.error}];if(!(r=(0,L._)(null!==(n=t.remotes.values())&&void 0!==n?n:void 0,1)[0]))return[2,{url:void 0,name:d_,error:null}];return[2,{url:r.push||r.fetch,name:null!==(i=r.name)&&void 0!==i?i:d_,error:null}]}})}),function(t){return e.apply(this,arguments)}));return null==t?(0,N.BX)($.G,{css:Y.l0.center,children:[(0,N.tZ)(J.xv,{color:"dimmest",multiline:!1,children:"Loading remote information."}),(0,N.tZ)(sR,{})]}):(null==t?void 0:t.error)?null:(0,N.tZ)(dS,{initialRemoteUrl:null==t?void 0:t.url,remoteName:null==t?void 0:t.name})}function dS(e){var t=e.initialRemoteUrl,n=e.remoteName,r=(0,L._)((0,O.useState)(t),2),i=r[0],o=r[1],a=(0,L._)((0,O.useState)(""===t||void 0===t?0:void 0),2),l=a[0],c=a[1],s=function(e){o(e)};return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Remote"}),(0,N.tZ)(u4.Z,{height:1}),(0,N.tZ)(dv,{remoteName:n,initialRemoteUrl:i,updateRemote:s}),(0,N.tZ)(u4.Z,{height:2}),(0,N.tZ)(dC,{title:"GitHub",expanded:0===l,onClick:function(){return c(function(e){return 0===e?void 0:0})},content:(0,N.tZ)(df,{remoteName:n,updateRemote:s})})]})}(s=x||(x={}))[s.GitHub=0]="GitHub";var dE=(0,nr.iv)(Y.l0.px(16));function dT(){return(0,N.BX)($.G,{css:dE,children:[(0,N.tZ)(u4.Z,{height:2}),(0,N.tZ)(dk,{}),(0,N.tZ)(u4.Z,{height:2}),(0,N.tZ)(dR,{})]})}function dR(){return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Commit author"}),(0,N.tZ)(u4.Z,{height:1}),(0,N.tZ)(dn,{})]})}var dI=(0,K.X)({container:[Y.l0.colWithGap(16),Y.l0.p(8),Y.l0.pt(16)],fakePaneHeader:[Y.l0.px(8),Y.l0.py(4),Y.l0.rowWithGap(8),Y.l0.backgroundColor.backgroundDefault,Y.l0.align.center,{borderBottom:"1px solid ".concat(Y.TV.outlineDimmer)}]});function dD(e){var t=e.onFileClick,n=e.status;return(0,N.BX)($.G,{children:[(0,N.tZ)(dG,{}),(0,N.BX)($.G,{css:dI.container,children:[(0,N.tZ)(ej.E,{colorway:"orange",icon:(0,N.tZ)(eV.Z,{}),text:"Your current branch doesn't have any commits. You need to make an initial commit before continuing."}),(0,N.BX)($.G,{css:uR.section,children:[(0,N.tZ)($.G,{css:uR.reviewChangesHeader,children:(0,N.tZ)(J.xv,{css:uR.headerText,multiline:!1,children:"Commit"})}),(0,N.tZ)(uc,{status:n,onStagedFileClick:t,defaultMessage:"Initial commit"})]})]})]})}function dG(){var e,t=lU(),n=(0,le.Z)((e=(0,eO._)(function(e){var n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:return[4,e.status()];case 1:return(n=r.sent()).error&&(ln({context:"unborn-branch-view-status",gitService:e,result:n}),t(n.error)),[2,n]}})}),function(t){return e.apply(this,arguments)}),[t]);return(null==n?void 0:n.error)?null:(0,N.tZ)($.G,{css:dI.fakePaneHeader,children:(null==n?void 0:n.branch)?(0,N.tZ)(l4,{name:n.branch,current:!0,heading:!0}):null})}function dB(e){var t=e.error;return(0,N.BX)($.G,{children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Failed to start the Git pane."}),(0,N.BX)(J.xv,{multiline:!1,children:["Error: ",t]})]})}var dP=function(e){var t,n=(0,le.Z)((t=(0,eO._)(function(t){var n,r,i;return(0,eX.Jh)(this,function(o){switch(o.label){case 0:return[4,t.isInitialized()];case 1:if((n=o.sent()).error)return[2,{error:n.error}];if(!n.initialized)return[2,{error:lp.aq.NOT_INITIALIZED}];return[4,t.log({max:1,revRange:e})];case 2:if((r=o.sent()).error)return[2,{error:r.error}];if(0===r.commits.length)return[2,{error:lp.aq.NO_COMMITS}];return[2,{commit:null!==(i=r.commits[0])&&void 0!==i?i:null,error:null}]}})}),function(e){return t.apply(this,arguments)}),[e]);return(0,O.useMemo)(function(){return n?n.error?{error:n.error}:n:null},[n])},dA=function(e){var t=e.source,n=e.target;return(0,N.tZ)("span",{children:n?(0,N.BX)(N.HY,{children:["Branch ",(0,N.tZ)(l4,{name:t})," into ",(0,N.tZ)(l4,{name:n})," "]}):(0,N.BX)(N.HY,{children:["Branch ",(0,N.tZ)(l4,{name:t})]})})},dN=(0,K.X)({markerContainer:[Y.l0.display.inlineFlex,Y.l0.mr(4)]}),dU=function(e){var t=e.merge,n=e.revert,r=e.subject,i=e.onViewCommitClick;return(0,N.BX)(J.h4,{level:2,variant:"subheadDefault",multiline:!0,children:[t?(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{css:dN.markerContainer,children:(0,N.tZ)(cY,{type:"merge"})}),(0,N.tZ)(lQ,{text:"merged"})," "]}):null,(null==t?void 0:t.type)==="pull-request"?(0,N.BX)(N.HY,{children:["PR ",(0,N.tZ)(l0,{id:t.id,hash:!0})," ",(null==n?void 0:n.pr)?(0,N.BX)(N.HY,{children:[(0,N.tZ)(lK,{text:"reverts"})," ",(0,N.tZ)(l0,{id:n.pr,hash:!0})]}):null," - "]}):null,(null==t?void 0:t.type)==="branch"?(0,N.BX)(N.HY,{children:[(0,N.tZ)(dA,{source:t.source,target:t.target})," -"," "]}):null,n&&!t?(0,N.BX)(N.HY,{children:[(0,N.tZ)("span",{css:dN.markerContainer,children:(0,N.tZ)(cY,{type:"revert"})}),(0,N.tZ)(lK,{text:"reverted"})," ",(0,N.tZ)("button",{css:[Y.l0.reset.button,Y.l0.linkStyle,Y.l0.fontWeight.medium],onClick:function(){(null==n?void 0:n.hash)!==void 0&&i(n.hash)},children:n.hash.slice(0,7)})," - "]}):null,(0,N.tZ)(l2,{subject:r})]})},dL=(0,K.X)({metaContainer:[Y.l0.rowWithGap(4),Y.l0.align.center,Y.l0.flex.wrap]}),dO=function(e){var t=e.author,n=e.committer,r=sa(n,t),i=sl(n.date,t.date);return(0,N.BX)($.G,{css:dL.metaContainer,children:[r&&i?(0,N.BX)(N.HY,{children:[(0,N.tZ)(cs,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,N.tZ)(J.xv,{variant:"small",children:"authored"}),(0,N.tZ)(cd.EK,{date:t.date,textColor:"dimmest",textVariant:"small"}),(0,N.tZ)(J.xv,{variant:"small",children:"and"})]}):null,r&&!i?(0,N.BX)(N.HY,{children:[(0,N.tZ)(cs,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,N.tZ)(J.xv,{variant:"small",children:"authored"}),(0,N.tZ)(J.xv,{variant:"small",children:"and"})]}):null,(0,N.tZ)(cs,{name:n.name,email:n.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),!r&&i?(0,N.BX)(N.HY,{children:[(0,N.tZ)(J.xv,{variant:"small",children:"authored "}),(0,N.tZ)(cd.EK,{date:t.date,textColor:"dimmest",textVariant:"small"}),(0,N.tZ)(J.xv,{variant:"small",children:"and "})]}):null,(0,N.tZ)(J.xv,{variant:"small",children:"committed"}),(0,N.tZ)(cd.EK,{date:n.date,textColor:"dimmest",textVariant:"small"})]})},dX=(0,K.X)({dullText:[Y.l0.color.foregroundDimmest],tooltipContainer:[Y.l0.display.inlineBlock]}),dM=function(e){var t=e.onViewCommitClick,n=e.hash;return(0,N.tZ)("span",{css:dX.tooltipContainer,children:(0,N.tZ)(eT.u,{tooltip:"View commit",children:(0,N.tZ)("button",{css:[Y.l0.reset.button,Y.l0.linkStyle,Y.l0.fontWeight.medium],onClick:function(){return t(n)},children:n.slice(0,7)})})})},dF=function(e){var t=e.parents,n=e.grafted,r=e.onViewCommitClick;return(0,N.BX)(J.xv,{variant:"small",children:[(0,N.BX)("span",{css:dX.dullText,children:[n?"Grafted with ":null,t.length," ",(0,eC.Z)("parent",t.length)," "]}),0===t.length?null:t.map(function(e,n){return(0,N.BX)(O.Fragment,{children:[(0,N.tZ)(dM,{hash:e,onViewCommitClick:r}),n===t.length-1?"":(0,N.tZ)("span",{css:dX.dullText,children:", "})]},e)})]})},dW=[{"& > span:first-child":[Y.l0.flex.grow(1),Y.l0.textAlign.left]},{"& > span":[Y.l0.flex.shrink(1)]}],dH=(0,K.X)({container:[Y.l0.colWithGap(16)],splitOrUnisonContainer:[Y.l0.colWithGap(8),Y.l0.display.flex,Y.l0.flex.row,Y.l0.flex.wrap,Y.l0.align.center,Y.l0.justify.spaceBetween],emphasizedText:[Y.l0.fontWeight.medium],buttonFolded:[dW,Y.l0.height("auto"),Y.l0.py(8),Y.l0.fontWeight.medium],buttonUnfolded:[dW,Y.l0.height("auto"),Y.l0.py(8),Y.l0.fontWeight.medium,Y.l0.borderRadius(8,8,0,0)],buttonGroupItem:[Y.l0.width(64),Y.l0.height(32)],textContainer:[Y.l0.mt(8),Y.l0.overflow("break-all")]}),dV=function(e){var t=e.value,n=e.onChange;return(0,N.BX)(a2.hE,{name:"SplitOrUnifiedDiff",value:t,onChange:n,row:!0,children:[(0,N.tZ)($.G,{css:dH.buttonGroupItem,children:(0,N.tZ)(a2.rK,{value:"Unified",text:"Unified",id:"SplitOrUnifiedDiffUnified"})}),(0,N.tZ)($.G,{css:dH.buttonGroupItem,children:(0,N.tZ)(a2.rK,{value:"Split",text:"Split",id:"SplitOrUnifiedDiffSplit"})})]})},dz=function(e){var t=e.files,n=e.totalFiles;return t===n?(0,N.BX)(J.xv,{css:dH.textContainer,children:["Showing"," ",(0,N.BX)("span",{css:dH.emphasizedText,children:[n," changed ",(0,eC.Z)("file",n),"."]})]}):(0,N.BX)(J.xv,{css:dH.textContainer,children:["Showing"," ",(0,N.BX)("span",{css:dH.emphasizedText,children:[t," of ",n," changed ",(0,eC.Z)("file",n),"."]})]})},dj=function(e){var t=e.query,n=e.setQuery,r=e.totalDiffs,i=e.diffs,o=e.splitOrUnified,a=e.setSplitOrUnified,l=e.folded,c=e.setFolded,s=(0,O.useMemo)(function(){return i.filter(function(e){var n="".concat(e.final.path,"/").concat(e.final.filename),r="".concat(e.initial.path,"/").concat(e.initial.filename);return n.toLowerCase().includes(t.toLowerCase())||r.toLowerCase().includes(t.toLowerCase())})},[t,i]);return(0,N.BX)($.G,{css:dH.container,children:[(0,N.tZ)(tu.E,{value:t,onChange:function(e){n(e.target.value)},onClear:function(){n("")},loading:!1,placeholder:"Filter changed files"}),(0,N.BX)($.G,{css:dH.splitOrUnisonContainer,children:[(0,N.tZ)(dz,{files:s.length,totalFiles:r}),i.length>0?(0,N.tZ)(dV,{value:o,onChange:function(e){return a(e)}}):null]}),s.map(function(e){var t;return(0,N.tZ)(a7,{folded:null===(t=l[e.id])||void 0===t||t,setFolded:function(t){return c(e.id,t)},diff:e,splitOrUnified:o},e.id)})]})},dq=function(e){var t,n=lU(),r=(0,le.Z)((t=(0,eO._)(function(t){var n,r,i,o,a,l;return(0,eX.Jh)(this,function(c){switch(c.label){case 0:return i=e.hash,[4,t.getFilesForCommit(i)];case 1:if(null==(o=c.sent())?void 0:o.error)return ln({context:"use-commit-diffs",gitService:t,result:o,data:{commit:e}}),[2,{error:o.error,diffs:[]}];return a=(null==o?void 0:null===(n=o.files)||void 0===n?void 0:n.filter(function(e){return["ADDED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}))||[],l=(null==o?void 0:null===(r=o.files)||void 0===r?void 0:r.filter(function(e){return["DELETED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}))||[],[2,{error:null,diffs:Array.from(new Set((0,ex._)(a).concat((0,ex._)(l)))).map(function(e){var t,n;return{id:(0,ag.v4)(),status:e.type,loading:!1,initial:{filename:(0,ec.UO)(null!==(t=e.originalPath)&&void 0!==t?t:e.path),path:(0,ec.Il)(null!==(n=e.originalPath)&&void 0!==n?n:e.path),content:""},final:{filename:(0,ec.UO)(e.path),path:(0,ec.Il)(e.path),content:""}}})}]}})}),function(e){return t.apply(this,arguments)}),[e]);return(0,O.useMemo)(function(){return r?r.error?(n(r.error),null):r:null},[n,r])},dY=(u=(0,eO._)(function(e,t,n,r){var i,o,a;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:return i=""===t?n:"".concat(t,"/").concat(n),[4,e.getFileContents({path:i,revision:r})];case 1:if((o=l.sent()).error)throw o.error;return[2,null!==(a=null==o?void 0:o.content)&&void 0!==a?a:""]}})}),function(e,t,n,r){return u.apply(this,arguments)}),d$=(d=(0,eO._)(function(e,t,n){var r,i,o,a;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:return i=t.hash,[4,dY(e,n.final.path,n.final.filename,i)];case 1:if(o=l.sent(),a="",!(!t.grafted&&(null===(r=t.parents)||void 0===r?void 0:r.length)))return[3,3];return[4,dY(e,n.initial.path,n.initial.filename,"".concat(i,"^"))];case 2:a=l.sent(),l.label=3;case 3:return[2,(0,eL._)((0,eU._)({},n),{loading:!1,initial:(0,eL._)((0,eU._)({},n.initial),{content:a}),final:(0,eL._)((0,eU._)({},n.final),{content:o})})]}})}),function(e,t,n){return d.apply(this,arguments)}),dJ=(0,K.X)({content:[Y.l0.colWithGap(16),Y.l0.p(16)],splitContainer:[Y.l0.display.flex,Y.l0.flex.row,Y.l0.flex.shrink(1),Y.l0.flex.wrap,Y.l0.justify.spaceBetween,Y.l0.maxWidth("100%"),Y.l0.border({color:Y.TV.outlineDimmest,direction:"bottom"}),Y.l0.pb(16)]}),dK=function(e){var t,n,r=e.git,i=e.commit,o=e.info,a=e.onViewCommitClick,l=void 0===a?function(){}:a,c=e.status,s=(0,O.useMemo)(function(){return sP(c?c.changes.map(function(e){return e.path}):[])},[c]),u=(0,O.useMemo)(function(){if(!c)return[];var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=c.changes[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.type.worktree!==aL.h.UNMODIFIED&&e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e},[c]),d=(0,nN.Z)().showConfirm,f=lU(),h=(0,L._)((0,O.useState)(!1),2),p=h[0],m=h[1],v=(0,L._)((0,O.useState)(""),2),g=v[0],y=v[1],b=(0,L._)((0,O.useState)("Split"),2),Z=b[0],w=b[1],x=(0,L._)((0,O.useState)({}),2),C=x[0],_=x[1],k=(0,L._)((0,O.useState)([]),2),S=k[0],E=k[1],T=sr(i,o),R=T.hideBody,I=T.merge,D=T.revert,G=i.hash,B=i.subject,P=i.body,A=i.committer,U=i.author,X=i.grafted,M=null!==(n=i.parents)&&void 0!==n?n:[],F=dq(i),W=(0,O.useCallback)((0,eO._)(function(){var e,t,n,o=arguments;return(0,eX.Jh)(this,function(a){switch(a.label){case 0:return e=!(o.length>0)||void 0===o[0]||o[0],[4,r.restoreFiles(e,i.hash)];case 1:if((t=a.sent()).error)return[3,3];return[4,r.status()];case 2:return(n=a.sent()).error?(f(n.error),ln({context:"commit-view",gitService:r,result:n,data:{files:e,commit:i.hash}})):d("Restored commit!"),r.forceRefresh(),[3,4];case 3:f(t.error),ln({context:"commit-view",gitService:r,result:t,data:{files:e,commit:i.hash}}),a.label=4;case 4:return[2]}})}),[i.hash,r,f,d]),H=sK(s),V=H.openRestoreConfirmationModal,z=H.restoreConfirmationModal,j=(0,O.useCallback)((0,eO._)(function(){var e,t,n,r=arguments;return(0,eX.Jh)(this,function(i){switch(i.label){case 0:if(!0!==(e=!(r.length>0)||void 0===r[0]||r[0]))return[3,6];if(m(!0),0!==u.length)return[3,2];return[4,W()];case 1:return i.sent(),m(!1),[2];case 2:return[4,V(u)];case 3:if(!i.sent())return[3,5];return[4,W()];case 4:i.sent(),i.label=5;case 5:return m(!1),[3,10];case 6:if("string"==typeof e){if(!(n=u.find(function(t){return t.path===e})))throw m(!1),Error("Could not find file in worktree list");t=[n]}else t=u.filter(function(t){return e.includes(t.path)});return[4,V(t)];case 7:if(!i.sent())return[3,9];return[4,W(e)];case 8:i.sent(),i.label=9;case 9:m(!1),i.label=10;case 10:return[2]}})}),[V,W,u]);(0,O.useEffect)(function(){var e;E(null!==(e=null==F?void 0:F.diffs.map(function(e){return(0,eL._)((0,eU._)({},e),{loading:!0})}))&&void 0!==e?e:[])},[F]),(0,O.useEffect)(function(){null!==F&&F.error&&f(F.error)},[F,f]);var q=(t=(0,eO._)(function(e,t){var n,o,a;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:if(_(function(n){var r=(0,eU._)({},n);return r[e]=t,r}),!(n=S.find(function(t){return t.id===e})))return f(lp.aq.INVALID_STATE),ln({context:"commit-view",gitService:r,result:{error:lp.aq.INVALID_STATE},data:{diffId:e}}),[2];if(!(!t&&n.loading))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,d$(r,i,n)];case 2:return o=l.sent(),E(function(t){var n=(0,ex._)(t),r=n.findIndex(function(t){return t.id===e});return n[r]=o,n}),[3,4];case 3:return ln({context:"commit-view",gitService:r,result:a=l.sent(),data:{diffId:e}}),f(a),[2];case 4:return[2]}})}),function(e,n){return t.apply(this,arguments)});return(0,N.BX)($.G,{css:dJ.content,children:[(0,N.tZ)(dU,{merge:I,revert:D,subject:B,onViewCommitClick:l}),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.start,Y.l0.flex.shrink(1)],children:[(0,N.tZ)(si,{hash:G}),(0,N.tZ)(so,{onClick:function(){return j()},text:"Restore All",loading:p})]}),R?null:(0,N.tZ)(l8,{body:P}),(0,N.BX)($.G,{css:dJ.splitContainer,children:[(0,N.tZ)(dO,{author:U,committer:A}),(0,N.tZ)(dF,{parents:M,grafted:X,onViewCommitClick:l})]}),null!==I?(0,N.tZ)(J.xv,{variant:"small",color:"dimmest",children:"There is more than one parent, diffing against the first parent."}):null,null===F?(0,N.tZ)(sR,{}):(0,N.tZ)(dj,{query:g,setQuery:y,totalDiffs:F.diffs.length,diffs:S,splitOrUnified:Z,setSplitOrUnified:w,folded:C,setFolded:q}),z]})};function dQ(e){var t=e.hash,n=e.onViewCommitClick,r=e.switchMode,i=e.status,o=(0,H.Z)().git,a=lU(),l=dP(null!=t?t:"");if(null===l)return(0,N.tZ)(sR,{});if(l.error)return l.error===lp.aq.NOT_INITIALIZED?r({mode:Z.CURRENT_BRANCH}):(a(l.error),(l.error===lp.aq.UNKNOWN||l.error===lp.aq.UNKNOWN_NOT_GIT)&&ln({context:"commit-view",gitService:o,result:l,data:{hash:t}})),null;if(null===l.commit)return a(lp.aq.UNKNOWN),null;var c=l.commit,s=cH(c)||cO(c);return(0,N.tZ)(dK,{git:o,commit:c,info:s,onViewCommitClick:n,status:i})}var d0=(0,K.X)({gitPane:[Y.l0.position.relative,Y.l0.display.flex,Y.l0.height("100%")],gitPaneContent:[Y.l0.flex.growAndShrink(1),Y.l0.overflow("auto")]});function d1(e){var t,n,r,i=e.isActive,o=e.performPaneOperation,a=(0,iA.P5)({controlName:"flag-git-commit-view",logFlagToAnalytics:!1}),l=(0,O.useRef)(),c=(0,L._)((0,O.useState)(Z.CURRENT_BRANCH),2),s=c[0],u=c[1],d=(0,L._)((0,O.useState)(null),2),f=d[0],h=d[1],p=(0,L._)((0,O.useState)(null),2),m=p[0],v=p[1],g=(0,L._)((0,O.useState)(!1),2),y=g[0],b=g[1];t=void 0!==i&&i,n=(0,H.Z)().git,(0,O.useEffect)(function(){t&&n.forceRefresh()},[t,n]);var w=(0,le.Z)((r=(0,eO._)(function(e){var t,n,r,i,o,a,l,c,s,u;return(0,eX.Jh)(this,function(d){switch(d.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=d.sent()).error)return[2,t];if(n=t.state,r=t.type,i=null,o=null,a=null,!(r!==lf.y5.INITIALIZING))return[3,6];return[4,e.status()];case 2:if((l=d.sent()).error)return ln({context:"git-pane-status",gitService:e,result:l,data:{state:n,type:r}}),[2,l];return i=l,[4,e.getRemotes()];case 3:if((c=d.sent()).error)return ln({context:"git-pane-remotes",gitService:e,result:c,data:{state:n,type:r}}),[2,c];if(o=c.remotes,!i.branch)return[3,5];return[4,e.getBranch(i.branch)];case 4:if((s=d.sent()).error)return ln({context:"git-pane-branch",gitService:e,result:s,data:{state:n,type:r}}),[2,s];a=s.branch,d.label=5;case 5:return[3,8];case 6:return[4,e.status()];case 7:if((u=d.sent()).error)return ln({context:"git-pane-status-initializing",gitService:e,result:u,data:{state:n,type:r}}),[2,{state:n,type:r,status:i,remotes:o,currentBranch:a,error:null}];i=u,d.label=8;case 8:return[2,{state:n,type:r,status:i,remotes:o,currentBranch:a,error:null}]}})}),function(e){return r.apply(this,arguments)})),x=!w||w.error?null:w.currentBranch,C=(0,O.useCallback)(function(e){switch(u(e),e){case Z.DASHBOARD:lk("pane-mode-changed",{mode:"dashboard"});break;case Z.BRANCH:lk("pane-mode-changed",{mode:"branch"});break;case Z.CURRENT_BRANCH:lk("pane-mode-changed",{mode:"current-branch"});break;case Z.SETTINGS:lk("pane-mode-changed",{mode:"settings"})}},[]),_=(0,O.useCallback)(function(){l.current?(C(l.current),l.current=void 0):C(Z.CURRENT_BRANCH)},[C]),k=(0,O.useCallback)(function(e){var t=function(e){l.current=s,C(e)};switch(e.mode){case Z.DASHBOARD:t(Z.DASHBOARD);break;case Z.BRANCH:if((0,lh.p3)(e.branch,x)){t(Z.CURRENT_BRANCH);break}v(e.branch),t(Z.BRANCH);break;case Z.CURRENT_BRANCH:t(Z.CURRENT_BRANCH);break;case Z.SETTINGS:t(Z.SETTINGS);break;case Z.COMMIT:h(e.hash),t(Z.COMMIT)}},[C,s,x]),S=(0,O.useCallback)(function(e){var t=(0,tX.Dp)({path:e});"codeEditor"===t?o({operation:"open",pane:{type:"diff",data:{left:{path:e,revision:"HEAD"},right:{path:e,revision:""}}}}):o({operation:"open",pane:{type:t,data:{path:e}}})},[o]),E=(0,O.useCallback)(function(e){k({mode:Z.COMMIT,hash:e})},[k]),T=(0,O.useCallback)(function(){b(!0)},[]);if(s===Z.BRANCH&&(0,lh.p3)(m,x)&&C(Z.CURRENT_BRANCH),(0,O.useEffect)(function(){return b(!1)},[w]),y||!w||w.error)return(0,N.tZ)(d2,{children:(null==w?void 0:w.error)?(0,N.tZ)(dB,{error:w.error}):(0,N.tZ)(sR,{})});switch(w.type){case lf.y5.INITIALIZING:case lf.y5.INTERMEDIATE:case lf.y5.DETACHED_HEAD:return(0,N.tZ)(d2,{children:(0,N.tZ)(d8,{state:w.state,status:w.status,onFileClick:S,gotoPendingState:T})});case lf.y5.NORMAL:if(s===Z.BRANCH&&!m||s===Z.CURRENT_BRANCH&&!x)return(0,N.tZ)(d2,{header:(0,N.tZ)(cI,{mode:Z.DASHBOARD,branch:null,switchMode:k,onBack:_}),children:(0,N.tZ)(uM,{currentBranch:null,switchMode:k})});return(0,N.tZ)(d2,{header:(0,N.tZ)(cI,{mode:s,branch:s===Z.CURRENT_BRANCH?x:m,switchMode:k,onBack:_}),children:(0,N.tZ)(d4,{mode:s,status:w.status,remotes:w.remotes,previewBranch:m,previewCommit:f,currentBranch:x,switchMode:k,onStagedFileClick:S,onViewCommitClick:a?E:void 0,gotoPendingState:T})})}}function d2(e){var t=e.header,n=e.children,r=(0,L._)((0,O.useState)(function(){return(0,eI.MT)()}),1)[0];return(0,N.tZ)(lB.Provider,{value:r,children:(0,N.BX)($.G,{css:d0.gitPaneContent,children:[(0,N.tZ)(lO,{}),t,(0,N.tZ)($.G,{css:d0.gitPaneContent,children:n})]})})}function d8(e){var t=e.state,n=e.status,r=e.onFileClick,i=e.gotoPendingState;switch(t){case lf.yG.NOT_INITIALIZED:return(0,N.tZ)(u1,{});case lf.yG.ON_UNBORN_BRANCH:return(0,N.tZ)(dD,{onFileClick:r,status:n});case lf.yG.MERGING:return(0,N.tZ)(uJ,{onFileClick:r,gotoPendingState:i});case lf.yG.REBASING:return(0,N.tZ)(u2,{});case lf.yG.REVERTING:return(0,N.tZ)(u8,{});case lf.yG.CHERRY_PICKING:return(0,N.tZ)(uG,{});case lf.yG.APPLYING_MAILBOX:return(0,N.tZ)(cP,{});case lf.yG.BISECTING:return(0,N.tZ)(cA,{});case lf.yG.DETACHED_HEAD:return(0,N.tZ)(uF,{});default:return null}}function d4(e){var t=e.mode,n=e.status,r=e.remotes,i=e.previewBranch,o=e.previewCommit,a=e.currentBranch,l=e.switchMode,c=e.onStagedFileClick,s=e.onViewCommitClick,u=e.gotoPendingState;switch(t){case Z.DASHBOARD:return(0,N.tZ)(uM,{currentBranch:a,switchMode:l});case Z.BRANCH:return(0,N.tZ)(uI,{status:n,branch:i,remotes:r,onStagedFileClick:c,onViewCommitClick:s,gotoPendingState:u});case Z.CURRENT_BRANCH:return(0,N.tZ)(uI,{status:n,remotes:r,branch:a,onStagedFileClick:c,onViewCommitClick:s,gotoPendingState:u,current:!0});case Z.SETTINGS:return(0,N.tZ)(dT,{});case Z.COMMIT:return(0,N.tZ)(dQ,{status:n,onViewCommitClick:s,hash:o,switchMode:l});default:(0,o6.Z)(t)}}var d3=es.Type.Object({type:es.Type.Literal("git")}),d5={Content:function(e){var t=e.options,n=t.isActive,r=t.performPaneOperation;return(0,N.tZ)(d1,{isActive:n,performPaneOperation:r})},Icon:function(e){var t=e.size;return(0,N.tZ)(ld.Z,{size:t})},getTitle:function(){return"Git"},decode:function(e){return eu.B4.Decode(d3,e)}},d6=n(31171),d9=n(28908);function d7(e){var t=e.reversed,n=void 0!==t&&t,r=e.hideName,i=void 0!==r&&r,o=e.color,a=void 0===o?"default":o,l=(0,d6.bA)(),c=(0,O.useMemo)(function(){return[n?Y.l0.rowReverseWithGap(4):Y.l0.rowWithGap(4),Y.l0.align.center]},[n]);if(!l)return null;if(0===l.count)return(0,N.BX)($.G,{css:c,children:[(0,N.tZ)(d9.Z,{size:24}),(0,N.tZ)(J.xv,{color:a,multiline:!1,children:"Server Authored"})]});var s=l.changes[l.version];if(!l.users)return(0,N.BX)($.G,{css:c,children:[(0,N.tZ)(l7.q,{size:24,src:"/public/images/ghost.svg",username:"Unknown"}),i?null:(0,N.tZ)(J.xv,{color:a,multiline:!1,children:"Unknown"})]});var u=l.users[s.userId];return u?(0,N.BX)($.G,{css:c,children:[(0,N.tZ)(l7.q,{size:24,src:u.image,username:u.username}),i?null:(0,N.tZ)(J.xv,{color:a,multiline:!1,children:u.username})]}):s.timestamp>16546464e5?(0,N.BX)($.G,{css:c,children:[(0,N.tZ)(d9.Z,{size:24}),i?null:(0,N.tZ)(J.xv,{color:a,multiline:!1,children:"Server Authored"})]}):(0,N.BX)($.G,{css:c,children:[(0,N.tZ)(l7.q,{size:24,src:"/public/images/ghost.svg",username:"Unknown"}),i?null:(0,N.tZ)(J.xv,{color:a,multiline:!1,children:"Unknown"})]})}function fe(){var e=(0,ns._)(["\n  query WorkspaceHistory2Users($ids: [Int!]!) {\n    currentUser {\n      id\n      username\n      image\n    }\n    usersByIds(ids: $ids) {\n      id\n      username\n      image\n    }\n  }\n"]);return fe=function(){return e},e}function ft(){var e=(0,ns._)(["\n  query WorkspaceHistory2CurrentUserDate {\n    currentUser {\n      id\n      timeCreated\n    }\n  }\n"]);return ft=function(){return e},e}var fn=(0,nu.Ps)(fe());ft();var fr=n(94376),fi=n(23026),fo=n(3194),fa=n(92635),fl=n(2543),fc=function(e){"use strict";(0,fo._)(n,e);var t=(0,fl._)(n);function n(e){var r;return(0,fi._)(this,n),(r=t.call(this,e)).name="UserError",r}return n}((0,fa._)(Error));function fs(e,t,n){return new Promise(function(r,i){try{var o,a=e.watchTextFile(t,{onReady:(o=(0,eO._)(function(e){var t,o;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,n(e)];case 1:return t=l.sent(),r(t),[3,3];case 2:return o=l.sent(),i(o),[3,3];case 3:return a(),[2]}})}),function(e){return o.apply(this,arguments)})})}catch(e){i(e)}})}var fu=fr.I;function fd(){return(fd=(0,eO._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b;return(0,eX.Jh)(this,function(Z){switch(Z.label){case 0:n=new Set,r=!0,i=!1,o=void 0;try{for(a=t[Symbol.iterator]();!(r=(l=a.next()).done);r=!0)(c=l.value).userId&&n.add(c.userId)}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}if(0===n.size)return[2,{}];if(n.size>=fu)return[2,"too_many_users"];return[4,e.query({query:fn,variables:{ids:Array.from(n)}})];case 1:if(u=(s=Z.sent()).data,d=s.error)throw d;f=u.currentUser?[u.currentUser].concat((0,ex._)(u.usersByIds)):u.usersByIds,h={},p=!0,m=!1,v=void 0;try{for(g=f[Symbol.iterator]();!(p=(y=g.next()).done);p=!0)h[(b=y.value).id]={id:b.id,username:b.username,image:b.image}}catch(e){m=!0,v=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw v}}return[2,h]}})})).apply(this,arguments)}function ff(){return(ff=(0,eO._)(function(e,t,n){var r,i,o;return(0,eX.Jh)(this,function(a){switch(a.label){case 0:var l;return[4,fs(e,n,(l=(0,eO._)(function(e){var t,n;return(0,eX.Jh)(this,function(r){return(t=e.fetchChanges,0===(n=e.version))?[2,{isDisposed:!1,result:[]}]:[2,t(1,n,"")]})}),function(e){return l.apply(this,arguments)}))];case 1:if((r=a.sent()).isDisposed)return[2,{data:null,handledError:"File deleted or removed."}];return[4,function(e,t){return fd.apply(this,arguments)}(t,i=r.result)];case 2:if("too_many_users"===(o=a.sent()))return[2,{data:{changes:i,users:null},handledError:null}];return[2,{data:{changes:i,users:o},handledError:null}]}})})).apply(this,arguments)}(C||(C={})).TooManyUsersRequestedError="too_many_users";var fh=n(99418),fp=(0,nr.iv)({display:"grid",gridTemplateColumns:"auto 1fr",rowGap:"0.5rem",columnGap:"1rem","> dt":{display:"flex",alignItems:"center",fontWeight:"bold"}});function fm(e){var t=e.onCloseHistory,n=(0,nN.Z)().showError,r=(0,L._)((0,O.useState)(!1),2),i=r[0],o=r[1],a=(0,L._)((0,O.useState)(!1),2),l=a[0],c=a[1],s=(0,H.Z)().fs,u=(0,d6.bA)(),d=(0,fh.j)(),f="Reset",h=!0;function p(){return(p=(0,eO._)(function(){var e,r;return(0,eX.Jh)(this,function(i){switch(i.label){case 0:if(!u||!s||l)return[2];i.label=1;case 1:var a,f;return i.trys.push([1,3,4,5]),c(!0),(0,fh.p)("versionRestored"),e=u.filePath,[4,(a=u.version+1,fs(s,e,(f=(0,eO._)(function(e){var t,n,r,i,o,l,c,u;return(0,eX.Jh)(this,function(d){switch(d.label){case 0:if(t=e.fetchChanges,n=e.writeChange,a>(r=e.version))throw Error("Cannot reset to a version that does not exist");if(a===r)return[2];i=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,t(1,r,"")];case 2:if((o=d.sent()).isDisposed)throw new fc("File deleted or removed.");return i=o.result,[3,4];case 3:throw d.sent(),new fc("Something went wrong while resetting the file. It is possible that a bad connection is to blame. Please try again.");case 4:c=(l=(0,tM._)(i.slice(a,i.length).reverse()))[0],u=l.slice(1).reduce(function(e,t){return e.compose(t.invertedChanges)},c.invertedChanges);try{n(u)}catch(e){throw lt.Tb(e),new fc("Something went wrong while resetting the file. Maybe the file changed while you were restoring it? Please try again.")}return[4,s.flush()];case 5:return d.sent(),[2]}})}),function(e){return f.apply(this,arguments)})))];case 2:return i.sent(),t(),[3,5];case 3:if((r=i.sent())instanceof fc)return n(r.message),[2];return d(r,"restore"),[3,5];case 4:return o(!1),c(!1),[7];case 5:return[2]}})})).apply(this,arguments)}return u?0===u.count?(f="No history",h=!0):l||i?(f="Resetting...",h=!0):u.playing?(f="Playing...",h=!0):u.version===u.count-1?(f="Viewing latest",h=!0):(f="Reset editor to here",h=!1):(f="Loading...",h=!0),(0,N.BX)(N.HY,{children:[(0,N.tZ)(eW.zx,{text:f,disabled:h,onClick:function(){return o(!0)},colorway:"primary",iconLeft:(0,N.tZ)(ri.Z,{})}),u&&0!==u.count&&(0,N.tZ)(iX.u,{isOpen:i,onRequestClose:function(){l||o(!1)},children:(0,N.BX)($.G,{css:Y.l0.colWithGap(24),children:[(0,N.tZ)(J.h4,{variant:"headerDefault",level:2,children:"Reset file version"}),(0,N.tZ)(eq.Tg,{elevated:!0,css:[Y.l0.px(16),Y.l0.py(12),Y.l0.borderRadius(8)],children:(0,N.BX)("dl",{css:fp,children:[(0,N.tZ)("dt",{children:"File"}),(0,N.tZ)("dd",{children:u.filePath}),(0,N.tZ)("dt",{children:"Version"}),(0,N.BX)("dd",{children:[u.version+1,(0,N.BX)("span",{css:[Y.l0.color.foregroundDimmest],children:[(0,N.tZ)("span",{css:Y.l0.mx(8),children:"/"}),u.count]})]}),(0,N.tZ)("dt",{children:"Date"}),(0,N.tZ)("dd",{children:(0,N.tZ)(cd.EK,{date:u.changes[u.version].timestamp,dateFormat:"absolute"})}),(0,N.tZ)("dt",{children:"Author"}),(0,N.tZ)("dd",{children:(0,N.tZ)(d7,{})})]})}),(0,N.tZ)(ej.E,{icon:(0,N.tZ)(r5.Z,{}),colorway:"positive",text:"Resetting is non-destructive. The reset content will become a new version at the end of history. You can always go back to the version you just had."}),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.justify.end],children:[(0,N.tZ)(eW.zx,{text:"Cancel",disabled:l,onClick:function(){return o(!1)}}),(0,N.tZ)(eW.zx,{text:l?"Resetting Version...":"Reset Version",disabled:l,colorway:"primary",onClick:function(){return p.apply(this,arguments)},iconLeft:(0,N.tZ)(ri.Z,{})})]})]})})]})}var fv=n(44166),fg=(0,O.forwardRef)(function(e,t){var n=(0,d6.bA)(),r=(0,O.useRef)(null);(0,O.useImperativeHandle)(t,function(){return r.current}),n&&r.current&&(r.current.setAttribute("aria-valuemin","1"),r.current.setAttribute("aria-valuemax",String(n.count)),r.current.setAttribute("aria-valuenow",String(n.version+1)));var i=(0,O.useMemo)(function(){return(0,N.tZ)("div",{ref:r,role:"slider",tabIndex:0,css:{position:"absolute",top:"0",left:"calc((100% - 16px) * var(--scrubber-progress, 0))",width:"16px",height:"16px",backgroundColor:Y.TV.accentPrimaryDefault,borderRadius:"100%",outline:"none",cursor:"pointer",transition:"left var(--scrubber-transition-time, 100ms) ease-out",willChange:"left, transition",":focus":{boxShadow:"0 0 0 1px ".concat(Y.TV.foregroundDefault," inset")}}})},[]);return n&&n.count>1?i:null}),fy=(0,O.forwardRef)(function(e,t){var n=(0,d6.bA)(),r=(0,O.useMemo)(function(){return(0,N.BX)(N.HY,{children:[(0,N.tZ)("div",{ref:t,"aria-hidden":!0,css:{position:"relative",top:"0",width:"100%",height:"16px",margin:"0",cursor:"pointer"}}),(0,N.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"6px",left:"0",width:"100%",height:"4px",margin:"0",overflow:"hidden",pointerEvents:"none",backgroundColor:Y.TV.backgroundHighest,borderRadius:"2px"},children:(0,N.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"0",left:"0",width:"100%",height:"4px",margin:"0",pointerEvents:"none",backgroundColor:Y.TV.accentPrimaryDefault,transformOrigin:"left",transform:"scaleX(var(--scrubber-progress, 0))",transition:"transform var(--scrubber-transition-time, 100ms) ease-out",willChange:"transform, transition"}})})]})},[t]),i=(0,O.useMemo)(function(){return(0,N.tZ)("div",{ref:t,"aria-hidden":!0,css:{width:"100%",height:"16px",pointerEvents:"none"},children:(0,N.tZ)("div",{css:{position:"absolute",width:"100%",height:"4px",top:"6px",left:"0",backgroundColor:Y.TV.backgroundHighest,borderRadius:"2px"}})})},[t]);return n&&n.count>1?r:i}),fb=["ArrowLeft","ArrowRight","Home","End"];function fZ(){var e=(0,d6.bA)(),t=(0,d6._Z)(),n=(0,L._)((0,O.useState)(!1),2),r=n[0],i=n[1],o=(0,O.useRef)(null),a=(0,O.useRef)(null),l=(0,O.useRef)(null),c=function(e){(0,fv.A)(o,"--scrubber-transition-time",e)},s=function(e){(0,fv.A)(o,"--scrubber-progress",e.toString())};return e&&!r&&(s(e.version/(e.count-1)),e.playing?c("50ms"):c("100ms")),(0,O.useEffect)(function(){if(e&&a.current&&l.current&&!r){var n=a.current,o=l.current,u=function(r){if(0===r.button){i(!0),o.focus();var a=n.getBoundingClientRect(),l=o.getBoundingClientRect(),u=a.width,d=l.width,f=r.target===n?d/2:r.clientX-l.left,h=null,p=function(n){var r=Math.max(0,Math.min(1,(n-a.left-f)/(u-d)));r!==h&&(h=r,s(r),t({version:Math.round(r*(e.count-1)),playing:!1}))};p(r.clientX);var m=function(e){c("0ms"),p(e.clientX),e.preventDefault(),e.stopPropagation()},v=function(){window.removeEventListener("pointermove",m),window.removeEventListener("pointerup",v),window.removeEventListener("pointercancel",v),c("100ms"),i(!1)};window.addEventListener("pointermove",m),window.addEventListener("pointerup",v),window.addEventListener("pointercancel",v),r.preventDefault(),r.stopPropagation()}};return n.addEventListener("pointerdown",u),o.addEventListener("pointerdown",u),function(){n.removeEventListener("pointerdown",u),o.removeEventListener("pointerdown",u)}}},[e,t,r]),(0,O.useEffect)(function(){if(e&&l.current&&!r){var n=l.current,i=function(n){if(e&&fb.includes(n.key)){var r=n.shiftKey?10:1,i=e.version,o=e.count-1,a=null;switch(n.key){case"ArrowLeft":a=Math.max(0,i-r);break;case"ArrowRight":a=Math.min(o,i+r);break;case"Home":a=0;break;case"End":a=o}null!==a&&(t({version:a,playing:!1}),n.preventDefault(),n.stopPropagation())}};return n.addEventListener("keydown",i),function(){n.removeEventListener("keydown",i)}}},[e,t,r]),(0,O.useMemo)(function(){return(0,N.BX)($.G,{innerRef:o,css:{position:"relative",height:"16px",width:"100%",touchAction:"none","--scrubber-progress":1,"--scrubber-transition-time":"100ms",":hover, :focus-within":{filter:"brightness(1.1)"},":hover:focus-within":{filter:"brightness(1.2)"}},children:[(0,N.tZ)(fy,{ref:a}),(0,N.tZ)(fg,{ref:l})]})},[])}var fw=n(44171);function fx(e){var t=e.onClose;return(0,N.tZ)(eW.zx,{text:"Cancel",onClick:function(){(0,fh.p)("historyExplicitlyClosed"),t()}})}var fC=n(10099),f_=(0,nr.iv)({filter:"grayscale(100%) opacity(0.5)",pointerEvents:"none"});function fk(){var e,t="/replEnvironmentMobile"===(0,o4.useRouter)().pathname,n=(0,d6.bA)(),r=(0,d6._Z)(),i=(0,rV.U)(),o=!n||0===n.count;return(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center,o?f_:null],children:[(0,N.tZ)(fC.Z,{id:i("diffButton"),isOn:null!==(e=null==n?void 0:n.comparing)&&void 0!==e&&e,onChange:function(e){o||r({comparing:e.target.checked})}}),(0,N.tZ)("label",{css:[{cursor:"pointer",userSelect:"none"},Y.l0.flex.column,Y.l0.align.center],htmlFor:i("diffButton"),children:(0,N.tZ)(J.xv,{multiline:!1,children:t?"Compare":"Compare Latest"})})]})}function fS(){var e=(0,d6.bA)(),t=0,n=0;return e&&0!==e.count&&(t=e.version+1,n=e.count),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(4),Y.l0.justify.spaceBetween],children:[(0,N.tZ)(J.xv,{css:{minWidth:"2ch",textAlign:"right"},color:e?"default":"dimmer",multiline:!1,children:t}),(0,N.tZ)(J.xv,{css:{width:"1ch",textAlign:"center"},color:"dimmer",multiline:!1,children:"/"}),(0,N.tZ)(J.xv,{css:{minWidth:"2ch",textAlign:"left"},color:"dimmer",multiline:!1,children:n})]})}var fE=n(27187),fT=n(56335);function fR(e){if(e<0)throw Error('Require at least zero ops to compute pace, got "'+e+'"');return 1/Math.log(e+2)*100}function fI(){var e,t,n,r,i=(0,d6.bA)(),o=(0,d6._Z)(),a=(null!==(t=null==i?void 0:null===(e=i.changes)||void 0===e?void 0:e.length)&&void 0!==t?t:1)-1,l=null!==(n=null==i?void 0:i.version)&&void 0!==n?n:0,c=null!==(r=null==i?void 0:i.playing)&&void 0!==r&&r,s=!i||0===i.count,u=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fR,i=(0,L._)((0,O.useState)(!1),2),o=i[0],a=i[1],l=(0,O.useCallback)(function(){t(1)},[t]),c=(0,O.useCallback)(function(){if(e+1>n){a(!1);return}t(e+1)},[t,e,n]);return(0,O.useEffect)(function(){if(o){var e=setTimeout(function(){c()},r(n));return function(){return clearTimeout(e)}}},[o,c,r,n]),{isPlaying:o,start:function(){a(!0)},stop:function(){a(!1)},reset:l}}(l,function(e){return o({version:e})},a),d=u.isPlaying,f=u.start,h=u.stop;(0,O.useEffect)(function(){d&&!c?h():!d&&c&&f()},[c,d,f,h]);var p="Loading...";return i&&(d?p="Pause":i.version===i.count-1?p="Play file history from beginning":0===i.version?p="Play file history":i.version>0&&(p="Play file history from here")),(0,N.tZ)(e_.hU,{alt:p,size:24,disabled:s,onClick:function(){l===a?o({version:0,playing:!0}):o({playing:!c})},children:d?(0,N.tZ)(fT.Z,{}):(0,N.tZ)(fE.Z,{})})}function fD(){return(0,N.BX)($.G,{css:[Y.l0.rowWithGap(4),Y.l0.align.center],children:[(0,N.tZ)(fI,{}),(0,N.tZ)(fG,{}),(0,N.tZ)(fS,{}),(0,N.tZ)(fB,{})]})}function fG(){var e=(0,d6.bA)(),t=(0,d6._Z)(),n=!e||0===e.version||0===e.count;return(0,N.tZ)(e_.hU,{alt:"Move backwards one version",size:24,disabled:n,onClick:function(){e&&e.version>0&&t({version:e.version-1})},children:(0,N.tZ)(lX.Z,{})})}function fB(){var e=(0,d6.bA)(),t=(0,d6._Z)(),n=!e||e.version===e.count-1||0===e.count;return(0,N.tZ)(e_.hU,{alt:"Move forwards one version",size:24,disabled:n,onClick:function(){e&&e.version<e.count-1&&t({version:e.version+1})},children:(0,N.tZ)(ek.Z,{})})}function fP(){var e=(0,d6.bA)();if(!e||0===e.count)return null;var t=e.changes[e.version].timestamp;return(0,N.tZ)(cd.EK,{textColor:"dimmer",dateFormat:"switch",date:t})}function fA(e){var t,n,r,i,o,a=e.filePath,l=e.onCloseHistory,c="/replEnvironmentMobile"===(0,o4.useRouter)().pathname,s=c?Y.l0.borderRadius(0):Y.l0.borderRadius(0,0,8,8),u=(0,d6.bA)(),d=(0,d6._Z)(),f=(0,d6.Ai)(),h=(0,fh.j)(),p=(n=(t=(0,L._)((0,O.useState)({data:null,loading:!0,error:null,handledError:null}),2))[0],r=t[1],i=(0,H.Z)().fs,o=(0,fw.x)(),(0,O.useEffect)(function(){if(!a){r({data:null,loading:!1,error:null,handledError:null});return}r({data:null,loading:!0,error:null,handledError:null});var e=!1;return(function(e,t,n){return ff.apply(this,arguments)})(i,o,a).then(function(t){var n=t.data,i=t.handledError;if(!e){if(i){r({data:null,loading:!1,error:null,handledError:i});return}r({data:n,loading:!1,error:null,handledError:null})}}).catch(function(t){e||(t instanceof Error||(t=Error(t)),r({data:null,loading:!1,error:t,handledError:null}))}),function(){e=!0}},[a,i,o]),n),m=p.data,v=p.loading,g=p.error;return(0,O.useEffect)(function(){if(g){h(g,"history2-index",{filePath:a});return}if(m&&!v)return d({filePath:a,changes:m.changes,users:m.users}),(0,fh.p)("historyLoaded"),function(){f()}},[a,m,v,g,h,d,f]),(0,N.BX)($.G,{css:[Y.l0.colWithGap(8),Y.l0.p(8),Y.l0.zIndex(3),Y.l0.overflow("hidden"),s,Y.l0.backgroundColor.backgroundDefault,{borderTop:"2px solid ".concat(Y.TV.backgroundHigher),boxShadow:"rgba(2, 2, 3, 0.125) 0px -16px 32px 0px"}],children:[(0,N.BX)(eq.Tg,{css:[Y.l0.position.relative,Y.l0.colWithGap(4),Y.l0.px(12),Y.l0.pt(8),Y.l0.pb(8),Y.l0.align.center,Y.l0.borderRadius(8),Y.l0.overflow("hidden")],elevated:!0,children:[(0,N.tZ)(fZ,{}),(0,N.BX)($.G,{css:[Y.l0.display.flex,Y.l0.flex.row,Y.l0.align.center,Y.l0.justify.spaceBetween,Y.l0.width("100%")],children:[(0,N.tZ)(fD,{}),u&&u.count>0?(0,N.BX)($.G,{css:[Y.l0.rowWithGap(4),Y.l0.align.center],children:[(0,N.tZ)(fP,{}),v||c?null:(0,N.tZ)(J.xv,{color:"dimmer",multiline:!1,children:""}),(0,N.tZ)(d7,{color:"dimmer",hideName:c,reversed:!0})]}):null]})]}),(0,N.BX)($.G,{css:[Y.l0.display.flex,Y.l0.flex.row],children:[(0,N.tZ)(fN,{justify:"flex-start",children:(0,N.tZ)(fk,{})}),(0,N.BX)(fN,{justify:"flex-end",children:[(0,N.tZ)(fx,{onClose:l}),(0,N.tZ)(fm,{onCloseHistory:l})]})]})]})}function fN(e){var t=e.children,n=e.justify;return(0,N.tZ)("div",{css:{display:"flex",flexGrow:1,flexBasis:0,alignItems:"center",justifyContent:n,columnGap:Y.TV.space8,minWidth:0},children:t})}var fU=n(74633),fL=n(80923),fO=n(62609),fX=n(54340),fM=(0,fO.B)();function fF(e){if(!(e instanceof nX.YW))return{compareTo:e.field(fM.state,!1),changed:!1};var t=e.state.field(fM.state,!1),n=e.startState.field(fM.state,!1)!==t;return{compareTo:t,changed:n}}function fW(e,t){e.state.field(fM.state,!1)!==t&&e.dispatch({effects:fM.effect.of(t)})}var fH=nX.QQ.define({create:function(){return null},update:function(e,t){var n=fF(t),r=n.compareTo,i=n.changed;if(!r)return null;if(!t.docChanged&&!i)return e;var o=t.state.doc.toString();return new fX.PO(o,r)}}),fV=null!==(_=globalThis.requestIdleCallback)&&void 0!==_?_:globalThis.requestAnimationFrame,fz=null!==(k=globalThis.cancelIdleCallback)&&void 0!==k?k:globalThis.cancelAnimationFrame,fj=nL.p.line({class:"cm-diff-deleted"}),fq=function(e){"use strict";(0,fo._)(n,e);var t=(0,fl._)(n);function n(e,r){var i;return(0,fi._)(this,n),(i=t.call(this)).insertion=e,i.highlight=r,i}var r=n.prototype;return r.destroy=function(){this.pendingHighlight&&fz(this.pendingHighlight)},r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-inserted cm-line",this.updateDOM(e),e},r.eq=function(e){return!e.pendingHighlight&&this.insertion===e.insertion},r.updateDOM=function(e){var t=this;return this.pendingHighlight&&(fz(this.pendingHighlight),this.pendingHighlight=null),this.insertion.length?e.textContent=this.insertion:e.innerHTML="&nbsp;",this.highlight&&this.insertion.length&&(this.pendingHighlight=fV(function(){if(t.highlight){t.pendingHighlight=null;try{var n=t.highlight();e.innerHTML="",e.append(n)}catch(e){}}})),!0},n}(nL.l9),fY=nX.QQ.define({create:function(){return nL.p.none},update:function(e,t){var n=t.state.field(fH,!1);if(!n)return nL.p.none;var r=fF(t).changed;if(!t.docChanged&&!r)return e.map(t.changes);var i=[],o=function(e,t){i.push({from:e,to:e,value:t})},a=n.startInsertions();if(a){var l=!0,c=!1,s=void 0;try{for(var u,d=a[Symbol.iterator]();!(l=(u=d.next()).done);l=!0)!function(){var e=u.value,n=new fq(e.content,function(){return f$(t.state,e.content)});o(0,nL.p.widget({widget:n,side:-1,block:!0}))}()}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}var f=!0,h=!1,p=void 0;try{for(var m,v=n.lines()[Symbol.iterator]();!(f=(m=v.next()).done);f=!0)!function(){var e=m.value;if(e.isDeleted&&o(e.from,fj),e.insertions){var n=!0,r=!1,i=void 0;try{for(var a,l=e.insertions[Symbol.iterator]();!(n=(a=l.next()).done);n=!0)!function(){var n=a.value,r=new fq(n.content,function(){return f$(t.state,n.content)});o(e.to,nL.p.widget({widget:r,side:1,block:!0}))}()}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}}}()}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}return nL.p.set(i,!0)},provide:function(e){return nL.tk.decorations.from(e)}});function f$(e,t){var n,r=document.createDocumentFragment(),i=null===(n=e.facet(fU.dK))||void 0===n?void 0:n.parser;if(!i){var o=document.createElement("span");return o.textContent=t,r.append(o),r}var a=i.parse(t),l=0;if((0,fL.bW)(a,{style:function(t){return(0,fU.QN)(e,t)}},function(e,n,i){if(e>l){var o=document.createElement("span");o.textContent=t.slice(l,e),r.append(o)}var a=document.createElement("span");a.className=i,a.textContent=t.slice(e,n),r.append(a),l=n}),l<t.length){var c=document.createElement("span");c.textContent=t.slice(l),r.append(c)}return r}var fJ=function(e){"use strict";(0,fo._)(n,e);var t=(0,fl._)(n);function n(e){var r;return(0,fi._)(this,n),(r=t.call(this)).line=e,r}var r=n.prototype;return r.eq=function(e){return this.line===e.line},r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-gutter-element-fallback",e.innerText=this.line.toString(),e},n}(nL.SJ),fK=function(e){"use strict";(0,fo._)(n,e);var t=(0,fl._)(n);function n(e,r){var i;return(0,fi._)(this,n),(i=t.call(this)).elementClass="cm-diff-gutter-block",i.lines=e,r&&(i.preceding=r),i}var r=n.prototype;return r.eq=function(e){var t,n,r,i;if((null===(t=this.lines)||void 0===t?void 0:t.length)!==(null==e?void 0:null===(n=e.lines)||void 0===n?void 0:n.length)||(null===(r=this.preceding)||void 0===r?void 0:r.length)!==(null==e?void 0:null===(i=e.preceding)||void 0===i?void 0:i.length))return!1;if(this.preceding&&e.preceding)for(var o=0;o<this.preceding.length;o++){var a=this.preceding[o],l=e.preceding[o];if(a.height!==l.height||a.left!==l.left||a.right!==l.right)return!1}if(this.lines&&e.lines)for(var c=0;c<this.lines.length;c++){var s=this.lines[c],u=e.lines[c];if(s.height!==u.height||s.left!==u.left||s.right!==u.right)return!1}return!0},r.toDOM=function(){var e=this,t=document.createElement("div");if(this.preceding){var n=this.preceding.slice().reverse(),r=0,i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;r+=s.height;var u=this.piece(s);u.style.position="absolute",u.style.top="-".concat(r,"px"),t.prepend(u)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}var d=this.lines.map(function(t){return e.piece(t)});return t.append.apply(t,(0,ex._)(d)),t},r.piece=function(e){var t=e.height,n=e.left,r=e.right,i=document.createElement("span");i.className="cm-diff-gutter-part",null!==n&&(i.innerText=n.toString());var o=document.createElement("span");o.className="cm-diff-gutter-part",null!==r&&(o.innerText=r.toString());var a=document.createElement("div");return a.className="cm-diff-gutter-element",a.style.height="".concat(t,"px"),a.append(i,o),(null===n||null===r)&&(null===r&&a.classList.add("cm-diff-gutter-deleted"),null===n&&a.classList.add("cm-diff-gutter-inserted")),a},n}(nL.SJ),fQ=(0,nL.v5)({class:"cm-lineNumbers cm-diff-gutter",markers:function(e){var t=e.viewportLineBlocks,n=[],r=fF(e.state).compareTo,i=e.state.field(fH,!1),o=function(e,t){n.push({from:e,to:e,value:t})};if(!r||!i){var a=!0,l=!1,c=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value,f=e.state.doc.lineAt(d.from).number;if(d.type===nL.kH.Text)o(d.from,new fJ(f));else if(Array.isArray(d.type)){var h=!0,p=!1,m=void 0;try{for(var v,g=d.type[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value;if(y.type===nL.kH.Text){o(y.from,new fJ(f));break}}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}return nX.Xs.of(n,!0)}var b=!0,Z=!1,w=void 0;try{for(var x,C=t[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var _=x.value,k=[],S=e.state.doc.lineAt(_.from).number,E=i.line(S);if(E){var T=e.defaultLineHeight,R=E.offset,I=E.isDeleted,D=E.insertions,G=1===S?i.startInsertions():null,B=G?G.length:0,P=G?[]:null;if(!(Array.isArray(_.type)&&_.type.length>=B+(null!==(L=null==D?void 0:D.length)&&void 0!==L?L:0)+1)){if(G&&P){var A=!0,N=!1,U=void 0;try{for(var L,O,X=G[Symbol.iterator]();!(A=(O=X.next()).done);A=!0){var M=O.value;P.push({height:T,left:null,right:M.number})}}catch(e){N=!0,U=e}finally{try{A||null==X.return||X.return()}finally{if(N)throw U}}}if(k.push({height:_.height,left:S,right:I?null:S+R}),D){var F=!0,W=!1,H=void 0;try{for(var V,z=D[Symbol.iterator]();!(F=(V=z.next()).done);F=!0){var j=V.value;k.push({height:T,left:null,right:j.number})}}catch(e){W=!0,H=e}finally{try{F||null==z.return||z.return()}finally{if(W)throw H}}}o(_.from,new fK(k,P));continue}for(var q=0;q<_.type.length;q++){var Y=_.type[q];if((null==Y?void 0:Y.type)===nL.kH.Text){if(G&&P)for(var $=0;$<G.length;$++){var J,K=G[$],Q=_.type[q-$-1];P.push({height:null!==(J=null==Q?void 0:Q.height)&&void 0!==J?J:T,left:null,right:K.number})}if(k.push({height:Y.height,left:S,right:I?null:S+R}),D)for(var ee=0;ee<D.length;ee++){var et,en=D[ee],er=_.type[q+ee+1];k.push({height:null!==(et=null==er?void 0:er.height)&&void 0!==et?et:T,left:null,right:en.number})}break}}o(_.from,new fK(k,P))}}}catch(e){Z=!0,w=e}finally{try{b||null==C.return||C.return()}finally{if(Z)throw w}}return nX.Xs.of(n,!0)},lineMarkerChange:function(e){if(e.docChanged)return!0;var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(fF(a).changed)return!0}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1},initialSpacer:function(e){return new fJ(e.state.doc.lines)},updateSpacer:function(e,t){var n=t.state.doc.lines;return fF(t.state).compareTo?new fK([{height:0,left:n,right:n}]):new fJ(n)}}),f0="#0053A644",f1="#c93c3733",f2=[nL.tk.theme({".cm-diff-inserted":{backgroundColor:f0},".cm-diff-deleted":{backgroundColor:f1},".cm-diff-gutter .cm-diff-gutter-block":{position:"relative",padding:"0"},".cm-diff-gutter-element":{display:"flex",width:"100%",alignItems:"center",columnGap:"8px",padding:"0 6px",borderLeft:"4px solid transparent"},".cm-diff-gutter-part":{display:"inline-block",height:"100%",width:"50%",textAlign:"center"},".cm-diff-gutter-inserted":{backgroundColor:f0,borderLeftColor:"#0053A6"},".cm-diff-gutter-deleted":{backgroundColor:f1,borderLeftColor:"#c93c37"},".cm-diff-gutter + .cm-foldGutter":{width:"0",transform:"translateX(-12px)",overflow:"visible"},".cm-diff-gutter .cm-diff-gutter-element":{paddingRight:"16px"},".cm-diff-gutter .cm-diff-gutter-element-fallback":{paddingRight:"12px"}}),fM.state,fH,fY,fQ,(0,fU.mi)({openText:"",closedText:""})],f8=n(57953),f4=function(){"use strict";function e(t){var n=this;(0,fi._)(this,e),this.view=t,this.overlay=document.createElement("div"),this.overlay.className="cm-overlay-generic",this.overlay.style.pointerEvents="none",this.overlay.style.contain="size style",this.overlay.setAttribute("aria-hidden","true"),this.view.scrollDOM.appendChild(this.overlay),this.elements=new Map,this.measureRequest={key:this,read:function(){var e=[],t=n.view.scrollDOM.getBoundingClientRect(),r=n.view.scrollDOM.scrollTop,i=n.view.scrollDOM.scrollLeft,o=!0,a=!1,l=void 0;try{for(var c,s=n.elements.values()[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,d=u.dom,f=u.pos,h=u.offsetX,p=u.offsetY,m=n.view.coordsAtPos(f),v=n.view.lineBlockAt(f);if(!m){e.push({dom:d,x:null,y:null});continue}var g=v.top-r+t.top+n.view.documentPadding.top,y=Math.round((m.top-g)/n.view.defaultLineHeight)*n.view.defaultLineHeight+g,b=i+m.left-t.left+h,Z=r+y-t.top+p;e.push({dom:d,x:b,y:Z})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return e},write:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)!function(){var e=i.value,t=e.dom,n=e.x,r=e.y;if(null===n||null===r)return t.style.visibility="hidden",t.style.transition="none";t.style.visibility="",t.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),t.style.transition.startsWith("none")&&requestAnimationFrame(function(){t.style.transition=""})}()}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}}var t=e.prototype;return t.destroy=function(){this.view.scrollDOM.removeChild(this.overlay)},t.map=function(e){if(e.geometryChanged||e.viewportChanged){if(e.docChanged){var t=Array.from(this.elements.values()),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=e.changes.mapPos(l.pos,-1,nX.gc.TrackDel);if(!c){this.removeElement(l.dom);continue}l.pos=c}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}this.view.requestMeasure(this.measureRequest)}},t.addElement=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.elements.has(e)){var i={dom:e,pos:t,offsetX:n,offsetY:r};return this.elements.set(e,i),this.overlay.appendChild(e),e.style.visibility="hidden",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.willChange="transform",e.style.transition="none",this.view.requestMeasure(this.measureRequest),i}},t.removeElement=function(e){this.elements.has(e)&&(this.elements.delete(e),e.parentNode===this.overlay&&this.overlay.removeChild(e))},t.updateElement=function(e,t){var n=t.pos,r=t.offsetX,i=t.offsetY,o=this.elements.get(e);o&&(void 0!==n&&(o.pos=n),void 0!==r&&(o.offsetX=r),void 0!==i&&(o.offsetY=i),this.view.requestMeasure(this.measureRequest))},t.clear=function(){this.elements.clear(),this.overlay.innerHTML=""},e}();(f=S||(S={}))[f.Insertion=0]="Insertion",f[f.Deletion=1]="Deletion";var f3=function(){"use strict";function e(t){(0,fi._)(this,e),this.map=new Map,this.duration=t}var t=e.prototype;return t.set=function(e,t,n,r,i){var o=this.map.get(e);o||(o=new Map,this.map.set(e,o)),o.set(t,{from:e,to:t,time:n,type:r,cursor:i})},t.get=function(e,t){var n=this.map.get(e);if(n)return n.get(t)},t.update=function(t){var n=Date.now(),r=new e(this.duration),i=!0,o=!1,a=void 0;try{for(var l,c=this[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;if(!(n-s.time>this.duration)){var u=t.changes.mapPos(s.from,-1,nX.gc.TrackDel),d=t.changes.mapPos(s.to,-1,nX.gc.TrackDel);if(null!==u&&null!==d){var f=s.cursor;t.docChanged&&(f=!1),r.set(u,d,s.time,s.type,f)}}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return t.changes.iterChangedRanges(function(e,t,i,o){r.set(i,o,n,i!==o?0:1,!0)},!0),r},t.cursors=function(){var e,t,n,r,i,o,a;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:e=!0,t=!1,n=void 0,l.label=1;case 1:l.trys.push([1,6,7,8]),r=this[Symbol.iterator](),l.label=2;case 2:if(e=(i=r.next()).done)return[3,5];if(!(o=i.value).cursor)return[3,4];return[4,{type:o.type,pos:o.to}];case 3:l.sent(),l.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return a=l.sent(),t=!0,n=a,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})},t[Symbol.iterator]=function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.map.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=!0,c=!1,s=void 0;try{for(var u,d=a.values()[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;e.push(f)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e[Symbol.iterator]()},e}(),f5="cm-flash-insertion",f6="cm-flash-deletion",f9="cm-flash-element",f7=nL.tk.theme((0,U._)({},".".concat(f5,", .").concat(f6),{display:"inline-block"})),he=function(e){"use strict";(0,fo._)(n,e);var t=(0,fl._)(n);function n(){return(0,fi._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.isNested=function(){for(var e=this.parentElement;e&&!e.classList.contains("cm-line");){if(e instanceof n&&e.type===this.type)return!0;e=e.parentElement}return!1},r.stop=function(){var e,t;null===(t=this.animation)||void 0===t||null===(e=t.cancel)||void 0===e||e.call(t)},r.play=function(){var e=this.isPlaying;if(this.stop(),!this.isNested()){var t=Date.now()-parseInt(this.getAttribute("data-time")||"0",10);if(!(t>1e3)){var n=this.type===S.Insertion?"rgba(100, 255, 0, 0.3)":"rgba(255, 32, 32, 0.25)";this.animate&&(this.animation=this.animate({backgroundColor:e?[n,n,"transparent"]:["transparent",n,"transparent"],offset:[0,.05,1]},{id:"cm-flash-anim",duration:1e3,easing:"ease-in-out",delay:-t}))}}},r.connectedCallback=function(){this.play()},r.attributeChangedCallback=function(e,t,n){"data-time"===e&&n&&this.play()},(0,f8._)(n,[{key:"type",get:function(){return this.classList.contains(f5)?S.Insertion:S.Deletion}},{key:"isPlaying",get:function(){var e;return(null===(e=this.animation)||void 0===e?void 0:e.playState)==="running"}}],[{key:"observedAttributes",get:function(){return["data-time"]}}]),n}((0,fa._)(HTMLElement));customElements.get(f9)||customElements.define(f9,he);var ht=function(){"use strict";function e(t){(0,fi._)(this,e),this.view=t,this.prevFlashes=new f3(1e3),this.decorations=nL.p.set([]),this.hasRenderedOnce=!1,this.overlay=new f4(t)}var t=e.prototype;return t.destroy=function(){this.overlay.destroy()},t.update=function(e){if(!this.hasRenderedOnce){e.docChanged&&(this.hasRenderedOnce=!0);return}var t=this.prevFlashes.update(e),n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;switch(c.type){case S.Insertion:n.push({from:c.from,to:c.to,value:(s=c.time,nL.p.mark({class:f5,tagName:f9,attributes:{"data-time":s.toString()}}))});break;case S.Deletion:var s,u,d=e.state.wordAt(c.from);d&&n.push({from:d.from,to:c.to,value:(u=c.time,nL.p.mark({class:f6,tagName:f9,attributes:{"data-time":u.toString()}}))})}}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}this.overlay.clear();var f=this.view.defaultLineHeight.toString()+"px",h=!0,p=!1,m=void 0;try{for(var v,g=t.cursors()[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value,b=y.type,Z=y.pos,w=function(e,t){var n=e===S.Insertion?"rgba(0, 100, 255, 1)":"rgba(255, 32, 32, 1)",r=document.createElement("div");return r.style.width="3px",r.style.height=t,r.style.borderRadius="1px",r.style.backgroundColor=n,r.animate&&r.animate({opacity:[1,0]},{duration:500,delay:400,fill:"forwards"}),r}(b,f);this.overlay.addElement(w,Z)}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}this.prevFlashes=t,this.decorations=nL.p.set(n,!0)},e}(),hn=nL.lg.fromClass(ht,{decorations:function(e){return e.decorations}}),hr=nX.Wl.lowest([f7,hn]),hi=n(3574),ho=n(62808),ha=n(11398),hl=function(){"use strict";function e(t){(0,fi._)(this,e),this.changes=[],this.forward=[],this.inverted=[],this.locations=[];var n=!0,r=!1,i=void 0;try{for(var o,a=this,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0)!function(){var e=o.value,t=e.changes,n=e.invertedChanges,r=null,i=!1;t.iterChangedRanges(function(e,t,n,o){i||(r||(r=o),n===o||(i=!0))}),a.forward.push(t),a.inverted.push(n),a.locations.push(r)}()}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}}var t=e.prototype;return t.slice=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;if(t>this.length||n>this.length||t<0||n<0)throw Error("Invalid version range");if(t===n){if(0===this.length)return[nX.as.empty(0),null];var r=this.forward[t].newLength;return[nX.as.empty(r),null]}var i=t<n?hc(this.forward.slice(t,n)):hc(this.inverted.slice(n,t).reverse()),o=t<n?t:n-1,a=null!==(e=this.locations[o])&&void 0!==e?e:null;return null!==a&&a>i.newLength&&(a=i.newLength),[i,a]},t.get=function(e){if(e>this.length||e<0)throw Error("Invalid version");return this.changes[e]},t.documentFor=function(e){if(e>this.length||e<0)throw Error("Invalid version");if(0===this.length)return"";var t=(0,L._)(this.slice(0,e),1)[0],n=nX.xv.of([""]);return t.apply(n).sliceString(0)},(0,f8._)(e,[{key:"length",get:function(){return this.forward.length}}]),e}();function hc(e){if(0===e.length)return nX.as.empty(0);if(1===e.length)return e[0];var t=(0,tM._)(e),n=t[0],r=t.slice(1),i=n,o=!0,a=!1,l=void 0;try{for(var c,s=r[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;i=i.compose(u)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return i}var hs=n(21677),hu=[hr,f2];function hd(e){var t,n,r,i=e.filePath,o=(0,d6.bA)(),a=(0,rI.Z)(),l=a.ref,c=a.view;(0,hi.VD)(c),(0,d6._H)(c);var s=(0,fh.j)();(0,ho.Y)({view:c}),t=(0,O.useMemo)(function(){return(null==o?void 0:o.changes)?new hl(o.changes):null},[null==o?void 0:o.changes]),n=(0,O.useMemo)(function(){return t?t.documentFor(t.length):null},[t]),r=(0,O.useRef)({current:-1,next:0,pending:!1}),(0,O.useEffect)(function(){if(c)return function(){r.current.pending=!1,r.current={current:-1,next:0,pending:!1}}},[c]),(0,O.useEffect)(function(){if(c&&o&&t){o.comparing?fW(c,n):fW(c,null);var e=r.current;e.next=o.version,e.pending||e.current===e.next||(e.pending=!0,requestAnimationFrame(function(){!1!==e.pending&&(e.pending=!1,c&&t&&e.current!==e.next&&(function(e,t,n,r){var i=(0,L._)(t.slice(n+1,r+1),2),o=i[0],a=i[1];if(o.length!==e.state.doc.length){var l=(0,L._)(t.slice(0,r+1),1)[0];if(l.length!==e.state.doc.length)throw Error("Unresolvable mismatch between changes and document");e.dispatch({changes:{from:0,to:e.state.doc.length}}),e.dispatch({changes:l});return}e.dispatch({changes:o,effects:a?nL.tk.scrollIntoView(a,{yMargin:10}):void 0})}(c,t,e.current,e.next),e.current=e.next))}))}},[c,o,t,n]);var u=(0,o4.useRouter)(),d=(0,iL.Vg)(u),f=hs.U.use(d);return(0,N.tZ)("div",{css:ha.ev,children:(0,N.tZ)("div",{css:ha.ac,children:o&&0===o.count?(0,N.tZ)(hf,{}):(0,N.tZ)("div",{css:ha.ac,children:(0,N.tZ)(rR.ZP,{ref:l,css:ha.Mp,filePath:i,extensions:[f,hu],initializing:!o,onException:function(e){s(e,"viewer-codemirror")},readOnly:!0,noHistory:!0,hideGutter:!0})})})})}function hf(){return(0,N.tZ)("div",{css:[ha.ac,{display:"flex",alignItems:"center",justifyContent:"center"}],children:(0,N.tZ)("span",{children:"This file has no history."})})}var hh=es.Type.Object({type:es.Type.Literal("history"),data:es.Type.Object({path:es.Type.Union([es.Type.String(),es.Type.Null()])})}),hp={Content:function(e){var t=e.pane,n=e.options;return(0,N.tZ)(hm,(0,eL._)((0,eU._)({},t.data),{performPaneOperation:n.performPaneOperation}))},Icon:function(e){var t=e.size;return(0,N.tZ)(ri.Z,{size:t})},getTitle:function(e){return e.data.path?"History - ".concat((0,ec.UO)(e.data.path)):"History - no file open"},decode:function(e){return eu.B4.Decode(hh,e)}};function hm(e){var t=e.path,n=e.performPaneOperation,r=(0,L._)((0,O.useState)(function(){return(0,eI.MT)()}),1)[0],i=(0,L._)((0,O.useState)(function(){return(0,eI.MT)()}),1)[0],o=(0,tI.Mp)({path:t,performPaneOperation:n});(0,et.L5)(function(){if(o)return{commands:o}},[o]);var a=(0,tk.Z)(function(){return function(){n({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})}},[t,n]);return t?(0,N.tZ)(hi.Cl.Provider,{value:r,children:(0,N.tZ)(d6.ox.Provider,{value:i,children:(0,N.BX)("div",{css:{position:"relative",display:"flex",flexDirection:"column",overflowY:"hidden",height:"100%",width:"100%"},children:[(0,N.tZ)(tI.HK,{path:t,performPaneOperation:n}),(0,N.tZ)(hd,{filePath:t}),(0,N.tZ)(fA,{filePath:t,onCloseHistory:a})]})})}):null}var hv=n(52924),hg=n(65667),hy=n.n(hg),hb=n(45726),hZ=n(11774),hw=(0,K.X)({create:[Y.l0.colWithGap(8),Y.l0.p(8)],pedit:{width:"100%",height:"100%"},canvas:{width:"100%",height:"100%",outline:"none",position:"absolute",top:0,left:0},upgradeButton:[Y.l0.position.absolute,Y.l0.top(8),Y.l0.left("50%"),{transform:"translateX(-50%)"}]});function hx(e){var t=e.data,n=e.onSave,r=O.useRef(null),i=O.useRef(null),o=(0,H.Z)().fs,a=(0,nN.Z)(),l=a.showError,c=a.showConfirm,s=(0,L._)(O.useState(!1),2),u=s[0],d=s[1],f=(0,V.Z)(function(){var e=r.current;if(!e)return null;e.width=e.offsetWidth,e.height=e.offsetHeight;var t=e.getContext("2d");t&&(t.imageSmoothingEnabled=!1)},{type:"debounce",wait:100});return O.useEffect(function(){var e=r.current;if(e){e.width=e.offsetWidth,e.height=e.offsetHeight;var o=hy()({canvas:e,data:t}),a=function(){return n(o.save())};return o.on("change",a),o.on("save",a),o.on("export",function(){return d(!0)}),i.current=o,e.focus(),function(){o&&o.cleanUp(),i.current&&(i.current=null)}}},[t,n,r]),(0,N.BX)(N.HY,{children:[(0,N.tZ)("canvas",{css:hw.canvas,ref:function(e){r.current=e,f(e)},tabIndex:0}),(0,N.tZ)(iX.u,{isOpen:u,onRequestClose:function(){return d(!1)},children:(0,N.tZ)(hb.Z,{prompt:"Export",desc:"What name to give to the exported file?",placeholder:"filename",type:"text",onCancel:function(){return d(!1)},onConfirm:function(e){if(!i.current){d(!1);return}var t="".concat(e,".png"),n=i.current.curFrame().toPNG();o.writeFile(t,rH.Z.from(n)).then(function(e){if(e.error){l("Failed to write to file ".concat(t));return}c("Successfully exported to ".concat(t)),d(!1)})}})})]})}function hC(e){var t,n=e.activeFile,r=(0,H.Z)().fs,i=(0,L._)(O.useState(!0),2),o=i[0],a=i[1],l=(0,L._)(O.useState(null),2),c=l[0],s=l[1],u=(0,nN.Z)().showError,d=n.endsWith(".kbmsprite");O.useEffect(function(){var e=!1;function t(){return(t=(0,eO._)(function(){var t,i,o;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:return[4,r.readFile(n)];case 1:if(t=l.sent(),a(!1),e)return[2];if(t.error)return u("failed to read ".concat(n)),[2];return o=(i=t.content.toString())&&JSON.parse(i),s(d?(0,hZ.C)(o):o),[2]}})})).apply(this,arguments)}return!function(){t.apply(this,arguments)}(),function(){e=!0}},[r,n,u,d]);var f=O.useCallback((t=(0,eO._)(function(e){return(0,eX.Jh)(this,function(t){switch(t.label){case 0:if(!d)return[3,2];return[4,(0,hZ.u)(e)];case 1:e=t.sent(),t.label=2;case 2:return[4,r.writeFile(n,rH.Z.from(JSON.stringify(e)))];case 3:return t.sent().error&&u("Failed to save ".concat(n,", please try again")),[2]}})}),function(e){return t.apply(this,arguments)}),[r,n,u,d]);return o?(0,N.tZ)(eE.Z,{}):c?(0,N.tZ)(hx,{data:c,onSave:f}):(0,N.tZ)(h_,{onCreate:function(e){return s(e)}})}function h_(e){var t=e.onCreate,n=(0,L._)(O.useState(""),2),r=n[0],i=n[1],o=(0,L._)(O.useState(""),2),a=o[0],l=o[1],c=Number(r),s=Number(a);return(0,N.BX)($.G,{css:hw.create,children:[(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Create a Pedit file"}),(0,N.tZ)(tF.II,{placeholder:"width",value:r,onChange:function(e){return i(e.target.value)}}),(0,N.tZ)(tF.II,{placeholder:"height",value:a,onChange:function(e){return l(e.target.value)}}),(0,N.tZ)(eW.zx,{text:"Create",disabled:!(c>0&&s>0),onClick:function(){t({width:Math.ceil(c),height:Math.ceil(s)})}})]})}var hk=es.Type.Object({type:es.Type.Literal("pedit"),data:es.Type.Object({path:es.Type.String()})}),hS={Content:function(e){var t=e.pane,n=e.options.performPaneOperation;return(0,N.tZ)(hE,{path:t.data.path,performPaneOperation:n})},Icon:function(e){var t=e.size;return(0,N.tZ)(hv.Z,{size:t})},getTitle:function(e){return(0,ec.UO)(e.data.path)},decode:function(e){return eu.B4.Decode(hk,e)}};function hE(e){var t=e.path,n=e.performPaneOperation,r=(0,tI.Mp)({path:t,performPaneOperation:n});return(0,et.L5)(function(){if(r)return{commands:r}},[r]),(0,N.BX)(N.HY,{children:[(0,N.tZ)(tI.HK,{path:t,performPaneOperation:n}),(0,N.tZ)(tI.VY,{children:(0,N.tZ)(hC,{activeFile:t})})]})}var hT=n(14648),hR=n(34581),hI=es.Type.Object({type:es.Type.Literal("unitTests")}),hD={Content:function(e){var t=e.options,n=(0,hR.nC)(),r=(0,et.dr)();function i(){var e=n().find(function(e){var t=(0,L._)(e,2);return"runnerOutput"===(t[0],t[1].type)});if(e)return e[0]}return(0,N.tZ)($.G,{css:[Y.l0.p(8),tX.F3],children:(0,N.tZ)(hT.Z,{getRunnerOutput:function(){var e=i();if(e||t.performPaneOperation({operation:"open",secondary:!0,pane:{type:"runnerOutput"}}),e=i()){var n=r(e);if((null==n?void 0:n.type)==="runnerOutput")return n}}})})},Icon:function(e){var t=e.size;return(0,N.tZ)(nU.Z,{size:t})},getTitle:function(){return"Unit Tests"},decode:function(e){return eu.B4.Decode(hI,e)}},hG=n(83447),hB=n(26397),hP=n(74883),hA=n(72129),hN=n(97703),hU=n(10169),hL=n(47507),hO=n(78094),hX=(0,eI.cn)(""),hM=(0,eI.cn)(null);(0,eI.cn)(null,(h=(0,eO._)(function(e,t){var n,r,i;return(0,eX.Jh)(this,function(o){return(n=e(hM))&&(r=e(hX),i=e(hU.FF),hL.kg.info("Ghostwriter Debugger error buffered",{debuggerBuffer:r,ghostwriterDebugError:n,inferredInterpreter:i})),t(hX,""),t(hM,null),[2]})}),function(e,t){return h.apply(this,arguments)}));var hF=n(3590),hW=function(e){var t=e.title,n=e.json,r=e.initialExpanded,i=(0,L._)((0,O.useState)(void 0===r||r),2),o=i[0],a=i[1];return(0,N.tZ)(ne.Q,{expanded:o,onClick:function(){return a(function(e){return!e})},headerContent:(0,N.tZ)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:t})}),children:(0,N.tZ)($.G,{css:[Y.l0.p(12),Y.l0.colWithGap(8),Y.l0.height("100%")],children:(0,N.tZ)(hN.Z,{json:n})})})},hH=function(e){var t=e.title,n=e.text,r=(0,L._)((0,O.useState)(!0),2),i=r[0],o=r[1];return(0,N.tZ)(ne.Q,{expanded:i,onClick:function(){return o(function(e){return!e})},headerContent:(0,N.tZ)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:t})}),children:(0,N.tZ)($.G,{css:[Y.l0.p(12),Y.l0.colWithGap(8),Y.l0.height("100%")],children:(0,N.tZ)(J.xv,{variant:"small",css:[Y.l0.fontSize(16),{whiteSpace:"pre-wrap"}],children:n})})})},hV=n(12621),hz=n(4498),hj=n(16643),hq=n(87659),hY=n(97631);function h$(){var e=(0,ns._)(["\n  query AdminPanelGitView {\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n        installations {\n          id\n          type\n          avatarUrl\n          name\n        }\n        userInfo {\n          name\n          email\n          avatarUrl\n        }\n      }\n    }\n  }\n"]);return h$=function(){return e},e}var hJ={},hK=(0,nu.Ps)(h$());function hQ(e){var t=e.event,n=t.input,r=t.output,i=t.error,o=t.start,a=t.end,l=t.cached,c=(0,L._)((0,O.useState)(!0),2),s=c[0],u=c[1],d=(0,O.useCallback)(function(){return u(function(e){return!e})},[]),f="bash"===n[0]&&"-c"===n[1]?n.slice(2).join(" "):n.join(" "),h=r.trimEnd();return(0,N.BX)($.G,{css:[(0,hq.ec)(i?"negative":"positive"),l?{opacity:.75}:void 0,Y.l0.borderRadius(8)],children:[(0,N.BX)($.G,{onClick:d,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&d()},tabIndex:0,css:[Y.l0.rowWithGap(4),Y.l0.justify.spaceBetween,Y.l0.py(4),Y.l0.px(8),Y.l0.font.code,Y.l0.cursor.pointer],children:[(0,N.BX)("span",{css:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:["$ ",f]}),(0,N.BX)("span",{css:[Y.l0.color.foregroundDimmer,Y.l0.flex.shrink(0)],children:[i?(0,N.tZ)("span",{css:[Y.l0.mr(16)],children:i}):null,l?(0,N.tZ)("span",{children:"CACHED"}):(0,N.BX)("span",{children:[a-o," ms"]})]})]}),s?null:(0,N.tZ)($.G,{css:[Y.l0.px(2),Y.l0.pb(2),Y.l0.borderRadius(0,0,8,8)],children:(0,N.tZ)(eq.Tg,{elevated:!0,css:[Y.l0.p(8),Y.l0.borderRadius(8)],children:(0,N.tZ)(hz.Z,{code:h})})})]})}var h0=n(24463),h1=n(88994),h2=n(61155);function h8(e){var t=e.t,n=e.children;return(0,N.BX)("span",{css:{display:"flex",alignItems:"flex-start",columnGap:"0.5rem"},children:[(0,N.BX)(J.xv,{css:{minWidth:"8em"},multiline:!1,children:[t,":"," "]}),(0,N.tZ)("span",{children:n})]})}var h4=n(87271),h3=n(98463),h5=O.memo(function(e){var t,n=e.log,r=e.filters,i=e.timeRef,o=e.setTimeRef,a=r.highlightOnly&&(0,h4.cF)(n,r),l=null!==(t=n.cmd.channel)&&void 0!==t?t:0,c=(0,O.useMemo)(function(){var e=(0,eU._)({},n.cmd);return delete e.channel,e},[n]),s=JSON.stringify(c,null,2),u=i?n.timestamp-i:n.timestamp,d=(0,L._)((0,h2.Z)(!0),2),f=d[0],h=d[1];return(0,N.BX)($.G,{css:[Y.l0.my(4),Y.l0.mx(4)],children:[(0,N.tZ)($.G,{role:"button",onClick:h,onKeyDown:h,tabIndex:0,css:[a?Y.l0.backgroundColor.accentPositiveDimmer:null,Y.l0.flex.row,Y.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".link":{textDecoration:"underline"}}}],children:(0,N.BX)($.G,{css:[Y.l0.flex.grow(1),Y.l0.rowWithGap(4),{maxWidth:"100%"}],children:[(0,N.tZ)(J.xv,{className:"icon",multiline:!1,children:"in"===n.dir?(0,N.tZ)($.G,{css:Y.l0.color.greenStrongest,children:""}):"out"===n.dir?(0,N.tZ)($.G,{css:Y.l0.color.redStrongest,children:""}):(0,N.tZ)($.G,{css:Y.l0.color.magentaStrongest,children:""})}),(0,N.tZ)(J.xv,{className:"link",multiline:!1,children:(0,N.BX)("code",{children:["#",l," - ",n.channel.service,n.channel.name?"::".concat(n.channel.name):""]})}),(0,N.tZ)(J.xv,{css:[Y.l0.flex.growAndShrink(1),{opacity:.5}],multiline:!1,children:(0,N.tZ)("code",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:s})}),null!=u&&(0,N.tZ)($.G,{onClick:function(){o(n.timestamp)},css:{opacity:.5},children:(0,N.tZ)(J.xv,{css:[Y.l0.fontSize(13),{cursor:"pointer"}],multiline:!1,children:n.timestamp===i?"(reference)":(0,N.BX)(N.HY,{children:[u.toFixed(0)," ms"]})})})]})}),!f&&(0,N.tZ)(N.HY,{children:void 0!==c&&(0,N.tZ)(h3.g,{name:"cmd",src:c})})]})}),h6=(0,O.memo)(function(e){var t=e.logs,n=e.filters,r=e.timeRef,i=e.setTimeRef,o=(0,O.useRef)(null),a=(0,cf.MG)({count:t.length,getScrollElement:function(){return o.current},estimateSize:function(){return 28},overscan:10});return(0,N.BX)("div",{ref:o,className:"log-list",children:[(0,N.tZ)("div",{style:{height:"".concat(a.getTotalSize(),"px"),width:"100%",position:"relative"},children:a.getVirtualItems().map(function(e){return(0,N.tZ)("div",{"data-index":e.index,ref:a.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:"translateY(".concat(e.start,"px)")},children:(0,N.tZ)(h5,{log:t[e.index],filters:n,timeRef:r,setTimeRef:i})},e.key)})}),(0,N.tZ)("div",{className:"bottom-anchor"})]})}),h9=function(e){var t=e.filters,n=e.updateFilters;return(0,N.BX)($.G,{css:Y.l0.colWithGap(4),children:[(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Regex (regex,flags):"}),(0,N.tZ)(tF.II,{id:"regex",onChange:function(e){var t=null;if(e.currentTarget.value){var r=(0,L._)(e.currentTarget.value.split(","),2),i=r[0],o=r[1];try{t=new RegExp(i,o)}catch(e){}}n({regexp:t})},placeholder:"\\w+,gi"}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Directions:"}),(0,N.tZ)(u3.E,{css:Y.l0.rowWithGap(16),name:"direction",value:t.direction,onChange:function(e){var t=e.target.value;n({direction:"in"===t||"out"===t||""===t?t:""})},children:[{val:"",text:"Both"},{val:"in",text:"In"},{val:"out",text:"Out"}].map(function(e){return(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8)],children:[(0,N.tZ)(u3.Y,{id:e.val,value:e.val}),(0,N.tZ)("label",{htmlFor:e.val,children:e.text})]},e.val)})}),(0,N.tZ)(J.xv,{variant:"subheadDefault",multiline:!1,children:"Filter style:"}),(0,N.tZ)(u3.E,{css:Y.l0.rowWithGap(16),name:"filter-style",value:t.highlightOnly?"highlight":"filter",onChange:function(e){return n({highlightOnly:"highlight"===e.target.value})},children:[{val:"highlight",text:"Highlight"},{val:"filter",text:"Filter"}].map(function(e){return(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8)],children:[(0,N.tZ)(u3.Y,{id:e.val,value:e.val}),(0,N.tZ)("label",{htmlFor:e.val,children:e.text})]},e.val)})})]})},h7=n(94450),pe=n.n(h7),pt=n(58130),pn=n(17867),pr=n(11516),pi=n(29358),po=n(83848),pa=n(16835);function pl(){var e=(0,ns._)(["\n  fragment AdminPanelRepl on Repl {\n    id\n    title\n    description\n    isProject\n    isPrivate\n    timeCreated\n    timeUpdated\n    slug\n    url\n    language\n    user {\n      id\n    }\n    config {\n      isServer\n      isVnc\n    }\n    isRenamed\n    isProjectFork\n    folderId\n    isOwner\n    origin {\n      id\n    }\n    source {\n      release {\n        id\n        repl {\n          id\n          url\n          templateLabel\n        }\n      }\n    }\n  }\n"]);return pl=function(){return e},e}function pc(){var e=(0,ns._)(["\n  query AdminPanelReplView($replId: String!) {\n    repl(id: $replId) {\n      ...AdminPanelRepl\n    }\n  }\n  ","\n"]);return pc=function(){return e},e}var ps={},pu=(0,nu.Ps)(pl()),pd=(0,nu.Ps)(pc(),pu),pf=n(96298),ph=n(95577);function pp(e){var t=e.sessionId,n=(0,L._)((0,O.useState)(!1),2),r=n[0],i=n[1],o=(0,L._)((0,O.useState)(""),2),a=o[0],l=o[1],c=(0,L._)((0,O.useState)(!1),2),s=c[0],u=c[1],d=(0,nN.Z)().showConfirm,f=(0,rV.U)();return null==t?(0,N.tZ)($.G,{children:(0,N.tZ)(J.xv,{multiline:!1,children:"Something went wrong... no RUM session found... Try refreshing the page"})}):(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[(0,N.BX)(J.xv,{variant:"small",multiline:!1,children:["RUM Session ID: ",t]}),(0,N.tZ)(J.xv,{variant:"headerDefault",multiline:!1,children:"Submit an Issue"}),(0,N.BX)($.G,{css:[Y.l0.colWithGap(16)],children:[(0,N.tZ)(tF.B,{id:f("message"),placeholder:"What can we do better?",value:a,onChange:function(e){return l(e.target.value)},disabled:r}),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8)],children:[(0,N.tZ)(uW.X,{id:f("issueInRecording"),checked:s,onChange:function(e){return u(e.target.checked)}}),(0,N.tZ)("label",{htmlFor:f("issueInRecording"),children:(0,N.tZ)(J.xv,{multiline:!1,children:"Issue is demoed in recording"})})]}),(0,N.tZ)(eW.zx,{onClick:function(){var e=rx()();i(!0),(0,hL.fc)({name:"replitOnReplit:issue",context:{message:a,issueInRecording:s,customEventId:e}}),d("Issue submitted! Have a cookie \uD83C\uDF6A",5e3),setTimeout(function(){i(!1),l(""),u(!1)},5e3)},text:"Submit",disabled:r||0===a.trim().length,colorway:"primary"})]})]})}(p=E||(E={})).Repl="repl",p.Logs="logs",p.LSP="lsp",p.AI="ai",p.GhostwriterChat="aiChat",p.AST="ast",p.Git="git",p.History2="history2",p.Metadata="metadata",p.Override="override",p.DDRum="rum";var pm=(T={},(0,U._)(T,"repl",function(){var e,t,n,r,i,o,a,l,c,s=(0,nc.Z)(),u=(e=(0,eU._)({},ps,{variables:{replId:s}}),nd.a(pd,e)).data,d=(null==u?void 0:u.repl.__typename)==="Repl"?JSON.parse(JSON.stringify(u.repl)):void 0;return d&&(delete d.__typename,null===(t=d.user)||void 0===t||delete t.__typename,null===(n=d.origin)||void 0===n||delete n.__typename,delete d.config.__typename,null===(r=d.source)||void 0===r||delete r.__typename,null===(o=d.source)||void 0===o||null===(i=o.release)||void 0===i||delete i.__typename,null===(c=d.source)||void 0===c||null===(l=c.release)||void 0===l||null===(a=l.repl)||void 0===a||delete a.__typename),(0,N.BX)($.G,{css:[Y.l0.colWithGap(16),Y.l0.p(4)],children:[(0,N.tZ)(pf.Z,{replId:s}),(0,N.tZ)("div",{className:"jsx-3187c500f6b377b0",children:d?(0,N.tZ)(hN.Z,{json:d}):null}),(0,N.tZ)(pe(),{id:"3187c500f6b377b0",children:"pre.jsx-3187c500f6b377b0{white-space:pre-wrap;word-wrap:break-word}"})]})}),(0,U._)(T,"logs",function(e){var t=e.isHidden,n=(0,L._)((0,h2.Z)(!1),2),r=n[0],i=n[1],o=(0,L._)((0,O.useState)(null),2),a=o[0],l=o[1],c=(0,eD.Dv)(h4.Sj),s=(0,L._)((0,eD.KO)(h4.a0),2),u=s[0],d=s[1],f=(0,L._)((0,eD.KO)(h4.ot),2),h=f[0],p=f[1],m=(0,eD.b9)(h4.UB);return t?null:(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[(0,N.BX)($.G,{css:[Y.l0.colWithGap(8),Y.l0.position.sticky,Y.l0.top(0),Y.l0.px(4),Y.l0.pb(8),{"z-index":3},Y.l0.backgroundColor.backgroundDefault],children:[(0,N.tZ)(eW.zx,{colorway:u?void 0:"positive",onClick:function(){d(function(e){return!e})},text:u?"Stop logging goval":"Start logging goval"}),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(4),Y.l0.justify.spaceBetween],children:[(0,N.tZ)(eW.zx,{onClick:i,text:r?"Hide filters":"Show filters"}),a?(0,N.tZ)(eW.zx,{onClick:function(){return l(null)},text:"Reset Time Ref"}):null,(0,N.tZ)(e_.hU,{alt:"Download as JSON",onClick:function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(c)),t=document.createElement("a");t.setAttribute("href",e);var n=new Date().toISOString();t.setAttribute("download","logs-".concat(n.slice(0,n.indexOf(".")).replaceAll("-","").replaceAll(":",""),".json")),t.click()},size:32,children:(0,N.tZ)(e1.Z,{})}),(0,N.tZ)(eW.zx,{colorway:"negative",onClick:function(){return m()},text:"Clear logs"})]}),r?(0,N.tZ)(h9,{filters:h,updateFilters:function(e){p((0,eU._)({},h,e))}}):null]}),(0,N.tZ)(h6,{logs:c,filters:h,timeRef:a,setTimeRef:l})]})}),(0,U._)(T,"lsp",h3.L),(0,U._)(T,"ai",hV.ho),(0,U._)(T,"aiChat",function(){var e=(0,hA.v)(),t=(0,nc.Z)(),n=(0,hF.ub)(),r=(0,ny.R3)(),i=(0,ar.Og)(),o=(0,ar.Cd)(),a=(0,L._)((0,hO.wM)(hX),1)[0],l=(0,L._)((0,hO.wM)(hM),1)[0],c="chat-".concat(n,".json"),s=(0,L._)((0,O.useState)(".ghostwriter/".concat(c)),2),u=s[0],d=s[1],f=(0,H.Z)().fs,h=(0,nN.Z)().showError,p=(0,L._)((0,ar.zu)(),2),m=p[0],v=p[1],g=(0,O.useCallback)(function(){return JSON.stringify({chatModel:e,chatSessionId:n,replId:t,messages:m},null,2)},[e,n,t,m]),y=(0,O.useCallback)((0,eO._)(function(){var e,t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:e=g(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,f.writeFile(u,rH.Z.from(e))];case 2:if((t=n.sent()).error)throw Error("fs error: ".concat(t.error));return[3,4];case 3:return h(n.sent().message),[3,4];case 4:return[2]}})}),[g,f,u,h]),b=(0,O.useCallback)((0,eO._)(function(){var e,t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,f.readFile(u)];case 1:if((e=n.sent()).error)throw Error("fs error: ".concat(e.error));if(!Array.isArray((t=JSON.parse(e.content.toString())).messages))throw Error("invalid chat JSON");return v(t.messages),[3,3];case 2:return h(n.sent().message),[3,3];case 3:return[2]}})}),[u,f,v,h]);return(0,N.tZ)($.G,{css:Y.l0.height("100%"),children:(0,N.BX)(hG.mQ,{css:[{width:"100%"}],children:[(0,N.BX)(hG.td,{withDividers:!1,children:[(0,N.tZ)(hG.OK,{iconLeft:(0,N.tZ)(hB.Z,{}),children:"File Context"}),(0,N.tZ)(hG.OK,{iconLeft:(0,N.tZ)(hB.Z,{}),children:"Debugger"}),(0,N.tZ)(hG.OK,{iconLeft:(0,N.tZ)(hP.Z,{}),children:"Messages"})]}),(0,N.BX)(hG.nP,{children:[(0,N.BX)(hG.x4,{children:[(0,N.tZ)(hW,{title:"active file",json:r}),(0,N.tZ)(hW,{title:"last stop reason",json:o}),(0,N.tZ)(hH,{title:"last prompt",text:i?JSON.stringify(JSON.parse(i),void 0,2):""})]}),(0,N.BX)(hG.x4,{children:[(0,N.tZ)(hW,{title:"buffered output",json:a}),(0,N.tZ)(hW,{title:"debug error context",json:l})]}),(0,N.tZ)(hG.x4,{children:(0,N.BX)($.G,{css:[Y.l0.colWithGap(8),Y.l0.m(8)],children:[(0,N.BX)(eq.Tg,{background:"higher",css:[Y.l0.borderRadius(8),Y.l0.colWithGap(8),Y.l0.p(8)],children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Chat History"}),(0,N.tZ)(tF.II,{type:"text",value:u,onChange:function(e){d(e.target.value)}}),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.flex.wrap],children:[(0,N.tZ)(eW.zx,{text:"Download",colorway:"primary",iconLeft:(0,N.tZ)(e1.Z,{}),onClick:function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(g()),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","".concat(c)),t.click()}}),(0,N.tZ)(eW.zx,{text:"Save to Repl",onClick:y,iconLeft:(0,N.tZ)(e1.Z,{})}),(0,N.tZ)(eW.zx,{text:"Load from Repl",onClick:b,iconLeft:(0,N.tZ)(sG.Z,{})})]})]}),(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[(0,N.tZ)("label",{css:Y.l0.color.foregroundDimmer,htmlFor:"gw-debug-chatModel",children:"Chat Model"}),(0,N.tZ)(tF.II,{id:"gw-debug-chatModel",type:"text",readOnly:!0,value:e})]}),(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[(0,N.tZ)("label",{css:Y.l0.color.foregroundDimmer,htmlFor:"gw-debug-replId",children:"Repl Id"}),(0,N.tZ)(tF.II,{id:"gw-debug-replId",type:"text",readOnly:!0,value:t})]}),(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[(0,N.tZ)("label",{css:Y.l0.color.foregroundDimmer,htmlFor:"gw-debug-sessionId",children:"Session Id"}),(0,N.tZ)(tF.II,{id:"gw-debug-sessionId",type:"text",readOnly:!0,value:n})]})]})})]})]})})}),(0,U._)(T,"ast",ho.Z),(0,U._)(T,"git",function(){var e,t=(0,L._)((0,O.useState)([]),2),n=t[0],r=t[1],i=(e=(0,eU._)({},hJ,void 0),nd.a(hK,e)).data,o=(0,hj.Z)(hY.e);return(0,O.useEffect)(function(){o&&r(function(e){return e.length&&e[0].key===o.key?e:[o].concat((0,ex._)(e)).slice(0,100)})},[o]),(0,N.BX)($.G,{css:[Y.l0.p(8)],children:[(0,N.BX)(eq.Tg,{elevated:!0,css:[Y.l0.borderRadius(8),Y.l0.p(8),Y.l0.mb(8)],children:[(0,N.tZ)("span",{children:"Git Service Connection Info"}),(0,N.tZ)("pre",{children:(null==i?void 0:i.currentUser)?JSON.stringify(i,function(e,t){return"accessToken"===e?"censored":t},2):"No gitHubInfo"})]}),(0,N.tZ)($.G,{css:[Y.l0.colWithGap(4)],children:n.length?n.map(function(e){return(0,N.tZ)(hQ,{event:e},e.key)}):"No events yet..."})]})}),(0,U._)(T,"history2",function(){var e=(0,rV.U)()("toggleIsShowingChanges"),t=(0,hj.Z)(d6.BI)(),n=(0,hj.Z)(d6.Jp)(),r=(0,L._)((0,h2.Z)(!1),2),i=r[0],o=r[1];if(!t)return null;var a=t.filePath,l=t.changes,c=t.users,s=t.version,u=t.playing,d=t.count,f=l[s];if(!f)return(0,N.BX)($.G,{children:[(0,N.BX)("div",{children:["Change at ",s," not found. Here's the state"]}),(0,N.tZ)("pre",{children:JSON.stringify(t,null,2)})]});var h=null==c?void 0:c[f.userId],p=f.timestamp,m=i&&n?function(e,t){try{return(0,h1.ed)(e,t).op}catch(e){return e}}(f.changes,n.state.doc.sliceString(0)):null;return(0,N.BX)($.G,{css:[Y.l0.colWithGap(16),Y.l0.p(4)],children:[(0,N.BX)($.G,{css:[Y.l0.colWithGap(4)],children:[(0,N.tZ)(h8,{t:"File",children:(0,N.tZ)("pre",{children:a})}),(0,N.BX)(h8,{t:"Version",children:[s," / ",d-1]}),(0,N.tZ)(h8,{t:"Playing",children:(0,N.tZ)(h0.Z,{children:u?"true":"false"})}),(0,N.tZ)(h8,{t:"Date",children:(0,N.tZ)(cd.EK,{date:p})})]}),h?(0,N.BX)($.G,{children:[(0,N.tZ)(h8,{t:"Author",children:h.username}),(0,N.BX)($.G,{css:[Y.l0.pl(8),Y.l0.colWithGap(4)],children:[(0,N.tZ)(h8,{t:"ID",children:h.id}),(0,N.tZ)(h8,{t:"Name",children:h.username}),(0,N.tZ)(h8,{t:"Image",children:(0,N.tZ)("a",{href:h.image,children:h.image})})]})]}):null,(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),{alignItems:"center"}],children:[(0,N.tZ)(fC.Z,{id:e,isOn:i,onChange:o}),(0,N.tZ)("label",{htmlFor:e,children:"Changes"})]}),f?null:"No changes",i&&f?(0,N.tZ)(N.HY,{children:(0,N.BX)($.G,{children:[(0,N.tZ)(h8,{t:"Changeset",children:(0,N.tZ)("pre",{children:JSON.stringify(f,null,2)})}),n?(0,N.tZ)(N.HY,{children:(0,N.BX)($.G,{css:[Y.l0.mt(4)],children:[(0,N.tZ)(h8,{t:"OT",children:(0,N.tZ)("pre",{children:JSON.stringify(m,null,2)})}),(0,N.tZ)("p",{children:(0,N.BX)("small",{children:["Note that the OT value is translated ",(0,N.tZ)("em",{children:"back"})," to an operational transformation from the CodeMirror changeset."]})})]})}):null]})}):null]})}),(0,U._)(T,"metadata",function(){var e=(0,H.Z)().container;(0,pn.Z)(e);var t=e.getConnectionMetadata();if(!t)return(0,N.tZ)("div",{children:"no token yet, wait for connection"});var n=t.token,r=new URL(t.conmanURL).host,i='./conman-repl -t "'.concat(n,'" -u ').concat(r);return(0,N.BX)("div",{className:"jsx-2e9ac5ab034fc317 token-viewer",children:[(0,N.BX)($.G,{css:Y.l0.rowWithGap(2),children:[(0,N.BX)(J.xv,{css:Y.l0.flex.shrink(1),multiline:!1,children:["conman Repl command: ",(0,N.tZ)(h0.Z,{children:i})]}),(0,N.tZ)(e_.hU,{alt:"Copy to clipboard",onClick:function(){return(0,tz.Z)(i)},children:(0,N.tZ)(rF.Z,{})})]}),(0,N.BX)("div",{className:"jsx-2e9ac5ab034fc317",children:["metadata:",(0,N.tZ)("pre",{className:"jsx-2e9ac5ab034fc317",children:JSON.stringify(t,null,2)})]}),(0,N.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,N.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,N.BX)("div",{className:"jsx-2e9ac5ab034fc317",children:["parsed token:",(0,N.tZ)("pre",{className:"jsx-2e9ac5ab034fc317",children:JSON.stringify((0,pt.he)(t.token),null,2)})]}),(0,N.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,N.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,N.tZ)(pe(),{id:"2e9ac5ab034fc317",children:".token-viewer.jsx-2e9ac5ab034fc317{height:100%;overflow:auto;padding:10px}pre.jsx-2e9ac5ab034fc317{white-space:pre-wrap;word-wrap:break-word}"})]})}),(0,U._)(T,"override",function(){var e=(0,L._)(O.useState(pr.Z.get("gurl","string")||""),2),t=e[0],n=e[1],r=(0,L._)(O.useState(""),2),i=r[0],o=r[1],a=iB(),l=""===t?"null":JSON.stringify((0,pa.t)(t),null,2);return(0,N.BX)("div",{style:{height:"100%",overflow:"auto"},children:[(0,N.tZ)(pi.ZP,{label:"Custom gurl",placeholder:"ws://localhost:".concat(4560),value:t,onChange:function(e){return n(e.currentTarget.value)}}),(0,N.BX)("pre",{children:["metadata override preview:",l]}),(0,N.tZ)("br",{}),(0,N.BX)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.tZ)(po.Z,{color:"positive",onClick:function(){pr.Z.set("gurl",t),window.location.reload()},children:"Set gurl and reload"}),(0,N.tZ)(po.Z,{color:"yellow",onClick:function(){pr.Z.set("gurl","wss://eval.canary.replit.com"),window.location.reload()},children:"Switch to canary & reload"}),(0,N.tZ)(po.Z,{color:"orange",onClick:function(){pr.Z.remove("gurl"),window.location.reload()},children:"Unset gurl and reload"})]}),(0,N.tZ)("br",{}),(0,N.tZ)("br",{}),(0,N.tZ)("div",{children:pr.Z.get("gurl","string")?"currently in localStorage: ".concat(pr.Z.get("gurl","string")):'No gurl set in local storage, using default gurl for this user, check "Token" tab for details'}),(0,N.tZ)("br",{}),(0,N.tZ)("br",{}),"Gurl order of precedence:",(0,N.BX)("ol",{style:{margin:20},children:[(0,N.tZ)("li",{children:"gurl in localStorage (set above)"}),(0,N.BX)("li",{children:["If in development webapp and a theres a response from",(0,N.tZ)("code",{children:"https://localhost:4563"})," or",(0,N.BX)("code",{children:["http://localhost:",4560]}),", then it will use that."]}),(0,N.BX)("li",{children:["default is ",(0,N.tZ)("code",{children:"wss://eval.<usercluster>.replit.com"})]})]}),(0,N.BX)($.G,{css:[Y.l0.pt(16),Y.l0.border({direction:"top"})],children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Override Database"}),(0,N.tZ)(pi.ZP,{type:"text",value:i,onChange:function(e){o(e.target.value)}}),(0,N.tZ)($.G,{css:[Y.l0.rowWithGap(8)],children:(0,N.tZ)(po.Z,{color:"positive",onClick:function(){a(i)},children:"Override Postgres connection string"})})]})]})}),(0,U._)(T,"rum",function(){var e,t=null===(e=ph.v.getInternalContext())||void 0===e?void 0:e.session_id,n=ph.v.getInitConfiguration(),r=null!=n&&100===n.sampleRate,i=(0,L._)((0,O.useState)(null!=t),2),o=i[0],a=i[1];return(0,N.tZ)($.G,{css:[Y.l0.colWithGap(16),Y.l0.p(4)],children:r?(0,N.BX)(N.HY,{children:[(0,N.tZ)(eW.zx,{onClick:o?function(){ph.v.stopSessionReplayRecording(),document.cookie="_dd_s=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",window.location.href=window.location.href.split("?")[0]}:function(){(0,hL.Oo)({name:"replitOnReplit"}),setTimeout(function(){a(!0)},1e3)},text:o?"\uD83D\uDD34 Recording... Click to stop and reload page":"Start Recording",colorway:o?void 0:"primary",css:(0,eU._)({},o&&ez.p.backgroundPulse(Y.TV.redDimmest,Y.TV.redDimmer))}),o?(0,N.tZ)(pp,{sessionId:t}):null]}):(0,N.tZ)(eW.zx,{onClick:function(){window.location.href=window.location.href.split("?")[0].split("#")[0]+"?rum=1"},text:"Click to reload and start recording",colorway:"primary"})})}),T),pv=Object.values(E);function pg(e){var t=e.paneOptions,n=(0,L._)((0,O.useState)("repl"),2),r=n[0],i=n[1],o=pv.map(function(e){return(0,N.tZ)(eW.zx,{colorway:e===r?"primary":void 0,onClick:function(){return i(e)},text:e},e)});return(0,N.BX)(eq.Tg,{background:"default",css:[Y.l0.colWithGap(8),Y.l0.p(4),Y.l0.height("100%")],children:[(0,N.tZ)($.G,{css:{flexWrap:"wrap",flexDirection:"row",gap:"4px"},children:o}),(0,N.tZ)($.G,{css:[Y.l0.flex.growAndShrink(1),Y.l0.overflow("auto")],children:Object.entries(pm).map(function(e){var n=(0,L._)(e,2),i=n[0],o=n[1];return(0,N.tZ)($.G,{css:i!==r&&Y.l0.display.none,children:"override"===i&&"override"!==r?null:(0,N.tZ)(o,{isHidden:t.isHidden||r!==i})},i)})})]})}var py=n(87279),pb=es.Type.Object({type:es.Type.Literal("adminPanel")}),pZ={Content:function(e){var t=e.options;return(0,N.tZ)(pg,{paneOptions:t})},Icon:function(e){var t=e.size;return(0,N.tZ)(py.Z,{color:"red",size:t})},getTitle:function(){return"Debug"},decode:function(e){return eu.B4.Decode(pb,e)}},pw=n(9617),px=n(71064),pC=n(35034),p_=n(15006);function pk(){var e=(0,ns._)(["\n  query SshConfigurator($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        replcoSSHUrl: hostedUrl(dotty: true)\n        owner {\n          __typename\n          ... on Team {\n            id\n            isTeamsPro: subscriptionIsType(subscriptionType: PRO)\n          }\n          ... on User {\n            id\n            username\n          }\n        }\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n      ... on SubscriptionExpiredError {\n        replId\n      }\n    }\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return pk=function(){return e},e}var pS={},pE=(0,nu.Ps)(pk()),pT=n(21557),pR=n(24801),pI=n(2454),pD=n(84731),pG=n(90513),pB=n(86612),pP=["ssh-dsa","ssh-ecdsa","ssh-ed25519","ssh-rsa"];function pA(e){var t=e.code,n=e.multiline;return(0,N.BX)(eq.Tg,{tag:"pre",elevated:!0,css:[Y.l0.borderRadius(8),Y.l0.p(8),Y.l0.rowWithGap(8)],children:[(0,N.tZ)(J.xv,{multiline:n,css:[Y.l0.overflow("auto"),Y.l0.font.code,Y.l0.flex.growAndShrink(1),{"::-webkit-scrollbar":[Y.l0.display.none]}],maxLines:n?void 0:1,children:t}),(0,N.tZ)(e_.hU,{onClick:function(){return(0,tz.Z)(t)},alt:"Copy",children:(0,N.tZ)(tV.Z,{})})]})}function pN(e,t){if(!e)return"Please add a key for this secret";if(!e.trim())return"The key must include a non-space character";if(t.includes(e))return"You already have this key";var n=e.split(" ");return 3!==n.length?"This seems to be an invalid key.":pP.includes(n[0])?null:"Key type is not valid."}function pU(e){return(0,N.BX)($.G,{css:[Y.l0.colWithGap(4)],children:[(0,N.tZ)("label",{htmlFor:e.id,children:(0,N.tZ)(J.xv,{variant:"small",color:"dimmer",multiline:!1,children:e.label})}),e.children,e.error?(0,N.BX)($.G,{css:[Y.l0.rowWithGap(2),Y.l0.align.center],children:[(0,N.tZ)(p_.Z,{}),(0,N.tZ)(J.xv,{variant:"small",css:Y.l0.color.accentNegativeStrongest,multiline:!1,children:e.error})]}):null]})}function pL(e){var t,n=e.authorizedKey,r=e.otherKeys,i=e.onUpdateKey,o=e.onSave,a=(0,L._)(O.useState(),2),l=a[0],c=a[1],s=O.useRef(null),u=function(){var e=pN(n.key,r);if(e){c(e),s.current&&s.current.focus();return}o()};O.useEffect(function(){!l||pN(n.key,r)||c(null)},[n.key,l,r]);var d=(t=function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),u())},function(e){e.stopPropagation(),t(e)}),f=(0,s7.d)(),h=(0,rV.U)()("key");return(0,N.BX)(eq.Tg,{elevated:!0,css:[Y.l0.p(16),Y.l0.borderRadius(8),Y.l0.colWithGap(16)],children:[r&&0!==r.length?null:(0,N.tZ)(J.xv,{children:"Before you can SSH to your Repl, you need to add an SSH key."}),(0,N.tZ)(pU,{id:h,label:"Key (in OpenSSH Public Key format)",error:l,children:(0,N.tZ)(tF.II,{id:h,ref:s,name:"key",value:n.key,spellCheck:!1,onChange:function(e){i(e.currentTarget.value)},onKeyDown:d})}),pT.ED||f?(0,N.tZ)($.G,{css:[Y.l0.colWithGap(8)],children:(0,N.BX)(J.xv,{children:["Need a hand? The"," ",(0,N.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"SSH documentation"})," ","provides information about generating SSH keys."]})}):(0,N.BX)($.G,{css:[Y.l0.colWithGap(8)],children:[(0,N.tZ)(J.xv,{children:"Need a hand? Generate a key:"}),(0,N.tZ)(pA,{code:'[ -s ~/.ssh/replit.pub ] || ssh-keygen -t ed25519 -f ~/.ssh/replit -q -N "" && cat ~/.ssh/replit.pub',multiline:!1}),(0,N.tZ)(J.xv,{children:"Paste the result in the form above."})]}),(0,N.tZ)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.justify.spaceBetween],children:(0,N.tZ)($.G,{css:Y.l0.rowWithGap(8),children:(0,N.tZ)(eW.zx,{colorway:"primary",onClick:u,text:"Add SSH Key"})})})]})}function pO(e){var t=e.onAdd,n=e.otherKeys,r=(0,L._)(O.useState({key:""}),2),i=r[0],o=r[1];return(0,N.tZ)(pL,{authorizedKey:i,otherKeys:n,onUpdateKey:function(e){o(function(t){return t?(0,eL._)((0,eU._)({},t),{key:e}):t})},onSave:function(){o({key:""}),i.key&&t(i)}})}function pX(e){var t=e.authorizedKey,n=e.onDelete;return(0,N.BX)($.G,{css:[lz.gU.filled,Y.l0.p(8),Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.justify.spaceBetween,Y.l0.borderRadius(8)],children:[(0,N.tZ)(px.Z,{size:24}),(0,N.BX)(J.xv,{css:[Y.l0.flex.growAndShrink(1)],maxLines:1,multiline:!1,children:[t.keytype," ",t.key.substring(0,8),"...",t.key.substring(t.key.length-8)," ",t.comment]}),(0,N.tZ)(e_.hU,{onClick:function(){return n(t)},alt:"Delete",size:28,children:(0,N.tZ)(pC.Z,{})})]})}function pM(e){var t=e.authorizedKeys,n=e.onAdd,r=e.onDelete;return(0,N.BX)($.G,{css:Y.l0.colWithGap(16),children:[(0,N.tZ)(pw.Z,{level:4,children:"Manage SSH Keys"}),Object.values(t).map(function(e){return(0,N.tZ)(pX,{authorizedKey:e,onDelete:r},e.key)}),(0,N.tZ)(pO,{onAdd:n,otherKeys:Object.keys(t)})]})}function pF(e){if(!e.length)return null;var t=e.split(" ");return t.length<3?null:{keytype:t[0],key:t[1],comment:t[2]}}function pW(e){var t=e.sshHostname,n=e.sshUser,r=e.sshPort,i="ssh -i ~/.ssh/replit -p ".concat(r," ").concat(n,"@").concat(t);return(0,N.BX)($.G,{css:Y.l0.colWithGap(16),children:[(0,N.tZ)(pw.Z,{level:5,children:"1. Quick-Connect SSH Command"}),(0,N.tZ)(J.xv,{children:"You can connect to this Repl directly using the command below without any further configuration on your machine"}),(0,N.tZ)(pA,{code:i,multiline:!1})]})}function pH(e){var t=e.initialAlias,n=e.sshHostname,r=e.sshUser,i=e.sshPort,o=(0,L._)(O.useState(t),2),a=o[0],l=o[1],c=a||t,s="Host ".concat(c,"\n  Hostname ").concat(n,"\n  Port ").concat(i,"\n  User ").concat(r,"\n  IdentityFile ~/.ssh/replit");return(0,N.BX)($.G,{css:Y.l0.colWithGap(16),children:[(0,N.tZ)(pw.Z,{level:5,children:"2. SSH Configuration File"}),(0,N.BX)(J.xv,{children:["By adding a host entry to your SSH configuration file (typically"," ",(0,N.BX)(J.xv,{css:[Y.l0.font.code,Y.l0.display.inline,Y.l0.align.baseline],children:[pT.ED?"%HOMEPATH%":"~","/.ssh/config"]}),"), you can simplify the connection process and give this Repl an alias."]}),(0,N.BX)($.G,{css:Y.l0.colWithGap(4),children:[(0,N.tZ)(J.xv,{children:"Host"}),(0,N.tZ)(J.xv,{variant:"small",color:"dimmer",children:"Enter an alias for this Repl's SSH connection. This can be anything but it can only contain letters, numbers, dots, hyphens, and underscores are allowed, it also has to be unique on your machine."}),(0,N.tZ)(tF.II,{css:[Y.l0.flex.grow(1),0===a.length?{borderColor:"".concat(Y.TV.accentNegativeDefault," !important"),borderStyle:"solid !important",borderWidth:"1px !important",outlineColor:"".concat(Y.TV.accentNegativeDefault," !important")}:null],value:a,spellCheck:!1,onChange:function(e){e.currentTarget.value.match(/^[a-zA-Z0-9.\-_]*$/)&&l(e.currentTarget.value)}})]}),(0,N.BX)($.G,{css:Y.l0.colWithGap(4),children:[(0,N.tZ)(J.xv,{children:"Configuration file"}),(0,N.tZ)(pA,{code:s,multiline:!0})]}),(0,N.BX)($.G,{css:Y.l0.colWithGap(4),children:[(0,N.tZ)(J.xv,{children:"Then connect using the following command"}),(0,N.tZ)(pA,{code:"ssh ".concat(c),multiline:!1})]})]})}function pV(e){var t=e.sshHostname,n=e.sshUser,r=e.sshPort;return(0,N.BX)($.G,{css:Y.l0.colWithGap(16),children:[(0,N.tZ)(pw.Z,{level:5,children:"3. SSH Client Configuration"}),(0,N.tZ)(J.xv,{children:"There are many SSH clients available. Some even come with a graphical interface such as PuTTY (on Windows) or Termius (on Mac). You can configure your SSH key and the following values:"}),(0,N.BX)($.G,{children:[(0,N.BX)($.G,{css:Y.l0.colWithGap(2),children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Hostname"}),(0,N.tZ)(pA,{code:t,multiline:!1})]}),(0,N.BX)($.G,{css:Y.l0.colWithGap(2),children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Username"}),(0,N.tZ)(pA,{code:n,multiline:!1})]}),(0,N.BX)($.G,{css:Y.l0.colWithGap(2),children:[(0,N.tZ)(J.xv,{multiline:!1,children:"Port"}),(0,N.tZ)(pA,{code:r,multiline:!1})]})]})]})}function pz(e){var t=e.replId,n=function(e){var t=e.replId,n=e.replcoHostname,r=(0,iA.P5)({controlName:"flag-dot-dev-url",logFlagToAnalytics:!1}),i=(0,H.Z)().container,o=(0,pB.Z)(i);if(r&&o){var a=new URL(o).host,l=a.indexOf(":"),c="22";return -1!==l&&(a=a.substring(0,l),c="2022"),{sshUser:t,sshHostname:a,sshPort:c}}return{sshUser:t,sshHostname:n,sshPort:"22"}}({replId:t,replcoHostname:e.replcoHostname}),r=n.sshHostname,i=n.sshUser,o=n.sshPort;return(0,N.BX)($.G,{css:Y.l0.colWithGap(32),children:[(0,N.BX)($.G,{css:Y.l0.colWithGap(8),children:[(0,N.tZ)(pw.Z,{level:4,children:"Connecting to this Repl"}),(0,N.tZ)(J.xv,{children:"Now that you have setup an SSH key. There are three ways you can connect to this Repl."})]}),(0,N.tZ)(pW,{sshHostname:r,sshUser:i,sshPort:o}),(0,N.tZ)(pH,{initialAlias:t,sshHostname:r,sshUser:i,sshPort:o}),(0,N.tZ)(pV,{sshHostname:r,sshUser:i,sshPort:o})]})}function pj(){return(pj=(0,eO._)(function(e){return(0,eX.Jh)(this,function(t){switch(t.label){case 0:return[4,e.createDir(".config")];case 1:return t.sent(),[4,e.createDir(".config/ssh")];case 2:return t.sent(),[2]}})})).apply(this,arguments)}function pq(e){var t,n,r,i=e.replId,o=e.replcoHostname,a=(0,H.Z)().fs,l=(0,u_.Z)(),c=(0,L._)(O.useState(null),2),s=c[0],u=c[1];O.useEffect(function(){function e(){return(e=(0,eO._)(function(){var e,t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:return[4,function(e){return pj.apply(this,arguments)}(a)];case 1:return n.sent(),[4,a.readFile(".config/ssh/.authorized_keys")];case 2:if((e=n.sent()).error===er.Df.NotFound)return l.current&&u({}),[2];if(e.error)throw Error("Error getting .authorized_keys");if(!l.current)return[2];return t={},e.content.toString().split("\n").forEach(function(e){if(!e.startsWith("#")){var n=pF(e);null!==n&&(t[n.key]=n)}}),u(t),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[a,u,l]);var d=(t=(0,eO._)(function(e){var t,n;return(0,eX.Jh)(this,function(r){switch(r.label){case 0:if(!s)throw Error("trying to write authorized keys before loading");return u(t=function(e,t){var n=(0,eU._)({},e);if("add"===t.type){var r=pF(t.key);r&&(n[r.key]=r)}else delete n[t.key];return n}(s,e)),n="# generated file, use the SSH tool instead of editing\n"+Object.values(t).map(function(e){return"".concat(e.keytype," ").concat(e.key," ").concat(e.comment)}).join("\n"),[4,a.writeFile(".config/ssh/.authorized_keys",rH.Z.from(n))];case 1:return r.sent(),[2]}})}),function(e){return t.apply(this,arguments)}),f=(n=(0,eO._)(function(e){return(0,eX.Jh)(this,function(t){switch(t.label){case 0:return[4,d((0,eU._)({type:"add"},e))];case 1:return t.sent(),(0,rl.j)(rl.U3.SSH_CONFIGURATOR_USED,{action:"added"}),[2]}})}),function(e){return n.apply(this,arguments)}),h=(r=(0,eO._)(function(e){return(0,eX.Jh)(this,function(t){switch(t.label){case 0:return[4,d({type:"delete",key:e.key})];case 1:return t.sent(),(0,rl.j)(rl.U3.SSH_CONFIGURATOR_USED,{action:"deleted"}),[2]}})}),function(e){return r.apply(this,arguments)});return s?(0,N.BX)($.G,{css:Y.l0.colWithGap(16),children:[(0,N.BX)(J.xv,{variant:"small",color:"dimmer",children:["Add authorized keys to configure SSH access to this Repl."," ",(0,N.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"Learn more here"}),"."]}),(0,N.BX)($.G,{css:Y.l0.colWithGap(32),children:[(0,N.tZ)(pM,{authorizedKeys:s,onAdd:f,onDelete:h}),Object.keys(s).length>0?(0,N.tZ)(pz,{replId:i,replcoHostname:o}):null]})]}):(0,N.tZ)($.G,{css:[Y.l0.center,Y.l0.coverContainer],children:(0,N.tZ)(eE.Z,{size:24})})}function pY(e){var t=e.onPurchaseComplete,n=(0,L._)(O.useState(!1),2),r=n[0],i=n[1],o=(0,pD.Q)();return(0,N.BX)($.G,{css:[Y.l0.colWithGap(16)],children:[(0,N.BX)(J.h4,{level:3,variant:"subheadDefault",children:["SSH is only available to Replit ",o," Members."]}),(0,N.BX)(J.xv,{children:["With SSH, you can access your Repl's shell remotely. SSH enables workflows like easy file transfer or using your favorite local IDE to edit your code on Replit."," ",(0,N.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"Learn more here"})]}),(0,N.tZ)(eW.zx,{onClick:function(){return i(!0)},text:"Join Replit ".concat(o),iconLeft:(0,N.tZ)(pI.Z,{}),colorway:"blurple"}),(0,N.tZ)(pG.Z,{isOpen:r,onClose:function(){return i(!1)},type:"purchase",onPurchaseComplete:t,analyticsContext:{upgrade:{context:"cycles_page"}}})]})}function p$(){var e,t,n,r=(t={variables:{replId:(0,nc.Z)()}},n=(0,eU._)({},pS,t),nd.a(pE,n)),i=r.data,o=r.loading,a=r.refetch;if(!i||o)return(0,N.tZ)($.G,{css:[Y.l0.center,Y.l0.coverContainer],children:(0,N.tZ)(eE.Z,{size:24})});if("ReplRedirect"===i.repl.__typename)throw Error("Got repl redirect for replId query");if("SubscriptionExpiredError"===i.repl.__typename)return(0,N.tZ)($.G,{children:(0,N.tZ)(J.xv,{children:"This Repl is private and your subscription expried. Please reload for further action."})});if(!i.currentUser)return(0,N.tZ)($.G,{children:(0,N.tZ)(J.xv,{children:"You must be logged in to use SSH."})});var l=(0,pR.jX)(i.currentUser.userSubscriptionType),c=(null===(e=i.repl.owner)||void 0===e?void 0:e.__typename)==="Team"&&i.repl.owner.isTeamsPro;return l||c?(0,N.tZ)(pq,{replId:i.repl.id,replcoHostname:new URL(i.repl.replcoSSHUrl).hostname}):(0,N.tZ)(pY,{onPurchaseComplete:function(){a()}})}function pJ(e){var t=e.children;return(0,N.tZ)($.G,{css:[Y.l0.height("100%"),Y.l0.overflowY("auto"),tX.F3],children:(0,N.BX)($.G,{css:[Y.l0.p(8),Y.l0.colWithGap(8),Y.l0.flex.grow(1)],children:[(0,N.tZ)($.G,{css:[Y.l0.rowWithGap(8)],children:(0,N.tZ)(pw.Z,{truncate:!0,level:4,children:"SSH Configuration"})}),(0,N.tZ)($.G,{css:[Y.l0.flex.grow(1),Y.l0.py(8),Y.l0.position.relative],children:t})]})})}var pK=n(89788),pQ=es.Type.Object({type:es.Type.Literal("sshConfigurator")}),p0={Content:function(){return(0,N.tZ)(p1,{})},Icon:function(e){var t=e.size;return(0,N.tZ)(pK.Z,{size:t})},getTitle:function(){return"SSH"},decode:function(e){return eu.B4.Decode(pQ,e)}};function p1(){return(0,N.tZ)(pJ,{children:(0,N.tZ)(p$,{})})}var p2=n(73030),p8=n(73164),p4=n(12880),p3=n(19408),p5=n(19615),p6=function(e){return"color-mix(in srgb, ".concat(iY.TV.blurpleDefault," ").concat(100*e,"%, transparent)")},p9=Y.nC.min(440),p7=(0,K.X)({root:[Y.l0.reset.button,lz.gU.filled,Y.l0.borderRadius(4),Y.l0.align.center,Y.l0.p(6),Y.l0.color.blurpleDefault,Y.l0.cursor.pointer,Y.l0.align.start,(R={},(0,U._)(R,p9,[Y.l0.rowWithGap(4),Y.l0.align.center]),(0,U._)(R,lz.dj.interactiveBackground,p6(.1)),(0,U._)(R,lz.dj.interactiveBackgroundActive,p6(.2)),R)],iconText:Y.l0.rowWithGap(4)});function me(e){return(0,N.BX)($.G,{css:p7.root,onClick:e.onClick,children:[(0,N.BX)($.G,{css:p7.iconText,children:[(0,O.cloneElement)(e.icon,{size:16,color:iY.TV.blurpleDefault}),(0,N.tZ)(J.xv,{variant:"small",children:e.text})]}),(0,N.tZ)(J.xv,{variant:"small",color:"dimmer",children:e.description})]})}var mt=(0,K.X)({root:[Y.l0.flex.growAndShrink(1),Y.l0.position.relative,Y.l0.overflow("auto"),Y.l0.display.block],content:[Y.l0.py(32),Y.l0.px(32),Y.l0.center,Y.l0.colWithGap(12),Y.l0.minHeight("100%")],header:[Y.l0.colWithGap(8),Y.l0.align.center,Y.l0.maxWidth(370),Y.l0.textAlign.center],buttons:[Y.l0.colWithGap(8),(0,U._)({},p9,[Y.l0.align.center])]});function mn(e){var t,n,r,i,o=e.promptEditor,a=(r=(n=(0,L._)((0,hR.AA)(),1)[0])?p8.$R.from(n):null,i=null!=n?n:"filename.js",[{icon:(0,N.tZ)(p4.Z,{}),title:"Generate",description:"Create a personal assistant chatbot",action:"GENERATE"},{icon:(0,N.tZ)(py.Z,{}),title:"Debug",description:"Fix the logic of updating price?",action:"DEBUG"},{icon:(0,N.tZ)(p3.Z,{}),title:"Explain",description:"How does ".concat(i," work?"),action:"EXPLAIN",promptToFill:n?"How can I improve the code in "+n:"How can I improve the code in "},{icon:(0,N.tZ)(p3.Z,{}),title:"Ask replit.com",description:"How to deploy a ".concat(null!==(t=null==r?void 0:r.name)&&void 0!==t?t:"python"," project?"),action:"REPLIT_DOCS"}]),l=(0,ar.Qn)();return o?(0,N.tZ)($.G,{css:mt.root,children:(0,N.BX)($.G,{css:mt.content,children:[(0,N.BX)($.G,{css:mt.header,children:[(0,N.tZ)(p5.R,{advanced:!0}),(0,N.tZ)(J.xv,{variant:"subheadBig",children:"Replit AI"}),(0,N.tZ)(J.xv,{color:"dimmest",children:"Use Replit AI to set up new projects, answer questions about your code, and assist your thinking."})]}),(0,N.tZ)($.G,{css:mt.buttons,children:a.map(function(e){return(0,N.tZ)(me,{icon:e.icon,text:e.title,description:e.description,onClick:function(){var t,n,r;r=null!==(n=e.promptToFill)&&void 0!==n?n:e.description,l(e.action),(0,rl.j)(rl.U3.GHOSTWRITER_CHAT_EXAMPLE_CLICKED,{title:e.title}),null==o||null===(t=o.setValue)||void 0===t||t.call(o,r),null==o||o.focus()}},e.action)})})]})}):null}var mr=function(){return(0,N.BX)($.G,{css:[Y.l0.colWithGap(16),Y.l0.align.center,Y.l0.p(24),Y.l0.height("100%"),Y.l0.justify.center],children:[(0,N.tZ)($.G,{css:[Y.l0.maxWidth(200)],children:(0,N.tZ)(od.Z,{src:"/public/images/ghostwriter/orb.png",css:[{userSelect:"none",mixBlendMode:"screen",filter:"brightness(110%) saturate(1.2)",maskImage:"linear-gradient(".concat(Y.TV.backgroundRoot,", transparent)")}],width:200,height:200,objectFit:"contain","aria-hidden":"true",alt:"",draggable:!1})}),(0,N.tZ)(J.xv,{variant:"subheadBig",multiline:!1,children:"Chat with Replit AI"}),(0,N.BX)($.G,{css:[Y.l0.rowWithGap(8),Y.l0.align.center],children:[(0,N.tZ)(eE.Z,{}),(0,N.tZ)(J.xv,{color:"dimmer",multiline:!1,children:"Loading"})]})]})},mi=n(43409),mo=n(84657),ma=n(28121),ml=n(43481),mc=n(57678),ms=n(20766),mu=(0,K.X)({messageWrapper:[Y.l0.px(8),Y.l0.py(12),Y.l0.colWithGap(8)],advancedModelOverrideForHexagonGwAvatar:[{"& > div > div":{borderRadius:0,backgroundColor:"transparent"},"& > div > div:before":{display:"none"},'& img:not([aria-hidden="true"])':{objectFit:"fill !important"}}],ghostwriterPurpleBackground:[{background:"linear-gradient(90.7deg, rgba(82, 57, 204, 0.1) 0.6%, rgba(166, 148, 255, 0.1) 137.79%)"}]}),md=(0,K.X)({headerWrapper:[Y.l0.rowWithGap(4),Y.l0.align.center],feedbackContent:[Y.l0.backgroundColor.backgroundHigher,Y.l0.colWithGap(4),Y.l0.borderRadius(8),Y.l0.py(4),Y.l0.px(8)],messagePreview:[Y.l0.colWithGap(4),Y.l0.borderRadius(4),Y.l0.py(4),Y.l0.px(8),mu.ghostwriterPurpleBackground,Y.l0.border({color:Y.TV.blurpleDefault,style:"solid",direction:"left",width:2})],userFeedbackWrapper:[Y.l0.rowWithGap(4),Y.l0.align.center,Y.l0.justify.start],userFeedbackText:[Y.l0.flex.growAndShrink(1),Y.l0.width("100%")]}),mf=function(e){var t=e.message,n=e.currentUser,r=e.autoScroll,i=t.useAdvancedModel,o=t.text,a=t.feedbackProvidedMessage;if(!n)throw Error("Expecting a current user to render a feedback message");if(!a)throw Error("Expecting a feedback provided message to render a feedback message");var l=(0,O.useRef)(null),c=(0,mo.rM)();return(0,O.useLayoutEffect)(function(){r&&l.current&&requestAnimationFrame(function(){r&&l.current&&((0,X.Z)(l.current,{skipOverflowHiddenElements:!0,behavior:"auto",scrollMode:"always"}),c(!0))})}),(0,N.BX)($.G,{css:mu.messageWrapper,children:[(0,N.BX)($.G,{css:md.headerWrapper,children:[(0,N.tZ)(p5.R,{advanced:i}),(0,N.tZ)(J.xv,{multiline:!1,children:"recorded feedback"}),(0,N.tZ)(nU.Z,{color:Y.TV.greenStronger})]}),(0,N.BX)($.G,{css:md.feedbackContent,children:[(0,N.tZ)($.G,{css:md.messagePreview,children:(0,N.tZ)(J.xv,{multiline:!1,maxLines:1,children:a.text})}),(0,N.BX)($.G,{css:md.userFeedbackWrapper,children:[(0,N.tZ)(l7.q,{src:n.image,username:n.username}),(0,N.tZ)(J.xv,{css:md.userFeedbackText,children:o})]})]}),(0,N.tZ)($.G,{innerRef:l})]})},mh=n(6079),mp=(0,K.X)({root:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.p(4),{borderBottom:"1px solid "+Y.TV.outlineDimmest}]});function mm(){var e=(0,hF.Cp)(),t=new Date(null===e?Date.now():e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0});return(0,N.tZ)(eq.Tg,{css:mp.root,children:(0,N.BX)(J.xv,{variant:"small",color:"dimmer",children:[t," Session"]})})}var mv=n(54254),mg=n(22580),my=n(92101),mb=n(8017),mZ=(0,K.X)({root:[Y.l0.borderRadius(4),Y.l0.border({color:Y.TV.outlineDimmest})],header:[Y.l0.rowWithGap(4),Y.l0.border({color:Y.TV.outlineDimmest,direction:"bottom"})],button:[{borderRadius:0,borderTopLeftRadius:4}]});function mw(e){var t=e.codeReference,n=e.onClick;return(0,N.BX)($.G,{css:mZ.root,children:[(0,N.tZ)($.G,{css:mZ.header,children:(0,N.tZ)(eW.zx,{css:mZ.button,size:"small",variant:"nofill",iconLeft:(0,N.tZ)(aI.Z,{size:12,path:t.filePath}),iconRight:(0,N.tZ)(mb.Z,{}),text:"".concat(t.filePath," ").concat(t.range.lineFrom,":").concat(t.range.lineTo),onClick:n})}),(0,N.tZ)(hz.Z,{lineNumbers:!0,lineNumbersStart:t.range.lineFrom,language:t.language,code:t.code,filePath:t.filePath})]})}var mx=n(15542);function mC(){var e=(0,ns._)(["\n  query AiChatUserMessage($userId: Int!) {\n    user(id: $userId) {\n      id\n      username\n      image\n    }\n  }\n"]);return mC=function(){return e},e}var m_={},mk=(0,nu.Ps)(mC()),mS=(0,K.X)({root:[Y.l0.colWithGap(8),Y.l0.px(8),Y.l0.pb(8)],header:[Y.l0.rowWithGap(8),Y.l0.align.center]}),mE=(0,O.memo)(function(e){var t,n=e.id,r=e.openFile,i=(0,ar.qQ)(n),o=(0,mx.d)(),a=(t=(0,eU._)({},m_,{variables:{userId:o||-1},skip:!o}),nd.a(mk,t)).data,l=null==a?void 0:a.user,c=(0,tk.Z)(function(){return(0,my.BW)(n)},[n]);if(!i||!l)return null;var s="TRANSFORM"===i.intent?void 0:c;return(0,N.BX)($.G,{css:mS.root,children:[(0,N.BX)($.G,{css:mS.header,children:[(0,N.tZ)(mv.n,{username:l.username,src:l.image,small:!0}),i.timeCreated?(0,N.tZ)(cd.EK,{live:!0,date:i.timeCreated}):null]}),"EXPLAIN"===i.intent?(0,N.BX)(N.HY,{children:[(0,N.tZ)(mg.J,{text:"Explain code",codeComponent:s}),i.codeReference?(0,N.tZ)(mw,{codeReference:i.codeReference,onClick:function(){i.codeReference&&r({path:i.codeReference.filePath,line:i.codeReference.range.lineTo})}}):null]}):(0,N.tZ)(mg.J,{text:i.text})]})}),mT=n(91608),mR=n(27592),mI=n(31950),mD=n(59173),mG=(0,mT.$)(["transform","opacity"]),mB=mG.cssVars,mP=mG.styleTokens,mA=(0,K.X)({root:[Y.l0.position.relative,{height:0}],container:[Y.l0.position.absolute,Y.l0.bottom(0),Y.l0.left("50%"),{transitionProperty:["opacity","transform"],transitionTimingFunction:M.H.timingFunction,transitionDuration:M.H.duration,opacity:mP.opacity,transform:mP.transform}],button:[Y.l0.reset.button,lz.gU.filledAndOutlined,Y.l0.p(4),Y.l0.rowWithGap(4),Y.l0.align.center,Y.l0.borderRadius(16),Y.l0.shadow(1)]}),mN={hidden:(I={},(0,U._)(I,mB.opacity,"0"),(0,U._)(I,mB.transform,"translate(-50%, ".concat(Y.TV.space4,")")),I),visible:(D={},(0,U._)(D,mB.opacity,"1"),(0,U._)(D,mB.transform,"translate(-50%, calc(-1 * ".concat(Y.TV.space4,"))")),D)};function mU(e){var t=e.visible,n=e.onClick,r=(0,O.useRef)(null);return(0,mI.j)(r,t,function(e){return e?mN.visible:mN.hidden}),(0,N.tZ)($.G,{innerRef:r,css:mA.root,children:(0,N.tZ)($.G,{css:mA.container,children:(0,N.BX)(eq.Tg,{css:mA.button,elevated:!0,tag:"button",onClick:n,children:[(0,N.tZ)(cV.Z,{size:12}),(0,N.tZ)(J.xv,{variant:"small",children:"Scroll to latest"})]})})})}var mL=n(98188),mO=n(29128),mX=n(39511),mM=n(44124),mF=n(7612),mW={layer:"cm-placeholder-layer",dom:"cm-placeholder-dom"},mH=nL.tk.theme((G={},(0,U._)(G,".".concat(mW.layer),{width:"100%",height:"100%",pointerEvents:"none"}),(0,U._)(G,".".concat(mW.dom),{position:"absolute",width:"100%",pointerEvents:"none",fontFamily:iY.TV.fontFamilyDefault,color:iY.TV.foregroundDimmest}),G)),mV=function(e){return 0===e.doc.length},mz=nX.QQ.define({create:mV,update:function(e,t){return mV(t.state)}}),mj=[mz,mH,(0,nL.EY)({above:!1,class:mW.layer,update:function(e){return(0,mF.a)(e,mz)},markers:function(e){if(!e.state.field(mz))return[];var t=e.coordsAtPos(0);if(!t)return[];var n=e.dom.getBoundingClientRect(),r=t.left-n.left,i=t.top-n.top,o=t.bottom-t.top;return[{draw:function(){var e=document.createElement("div");return e.className=mW.dom,e.textContent="Type message...",e.style.width="100%",e.style.paddingTop=i+"px",e.style.paddingLeft=r+"px",e.style.height=o+"px",e},eq:function(){return!0}}]}})],mq=n(83807),mY=n(72443),m$=n(1415),mJ=n(56158),mK=[{title:"Ask AI",description:"Detect actions based on the prompt",action:"NONE",icon:(0,N.tZ)(mq.Z,{})},{title:"Generate",description:"Write starter code/tests",action:"GENERATE",icon:(0,N.tZ)(p4.Z,{})},{title:"Modify",description:"Refactor existing features",action:"TRANSFORM",icon:(0,N.tZ)(p4.Z,{})},{title:"Explain",description:"Ask a question about your code",action:"EXPLAIN",icon:(0,N.tZ)(p3.Z,{})},{title:"Ask replit.com",description:"Ask about how to do things on Replit",action:"REPLIT_DOCS",icon:(0,N.tZ)(p3.Z,{})}],mQ=(0,K.X)({root:[Y.l0.rowWithGap(8),Y.l0.px(8),Y.l0.py(4),Y.l0.cursor.pointer,lz.gU.listItem],header:[Y.l0.rowWithGap(4),Y.l0.align.center],content:[Y.l0.flex.growAndShrink(1)]});function m0(e){var t=e.mode,n=e.selected,r=e.highlighted;return(0,N.BX)($.G,{css:mQ.root,style:r?{backgroundColor:lz.vb.interactiveBackground}:void 0,children:[(0,N.BX)($.G,{css:mQ.content,children:[(0,N.BX)($.G,{css:mQ.header,children:[(0,O.cloneElement)(t.icon,{size:16,color:Y.TV.blurpleDefault}),(0,N.tZ)(J.xv,{variant:"small",children:t.title})]}),(0,N.tZ)(J.xv,{variant:"small",color:"dimmest",children:t.description})]}),n?(0,N.tZ)(nU.Z,{color:Y.TV.foregroundDimmer}):null]})}var m1=(0,K.X)({button:[Y.l0.reset.button,lz.gU.outlined,Y.l0.px(8),Y.l0.rowWithGap(4),Y.l0.borderRadius(8,0,0,8),Y.l0.height("100%"),Y.l0.align.center],button2:[Y.l0.reset.button,Y.l0.p(4),Y.l0.cursor.pointer,Y.l0.rowWithGap(4),Y.l0.align.center,lz.gU.nofill,Y.l0.color.foregroundDimmest,{"&:hover":Y.l0.color.foregroundDefault}],heading:[Y.l0.px(8),Y.l0.py(4)]});function m2(){var e,t,n=(0,L._)((0,ar.fr)(),2),r=n[0],i=n[1],o=(0,mY.L7)({items:mK,selectedItem:null!==(t=mK.find(function(e){return e.action===r}))&&void 0!==t?t:mK.find(function(e){return"NONE"===e.action}),onSelectedItemChange:function(e){var t=e.selectedItem;t&&i(t.action)}}),a=(0,mJ.w)(),l=a.setTriggerEl,c=a.setPopoverEl,s=a.attributes,u=a.styles;return o.isOpen||o.getMenuProps({},{suppressRefError:!0}),(0,N.BX)(N.HY,{children:[(0,N.tZ)("label",(0,eL._)((0,eU._)({css:Y.l0.visuallyHidden},o.getLabelProps()),{children:"Select a mode for AI"})),(0,N.BX)($.G,(0,eL._)((0,eU._)({css:m1.button2},o.getToggleButtonProps({ref:l,refKey:"innerRef"})),{children:[o.selectedItem?(0,O.cloneElement)(o.selectedItem.icon,{size:12}):null,(0,N.tZ)(J.xv,{variant:"small",children:null===(e=o.selectedItem)||void 0===e?void 0:e.title})]})),o.isOpen?(0,N.tZ)(m$.h,{children:(0,N.tZ)(eq.Tg,(0,eL._)((0,eU._)({elevated:!0,style:u,innerRef:c,css:mJ.L.popover},s),{children:(0,N.BX)($.G,(0,eL._)((0,eU._)({},o.getMenuProps({refKey:"innerRef"})),{children:[(0,N.tZ)($.G,{css:m1.heading,children:(0,N.tZ)(J.xv,{color:"dimmest",variant:"small",children:"Select a mode"})}),mK.map(function(e,t){var n=e===o.selectedItem,r=t===o.highlightedIndex;return(0,N.tZ)($.G,(0,eL._)((0,eU._)({},o.getItemProps({refKey:"innerRef",item:e})),{children:(0,N.tZ)(m0,{mode:e,selected:n,highlighted:r},e.action)}),e.action)})]}))}))}):null]})}var m8=n(43151),m4=n(2581),m3=n(25202),m5=n(17225),m6=n(69119),m9=n(90841);function m7(){var e=(0,ny.Bx)(),t=(0,m9.U0)(),n=(0,m9.Xy)(),r=(0,L._)((0,O.useState)([]),2),i=r[0],o=r[1],a=(0,hA.v)();return(0,O.useEffect)(function(){var e;(e=(0,eO._)(function(){var e,n,r,i,a,l,c,s;return(0,eX.Jh)(this,function(u){switch(u.label){case 0:return e=new Set,[4,t()];case 1:return r=(n=u.sent().ghostwriterFileContext).fileContext,i=n.truncatedFiles,a=n.overflowingFiles,r.forEach(function(t){e.add(t.filePath)}),l=Array.from(e).map(function(e){return{path:e,inclusionStatus:"included"}}),c=i.map(function(e){return{path:e,inclusionStatus:"truncated"}}),s=a.map(function(e){return{path:e,inclusionStatus:"overflowing"}}),o((0,ex._)(l).concat((0,ex._)(c),(0,ex._)(s))),[2]}})}),function(){return e.apply(this,arguments)})()},[e,a,n,t]),i}var ve=n(21488),vt=n(76673);function vn(e){var t,n=(0,ny.AA)(),r=(0,ve.T)();return(0,O.useCallback)((t=(0,eO._)(function(t){var i,o,a,l,c;return(0,eX.Jh)(this,function(s){switch(s.label){case 0:return[4,e.listFiles()];case 1:if((i=s.sent()).error||!i.files)return[2,{error:null!==(o=i.error)&&void 0!==o?o:"Something went wrong",files:null}];if(a=i.files.filter(function(e){return!r(e)}),!t)return[3,3];return[4,(0,m5.Rz)(t,a)];case 2:return c=s.sent(),[3,4];case 3:c=(0,vt.Z)(a,{existing:n(),getKey:function(e){return e}}).map(function(e){return{path:e}}),s.label=4;case 4:return l=c,[2,{total:a.length,files:l,error:null}]}})}),function(e){return t.apply(this,arguments)}),[e,r,n])}var vr=(0,K.X)({root:[lz.gU.listItem,Y.l0.p(4),Y.l0.colWithGap(2)],content:[Y.l0.rowWithGap(8),Y.l0.align.center],left:[Y.l0.flex.growAndShrink(1),Y.l0.rowWithGap(4),Y.l0.align.center,{fontSize:Y.TV.fontSizeSmall}],warning:[{color:Y.TV.accentNegativeDefault}],dir:[{opacity:.6},Y.l0.flex.shrink(100)]});function vi(e){var t=e.path,n=e.highlighted,r=e.ranges,i=e.status,o=n?{backgroundColor:lz.vb.interactiveBackgroundActive}:void 0,a=i?({included:(0,N.tZ)(nU.Z,{}),overflowing:(0,N.tZ)(eV.Z,{}),truncated:(0,N.tZ)(eV.Z,{})})[i]:null,l=(0,m5.Q1)({path:t,ranges:null!=r?r:[]}),c=l.directory,s=l.filename;return(0,N.BX)($.G,{css:vr.root,style:o,children:[(0,N.BX)($.G,{css:vr.content,style:o,children:[(0,N.BX)($.G,{css:vr.left,style:o,children:[(0,N.tZ)(aI.Z,{path:t,size:16}),(0,N.tZ)(m6.x,{text:s.text,highlight:s.ranges,dimmed:!n}),c?(0,N.tZ)($.G,{color:"dimmest",css:vr.dir,children:(0,N.tZ)(m6.x,{text:c.text+"/",highlight:c.ranges,dimmed:!n})}):null]}),a]}),"overflowing"===i||"truncated"===i?(0,N.tZ)(J.xv,{css:vr.warning,variant:"small",children:"Exceeds file memory"}):null]})}var vo=(0,mT.$)(["iconColor","placeholderColor","itemTransform","inputBorderRadius","inputBorder"]),va=vo.cssVars,vl=vo.styleTokens,vc=(0,K.X)({root:[Y.l0.width(240),Y.l0.maxHeight(200)],inputRow:[Y.l0.position.relative,(P={},(0,U._)(P,va.iconColor,Y.TV.foregroundDimmest),(0,U._)(P,va.placeholderColor,Y.TV.foregroundDimmer),(0,U._)(P,":focus-within, :hover",(B={},(0,U._)(B,va.iconColor,Y.TV.foregroundDimmer),(0,U._)(B,va.placeholderColor,Y.TV.foregroundDimmest),B)),P)],searchIcon:[Y.l0.pl(6),Y.l0.coverContainer,Y.l0.align.start,Y.l0.justify.center,{color:vl.iconColor,pointerEvents:"none"}],input:[lz.gU.nofill,Y.l0.p(4),Y.l0.pl(24),{borderRadius:vl.inputBorderRadius,fontSize:Y.TV.fontSizeSmall,margin:"-1px -1px 0",cursor:"text","::placeholder":{color:vl.placeholderColor},"@media (hover: hover)":{":not([disabled]):focus":{outline:"0 none"}}}],header:[Y.l0.rowWithGap(2),Y.l0.px(4),Y.l0.height(24),Y.l0.align.center],unselectButton:[Y.l0.reset.button,lz.gU.nofill,Y.l0.p(2),{fontSize:Y.TV.fontSizeSmall}],menu:[Y.l0.flex.growAndShrink(1),{overflow:"auto"}],item:[{transform:vl.itemTransform,position:"absolute",top:0,left:0,width:"100%"}]});function vs(e,t){return t.status&&!e.status?1:e.status&&!t.status?-1:"included"===t.status&&"included"!==e.status?1:"included"===e.status&&"included"!==t.status?-1:0}function vu(e){var t,n,r,i,o,a,l,c=e.fileContextInclusions,s=e.placement,u=void 0===s?"bottom":s,d=e.findFiles,f=e.overscan,h=(0,O.useRef)(null),p=(0,L._)((0,O.useState)(""),2),m=p[0],v=p[1],g=(r=(n=(0,L._)((0,O.useState)({loading:!0,error:null,items:null}),2))[0],i=n[1],(o=(0,O.useRef)(null)).current||(o.current=(0,m3.Z)((t=(0,eO._)(function(e){var t;return(0,eX.Jh)(this,function(n){switch(n.label){case 0:return[4,d(e)];case 1:return t=n.sent(),(0,O.startTransition)(function(){i(null!==t.error?{error:t.error,loading:!1,items:null}:{items:t.files,total:t.total,error:null,loading:!1})}),[2]}})}),function(e){return t.apply(this,arguments)}),{wait:40})),a=(0,O.useCallback)(function(e){var t;return null===(t=o.current)||void 0===t?void 0:t.call(o,e).catch(function(){})},[]),(0,O.useEffect)(function(){return a(""),function(){try{var e;null===(e=o.current)||void 0===e||e.cancel()}catch(e){}}},[a]),{files:r.items,loading:r.loading,error:r.error,total:r.total,update:a}),y=g.files,b=g.total,Z=g.loading,w=g.error,x=g.update,C=(0,m9.zU)(),_=(0,O.useRef)(null),k=(0,aQ.Z)(m),S=(0,O.useMemo)(function(){var e=new Map(c.map(function(e){return[e.path,e.inclusionStatus]})),t=null==y?void 0:y.map(function(t){var n=t.path;return{path:n,ranges:t.ranges,status:e.get(n)}});if(!t)return null;if(_.current)return(0,vt.Z)(t,{existing:_.current,getKey:function(e){return e.path}});if(k.current)return t;var n=t.sort(vs);return _.current=n,n},[y,c,k]),E=(0,O.useMemo)(function(){var e;return null!==(e=null==S?void 0:S.filter(function(e){return e.status}))&&void 0!==e?e:[]},[S]),T=(0,mY.Kb)({inputValue:m,items:null!=S?S:[],isOpen:!0,defaultHighlightedIndex:0,stateReducer:function(e,t){var n=t.changes;switch(t.type){case mY.Kb.stateChangeTypes.InputKeyDownEnter:case mY.Kb.stateChangeTypes.ItemClick:return(0,rC.ZP)(n,function(t){t.highlightedIndex=e.highlightedIndex});default:return n}},onHighlightedIndexChange:function(e){void 0!==e.highlightedIndex&&-1!==e.highlightedIndex&&I.getVirtualItems()[e.highlightedIndex]&&I.scrollToIndex(e.highlightedIndex)},onStateChange:function(e){switch(e.type){case mY.Kb.stateChangeTypes.InputKeyDownEnter:case mY.Kb.stateChangeTypes.ItemClick:if(!e.selectedItem)break;var t,n,r,i=E.includes(e.selectedItem)?"exclude":"include";C({path:e.selectedItem.path,preference:i}),null===(r=h.current)||void 0===r||r.select();break;case mY.Kb.stateChangeTypes.InputChange:v(null!==(t=e.inputValue)&&void 0!==t?t:""),x(null!==(n=e.inputValue)&&void 0!==n?n:"")}}}),R=(0,O.useRef)(null),I=(0,cf.MG)({count:null!==(l=null==S?void 0:S.length)&&void 0!==l?l:0,getScrollElement:function(){return R.current},estimateSize:function(){return 32},getItemKey:function(e){var t,n;return null!==(n=null==S?void 0:null===(t=S[e])||void 0===t?void 0:t.path)&&void 0!==n?n:""},overscan:void 0===f?4:f}),D=(0,N.BX)($.G,{css:vc.inputRow,children:[(0,N.tZ)($.G,{css:vc.searchIcon,children:Z?(0,N.tZ)(eE.Z,{size:12}):(0,N.tZ)(oM.Z,{size:12})}),(0,N.tZ)("input",(0,eU._)({autoFocus:!0,placeholder:"Search files",css:vc.input},T.getInputProps({ref:h})))]}),G="top"===u?"0 0 ".concat(Y.TV.space4," ").concat(Y.TV.space4):"".concat(Y.TV.space4," ").concat(Y.TV.space4," 0 0");return!Z||(null==S?void 0:S.length)||(G=Y.TV.space4),(0,N.BX)($.G,{css:vc.root,style:(0,U._)({},va.inputBorderRadius,G),children:["bottom"===u?D:null,w?(0,N.tZ)(ej.E,{icon:(0,N.tZ)(eV.Z,{}),text:w}):null,void 0!==b?(0,N.BX)($.G,{css:vc.header,style:"bottom"===u?{borderTop:"1px solid "+Y.TV.outlineDimmer}:void 0,children:[(0,N.BX)(J.xv,{variant:"small",color:"dimmest",children:[c.length,"/",b]}),c.length?(0,N.tZ)($.G,{tag:"button",css:vc.unselectButton,onClick:function(){return function(){var e=!0,t=!1,n=void 0;try{for(var r,i=c[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value.path;C({path:o,preference:"exclude"})}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}()},children:"Unselect"}):null]}):null,(0,N.tZ)("div",(0,eL._)((0,eU._)({style:"top"===u?{borderBottom:"1px solid "+Y.TV.outlineDimmer}:void 0,css:vc.menu},T.getMenuProps({ref:R})),{children:(0,N.tZ)("div",{style:{height:"".concat(I.getTotalSize(),"px"),width:"100%",position:"relative"},children:I.getVirtualItems().map(function(e){var t=e.index,n=e.key,r=e.start,i=null==S?void 0:S[t];return i?(0,N.tZ)($.G,(0,eL._)((0,eU._)({"data-index":t,css:vc.item,style:(0,U._)({},va.itemTransform,"translateY(".concat(r,"px)"))},T.getItemProps({item:i,index:t,refKey:"innerRef",ref:I.measureElement})),{"aria-selected":void 0!==i.status,children:(0,N.tZ)(vi,{highlighted:t===T.highlightedIndex,path:i.path,ranges:i.ranges,status:i.status})}),n):null})})})),"top"===u?D:null]})}var vd=(0,K.X)({button:[Y.l0.reset.button,Y.l0.align.center,Y.l0.cursor.pointer,Y.l0.px(4),Y.l0.py(2),Y.l0.rowWithGap(4),lz.gU.nofill,Y.l0.color.foregroundDimmest,{"&:hover":Y.l0.color.foregroundDefault}]});function vf(){var e,t=(0,H.Z)().fs,n=m7(),r=(0,L._)((0,O.useState)(!1),2),i=r[0],o=r[1],a=(0,L._)((0,O.useState)(null),2),l=a[0],c=a[1],s=(0,L._)((0,O.useState)(null),2),u=s[0],d=s[1];(0,O.useEffect)(function(){var e=function(e){var t,n;t=e.target,n=[u,l],t instanceof Node&&n.some(function(e){return null==e?void 0:e.contains(t)})||o(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[u,l]),(0,O.useEffect)(function(){var e=function(e){"Escape"===e.key&&o(!1)};if(i)return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[i]);var f=(0,m4.D)(l,u,{modifiers:[{name:"offset",options:{offset:[0,4]}},{name:"preventOverflow",options:{padding:16}}],placement:"bottom-start"}),h="Context";n.length&&(h=1===n.length?(0,ec.UO)(n[0].path):n.length+" files");var p=(0,O.useId)(),m=vn(t);return(0,N.BX)(N.HY,{children:[(0,N.BX)($.G,{tag:"button",css:vd.button,innerRef:c,onClick:function(){return o(function(e){return!e})},onKeyDown:function(e){"ArrowDown"===e.key&&o(!0)},"aria-label":"Select files","aria-haspopup":!0,"aria-expanded":i,"aria-controls":p,children:[(0,N.tZ)(m8.Z,{}),(0,N.tZ)(J.xv,{variant:"small",children:h})]}),i?(0,N.tZ)(m$.h,{children:(0,N.tZ)(nF.MT,{restoreFocus:!0,children:(0,N.tZ)(eq.Tg,(0,eL._)((0,eU._)({id:p,elevated:!0,style:f.styles.popper,innerRef:d,css:mJ.L.popover},f.attributes.popper),{children:(0,N.tZ)(vu,{findFiles:m,fileContextInclusions:n,placement:(null===(e=f.state)||void 0===e?void 0:e.placement.startsWith("top"))?"top":"bottom"})}))})}):null]})}var vh=n(45434),vp=n(45086),vm=nX.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:0}}),vv=new rG.j(function(e){return vm.of(e)}),vg={marker:"cm-empty-state-dom"},vy=nL.tk.theme((0,U._)({},".".concat(vg.marker),{backgroundColor:Y.TV.redDefault,opacity:"0.2"})),vb=nX.QQ.define({create:function(e){return e.doc.length},update:function(e,t){return t.state.doc.length}}),vZ=function(e){return Math.max(e.doc.length-e.facet(vm),0)},vw=nX.QQ.define({create:vZ,update:function(e,t){return(0,mF.a)(t,"doc",vm)?vZ(t.state):e},provide:function(e){return[vb,vy,(0,nL.EY)({above:!1,update:function(t){return(0,mF.a)(t,e)},markers:function(t){var n=t.state.field(e);if(0===n)return[];var r=t.state.doc.length;return nL.dc.forRange(t,vg.marker,nX.jT.range(r-n,r))}})]}}),vx=(0,K.X)({charLimit:[Y.l0.color.redDefault]});function vC(e){var t=e.view,n=(0,vp.IK)(t,vw);return n?(0,N.tZ)(J.xv,{variant:"small",css:vx.charLimit,children:n}):null}var v_=n(7730),vk=n.n(v_),vS=nX.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:[]},compare:vk()}),vE=new rG.j(function(e){return vS.of(e)}),vT={render:function(e){var t=e.file,n=t.path,r=t.match,i=(0,rD.VV)((0,N.tZ)($.G,{css:vr.root,style:{width:"100%"},className:"option",children:(0,N.BX)($.G,{css:vr.content,children:[(0,N.BX)($.G,{css:vr.left,children:[(0,N.tZ)(aI.Z,{path:n,size:16}),(0,N.tZ)(m6.x,{text:r.filename.text,highlight:r.filename.ranges,dimmed:!0}),r.directory?(0,N.tZ)($.G,{color:"dimmest",css:vr.dir,children:(0,N.tZ)(m6.x,{text:r.directory.text+"/",highlight:r.directory.ranges,dimmed:!0})}):null]}),"included"===t.inclusionStatus?(0,N.tZ)(nU.Z,{}):null]})}));return i.style.display="flex",i.style.width="100%",i},position:81},vR=nL.tk.theme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:iY.TV.fontFamilyDefault,fontSize:iY.TV.fontSizeSmall},"& > ul > li":{padding:"0px",display:"flex",alignItems:"center"},"& > ul > li[aria-selected] .option":{backgroundColor:iY.TV.backgroundHighest}},".cm-completionLabel":{width:0}}),vI=new rG.j(function(e){function t(){return(t=(0,eO._)(function(t){var n,r,i,o,a;return(0,eX.Jh)(this,function(l){switch(l.label){case 0:if(!t.matchBefore(/@(\S*)/g)||null===(n=t.matchBefore(/\w*/)))return[2,null];return[4,e(n.text)];case 1:return i=null!==(r=l.sent().files)&&void 0!==r?r:[],o=new Map(t.state.facet(vS).map(function(e){return[e.path,e.inclusionStatus]})),a=i.map(function(e){var t=e.path,n=e.ranges;return{label:t,displayLabel:" ",file:{path:t,inclusionStatus:o.get(t),match:(0,m5.Q1)({path:t,ranges:null!=n?n:[]})}}}),[2,{from:n.from,filter:!1,options:a}]}})})).apply(this,arguments)}return[vR,(0,mL.ys)({defaultKeymap:!1,icons:!1,aboveCursor:!0,addToOptions:[vT],override:[function(e){return t.apply(this,arguments)}],maxRenderedOptions:100})]}),vD=new rG.j(function(e){return nL.tk.updateListener.of(function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value.annotation(mL.Jv);l&&e(l.label)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}})}),vG=n(92651),vB=n.n(vG),vP=(0,K.X)({root:[Y.l0.display.inlineFlex],button:[Y.l0.reset.button,Y.l0.display.inlineFlex,Y.l0.px(2),lz.gU.outlined,Y.l0.borderRadius(4),Y.l0.rowWithGap(2),Y.l0.align.center],warning:{color:Y.TV.redDefault}}),vA=new rD.Jf(function(e){var t=(0,ec.UO)(e.path),n=(0,ec.Il)(e.path);return(0,N.tZ)(eT.u,{isDisabled:!n&&!e.warning,tooltip:(0,N.BX)($.G,{children:[e.warning?(0,N.tZ)(J.xv,{variant:"small",css:vP.warning,children:e.warning}):null,n?(0,N.BX)(J.xv,{variant:"small",color:"dimmest",children:[n,"/"]}):null]}),children:function(n,r){return(0,N.tZ)($.G,(0,eL._)((0,eU._)({css:vP.root,innerRef:r},n),{children:(0,N.BX)($.G,{tag:"button",css:vP.button,onClick:function(){return e.onClick()},children:[(0,N.tZ)(aI.Z,{size:12,path:e.path}),(0,N.tZ)(J.xv,{variant:"small",children:t}),e.warning?(0,N.tZ)(eV.Z,{size:12}):null]})}))}})}),vN=function(e){"use strict";(0,fo._)(n,e);var t=(0,fl._)(n);function n(e,r){var i;return(0,fi._)(this,n),(i=t.call(this)).file=e,i.onClick=r,i}var r=n.prototype;return r.eq=function(e){return this.file.path===e.file.path&&this.file.inclusionStatus===e.file.inclusionStatus},r.toDOM=function(){var e=this.file,t=e.path,n=e.inclusionStatus,r=vA.create({path:t,onClick:this.onClick,warning:"included"!==n?"Exceedes memory limit":null});return r.style.display="inline",r},n}(nL.l9),vU=function(e,t){return new nL.Y1({regexp:RegExp("".concat(e.map(function(e){var t=e.path;return"@".concat(vB()(t))}).join("|")),"g"),decoration:function(n,r){var i,o=n[0].substring(1,null===(i=n[0])||void 0===i?void 0:i.length),a=e.find(function(e){return e.path===o});return a?nL.p.replace({widget:new vN(a,function(){return t(o)}),inclusive:!0}):null}})},vL=new rG.j(function(e){return nL.lg.fromClass(function(){"use strict";function t(n){(0,fi._)(this,t);var r=n.state.facet(vS);this.match=r.length?vU(r,e):null,this.placeholders=this.match?this.match.createDeco(n):nL.p.none}return t.prototype.update=function(t){var n=t.state.facet(vS);if(0===n.length){this.match=null,this.placeholders=nL.p.none;return}if((0,mF.a)(t,vS)){this.match=vU(n,e),this.placeholders=this.match.createDeco(t.view);return}if((0,mF.a)(t,"doc")){if(!this.match){this.match=vU(n,e),this.placeholders=this.match.createDeco(t.view);return}this.placeholders=this.match.updateDeco(t,this.placeholders)}},t}(),{decorations:function(e){return e.placeholders},provide:function(e){return nL.tk.atomicRanges.of(function(t){var n;return(null===(n=t.plugin(e))||void 0===n?void 0:n.placeholders)||nL.p.none})}})}),vO=n(4736),vX=n(83109),vM=(0,K.X)({surface:[Y.l0.flex.growAndShrink(0),Y.l0.borderRadius(8),Y.l0.m(8),Y.l0.position.relative,{marginTop:"auto"}],messageBoxContainer:[Y.l0.p(8)],quotaLimitContainer:[Y.l0.p(8),Y.l0.colWithGap(8),Y.l0.position.relative,{marginTop:"auto"}]});function vF(e){var t=e.text,n=e.type,r=(0,pD.Q)(),i=(0,L._)((0,O.useState)(!1),2),o=i[0],a=i[1];return(0,N.BX)($.G,{css:vM.quotaLimitContainer,children:[(0,N.tZ)(ej.E,{icon:(0,N.tZ)(eV.Z,{}),colorway:"red",text:t}),"basic"===n?(0,N.tZ)(eW.zx,{onClick:function(){return a(!0)},colorway:"blurple",text:"Upgrade to Replit ".concat(r)}):null,(0,N.tZ)(pG.Z,{isOpen:o,onClose:function(){return a(!1)},type:"purchase",analyticsContext:{upgrade:{context:"ai_model_selector",surface:"ghostwriter_power_up_dialog"},trial:{context:iq.$X.Workspace}}})]})}var vW=n(92815),vH=n(66820),vV=n(50455),vz=n(475),vj=new rG.j(function(e){return nL.tk.domEventHandlers({keydown:function(t,n){!((0,mL.SI)(n.state).length>0)&&("Enter"!==t.key||t.shiftKey||(t.preventDefault(),e(n.state.doc.toString()),n.dispatch({changes:{from:0,to:n.state.doc.length}})))}})}),vq=nL.tk.theme((A={"& .cm-content":{fontFamily:Y.TV.fontFamilyDefault}},(0,U._)(A,"& .".concat(mO.ll),{display:"none"}),(0,U._)(A,"& .cm-indent-markers",{display:"none"}),A)),vY=(0,K.X)({root:[Y.l0.borderRadius(0,0,4,4),Y.l0.border({color:Y.TV.outlineDimmest,direction:"top"}),{marginTop:"auto"}],codemirror:[Y.l0.maxHeight(300),Y.l0.overflow("auto"),{"& .cm-content":Y.l0.pt(8)}],footer:[Y.l0.rowWithGap(8),Y.l0.align.center,Y.l0.height(32)],left:[Y.l0.rowWithGap(8),Y.l0.flex.growAndShrink(1),Y.l0.align.center,Y.l0.pl(4)],right:[Y.l0.rowWithGap(4),Y.l0.align.center,Y.l0.pr(8)],send:[Y.l0.borderRadius(8)],sendDisabled:[(0,hq.ec)("grey")],sendEnabled:[(0,hq.ec)("blurple")]});function v$(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p=e.setPromptEditor,m=e.openFile,v=(o=(0,mM.Lw)(),a=(0,vO.Tt)(),l=(0,L._)((0,mM.Ni)(),1)[0],c=(0,pD.Q)(),a?o?"advanced"!==l?null:a.advancedModelUsage<a.advancedModelLimit?null:{type:"advanced",text:"Quota reached. Refreshes ".concat((0,vX.Z)(new Date(a.advancedModelTTLEnd),"do MMM, hh:mm a"))}:a.basicModelUsage<a.basicModelLimit?null:{type:"basic",text:"100% quota reached. Upgrade to Replit ".concat(c," to get unlimited quota.")}:null),g=(0,H.Z)().fs,y=(0,ar.ql)(),b=(0,O.useCallback)(function(e){y({chatMessage:{type:"chat",text:e}})},[y]),Z=(0,iL.Vg)((0,o4.useRouter)()),w=(0,O.useRef)(null),x=(0,vH.j3)(),C=(0,vH.em)(),_=(0,hA.v)(),k=(u=(s={enableBridge:Z,model:(0,vV.P)(_),sendChatMessage:function(e){y({chatMessage:{type:"chat",text:e}})},abortResponse:function(){x&&E()}}).enableBridge,d=s.sendChatMessage,f=s.abortResponse,h=(0,vW.v)(),(0,O.useEffect)(function(){if(u){var e=function(e){return(0,o5.I6)(e,function(e){var t=e.type;switch(h(!1),t){case o3.cF.GHOSTWRITER_CHAT_SEND:d(e.chatMessage),(0,o5.gU)(e.id);break;case o3.cF.GHOSTWRITER_CHAT_ABORT_RESPONSE:f(),(0,o5.gU)(e.id);break;default:(0,o6.Z)(t)}})};return window.addEventListener("message",e),function(){return window.removeEventListener("message",e)}}},[f,u,d,h]),{focusNativeMobileInput:(0,O.useCallback)(function(){var e={messageType:o3.cF.GHOSTWRITER_CHAT_FOCUS_INPUT};(0,o5.bG)(e,ay()())},[])}).focusNativeMobileInput,S=(0,O.useCallback)(function(){if(Z)k();else{var e;null===(e=w.current)||void 0===e||e.focus()}},[k,Z]),E=(0,O.useCallback)(function(){(0,rl.j)(rl.U3.GHOSTWRITER_CHAT_RESPONSE_STOPPED),C(),S()},[C,S]),T=vj.use(b),R=(0,rI.Z)(),I=R.ref,D=R.view;n=(t={view:D,setPromptEditor:function(e){w.current=e,p(e)}}).view,r=t.setPromptEditor,i=(0,aQ.Z)(r),(0,O.useEffect)(function(){if(n){var e=i.current;return e({setValue:function(e){n.state.doc.toString()!==e&&n.dispatch({changes:{from:0,to:n.state.doc.length,insert:e}})},focus:function(){n.focus(),n.dispatch({selection:{anchor:n.state.doc.length}})}}),function(){e(null)}}},[n,i]);var G=(0,vp.IK)(D,mz),B=(0,vh.yL)(_).messageCharacters,P=vv.use(B),A=vE.use(m7()),U=vL.use(m),X=vn(g),M=vI.use(X),F=(0,m9.zU)(),W=vD.use((0,O.useCallback)(function(e){return F({path:e,preference:"include"})},[F])),V=(0,ar.J)();if((0,o4.useRouter)().query.hideChatInput)return null;if(v)return(0,N.tZ)(vF,{type:v.type,text:v.text});var z=!D||!0===G;return(0,N.BX)(eq.Tg,{css:vY.root,children:[(0,N.tZ)(rR.ZP,{ref:I,language:"markdown",css:vY.codemirror,hideGutter:!0,autocomplete:!1,extensions:[vq,T,mj,vw,P,A,U,M,W]}),(0,N.BX)($.G,{css:vY.footer,children:[(0,N.BX)($.G,{css:vY.left,children:[(0,N.tZ)(m2,{}),(0,N.tZ)(vf,{})]}),(0,N.BX)($.G,{css:vY.right,children:[(0,N.tZ)(vC,{view:D}),(0,N.tZ)(mM.O3,{}),(0,N.tZ)(eq.Tg,{elevated:!0,css:vY.send,children:(0,N.tZ)(e_.hU,{css:z?vY.sendDisabled:vY.sendEnabled,disabled:z,alt:V?"Stop":"Send",onClick:function(){if(V){E();return}if(D){var e=D.state.doc.toString();e&&(b(e),D.dispatch({changes:{from:0,to:D.state.doc.length}}))}},children:V?(0,N.tZ)(vz.Z,{}):(0,N.tZ)(mX.Z,{})})})]})]})]})}var vJ=n(99708),vK=(0,K.X)({root:[Y.l0.flex.column,Y.l0.maxHeight("100%"),Y.l0.maxWidth("100%"),Y.l0.flex.grow(1),Y.l0.position.relative,Y.l0.colorMixBg(Y.TV.blurpleDefault,"transparent",.05)]});function vQ(e){var t,n,r,i,o,a,l,c=e.paneIsActive,s=e.openFile,u=(0,iL.T3)(),d=(0,L._)((0,ar.zu)(),1)[0],f=d.filter(function(e){return"feedback"!==e.type});(0,mh.$h)();var h=(0,vJ.yz)(),p=h.data,m=h.loading,v=h.error,g=null==p?void 0:p.currentUser,y=(0,L._)((0,O.useState)(!1),2),b=y[0],Z=y[1],w=null==g?void 0:g.isStaff,x=(0,L._)((0,ms.RN)(),2),C=x[0],_=x[1],k=(0,ar.ZT)(),S=(0,tk.Z)(function(){return[{type:"action",label:"Clear chat history",icon:(0,N.tZ)(e2.Z,{}),run:function(){(0,rl.j)(rl.U3.GHOSTWRITER_CHAT_CLEARED),k()}}]},[k]),E=(0,tk.Z)(function(){var e=[];if(w){var t={match:aD.pl,data:{type:"action",icon:(0,N.tZ)(py.Z,{fill:C?Y.TV.accentPrimaryDefault:Y.TV.foregroundDefault}),label:"Toggle debug mode",run:function(){_(function(e){return!e})}}};e.push(t)}return e},[C,_,w]),T=(0,L._)((0,O.useState)(null),2),R=T[0],I=T[1];(0,et.Wk)(function(){return R},[R]),(0,et.L5)(function(){return{actions:S,commands:E}},[S,E]);var D=(0,O.useRef)(null),G=(0,L._)((0,mo.Z_)(),2),B=G[0],P=G[1],A=(0,L._)((0,mo.Z9)(),2),U=A[0],M=A[1],F=(0,O.useCallback)(function(){if(U){M(!1);return}if(null!=D.current&&D.current.scrollHeight-D.current.scrollTop===D.current.clientHeight&&(c||!u)){P(!0);return}P(!1)},[U,P,M,c,u]),W=(t=(0,L._)((0,O.useState)(function(){return(0,mD.u)(!1)}),1)[0],r=(n=(0,L._)((0,O.useState)(null),2))[0],i=n[1],a=(o=(0,L._)((0,O.useState)(null),2))[0],l=o[1],(0,O.useEffect)(function(){if(r&&a)return(0,mR.j)(r,function(){return t.set(!1),function(){t.set(!0)}},{root:a,rootMargin:"100px"})},[t,r,a]),(0,O.useEffect)(function(){r&&(0,X.Z)(r,{behavior:"instant"})},[r]),{showButton:t,anchorRef:i,scrollRef:l,onClick:function(){r&&(0,X.Z)(r)}});return m?(0,N.tZ)(mr,{}):v||!g?(0,N.BX)($.G,{children:["error: ",(null==v?void 0:v.message)||"User not found, please log in or reload"]}):(0,N.BX)($.G,{css:vK.root,dataCy:"ghostwriter-chat",children:[(0,N.tZ)(ml.Z,{isOpen:b,setOpen:Z,feature:ma.l.GhostWriter}),(0,N.tZ)(mm,{}),d.length?(0,N.BX)(N.HY,{children:[(0,N.BX)($.G,{innerRef:(0,s3.l)(D,W.scrollRef),css:[Y.l0.colWithGap(8),Y.l0.overflow("auto"),Y.l0.flex.growAndShrink(1),Y.l0.pt(12),Y.l0.position.relative],onScroll:F,role:"log",children:[d.map(function(e,t){if("Human"===e.attribution)return(0,N.tZ)(mE,{id:e.id,openFile:s},e.id);var n=B&&t===d.length-1;return"feedback"===e.type?(0,N.tZ)(mf,{message:e,currentUser:g,autoScroll:n}):(0,N.tZ)(mi.v0,{message:e,autoScroll:n,isLastAssistantMessage:"Assistant"===e.attribution&&f[f.length-1].id===e.id},e.id)}),(0,N.tZ)($.G,{innerRef:W.anchorRef})]}),(0,N.tZ)(mU,{visible:W.showButton,onClick:W.onClick})]}):(0,N.tZ)(mn,{promptEditor:R}),(0,N.tZ)(v$,{openFile:s,setPromptEditor:I})]})}var v0=function(e){var t=(0,iA.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1}),n=e.performPaneOperation,r=(0,O.useCallback)(function(e){n({operation:"open",pane:"string"==typeof e?(0,tI.$E)(e):{type:(0,tX.Dp)(e),data:e},secondary:!0})},[n]);return t?(0,N.tZ)(mc.Z,{textVariant:"headerDefault",showImage:!0}):(0,N.tZ)(vQ,{openFile:r,paneIsActive:e.paneIsActive})},v1=es.Type.Object({type:es.Type.Literal("ghostwriterChat")}),v2={Content:function(e){var t=e.options;return(0,N.tZ)(v0,{paneIsActive:t.isActive,performPaneOperation:t.performPaneOperation})},Icon:function(e){var t=e.size;return(0,N.tZ)(p2.Z,{size:t})},getTitle:function(){return"AI"},decode:function(e){return eu.B4.Decode(v1,e)}},v8=n(79098),v4=n(67711),v3=(0,K.X)({badge:[Y.l0.backgroundColor.backgroundHighest,Y.l0.borderRadius(4),{padding:"0 0.35em"}],container:[Y.l0.p(8),Y.l0.colWithGap(8)],header:[Y.l0.py(4),Y.l0.justify.spaceBetween,Y.l0.flex.grow(1),Y.l0.pr(16),Y.l0.height(24)],result:[Y.l0.borderRadius(4),Y.l0.overflow("hidden")],problems:[Y.l0.px(6),Y.l0.py(6)],item:[lz.gU.listItem,Y.l0.reset.button,Y.l0.justify.spaceBetween,Y.l0.px(8),Y.l0.py(4),Y.l0.overflow("hidden"),Y.l0.cursor.pointer,Y.l0.borderRadius(4),{"&:focus-visible":[Y.l0.focusRing],"&:hover, &:focus-visible":[Y.l0.backgroundColor.backgroundHighest]}],itemMain:[Y.l0.flex.growAndShrink(1)],itemSecondary:[Y.l0.color.foregroundDimmest],flex:[Y.l0.rowWithGap(8),Y.l0.align.center],message:[Y.l0.flex.shrink(1),Y.l0.overflowX("hidden"),{textOverflow:"ellipsis",whiteSpace:"nowrap"}]});function v5(e){var t=e.isActive,n=e.performPaneOperation,r=(0,L._)((0,O.useState)({}),2),i=r[0],o=r[1],a=(0,hR.nC)(),l=(0,et.dr)(),c=(0,O.useCallback)(function(){var e=!0,t=!1,n=void 0;try{for(var r,i=a()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)!function(){var e,t=r.value;if("codeEditor"===t[1].type){var n=l(t[0]);if(n&&"codeEditor"===n.type){var i=t[1].data.path,a=null===(e=n.fetchProblems)||void 0===e?void 0:e.call(n);i&&a&&o(function(e){return(0,eL._)((0,eU._)({},e),(0,U._)({},i,a))})}}}()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},[l,a]);return(0,O.useEffect)(function(){t&&c()},[t,c]),(0,et.L5)(function(){return{type:"problems",updateProblems:function(e,t){o(function(n){return(0,eL._)((0,eU._)({},n),(0,U._)({},e,t))})}}},[o]),(0,N.BX)($.G,{css:v3.container,children:[Object.values(i).some(function(e){return e.length>0})?null:(0,N.tZ)(J.xv,{children:"No problems detected in this workspace"}),Object.keys(i).map(function(e){return 0===i[e].length?null:(0,N.tZ)(eq.Tg,{elevated:!0,css:v3.result,children:(0,N.tZ)(ne.Q,{chevron:"end",defaultExpanded:!0,headerContent:(0,N.BX)($.G,{css:[v3.flex,v3.header],children:[(0,N.BX)($.G,{css:v3.flex,children:[(0,N.tZ)(aI.Z,{path:e}),(0,N.tZ)(J.xv,{children:e})]}),(0,N.tZ)($.G,{css:v3.badge,children:i[e].length>99?"99+":i[e].length})]}),children:(0,N.tZ)($.G,{css:v3.problems,children:i[e].map(function(t,r){var i=t.range.start.line+1,o=t.range.start.character;return(0,N.tZ)(v4.Z,{problem:t,onClick:function(){n({operation:"open",pane:{type:"codeEditor",data:{path:e,line:i,col:o}},secondary:!0})}},"".concat(i,"-").concat(o,"-").concat(r))})})},e)},e)})]})}var v6=es.Type.Object({type:es.Type.Literal("problems")}),v9={Content:function(e){var t=e.options,n=t.isActive,r=t.performPaneOperation;return(0,N.tZ)(v5,{isActive:n,performPaneOperation:r})},Icon:function(){return(0,N.tZ)(v8.Z,{})},getTitle:function(){return"Problems"},decode:function(e){return eu.B4.Decode(v6,e)}},v7=n(9610),ge=n(35375),gt=n(20399),gn=(0,K.X)({table:{},tableRow:[Y.l0.rowWithGap(12),Y.l0.align.center,Y.l0.border({direction:"bottom"}),{"box-sizing":"border-box",":last-child":{borderBottom:0}}],wrapper:[Y.l0.rowWithGap(0)],column:[Y.l0.colWithGap(0),Y.l0.justify.center,Y.l0.border({direction:"right"}),{":last-child":{borderRight:0}}],header:[Y.l0.colWithGap(0),Y.l0.justify.center],cell:[Y.l0.rowWithGap(0),Y.l0.align.center,Y.l0.color.foregroundDimmest,Y.l0.fontSize("small"),Y.l0.px(4),Y.l0.py(2)],responsiveWrapper:[],responsiveColumn:[]}),gr=function(e){var t=e.children;return(0,N.tZ)($.G,{css:gn.tableRow,children:(0,N.tZ)($.G,{css:gn.wrapper,children:t})})},gi=function(e){var t=e.header,n=e.width,r=e.children;return(0,N.tZ)($.G,{css:void 0!==t&&t?gn.header:gn.column,style:n?{width:n}:{},children:(0,N.tZ)($.G,{css:gn.cell,children:r})})},go=function(e){var t=e.children;return(0,N.tZ)($.G,{css:gn.table,children:t})},ga=n(51533),gl=(0,K.X)({self:[Y.l0.p(12),Y.l0.colWithGap(16)],devUrl:[Y.l0.rowWithGap(4),Y.l0.align.center],url:[Y.l0.color.accentPositiveStronger,Y.l0.fontSize("small"),Y.l0.focusRing,{"&:hover":[Y.l0.cursor.pointer,Y.l0.color.accentPositiveStrongest]}],section:[Y.l0.colWithGap(4)],openPort:[Y.l0.color.accentPositiveStronger],localPortIcon:[Y.l0.color.foregroundDefault,Y.l0.px(4),{flex:"0 0 auto",marginLeft:"auto",marginRight:"auto !important"}],internalMessage:[Y.l0.flex.shrink(1),{marginLeft:"auto",span:Y.l0.color.foregroundDimmest}],portStatus:[Y.l0.py(0),Y.l0.px(4)]});function gc(e){var t,n,r,i,o=e.localPort,a=e.externalPort,l=(0,H.Z)().ports.updateDotReplitPortsMapping,c=(t=(0,H.Z)().ports,n=(0,hj.Z)(t.portsState),r=(0,iA.P5)({controlName:"flag-dot-dev-url",logFlagToAnalytics:!1})?ge.UK:ge.wy,i=new Set(null==n?void 0:n.map(function(e){var t;return null!==(t=(0,ge.OD)(e.configuration))&&void 0!==t&&t}).filter(Boolean)),Array.from(r).sort(function(e,t){return e-t}).map(function(e){return{isAvailable:!i.has(e),externalPort:e}}));return(0,N.tZ)($.G,{css:Y.l0.flex.row,children:void 0!==a&&0!==a?(0,N.BX)(N.HY,{children:[":",a,(0,N.tZ)(e_.hU,{alt:"Remove Mapping",onClick:function(){o&&l(o,void 0)},children:(0,N.tZ)(tb.Z,{})})]}):(0,N.tZ)(gt.ZE,{label:"Add External Port",onAction:function(e){if(o){var t=c.find(function(t){return String(t.externalPort)===e});t&&t.isAvailable&&l(o,t.externalPort)}},children:c.map(function(e){var t=e.isAvailable,n=e.externalPort;return(0,N.tZ)(gt.ck,{"aria-label":String(n),children:(0,N.BX)($.G,{css:t?Y.l0.color.foregroundDefault:Y.l0.color.foregroundDimmest,children:[":",n]})},String(n))})})})}function gs(e){var t=e.portState,n=null;switch(t.configuration.type){case ge.DL.MISCONFIGURED:n=(0,N.tZ)(eT.u,{tooltip:"Port misconfigured",delay:"default",children:(0,N.tZ)(eV.Z,{})});break;case ge.DL.CONFIG_MISSING:n=(0,N.tZ)(eT.u,{tooltip:"Configuration missing",delay:"default",children:(0,N.tZ)(eV.Z,{})});break;case ge.DL.INTERNAL_ONLY:n=(0,N.tZ)($.G,{css:gl.internalMessage,children:(0,N.tZ)(ej.E,{css:gl.portStatus,text:"Internal"})});break;case ge.DL.NO_MORE_EXTERNAL_PORTS_AVAILABLE:n=(0,N.tZ)(eV.Z,{});break;case ge.DL.FORWARDED:n=(0,N.tZ)(tH.Z,{})}return(0,N.tZ)("span",{css:gl.localPortIcon,children:n})}function gu(e){var t=e.portState;return(0,N.BX)(gi,{width:105,children:[(0,N.BX)(J.xv,{css:t.isOpen?gl.openPort:{},children:[":",t.configuration.localPort]}),(0,N.tZ)(gs,{portState:t})]})}function gd(e){var t=e.portState;return t.configuration.type===ge.DL.NO_MORE_EXTERNAL_PORTS_AVAILABLE?(0,N.tZ)(gi,{width:160,children:(0,N.tZ)(ej.E,{css:gl.portStatus,icon:(0,N.tZ)(eV.Z,{}),text:"No ports available"})}):"externalPort"in t.configuration?(0,N.tZ)(gi,{width:160,children:(0,N.tZ)(gc,{localPort:t.configuration.localPort,externalPort:(0,ge.OD)(t.configuration)})}):(0,N.tZ)(gi,{width:160})}function gf(e){var t,n=e.portState;return n.isOpen?(0,N.BX)(N.HY,{children:[(0,N.tZ)(gi,{width:100,children:(t=n.processInfo.cmdline[0].split("/"))[t.length-1]}),(0,N.tZ)(gi,{width:100,children:n.processInfo.pid})]}):(0,N.tZ)(gi,{width:100})}function gh(e){var t=e.portState;return(0,N.BX)(gr,{children:[(0,N.tZ)(gu,{portState:t}),(0,N.tZ)(gd,{portState:t}),(0,N.tZ)(gf,{portState:t})]},t.configuration.localPort)}function gp(){var e,t=(0,nc.Z)(),n=(0,ga.J)(t),r=(0,H.Z)().ports,i=null!==(e=(0,hj.Z)(r.portsState))&&void 0!==e?e:[];return(0,N.BX)($.G,{css:gl.self,children:[(null==n?void 0:n.presentationUrl)?(0,N.BX)($.G,{css:gl.section,children:[(0,N.tZ)(J.xv,{children:"Dev URL:"}),(0,N.BX)($.G,{css:gl.devUrl,children:[(0,N.tZ)(iy(),{legacyBehavior:!0,href:n.presentationUrl,passHref:!0,children:(0,N.tZ)("a",{css:gl.url,target:"_blank",children:n.presentationUrl})}),(0,N.tZ)(em.qi,{value:n.presentationUrl})]})]}):null,(0,N.BX)($.G,{css:gl.section,children:[(0,N.tZ)(J.xv,{children:"Ports"}),(0,N.BX)(go,{children:[(0,N.BX)(gr,{children:[(0,N.tZ)(gi,{header:!0,width:105,children:"Internal Port"}),(0,N.tZ)(gi,{header:!0,width:160,children:"External Port"}),(0,N.tZ)(gi,{header:!0,width:100,children:"Name"}),(0,N.tZ)(gi,{header:!0,width:100,children:"Pid"})]}),i?i.map(function(e){return(0,N.tZ)(gh,{portState:e},e.configuration.localPort)}):null]})]})]})}var gm=n(81810),gv=(0,K.X)({unavailable:[Y.l0.p(8)]}),gg=es.Type.Object({type:es.Type.Literal("networking")}),gy={Content:function(){return(0,iA.P5)({controlName:gm.wK,logFlagToAnalytics:!0})||($.G,gv.unavailable,J.xv),(0,N.tZ)(gp,{})},Icon:function(e){var t=e.size;return(0,N.tZ)(v7.Z,{size:t})},getTitle:function(){return"Networking"},decode:function(e){return eu.B4.Decode(gg,e)}};function gb(){return{codeEditor:eh.D,webview:oP.Rm,media:aB,pedit:hS,vnc:oL,unitTests:hD,adminPanel:pZ,runnerOutput:ep.G,shell:ao,packager:tG,systemDependencies:tL,envEditor:ey,draw:aE,git:d5,diff:lu,history:hp,database:nx,neon:oB,markdown:ef,sshConfigurator:p0,ghostwriterChat:v2,problems:v9,networking:gy}}},35614:function(e,t,n){n.d(t,{T:function(){return o},u:function(){return a}});var r=n(68956),i=(0,n(90234).cn)(null);function o(){return(0,r.$X)(i)}function a(){return(0,r.Hg)(i)}},76568:function(e,t,n){n.d(t,{L5:function(){return y},Wk:function(){return T},Xq:function(){return G},Y6:function(){return b},bS:function(){return R},c4:function(){return _},dr:function(){return Z},u1:function(){return C}});var r=n(34142),i=n(32477),o=n(21289),a=n(87682),l=n(43429),c=n(90234),s=n(92153),u=n(50199),d=n(15859),f=n(7444),h=n(68956),p=n(2038),m=n(34581),v=(0,c.cn)({}),g=(0,c.cn)(null,function(e,t,n){t(v,function(e){return(0,s.ZP)(e,function(e){null===n.actions?delete e[n.paneId]:e[n.paneId]=n.actions})})});function y(e,t){var n=D(),r=(0,h.$X)(g),i=(0,f.Z)(e);(0,l.useEffect)(function(){var e;return r({paneId:n,actions:null!==(e=i.current())&&void 0!==e?e:null}),function(){r({paneId:n,actions:null})}},[r,n,i].concat((0,o._)(t)))}function b(e){var t=(0,u.Z)(function(){return(0,d.kv)(v,function(t){return e?t[e]:{}})},[e]);return(0,h.Hg)(t)}function Z(){var e=(0,h.XD)(v);return(0,l.useCallback)(function(t){var n;return null!==(n=e()[t])&&void 0!==n?n:null},[e])}var w=(0,c.cn)(new Map),x=(0,c.cn)(null,function(e,t,n,r){t(w,function(e){var t=new Map(e);return null===r?t.delete(n):r&&t.set(n,r),t})});function C(){return(0,h.$X)(x)}function _(){var e,t,n=(e=(0,h.rF)(),(0,l.useCallback)(function(t){return e((0,d.kv)(v,function(e){return e[t]}))},[e]));return(0,l.useCallback)((t=(0,r._)(function(e){return(0,a.Jh)(this,function(t){return[2,new Promise(function(t){var r=n(e);if(r.current){t(r.current);return}var i=r.subscribe(function(e){e&&(t(e),i())})})]})}),function(e){return t.apply(this,arguments)}),[n])}var k=(0,c.cn)(new Map),S=(0,c.cn)(null,function(e,t,n){t(k,function(e){return(0,s.ZP)(e,function(e){null===n.focus?e.delete(n.paneId):e.set(n.paneId,n.focus)})})});function E(e){var t=document.activeElement;return!!e&&!!t&&e!==t&&e.contains(t)}function T(e,t){var n=(0,f.Z)(e),r=D(),a=(0,p.T3)(),c=(0,l.useRef)(!a),s=(0,h.$X)(S),u=(0,h.XD)(m.J1),d=(0,h.XD)(w),v=(0,i._)((0,l.useState)(null),2),g=v[0],y=v[1];return(0,l.useEffect)(function(){n.current&&y(n.current())},t?(0,o._)(t):[]),(0,l.useEffect)(function(){var e=function(e){u()===r&&e.target!==d().get(r)&&(c.current=!1)};return document.body.addEventListener("focus",e,!0),function(){document.body.removeEventListener("focus",e,!0)}},[u,d,r]),(0,l.useEffect)(function(){if(g){var e=function(){g.focus()};return c.current&&u()===r&&!E(d().get(r))&&e(),s({paneId:r,focus:e}),function(){s({paneId:r,focus:null})}}},[g,s,r,u,d,a]),y}function R(){var e=(0,h.XD)(k),t=(0,h.XD)(w);return(0,u.Z)(function(){return function(n){var r=e().get(n),i=t().get(n);if(!E(i)){if(r){r();return}null==i||i.focus()}}},[e,t])}var I=(0,l.createContext)(null);function D(){var e=(0,l.useContext)(I);if(!e)throw Error("Expected pane id in context");return e}var G=I.Provider},34581:function(e,t,n){n.d(t,{AA:function(){return U},J1:function(){return h},Np:function(){return I},Vu:function(){return G},WU:function(){return p},Xo:function(){return P},ex:function(){return N},fg:function(){return L},gv:function(){return B},jY:function(){return A},nC:function(){return D}});var r=n(32477),i=n(21289),o=n(52902),a=n(7730),l=n.n(a),c=n(92153),s=n(43429),u=n(90234),d=n(68956),f=n(50199),h=(0,u.cn)(null);function p(){return(0,d.XD)(h)}var m=(0,u.cn)(new Map),v=(0,u.cn)([]),g=(0,u.cn)(null,function(e,t,n){t(m,function(e){return(0,c.ZP)(e,function(e){var t=e.get(n.paneId),r=Date.now();if(!t){e.set(n.paneId,{panes:[n.pane],lastActiveAt:r});return}var i=t.panes[t.panes.length-1];t.lastActiveAt=r,l()(n.pane,i)||t.panes.push(n.pane)})}),t(h,n.paneId)}),y=(0,u.cn)(null,function(e,t,n){var r=e(h),i=e(m).get(n);i&&t(v,function(e){return(0,c.ZP)(e,function(e){e.push(i.panes)})}),t(m,function(e){return(0,c.ZP)(e,function(e){e.delete(n)})}),r===n&&t(h,null)}),b=(0,u.cn)(null,function(e,t,n){t(m,function(e){return(0,c.ZP)(e,function(e){var t=e.get(n);t&&(t.lastActiveAt=Date.now())})}),t(h,n)}),Z=(0,u.cn)(null,function(e,t){t(h,null)}),w=(0,u.cn)(function(e){return(0,i._)(e(m).values()).sort(function(e,t){return t.lastActiveAt-e.lastActiveAt}).map(function(e){return e.panes})}),x=(0,u.cn)(function(e){var t=e(m),n=[];return t.forEach(function(e,t){var r=e.panes[e.panes.length-1];r&&n.push([t,r,e.lastActiveAt])}),n.sort(function(e,t){return e[2]-t[2]})}),C=(0,u.cn)(function(e){var t=[],n=!0,i=!1,a=void 0;try{for(var l,c=e(x)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=(0,r._)(l.value,2),u=(s[0],s[1]),d=(0,o.Ur)(u)?u.data.path:null;d&&t.push(d)}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}return t}),_=(0,u.cn)(function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var a,l=e(w)[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;c.length<=1||t.push.apply(t,(0,i._)(c.slice(0,-1)))}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}var s=!0,u=!1,d=void 0;try{for(var f,h=e(v)[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value;t.push.apply(t,(0,i._)(p))}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}return t}),k=(0,u.cn)(null,function(e,t){var n=e(v).flat().pop();return t(v,function(e){return(0,c.ZP)(e,function(e){var t=e.pop();t&&t.pop()})}),n}),S=(0,u.cn)(function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,l=e(_)[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value,s=(0,o.Ur)(c)?c.data.path:null;s&&t.push(s)}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return t}),E=(0,u.cn)(function(e){return(0,i._)(e(C)).concat((0,i._)(e(S)))}),T=(0,u.cn)(function(e){var t,n=e(h);if(!n)return null;var r=e(m).get(n);return r&&null!==(t=r.panes[r.panes.length-1])&&void 0!==t?t:null}),R=(0,u.cn)(function(e){var t=e(T);return t&&(0,o.Ur)(t)&&t.data.path||null});function I(e,t){var n=(0,d.$X)(g),r=(0,d.$X)(y);(0,s.useEffect)(function(){n({paneId:e,pane:t})},[n,e,t]),(0,s.useEffect)(function(){return function(){r(e)}},[r,e])}function D(){return(0,d.XD)(x)}function G(){return(0,d.Hg)(C)}function B(){return(0,d.$X)(k)}function P(){return(0,d.$X)(b)}function A(){return(0,d.$X)(Z)}function N(){return(0,d.Hg)(R)}function U(){return(0,d.Hg)(E)}function L(){var e=(0,d.yL)(C);return(0,f.Z)(function(){return function(t){return new Promise(function(n,r){var i=e.subscribe(function(e){e.includes(t)||(i(),n())})})}},[e])}},95684:function(e,t,n){n.d(t,{mK:function(){return s},qm:function(){return l},xx:function(){return c}});var r=n(90234),i=n(43429),o=n(68956),a=(0,r.cn)(!1);function l(){return(0,o.Hg)(a)}function c(){var e=(0,o.$X)(a);return(0,i.useCallback)(function(){return e(!0)},[e])}function s(e){var t=(0,o.$X)(a),n=(0,i.useRef)(!1);(0,i.useEffect)(function(){n.current||(n.current=!0,t(e))},[t,e])}},39327:function(e,t,n){n.d(t,{a9:function(){return a},kM:function(){return l}});var r=n(90234),i=n(68956),o=(0,r.cn)(null);function a(){return(0,i.$X)(o)}function l(){return(0,i.Hg)(o)}},20798:function(e,t,n){n.d(t,{OO:function(){return r},Uw:function(){return i},vw:function(){return o}});var r="replit-repltuned-v1-3b",i={"replit-repltuned-v1-3b":{},"replit-repltuned-v1-5-3b":{},"replit-v1-5-3b":{},"gpt-3.5-turbo":{implementation:"chat-as-completion",implementationSettings:{model:"gpt-3.5-turbo"}}},o=new Set(Object.keys(i))},50682:function(e,t,n){n.d(t,{J9:function(){return v},LK:function(){return g}});var r,i,o,a,l=n(34142),c=n(87682),s=n(32672),u=n.n(s),d=n(17676),f=n.n(d),h=n(48900),p="https://api.github.com",m=(r=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/contents"),{method:"GET",headers:n?{Authorization:"Bearer ".concat(n)}:{}})];case 1:if(404!==(r=i.sent()).status)return[3,3];return[4,r.json()];case 2:if("This repository is empty."===i.sent().message)return[2,{error:"This repository is empty."}];throw new d.AbortError(r.statusText);case 3:if(!r.ok)return[2,{error:"This repository could not be accessed, try again later"}];return[4,r.json().then(function(e){return e.map(function(e){return{path:e.path,type:e.type}})})];case 4:return[2,i.sent()]}})}),function(e){return r.apply(this,arguments)}),v=(i=(0,l._)(function(e){var t,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,f()(function(){return m({repoNameWithOwner:t,accessToken:n})},{retries:3,minTimeout:200,onFailedAttempt:function(e){e.retriesLeft||h.$e(function(e){e.setTag("github-import",!0),h.Tb(Error("Could not fetch repository files."))})}})];case 1:return[2,r.sent()]}})}),function(e){return i.apply(this,arguments)}),g=(o=(0,l._)(function(e){var t,n,r,i;return(0,c.Jh)(this,function(o){switch(o.label){case 0:return t=e.repoNameWithOwner,n=e.filePath,r=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/contents/").concat(n),{method:"GET",headers:r?{Authorization:"Bearer ".concat(r)}:{}})];case 1:if(!(i=o.sent()).ok)return[2,{error:"This file could not be accessed, try again later"}];return[4,i.json()];case 2:return[2,o.sent()]}})}),function(e){return o.apply(this,arguments)}),y=(a=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/languages"),{method:"GET",headers:n?{Authorization:"Bearer ".concat(n)}:{}})];case 1:if(404===(r=i.sent()).status)throw new d.AbortError(r.statusText);if(!r.ok)return[3,3];return[4,r.json()];case 2:return[2,i.sent()];case 3:return[2,{error:"Error fetching repository languages."}]}})}),function(e){return a.apply(this,arguments)});(0,l._)(function(e){var t,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,f()(function(){return y({repoNameWithOwner:t,accessToken:n})},{retries:3,minTimeout:200,onFailedAttempt:function(e){e.retriesLeft||h.$e(function(e){e.setTag("github-import",!0),h.Tb(Error("Could not fetch repository language."))})}})];case 1:return[2,r.sent()]}})}),(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:t=e.repoNameWithOwner,n=e.accessToken,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,u()("".concat(p,"/repos/").concat(t),{method:"GET",headers:n?{Authorization:"Bearer ".concat(n)}:{}})];case 2:if(404===(r=i.sent()).status)return[2,!0];if(!r.ok)return[2,!1];return[4,r.json()];case 3:if(i.sent().private)return[2,!0];return[2,!1];case 4:return i.sent(),[2,!1];case 5:return[2]}})})},70078:function(e,t,n){function r(e){return 15113696===e}function i(e){return 777914===e||r(e)||3944703===e}n.d(t,{v4:function(){return r},xm:function(){return i}})},94376:function(e,t,n){n.d(t,{I:function(){return i},z:function(){return r}});var r=100,i=250},95597:function(e,t,n){n.d(t,{F5:function(){return d},Hk:function(){return s},Kd:function(){return u},N$:function(){return c},Ob:function(){return l},Vl:function(){return a},Vt:function(){return r},ig:function(){return i},lF:function(){return o}});var r=/^([A-Za-z0-9_]{1,15})\/?$/,i=/^([%A-Za-z0-9]+|-)*\/?$/,o=/^([A-Za-z\d](?:[A-Za-z\d]|-){0,38})\/?$/,a=/^https:\/\/(www\.)?youtube\.com(\/(c|channel|user|@(\w)+))*(\/([A-Za-z0-9_-]+))*(\/?)$/,l=/^(.{2,32}#[0-9]{4})$|^([a-zA-Z0-9_.]{2,32})$/,c="https://twitter.com/",s="https://www.linkedin.com/in/",u="https://github.com/",d=/\/$/},44471:function(e,t,n){n.d(t,{Eg:function(){return m},UF:function(){return u},mD:function(){return l},r0:function(){return d},v:function(){return p},xi:function(){return h}});var r=n(45903),i=n(25e3),o=n(21289),a=n(39426);function l(e){return e.split(".").pop()}function c(e,t){return e.some(function(e){return e.path===t})}function s(e,t){var n=e.findIndex(function(e){return l(e.path)===l(t)});if(-1===n)return e;var a=(0,i._)((0,r._)({},e[n]),{path:t});return(0,o._)(e.slice(0,n)).concat([a],(0,o._)(e.slice(n+1)))}function u(e){var t=[];return e.forEach(function(e){var n=l(e.path),r=a.ZP.allSupportedByPopularity().find(function(e){return e.ext===n});r&&!t.includes(r.key)&&t.push(r.key)}),t}function d(e){var t=e.files,n=e.language,r=a.ZP.getMainFileName(null!=n?n:"python");if(!r)return t;var i=t;return c(t,r)||(i=s(i,r)),"html"!==n||c(t,"style.css")||(i=s(i,"style.css")),"html"!==n||c(t,"script.js")||(i=s(i,"script.js")),i}var f=["GoogleCloudPlatform","googleapis"];function h(e){return f.includes(e)}var p="b3294059-2b61-4b20-abde-f06b61a9a1b3",m="gcloud:v1-20230815-e6e4431"},1660:function(e,t,n){n.d(t,{Z:function(){return u}});var r,i,o=n(34142),a=n(70322),l=n(87682);(r=i||(i={})).CHANNEL_OPENED="CHANNEL_OPENED",r.OUTPUT_RECEIVED="OUTPUT_RECEIVED",r.STDERR_RECEIVED="STDERR_RECEIVED",r.STATE_CHANGED="STATE_CHANGED";var c=n(83493),s=n(58962);function u(e){var t,n=e.container,r=(0,c.ZP)(),u=null,d=!1;function f(){return(f=(0,o._)(function(){return(0,l.Jh)(this,function(e){if(d)throw Error("closed");return u?[2,u]:[2,new Promise(function(e){r.once(i.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}var h="",p="",m=n.openChannel({service:"exec"},function(e){var t=e.channel,n=!1;return t.onCommand(function(e){if(null!=e.output)h+=e.output,r.emit(i.OUTPUT_RECEIVED,e.output);else if(null!=e.stderr)p+=e.stderr,r.emit(i.STDERR_RECEIVED,e.stderr);else if(null!=e.state){if(!n){n=!0;return}r.emit(i.STATE_CHANGED,{state:e.state,outputBuffer:h,stderrBuffer:p}),e.state===s.api.State.Stopped&&(h="",p="")}}),u=t,r.emit(i.CHANNEL_OPENED,t),function(){u=null}});return{request:(t=(0,o._)(function(e){var t,n,r,i,o,c,u,d,h;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=e.env,n=e.args,i=void 0===(r=e.lifecycle)?s.api.Exec.Lifecycle.BLOCKING:r,c=void 0!==(o=e.splitStderr)&&o,u=(0,a._)(e,["env","args","lifecycle","splitStderr"]),[4,function(){return f.apply(this,arguments)}()];case 1:return h=(d=l.sent()).request({exec:{env:t,args:n,lifecycle:i,splitStderr:c}}),i===s.api.Exec.Lifecycle.STDIN&&"stdin"in u&&(d.send({input:u.stdin}),d.send({inputClose:{}})),[2,h]}})}),function(e){return t.apply(this,arguments)}),onOutput:function(e){return r.on(i.OUTPUT_RECEIVED,e),function(){r.off(i.OUTPUT_RECEIVED,e)}},onStderr:function(e){return r.on(i.STDERR_RECEIVED,e),function(){r.off(i.STDERR_RECEIVED,e)}},onStateChanged:function(e){return r.on(i.STATE_CHANGED,e),function(){r.off(i.STATE_CHANGED,e)}},getStatus:function(){return u?u.status:"closed"},dispose:function(){d=!0,m(),u=null}}}}}]);
//# sourceMappingURL=3650-665c2006f005b358.js.map